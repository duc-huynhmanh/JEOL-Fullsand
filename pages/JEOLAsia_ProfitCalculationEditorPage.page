<!--
 * Created : 2016/03/02 by Polus (Voxer)
 -->
<apex:page showHeader="false" standardStylesheets="true" applyHtmlTag="false" applyBodyTag="false" doctype="html-5.0"  controller="JEOLAsia_ProfitCalculationEditorPageCtrl">
 <apex:outputPanel layout="none" id="contentPage">
  <html>
    <head>
      <meta name="viewport" content="width=device-width, initial-scale=1" />
      <title>Salesforce -{!qdm.parentRec.name}-</title>
      <apex:stylesheet value="{!URLFOR($Resource.JQueryUI, 'JQueryUI/jquery-ui.min.css')}" />
      <apex:stylesheet value="{!URLFOR($Resource.JEOL_CustomizedMaterials, 'JEOL_CustomizedMaterials/bootstrap/css/bootstrap.css')}" />
      <apex:stylesheet value="{!URLFOR($Resource.JEOL_CustomizedMaterials, 'JEOL_CustomizedMaterials/JEOL_CustomBaseStyle.css')}" />
      <!--[if IE 8.0]>
      <style>
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-item .quotation-detail-item[data-depth="0"] .indent-wrap:after {
          display: none;
        }
      </style>
      <script>
        document.createElement('button');
      </script>
      <![endif]-->
      <style>
        .contents .page-header {
          z-index: 2;
          position :relative;
          margin-bottom: 42px;
        }
        .contents .contents-body .section .section-body hr {
          float: left;
        }
        .contents .contents-body .button-area .section-body .customButton {
          float: left;
        }
        .customButtonDisabled {
          font-family: メイリオ, 'Lucida Grande','Hiragino Kaku Gothic ProN', 'ヒラギノ角ゴ ProN W3', Meiryo, sans-serif !important;
          font-size: 13px !important;
          font-weight: 100 !important;
          padding: 4px 16px !important;
        }
        .contents .contents-body .navi-area {
          background-color: #7e9bc1;
          box-shadow: 0 1px 3px rgba(0,0,0,0.15);
          width: 100%;
          position: absolute;
          top: 0px;
          left: 0px;
          margin-top: 49px;
        }
        .contents .contents-body .navi-area.fixed-top {
          z-index: 2;
          position: fixed;
          margin-top: 0px;
        }
        .contents .contents-body .navi-area .section-body {
          padding: 4px 8px;
          margin: 0px auto;
          position: relative;
          z-index: 1;
        }
        .contents .contents-body .navi-area .section-body .navi-buttons {
          float: left;
          margin-right: 16px;
        }
        .contents .contents-body .navi-area .section-body .navi-buttons.right {
          float: right;
          margin-right: 0px;
          margin-left: 16px;
        }
        .contents .contents-body .navi-area .section-body .navi-item {
          margin-right: -1px;
          float: left;
        }
        .contents .contents-body .navi-area .section-body .navi-item>* {
          border-radius: 0;
        }
        .contents .contents-body .navi-area .section-body .navi-item:first-child>* {
          border-top-left-radius: 4px;
          border-bottom-left-radius: 4px;
        }
        .contents .contents-body .navi-area .section-body .navi-item:last-child {
          margin-right: 0px;
        }
        .contents .contents-body .navi-area .section-body .navi-item:last-child>* {
          border-top-right-radius: 4px;
          border-bottom-right-radius: 4px;
        }
        .contents .contents-body .navi-area .section-body .navi-item div[data-type="dropdown"] button[data-type="button"] {
          width: auto;
          padding: 0px 16px;
          border-radius: 0px;
          margin: 0px auto;
          border: 1px solid #7e9bc1;
          color: #2f4159;
        }
        
        .contents .contents-body .quotation-area .section-body .quotation-information {
          box-shadow: 0 1px 3px rgba(0,0,0,0.15);
          border: 1px solid #ddd;
          background-color: #ffffff;
        }
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-item {
          float: left;
          padding: 8px;
        }
        .contents .contents-body .quotation-area .section-body .quotation-information .field-label {
          font-size: 12px;
        }
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-item .quotation-item-header {
          width: 100%;
          border-radius: 2px;
          background-color: #becde0;
          margin: 0 0 4px 0;
          border: 1px solid transparent;
        }
        
        .backgroundcolorgrey {
          background-color: #dddddd !important;
        }

        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-item .quotation-item-header .header-title {
          float: left;
          display: block;
          padding: 8px;
        }
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-item.shipment-account-area .quotation-item-header .customButton {
          float: right;
          display: block;
          margin: 3px;
        }
        .updateRateButton {
          float: right;
          display: block;
          margin: 3px !important;
        }
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-item .quotation-item-body>* {
          float: left;
        }
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-item .quotation-item-body {
          width: 100%;
          border: 1px solid transparent;
          position: relative;
        }
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations .quotation-detail-header .quotation-detail-header-item {
          float: left;
        }
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations .quotation-detail-header .quotation-detail-header-item.customButton,
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations .quotation-detail-header .quotation-detail-header-item.disabled-button {
          padding: 6px;
          margin: 3px 0px 3px 3px;
        }
        .refreshButton-disabled.disabled-button {
          cursor: wait;
        }
        .disabled-button .refresh-icon {
          border-top-color: #ddd;
          border-left-color: #ddd;
          border-bottom-color: #ddd;
          background-color: #f9f9f9;
        }
        .disabled-button .refresh-icon:before {
          border-left-color: #ddd;
        }
        .contents .quotation-detail-action {
          display: block;
          border: 1px solid transparent;
          width: 30px;
          padding: 0px;
          text-align: center;
          text-decoration: none;
          cursor: pointer;
        }
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations .quotation-detail-list .quotation-detail-item {
          border: 1px solid transparent;
          margin: 2px 0px;
        }
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations .quotation-detail-list .quotation-detail-item[data-type="3"] {
          background-color: #d9edeb;
          border-radius: 8px;
        }
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations .quotation-detail-list .quotation-detail-item[data-type="4"] {
          background-color: #F9E4EC;
          border-radius: 8px;
        }
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations .quotation-detail-list .quotation-detail-item[data-type="5"] {
          background-color: #abcdef;
          border-radius: 8px;
        }
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations .quotation-detail-list .quotation-detail-item .quotation-detail-productName.quotation-detailA-productName,
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations .quotation-detail-list .quotation-detail-item .quotation-detail-productName.quotation-detailB-productName,
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations .quotation-detail-list .quotation-detail-item .quotation-detail-productName.quotation-detailG-productName {
          padding-left: 30px;
        }
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations .quotation-detail-header .quotation-detail-header-item,
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations .quotation-detail-list .quotation-detail-item .field {
          margin-left: 8px;
        }
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations .quotation-detail-list .quotation-detail-item .field .indent-wrap {
          //height: 30px;
          position: relative;
        }
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations .quotation-detail-list .quotation-detail-item .field .indent-wrap .field-value {
          height: 30px;
          resize: none;
        }
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations .quotation-detail-list .quotation-detail-item .field .indent-wrap .field-value:noborder{
          height: 30px;
          resize: none;
        }
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations .quotation-detail-list .quotation-detail-item .field .indent-wrap .field-value:focus {
          resize: vertical;
        }
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations .quotation-detail-list .quotation-detail-item .field:first-child {
          margin-left: 0px;
        }
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations .quotation-detail-list .quotation-detail-item .field .sortableAction {
          height: 30px;
          box-shadow: none;
          transition: box-shadow 0.1s linear 0s;
          background-color: #FFFFFF;
          border-radius: 4px;
        }
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations .quotation-detail-list .quotation-detail-item .field .sortableAction:hover {
          box-shadow: 0 1px 3px rgba(0,0,0,0.40);
        }
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations .quotation-detail-list .quotation-detail-childWrap-itemA .quotation-detail-item .field .sortableAction:hover,
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations .quotation-detail-list .quotation-detail-childWrap-itemB .quotation-detail-item .field .sortableAction:hover,
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations .quotation-detail-list .quotation-detail-childWrap-itemC .quotation-detail-item .field .sortableAction:hover,
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations .quotation-detail-list .quotation-detail-childWrap-itemD .quotation-detail-item .field .sortableAction:hover,
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations .quotation-detail-list .quotation-detail-childWrap-itemE .quotation-detail-item .field .sortableAction:hover,
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations .quotation-detail-list .quotation-detail-childWrap-itemF .quotation-detail-item .field .sortableAction:hover,
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations .quotation-detail-list .quotation-detail-childWrap-itemG .quotation-detail-item .field .sortableAction:hover {
          box-shadow: 0 1px 3px rgba(0,0,0,0.40) inset;
        }
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations .quotation-detail-list .quotation-detail-item .field .sortableAction:active {
          cursor: row-resize;
          box-shadow: none;
          transition: none;
        }
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations .quotation-detail-list .quotation-detail-item .field .optionalButton {
          width: 30px;
          padding: 4px 8px;
          border: 1px solid transparent;
          background-color: #FFF;
          color: #7e9bc1;
          text-decoration: none;
          display: inline-block;
          *display: inline;
          *zoom: 1;
          border-radius: 4px;
          transition: box-shadow 0.2s linear 0s, background-color 0.2s linear 0s, color 0.2s linear 0s; 
        }
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations .quotation-detail-list .quotation-detail-item .field .desabled-optionalButton {
          width: 30px;
          padding: 4px 8px;
          border: 1px solid transparent;
          background-color: #FFF;
          color: #7e9bc1;
        }
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations .quotation-detail-list .quotation-detail-item .field.open .optionalButton {
          background-color: #F2D350;
          border: 1px solid #fff;
          color: #fff;
          box-shadow: 0px 1px 3px rgba(0,0,0,0.2) inset;
        }
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations .quotation-detail-list .quotation-detail-item .field .optionalButton:hover {
          background-color: #F2D350;
          box-shadow: 0px 1px 3px rgba(0,0,0,0.2);
          color: #fff;
        }
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations .quotation-detail-list .quotation-detail-item .field.open .optionalButton:hover {
          background-color: #F2D350;
          box-shadow: 0px 1px 3px rgba(0,0,0,0.2) inset;
          color: #fff;
        }
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations .quotation-detail-list .quotation-detail-item .field .optionalButton:focus {
          position: relative;
          border-color: #00ABFF;
          box-shadow: 0 1px 5px rgba(0,171,255,0.25);
          outline: none;
        }
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations .quotation-detail-list .quotation-detail-item .field .optionalButton:active {
          box-shadow: 0px 1px 3px rgba(0,0,0,0.2) inset;
          border: 1px solid #fff;
          
        }
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations .quotation-detail-list .quotation-detail-item .field .detail-options {
          top: 2.4em;
        }
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations .quotation-detail-list .quotation-detail-item .field .detail-options .detail-options-item {
          width: 158px;
          cursor: default;
          margin: 0;
        }
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations .quotation-detail-list .quotation-detail-item .field .detail-options .detail-options-item .field-value {
          margin: 0;
          vertical-align: middle;
        }
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations .quotation-detail-list .quotation-detail-item .field .detail-options .detail-options-item a {
          width: 100%;
          margin: 0px;
          vertical-align: middle;
          display: block;
          padding: 4px 16px;
        }
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations .quotation-detail-header .configAction {
          width: 36px;
          border: 1px solid transparent;
        }
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations .quotation-detail-list .quotation-detail-item .field .configAction {
          width: 40px;
          top: 3px;
          height: 30px;
          cursor: default;
        }
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations .quotation-detail-list .quotation-detail-item .field .configAction .paragraph-option {
          float: left;
          display: block;
          width: 50%;
          text-decoration: none;
          height: 100%;
          vertical-align: middle;
          box-shadow: none;
          transition: box-shadow 0.1s linear 0s, background-color 0.1s linear 0s;
          font-size: 30px;
          line-height: 30px;
          color: #becde0;
          background-color: transparent;
          cursor: pointer;
        }
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations .quotation-detail-list .quotation-detail-item .field .configAction .paragraph-option.paragraph-up {
          border-radius: 8px 0px 0px 8px;
        }
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations .quotation-detail-list .quotation-detail-item .field .configAction .paragraph-option.paragraph-down {
          border-radius: 0px 8px 8px 0px;
        }
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations .quotation-detail-list .quotation-detail-item .field .configAction .paragraph-option:hover {
          transition: none;
          box-shadow: 0 1px 3px rgba(0,0,0,0.20);
          color: #fff;
          background-color: #7FCC9E;
        }
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations .quotation-detail-list .quotation-detail-item .field .configAction .paragraph-option:active {
          box-shadow: 0 1px 3px rgba(0,0,0,0.20) inset;
        }

        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations .quotation-detail-list .quotation-detail-item .field .deleteAction {
          height: 30px;
          box-shadow: none;
          background-color: transparent;
          transition: box-shadow 0.1s linear 0s, background-color 0.1s linear 0s, color 0.1s linear 0s;
          font-weight: bold;
          border-radius: 30px;
          line-height: 30px;
          color: #becde0;
        }
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations .quotation-detail-list .quotation-detail-item .field .deleteAction:hover {
          box-shadow: 0 1px 3px rgba(0,0,0,0.20);
          background-color: #E34B4B;
          color: #FFFFFF;
        }
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations .quotation-detail-list .quotation-detail-item .field .deleteAction:focus {
          box-shadow: 0 1px 3px rgba(0,0,0,0.20);
          background-color: #E34B4B;
          color: #FFFFFF;
        }
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations .quotation-detail-list .quotation-detail-item .field .deleteAction:active {
          transition: none;
          box-shadow: 0 1px 3px rgba(0,0,0,0.40) inset;
        }

        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations .quotation-detail-list .quotation-detail-item .field .sortableAction .sortable-pointer {
          width: 18px;
          height: 18px;
          background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAABkCAYAAABw4pVUAAAAoUlEQVR42u3bUQ0AIQxEwSpHCGYqjRpAwDaZl6yBzid3dW4/y1k5AhADAsSAADEgQAwIEIcAYkCAGBAgBgSIAQFiQOwPIkmSJEmSJEmSJEmKyTu2jxwMCBADAsSAADEgQBwCiAEBYkCAGBAgBgSIATEg/lOXJEmSJEmSJEmSFJ5nU2/qBgSIAQFiQIAYECAOAcSAADEgQAwIEAMCxIAYkA0br9/OdIXF4wsAAAAASUVORK5CYII=');
          background-repeat: no-repeat;
          background-position: center, center;
          background-size: 18px 14px;
          margin-top: 50%;
          top: -9px;
          position: relative;
          display: inline-block;
          *display: inline;
          *zoom: 1;
          vertical-align: middle;
        }
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations .quotation-detail-list .quotation-detail-item .field .panel-area {
          border: none;
          width: 45px;
        }
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations .quotation-detail-list .quotation-detail-item .field .panel-area .option-view-panel {
          float: left;
          width: 15px;
          height: 15px;
          border: none;
          border-radius: 2px;
          background-color: #eee;
          transition: background-color 0.2s linear 0s, box-shadow 0.2s linear 0s, color 0.2s linear 0s, box-shadow 0.2s linear 0s;
          font-size: 11px;
          text-align: center;
          line-height: 15px;
          cursor: pointer;
          color: #fff;
          font-weight: bold;
          text-shadow: 1px 1px 0px #999, -1px -1px 0px #999, -1px 1px 0px #999, 1px -1px 0px #999;
        }
        /*
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations .quotation-detail-list .quotation-detail-item .field .panel-area:hover .option-view-panel:hover {
          width: 30px;
          height: 30px;
          line-height: 30px;
          font-size: 14px;
        }
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations .quotation-detail-list .quotation-detail-item .field .panel-area:hover .option-view-panel {
          width: 0px;
          height: 0px;
          overflow: hidden;
        }
        */
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations .quotation-detail-list .quotation-detail-item .field .detail-options .detail-options-item .discountTarget,
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations .quotation-detail-list .quotation-detail-item .field .detail-options .detail-options-item .overhead,
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations .quotation-detail-list .quotation-detail-item .field .detail-options .detail-options-item .showAmount,
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations .quotation-detail-list .quotation-detail-item .field .detail-options .detail-options-item .jProdTarget,
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations .quotation-detail-list .quotation-detail-item .field .detail-options .detail-options-item .forbiddenTarget,
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations .quotation-detail-list .quotation-detail-item .field .detail-options .detail-options-item .commissionTarget,
        .blankTarget {
          width: 14px;
          height: 14px;
          display: inline-block;
          *display: inline;
          *zoom: 1;
          vertical-align: middle;
          margin-left: 8px;
        }
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations .quotation-detail-list .quotation-detail-item[data-discount-target="true"] .field .panel-area .option-view-panel.discountTarget,
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations .quotation-detail-list .quotation-detail-item[data-overhead-target="true"] .field .panel-area .option-view-panel.overhead,
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations .quotation-detail-list .quotation-detail-item[data-show-target="true"] .field .panel-area .option-view-panel.showAmount,
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations .quotation-detail-list .quotation-detail-item[data-jprod-target="true"] .field .panel-area .option-view-panel.jProdTarget,
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations .quotation-detail-list .quotation-detail-item[data-forbidden-target="true"] .field .panel-area .option-view-panel.forbiddenTarget,
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations .quotation-detail-list .quotation-detail-item[data-commission-target="true"] .field .panel-area .option-view-panel.commissionTarget {
          box-shadow: 0px 1px 3px rgba(0,0,0,0.4) inset;
          color: #666;
          text-shadow: 1px 1px 0px #fff, -1px -1px 0px #fff, -1px 1px 0px #fff, 1px -1px 0px #fff;
        }
        
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations .quotation-detail-list .quotation-detail-item .field .detail-options .detail-options-item .discountTarget,
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations .quotation-detail-list .quotation-detail-item[data-discount-target="true"] .field .panel-area .option-view-panel.discountTarget {
          background-color: #7E8DC6;
          color: #2E385D;
        }
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations .quotation-detail-list .quotation-detail-item .field .detail-options .detail-options-item .jProdTarget,
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations .quotation-detail-list .quotation-detail-item[data-jprod-target="true"] .field .panel-area .option-view-panel.jProdTarget {
          background-color: #6EBBB3;
          color: #346E68;
        }
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations .quotation-detail-list .quotation-detail-item .field .detail-options .detail-options-item .overhead,
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations .quotation-detail-list .quotation-detail-item[data-overhead-target="true"] .field .panel-area .option-view-panel.overhead {
          background-color: #6EBBB3;
          color: #346E68;
        }
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations .quotation-detail-list .quotation-detail-item .field .detail-options .detail-options-item .showAmount,
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations .quotation-detail-list .quotation-detail-item[data-show-target="true"] .field .panel-area .option-view-panel.showAmount {
          background-color: #FFC396;
          color: #60412A;
        }
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations .quotation-detail-list .quotation-detail-item .field .detail-options .detail-options-item .forbiddenTarget,
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations .quotation-detail-list .quotation-detail-item[data-forbidden-target="true"] .field .panel-area .option-view-panel.forbiddenTarget {
          background-color: #FFDF96;
          color: #665736;
        }
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations .quotation-detail-list .quotation-detail-item .field .detail-options .detail-options-item .commissionTarget,
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations .quotation-detail-list .quotation-detail-item[data-commission-target="true"] .field .panel-area .option-view-panel.commissionTarget {
          background-color: #DB81A5;
          color: #9A2D59;
        }
        .contents .contents-body .quotation-area .section-body .quotation-information .create-action-area .quotation-item-body {
          padding-left: 38px;
          position: relative;
        }
        .contents .contents-body .quotation-area .section-body .quotation-information .create-action-area .quotation-item-body .add-default-detail {
          float: left;
          border-radius: 4px 0 0 4px;
          margin-right: -1px;
        }
        .contents .contents-body .quotation-area .section-body .quotation-information .create-action-area .quotation-item-body .add-optional-details {
          float: left;
          border-radius: 0 4px 4px 0;
        }
        .contents .drag-placeholder {
          margin: 2px;
        }
        .contents .drag-placeholder>* {
          border-right: 1px dashed #ccc; 
          display: block;
          border: 1px solid transparent;
          overflow: hidden;
          border-radius: 4px;
        }
        .contents .drag-placeholder>*:after {
          padding: 5px 4px;
          text-align: center;
          margin: 4px 12px 4px 4px;
          border-radius: 4px;
          border: 1px dashed #CCC;
          background-color: #f6f6f6;
          color: #f6f6f6;
          position: relative;
          content: ".";
          display: block;
          left: 0px;
        }
        .contents .quotation-detail-childWrap-itemA,
        .contents .quotation-detail-childWrap-itemB,
        .contents .quotation-detail-childWrap-itemC,
        .contents .quotation-detail-childWrap-itemD,
        .contents .quotation-detail-childWrap-itemE,
        .contents .quotation-detail-childWrap-itemF,
        .contents .quotation-detail-childWrap-itemG {
          border: 1px dashed #7e9bc1;
          margin: -1px;
          overflow: hidden;
        }
        .contents .quotation-detail-childWrap-itemA>*,
        .contents .quotation-detail-childWrap-itemB>*,
        .contents .quotation-detail-childWrap-itemC>*,
        .contents .quotation-detail-childWrap-itemD>*,
        .contents .quotation-detail-childWrap-itemE>*,
        .contents .quotation-detail-childWrap-itemF>*,
        .contents .quotation-detail-childWrap-itemG>* {
          float: left;
        }
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-note-area {
          margin-top: 48px; 
        }
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-note-area .quotation-item-body .field .field-label {
          text-align: left;
          padding: 0 8px;
        }
        .contents .contents-body .action-area .section-body .save {
          float: left;
        }
        
        .contents .contents-body .quotation-detail-item .field .indent-wrap {
          position: relative;
          left: 0px;
          transition: left 0.2s linear 0s;
        }
        .contents .contents-body .quotation-detail-item[data-depth="0"] .indent-wrap {
          left: 0px;
        }
        .contents .drag-placeholder [data-depth="0"]:after {
          left: 82px;
        }
        .contents .contents-body  .quotation-detail-item[data-discount-target="true"] .quotation-detail-Amount {
          color: #999;
          text-decoration: line-through;
        }
        .contents .contents-body  .quotation-detail-item[data-depth="0"][data-discount-target="false"] .quotation-detail-Amount {
          font-weight: bold;
        }
        .contents .contents-body .quotation-detail-item[data-depth="1"] .indent-wrap {
          left: 24px;
        }
        .contents .contents-body .quotation-detail-item[data-depth="1"] .indent-wrap:after {
          color: #444;
        }
        .contents .drag-placeholder [data-depth="1"]:after {
          left: 106px
        }
        .contents .contents-body .quotation-detail-item[data-depth="2"] .indent-wrap {
          left: 48px;
        }
        .contents .contents-body .quotation-detail-item[data-depth="2"] .indent-wrap:after {
          color: #666;
        }
        .contents .drag-placeholder [data-depth="2"]:after {
          left: 130px
        }
        .contents .contents-body .quotation-detail-item[data-depth="3"] .indent-wrap {
          left: 72px;
        }
        .contents .contents-body .quotation-detail-item[data-depth="3"] .indent-wrap:after {
          color: #888;
        }
        .contents .drag-placeholder [data-depth="3"]:after {
          left: 154px;
        }
        .contents .contents-body .quotation-detail-item[data-depth="4"] .indent-wrap {
          left: 96px;
        }
        .contents .contents-body .quotation-detail-item[data-depth="4"] .indent-wrap:after {
          color: #aaa;
        }
        .contents .drag-placeholder [data-depth="4"]:after {
          left: 178px;
        }
        .contents .contents-body .quotation-detail-item[data-depth="5"] .indent-wrap {
          left: 120px;
        }
        .contents .contents-body .quotation-detail-item[data-depth="5"] .indent-wrap:after {
          color: #ccc;
        }
        .contents .drag-placeholder [data-depth="5"]:after {
          left: 202px;
        }
        .contents .contents-body .quotation-detail-item .indent-wrap:after {
          content: "┗";
          position: absolute;
          top: 8px;
          left: 0px;
          opacity: 0;
          z-index: -1;
          transition: opacity 0.1s linear 0.1s, left 0.2s linear 0s;
        }
        .contents .contents-body .quotation-detail-item[data-depth="1"] .indent-wrap:after,
        .contents .contents-body .quotation-detail-item[data-depth="2"] .indent-wrap:after,
        .contents .contents-body .quotation-detail-item[data-depth="3"] .indent-wrap:after,
        .contents .contents-body .quotation-detail-item[data-depth="4"] .indent-wrap:after,
        .contents .contents-body .quotation-detail-item[data-depth="5"] .indent-wrap:after {
          z-index: 1;
          opacity: 1.0;
          left: -24px;
        }
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations .quotation-detail-list>.quotation-detail-item:first-child .field .configAction .paragraph-option,
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations .quotation-detail-list>.quotation-detail-childWrap-itemA:first-child>.quotation-detail-item:first-child .field .configAction .paragraph-option,
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations .quotation-detail-list>.quotation-detail-childWrap-itemB:first-child>.quotation-detail-item:first-child .field .configAction .paragraph-option,
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations .quotation-detail-list>.quotation-detail-childWrap-itemC:first-child>.quotation-detail-item:first-child .field .configAction .paragraph-option,
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations .quotation-detail-list>.quotation-detail-childWrap-itemD:first-child>.quotation-detail-item:first-child .field .configAction .paragraph-option,
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations .quotation-detail-list>.quotation-detail-childWrap-itemE:first-child>.quotation-detail-item:first-child .field .configAction .paragraph-option,
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations .quotation-detail-list>.quotation-detail-childWrap-itemF:first-child>.quotation-detail-item:first-child .field .configAction .paragraph-option,
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations .quotation-detail-list>.quotation-detail-childWrap-itemG:first-child>.quotation-detail-item:first-child .field .configAction .paragraph-option {
          display: none;
        }
        .contents .contents-body .quotation-area .section-body .quotation-information .contract-account-area,
        .contents .contents-body .quotation-area .section-body .quotation-information .shipment-account-area,
        .contents .contents-body .quotation-area .section-body .quotation-information .basic-information-area,
        .contents .contents-body .quotation-area .section-body .quotation-information .option-field-area,
        .contents .contents-body .quotation-area .section-body .quotation-information .organization-information-area,
        .contents .contents-body .quotation-area .section-body .quotation-information .create-action-area,
        .contents .contents-body .quotation-area .section-body .quotation-information .total-amount-area {
          width: 50%;
        }
        .contents .contents-body .quotation-area .section-body .quotation-information .rate-area {
          width: 100%;
        }
        .contents .contents-body .quotation-area .section-body .quotation-information .contract-account-area,
        .contents .contents-body .quotation-area .section-body .quotation-information .shipment-account-area {
          min-height: 320px;
        }


        .contents .contents-body .quotation-area .section-body .quotation-information .total-amount-area .quotation-item-body .field .subtitleLabel,
        .contents .contents-body .quotation-area .section-body .quotation-information .total-amount-area .quotation-item-body .field .customReductionTitle {
          margin: 0px 10px 0px 88px;
          text-align: right;
        }
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations {
          position: relative;
        }
        .contents .contents-body .quotation-area .section-body .quotation-information .main-information-area,
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations,
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-note-area {
          width: 100%;
        }
        .contents .contents-body .memo-area .section-body {
          box-shadow: 0 1px 3px rgba(0,0,0,0.15);
          border: 1px solid #ddd;
          background-color: #ffffff;
          padding: 8px;
          border-radius: 8px;
        }
        .contents .contents-body .memo-area .section-body .panel,
        .contents .contents-body .memo-area .section-body .panel .panel-header,
        .contents .contents-body .memo-area .section-body .panel .panel-body,
        .contents .contents-body .memo-area .section-body .panel .panel-body textarea {
          width: 100%;
          margin: 0;
        }
        .add-space {
          margin-top: 20px
        }

        .total-amount-area .quotation-item-body .field .field-value.commissionRate,
        .total-amount-area .quotation-item-body .field .field-value.discountRate,
        .total-amount-area .quotation-item-body .field .field-value.taxRate {
          width: 46px;
        }
        .discountSubtotalARateInput {
          width: 60px !important;
        }
        .quotation-item .quotation-item-header .quotation-detail-action,
        .deliveryPeriod {
          width: 32px;
        }
        .quoteValidityPeriod, .quoteValidityPeriodDays {
          width: 50px;
        }
        .month:after {
          content: "{!$Label.JEOL_QuotEdit_Label_Month}";          
        }
        .day:after {
          content: "day(s)";          
        }
        .quotation-detail-QuantityUnit {
          width: 45px;
        }
        .groupLeaderApproval,
        .branchManagerApproval,
        .quotation-detail-quantity,
        .quotation-detail-overheadRate,
        .quotation-detail-commissionRate,
        .quotation-detail-discountRate,
        .contents .field .field-label[for="discountRate"] {
          width: 60px;
        }
        .field.toggle .deliveryCondition1 {
          width: 61px;
        }
        
        .contents .field .field-label[for="discountAmount"] {
          width: {!IF(language <> 'ja', '126px;', '72px')};
        }
        .series,
        .master-QuantityUnit,
        .master-productPrice,
        .quotation-detail-QuantityUnit-rate {
          width: 80px;
        }
        .contents .field .field-label[data-target="deliveryDeadline"] {
          width: 127px;
        }
        .deliveryCondition1 {
          width: 60px;
        }
        .deliveryCondition2 {
          width: 240px;
        }
        .deliveryCondition3 {
          margin-left: 15px;
          width: 565px;
        }
        .contents .field.toggle .field-value.contractCode,
        .contents .field.toggle .field-value.shipmentCode {
          width: 67px;
          border-radius: 4px 0px 0px 4px;
          transition: border-color 0.2s linear 0s, box-shadow 0.2s linear 0s;
        }
        .contractCodeView {
          width: 97px;
          border-radius: 4px 0px 0px 4px;
          border-bottom: 0px;
          display: inline-block;
          padding: 4px 8px;
          height: 30px;
          vertical-align: middle;
          overflow: hidden;
          white-space: nowrap;
          }
          
        .contractNameView {
          width: 300px;
          border-radius: 4px 0px 0px 4px;
          border-bottom: 0px;
          display: inline-block;
          padding: 4px 8px;
          height: 30px;
          vertical-align: middle;
          overflow: hidden;
          white-space: nowrap;
          }

        .contractNameView2 {
          width: 270px;
          border-radius: 4px 0px 0px 4px;
          border-bottom: 0px;
          display: inline-block;
          padding: 4px 8px;
          height: 30px;
          vertical-align: middle;
          overflow: hidden;
          white-space: nowrap;
          }

        .contractBelongView {
          width: 150px;
          border-radius: 4px 0px 0px 4px;
          border-bottom: 0px;
          display: inline-block;
          padding: 4px 8px;
          height: 30px;
          vertical-align: middle;
          overflow: hidden;
          white-space: nowrap;
          }        

        .deliveryLocationSectionView {
          width: 110px;
          border-radius: 4px 0px 0px 4px;
          border-bottom: 0px;
          display: inline-block;
          padding: 4px 8px;
          height: 30px;
          vertical-align: middle;
          overflow: hidden;
          white-space: nowrap;
          }
          
        .deliveryLocationTextView {
          width: 287px;
          border-radius: 4px 0px 0px 4px;
          border-bottom: 0px;
          display: inline-block;
          padding: 4px 8px;
          height: 30px;
          vertical-align: middle;
          overflow: hidden;
          white-space: nowrap;
          }
        .unitBodyView {
          border-radius: 4px 0px 0px 4px;
          border-bottom: 0px;
          display: inline-block;
          padding: 4px 8px;
          height: 30px;
          vertical-align: middle;
          overflow: hidden;
          white-space: nowrap;
          }
        .otherTextView {
          width: 910px;
          border-radius: 4px 0px 0px 4px;
          border-bottom: 0px;
          display: inline-block;
          padding: 4px 8px;
          height: 30px;
          vertical-align: middle;
          overflow: hidden;
          white-space: nowrap;
          }
        .shipmentCode + .productSearchButton,
        .contractCode + .productSearchButton {
          float: none;
          vertical-align: middle;
        }
        .quotationDivision,
        .contractCode,
        .shipmentCode,
        .shipmentDistanceZone {
          width: 96px;
        }
        .contents .field .field-value.deliveryDeadline,
        .contents .field .field-value.quoteExpirationDate {
          width: 98px;
        }
        .contents .field .field-value.postalCode {
          padding: 4px 8px 4px 24px;
          width: 100px;
        }
        .quotation-detail-UnitPrice {
          width: 94px;
        }
        .contents .field .field-label.quotationLimitDateLabel {
          width: {!IF(language <> 'ja', '111px', '108px')};
        }
        
        .contents .field .field-label[for="quoteNo"],
        .contents .field .field-label[for="quotationType"],
        .contents .field .field-label[for="createdByName"],
        .contents .field .field-label[for="issueDate"],
        .contents .field .field-label[for="CustomerPurchaseOrder"],
        .contents .field .field-label[for="printedDate"],
        .contents .field .field-label[for="quotationRequestedDate"],
        .contents .field .field-label[for="customerQuotationRequestedNo"],
        .contents .field .field-label[for="groupLeaderApproval"],
        .contents .field .field-label[for="branchManagerApproval"] {
          width: 112px;
        }
        
        .quotationRequestedDate,
        .issueDate,
        .CustomerPurchaseOrder {
          margin-left: -4px;
        }
        
        .quotation-detail-Amount,
        .quotation-detail-totalDiscountAmount  {
          margin-left: 4px;
          width: 112px;
        }
        .contents .field .field-value.quotation-detail-ModelType {
          width: 109px;
        }
        .contents .field.toggle .field-value.quotation-detail-ModelType {
          width: 80px;
          position: relative;
          border-radius: 4px 0px 0px 4px;
          float: left;
          transition: border-color 0.2s linear 0s, box-shadow 0.2s linear 0s;
        }

        .contents .field .field-value.quotation-detail-ModelType.not-found-alert{
          border-color: #e34b4b;
          box-shadow: 0px 1px 3px rgba(227, 75, 75, 0.4), 0px 1px 3px rgba(0,0,0,0.15) inset;
        }
        .contents .field .field-value.quotation-detail-ModelType.not-found-alert:focus {
          box-shadow: 0 1px 5px rgba(0,0,0,0.30) inset, 0px 1px 3px rgba(227, 75, 75, 0.4);
        }
        .contents .field.toggle .field-value + .productSearchButton {
          display:inline-block;
          *display: inline;
          *zoom: 1;
        }
        
        .contractPersonInCharge,
        .shipmentPersonInCharge,
        .quotation-detail-header-item.quotation-detail-ModelType,
        .deliveryLocationSection,
        .durationYear,
        .paymentConditionSection {
          width: 112px;
        }
        .contents .field.toggle .field-value.unitBody {
          width: 122px;
          position: relative;
          border-radius: 4px 0px 0px 4px;
        }
        .contents .field .field-label[data-target="deliveryDate_Arbitrarily"] {
          width: 127px;
        }
        
        .createdByName,
        .createdDate {
          width: 148px;
        }
        .contractBelong,
        .contractPost,
        .contractPhone,
        .contractEmail,
        .contractFax,
        .shipmentBelong,
        .shipmentPost,
        .shipmentPhone,
        .shipmentEmail,
        .shipmentFax,
        .quoteNo,
        .branchNo,
        input.registerDate,
        input.issueDate,
        input.quotationRequestedDate,
        .printedDate,
        .quotation-detail-discountAmount,
        .unitBody,
        .acceptanceDate {
          width: 152px;
        }
        
        .quotationTypeView {
          width: 78px;
          border-bottom: 0px;
          display: inline-block;
          padding: 4px 8px;
          height: 30px;
          vertical-align: middle;
          }
        
        .field.toggle .department,
        .field.toggle .quotationType {
          width: 79px;
        }
        .department,
        .quotationType {
          width: 108px;
        }
        .departmentView {
          width: 108px;
          border-bottom: 0px;
          display: inline-block;
          padding: 4px 8px;
          height: 30px;
          vertical-align: middle;
          }
        
        .contents .field .field-label[data-target="deliveryPeriod"] {
          width: {!IF(language <> 'ja', '127px;', '156px')};
        }
        
        .total-amount-area .quotation-item-body .field .field-value,
        .salesPerson,
        .orgPhone,
        .orgFax,
        .salesAssistant {
          width: 172px;
        }
        .master-productName,
        .master-ModelType,
        .master-supplier {
          width: 180px;
        }
        .quotationSubtitleOutput,
        .quotationTotalAmountOutput {
          width: 192px;
        }
        .master-acountName {
          width: 200px;
        }
        .total-amount-area .quotation-item-body .field .field-label {
          width: 269px;
        }
        
        .organization-information-area .quotation-item-body .field .field-label {
          width: 120px;
        }
        
        .deliveryLocationText,
        .paymentConditionText {
          width: 282px;
          margin: 0 0 0 0px;
        }
        .contractName,
        .shipmentName {
          width: 250px;
          margin: 0 0 0 8px;
        }
        .lastModifiedDate,
        .orgName,
        .shipmentDistanceSection {
          width: 256px;
        }
        .customerQuotationRequestedNo {
          width: 384px;
        }
        .master-acountAddress {
          width: 308px;
        }
        .quotation-detail-productName {
          width: 320px;
        }

        .quotation-detail-productName.quotation-detailA-productName {
          width: 235px;
        }
        .quotation-detail-productName.quotation-detailA2SP-productName {
          width: 494px;
        }
        .quotation-detail-quantity.quotation-detailA-quantity {
          width: 50px;
        }
        .quotation-detail-UnitPrice.quotation-detailA-UnitPrice, 
        .quotation-detail-UnitPrice.quotation-detailA2SP-UnitPrice {
          width: 70px;
        }
        .quotation-detail-CatalogCurrency.quotation-detailA-CatalogCurrency, 
        .quotation-detail-CatalogCurrency.quotation-detailA2SP-CatalogCurrency {
          width: 50px;
        }
        .quotation-detail-CostPrice.quotation-detailA-CostPrice {
          width: 95px;
        }
        .quotation-detail-SalesPrice.quotation-detailA-SalesPrice {
          width: 95px;
        }

        .quotation-detail-CostPriceJPY.quotation-detailA2SP-CostPriceJPY, 
        .quotation-detail-CostPriceSalesUnit.quotation-detailA2SP-CostPriceSalesUnit, 
        .quotation-detail-SalesPrice.quotation-detailA2SP-SalesPrice {
          width: 95px;
        }

        .quotation-detail-header-item.quotation-detail-productName.quotation-detailA-productName, 
        .quotation-detail-header-item.quotation-detail-productName.quotation-detailA2SP-productName {
          margin-top: 8px;
        }
        .quotation-detail-header-item.quotation-detail-ModelType.quotation-detailA-ModelType {
          margin-top: 8px;
        }
        .quotation-detail-header-item.quotation-detail-quantity.quotation-detailA-quantity {
          margin-top: 8px;
        }
        .quotation-detail-header-item.quotation-detail-QuantityUnit.quotation-detailA-QuantityUnit, 
        .quotation-detail-header-item.quotation-detail-QuantityUnit.quotation-detailB-QuantityUnit, 
        .quotation-detail-header-item.quotation-detail-QuantityUnit.quotation-detailG-QuantityUnit {
          margin-top: 8px;
        }
        .quotation-detail-header-item.quotation-detail-UnitPrice.quotation-detailA-UnitPrice {
          margin-top: 8px;
        }
        .quotation-detail-header-item.quotation-detail-CatalogCurrency.quotation-detailA-CatalogCurrency {
          margin-top: 8px;
          margin-right: -8px;
        }
        .quotation-detail-header-item.quotation-detail-CostPrice.quotation-detailA-CostPrice {
          text-align: center;
        }
        .quotation-detail-header-item.quotation-detail-SalesPrice.quotation-detailA-SalesPrice {
          text-align: center;
        }

        .quotation-detail-header-item.quotation-detail-CostPriceJPY.quotation-detailA2SP-CostPriceJPY, 
        .quotation-detail-header-item.quotation-detail-CostPriceSalesUnit.quotation-detailA2SP-CostPriceSalesUnit, 
        .quotation-detail-header-item.quotation-detail-SalesPrice.quotation-detailA2SP-SalesPrice{
          text-align: center;          
        } 


        hr.hrdoubleline {
            padding: 0;
            margin-left: 8px;
            width: 1024px;
            border: none;
            border-top: medium double #999;
            color: #999;
            text-align: center;
        }





        .quotation-detail-productName.quotation-detailC-productName,
        .quotation-detail-productName.quotation-detailE-productName,
        .quotation-detail-productName.quotation-detailF-productName {
          width: 200px;
        }
        .quotation-detail-productName.quotation-detailB-productName,
        .quotation-detail-productName.quotation-detailG-productName {
          width: 160px;
        }
        .quotation-detail-productName.quotation-detailD-productName {
          width: 182px;
        }
        .quotation-detail-Description.quotation-detailC-Description,
        .quotation-detail-Description.quotation-detailE-Description,
        .quotation-detail-Description.quotation-detailF-Description {
          width: 130px;
        }
        .quotation-detail-Description.quotation-detailB-Description,
        .quotation-detail-Description.quotation-detailG-Description {
          width: 120px;
        }
        .quotation-detail-Description.quotation-detailD-Description {
          width: 100px;
        }
        .quotation-detail-quantity.quotation-detailB-quantity,
        .quotation-detail-quantity.quotation-detailC-quantity,
        .quotation-detail-quantity.quotation-detailE-quantity,
        .quotation-detail-quantity.quotation-detailF-quantity,
        .quotation-detail-quantity.quotation-detailG-quantity {
          width: 50px;
        }
        .quotation-detail-quantity.quotation-detailD-quantity {
          width: 65px;          
        }
        .quotation-detail-UnitPrice.quotation-detailB-UnitPrice,
        .quotation-detail-UnitPrice.quotation-detailC-UnitPrice,
        .quotation-detail-UnitPrice.quotation-detailD-UnitPrice,
        .quotation-detail-UnitPrice.quotation-detailE-UnitPrice,
        .quotation-detail-UnitPrice.quotation-detailF-UnitPrice,
        .quotation-detail-UnitPrice.quotation-detailG-UnitPrice {
          width: 70px;
        }
        .quotation-detail-CatalogCurrency.quotation-detailB-CatalogCurrency,
        .quotation-detail-CatalogCurrency.quotation-detailC-CatalogCurrency,
        .quotation-detail-CatalogCurrency.quotation-detailD-CatalogCurrency,
        .quotation-detail-CatalogCurrency.quotation-detailE-CatalogCurrency,
        .quotation-detail-CatalogCurrency.quotation-detailF-CatalogCurrency,
        .quotation-detail-CatalogCurrency.quotation-detailG-CatalogCurrency {
          width: 50px;
        }
        .quotation-detail-CostPrice.quotation-detailB-CostPrice,
        .quotation-detail-CostPrice.quotation-detailC-CostPrice,
        .quotation-detail-CostPrice.quotation-detailD-CostPrice,
        .quotation-detail-CostPrice.quotation-detailE-CostPrice,
        .quotation-detail-CostPrice.quotation-detailF-CostPrice,
        .quotation-detail-CostPrice.quotation-detailG-CostPrice {
          width: 70px;
        }
        .quotation-detail-SalesPrice.quotation-detailB-SalesPrice,
        .quotation-detail-SalesPrice.quotation-detailC-SalesPrice,
        .quotation-detail-SalesPrice.quotation-detailD-SalesPrice,
        .quotation-detail-SalesPrice.quotation-detailE-SalesPrice,
        .quotation-detail-SalesPrice.quotation-detailF-SalesPrice,
        .quotation-detail-SalesPrice.quotation-detailG-SalesPrice {
          width: 70px;
        }
        .quotation-detail-CostPct.quotation-detailD-CostPct {
          width: 55px;
        }
        .quotation-detail-Supplier.quotation-detailB-Supplier,
        .quotation-detail-Remarks.quotation-detailC-Remarks,
        .quotation-detail-Remarks.quotation-detailE-Remarks,
        .quotation-detail-Remarks.quotation-detailF-Remarks,
        .quotation-detail-Remarks.quotation-detailG-Remarks {
          width: 106px;
        }
        .quotation-detail-Remarks.quotation-detailD-Remarks {
          width: 76px;
        }


        .quotation-detail-header-item.quotation-detail-productName.quotation-detailB-productName,
        .quotation-detail-header-item.quotation-detail-productName.quotation-detailC-productName,
        .quotation-detail-header-item.quotation-detail-productName.quotation-detailD-productName,
        .quotation-detail-header-item.quotation-detail-productName.quotation-detailE-productName,
        .quotation-detail-header-item.quotation-detail-productName.quotation-detailF-productName,
        .quotation-detail-header-item.quotation-detail-productName.quotation-detailG-productName {
          margin-top: 8px;
        }
        .quotation-detail-header-item.quotation-detail-Description.quotation-detailB-Description,
        .quotation-detail-header-item.quotation-detail-Description.quotation-detailC-Description,
        .quotation-detail-header-item.quotation-detail-Description.quotation-detailD-Description,
        .quotation-detail-header-item.quotation-detail-Description.quotation-detailE-Description,
        .quotation-detail-header-item.quotation-detail-Description.quotation-detailF-Description,
        .quotation-detail-header-item.quotation-detail-Description.quotation-detailG-Description {
          margin-top: 8px;
        }
        .quotation-detail-header-item.quotation-detail-quantity.quotation-detailB-quantity,
        .quotation-detail-header-item.quotation-detail-quantity.quotation-detailC-quantity,
        .quotation-detail-header-item.quotation-detail-quantity.quotation-detailD-quantity,
        .quotation-detail-header-item.quotation-detail-quantity.quotation-detailE-quantity,
        .quotation-detail-header-item.quotation-detail-quantity.quotation-detailF-quantity,
        .quotation-detail-header-item.quotation-detail-quantity.quotation-detailG-quantity {
          margin-top: 8px;
        }
        .quotation-detail-header-item.quotation-detail-UnitPrice.quotation-detailB-UnitPrice,
        .quotation-detail-header-item.quotation-detail-UnitPrice.quotation-detailC-UnitPrice,
        .quotation-detail-header-item.quotation-detail-UnitPrice.quotation-detailD-UnitPrice,
        .quotation-detail-header-item.quotation-detail-UnitPrice.quotation-detailE-UnitPrice,
        .quotation-detail-header-item.quotation-detail-UnitPrice.quotation-detailF-UnitPrice,
        .quotation-detail-header-item.quotation-detail-UnitPrice.quotation-detailG-UnitPrice {
          margin-top: 8px;
        }
        .quotation-detail-header-item.quotation-detail-CatalogCurrency.quotation-detailB-CatalogCurrency,
        .quotation-detail-header-item.quotation-detail-CatalogCurrency.quotation-detailC-CatalogCurrency,
        .quotation-detail-header-item.quotation-detail-CatalogCurrency.quotation-detailD-CatalogCurrency,
        .quotation-detail-header-item.quotation-detail-CatalogCurrency.quotation-detailE-CatalogCurrency,
        .quotation-detail-header-item.quotation-detail-CatalogCurrency.quotation-detailF-CatalogCurrency,
        .quotation-detail-header-item.quotation-detail-CatalogCurrency.quotation-detailG-CatalogCurrency {
          margin-top: 8px;
          margin-right: -8px;
        }
        .quotation-detail-header-item.quotation-detail-CostPrice.quotation-detailB-CostPrice,
        .quotation-detail-header-item.quotation-detail-CostPrice.quotation-detailC-CostPrice,
        .quotation-detail-header-item.quotation-detail-CostPrice.quotation-detailD-CostPrice,
        .quotation-detail-header-item.quotation-detail-CostPrice.quotation-detailE-CostPrice,
        .quotation-detail-header-item.quotation-detail-CostPrice.quotation-detailF-CostPrice,
        .quotation-detail-header-item.quotation-detail-CostPrice.quotation-detailG-CostPrice {
          text-align: center;
        }
        .quotation-detail-header-item.quotation-detail-SalesPrice.quotation-detailB-SalesPrice,
        .quotation-detail-header-item.quotation-detail-SalesPrice.quotation-detailC-SalesPrice,
        .quotation-detail-header-item.quotation-detail-SalesPrice.quotation-detailD-SalesPrice,
        .quotation-detail-header-item.quotation-detail-SalesPrice.quotation-detailE-SalesPrice,
        .quotation-detail-header-item.quotation-detail-SalesPrice.quotation-detailF-SalesPrice,
        .quotation-detail-header-item.quotation-detail-SalesPrice.quotation-detailG-SalesPrice{
          text-align: center;
        }
        .quotation-detail-header-item.quotation-detail-CostPct.quotation-detailD-CostPct {
          margin-top: 8px;
          text-align: center;
        }
        .quotation-detail-header-item.quotation-detail-Supplier.quotation-detailB-Supplier,
        .quotation-detail-header-item.quotation-detail-Remarks.quotation-detailC-Remarks,
        .quotation-detail-header-item.quotation-detail-Remarks.quotation-detailD-Remarks,
        .quotation-detail-header-item.quotation-detail-Remarks.quotation-detailE-Remarks,
        .quotation-detail-header-item.quotation-detail-Remarks.quotation-detailF-Remarks,
        .quotation-detail-header-item.quotation-detail-Remarks.quotation-detailG-Remarks {
          margin-top: 8px;
          margin-left: 16px !important;
        }






        .deliveryDate_ArbitrarilyTitle {
          width: 152px;
        }
        .deliveryDate_Arbitrarily {
          width: 210px;
          margin-left: 6px;
        }
        .contractAddress,
        .shipmentAddress,
        .contractUndergraduate,
        .shipmentUndergraduate,
        .orgAddress {
          width: 400px;
        }
        
        .quotation-detail-overheadBody,
        .quotation-detail-commissionBody {
          width: 437px;
        }
        .name,
        .otherText {
          width: 918px;
        }
        .contents .field.toggle .name {
          width: 888px;
          position: relative;
          border-radius: 4px 0px 0px 4px;
        }
        .quotation-detail-subtotalBody {
          width: 681px;
        }
        .quotation-detail-headingBody {
          width: 802px;
        }
        .quotation-note-area .quotation-item-body .field,
        .quotation-note-area .quotation-item-body .field .field-value {
          width: 100%
        }
        .number {
          text-align: right;
        }
        .section-separator {
          border-top: 1px solid #7e9bc1;
          padding: 0px;
          margin: 0 auto;
          width: 100%;
        }
        .productSearchButton {
          width: 30px;
          height: 30px;
          display: none;
          border: 1px solid silver;
          background-color: #fff;
          border-radius: 0px 4px 4px 0px;
          text-align: center;
          line-height: 40px;
          margin-left: -1px;
          float: right;
        }
        .productSearchButton:hover {
          background-color: #f2f5f8;
          border-color: #00ABFF;
          text-decoration: none;
          box-shadow: 0px 1px 5px rgba(0,171,255,0.25);
          position: relative;
        }
        .productSearchButton
        Button:before {
          background-color: #becde0;
          display: block;
          content: " ";
          position: absolute;
          border-radius: 2px;
          width: 4px;
          height: 12px;
          top: 0px;
          left: 0px;
          right: 0px;
          bottom: 0px;
          margin: auto;
        }
        .productSearchButton:hover {
          background-color: #f2f5f8;
          border-color: #00ABFF;
          text-decoration: none;
          box-shadow: 0px 1px 5px rgba(0,171,255,0.25);
          position: relative;
        }
        .productSearchButton:focus {
          position: relative;
          border-color: #00ABFF;
          box-shadow: 0 1px 5px rgba(0,171,255,0.25);
          outline: none;
        }
        .productSearchButton:active {
          background-color: #f2f5f8;
          border-color: #00ABFF;
          text-decoration: none;
          position: relative;
          box-shadow: 0px 1px 5px rgba(0,171,255,0.25) inset;
        }
        .productSelectButton {
          position: absolute;
          top: 5px;
          left: 5px;
          width: 20px;
          height: 20px;
          border: 2px solid #becde0;
          display: block;
          background: none;
          background-color: #fff;
          border-radius: 20px;
          transform: none;
          transition: box-shadow 0.1s linear 0s, transform 0.1s linear 0s;
          cursor: pointer;
        }
        .productSelectButton:before {
          background-color: #becde0;
          display: block;
          content: " ";
          position: absolute;
          border-radius: 2px;
          width: 4px;
          height: 12px;
          top: 0px;
          left: 0px;
          right: 0px;
          bottom: 0px;
          margin: auto;
        }        
        .productSelectButton:after {
          background-color: #becde0;
          display: block;
          content: " ";
          position: absolute;
          border-radius: 2px;
          width: 12px;
          height: 4px;
          top: 0px;
          left: 0px;
          right: 0px;
          bottom: 0px;
          margin: auto;
        }
        .productSelectButton:hover {
          border-color: #7e9bc1;
          box-shadow: 1px 0px 3px rgba(0,0,0,0.20);
          transform: rotate(90deg);
        }
        .productSelectButton:hover:before {
          background-color: #7e9bc1;
        }
        .productSelectButton:hover:after {
          background-color: #7e9bc1;
        }
        .productSelectButton:active {
          cursor: pointer;
          box-shadow: 1px 0 3px rgba(0,0,0,0.40) inset;
        }
        .contents div[data-type="dropdown"] {
          display: block;
          position: relative;
        }
        .contents div[data-type="dropdown"]:after {
          content: "";
          display: block;
          height: 0px;
          clear: both;
        }
        .contents div[data-type="dropdown"] *[data-type="label"] {
          display: block;
          float: left;
        }
        .contents div[data-type="dropdown"] input[type="text"][data-type="input-field"] {
          display: block;
          float: left;
          border-radius: 4px 0px 0px 4px;
          border: 1px solid silver;
          box-shadow: 0 1px 3px rgba(0,0,0,0.15) inset;
          transition: box-shadow 0.1s linear 0s;
          height: 30px;
        }
        .contents div[data-type="dropdown"] input[type="text"][data-type="input-field"] + .productSearchButton {
          float: left;
          border-radius: 0px;
        }
        .contents div[data-type="dropdown"] input[type="text"][data-type="input-field"]:focus {
          position: relative;
        }
        .contents div[data-type="dropdown"] button[data-type="button"] {
          display: block;
          float: left;
          margin: 0px 0px 0px -1px;
          border-radius: 0px 4px 4px 0px;
          border: 1px solid silver;
          height: 30px;
          background-image: none;
          font-weight: normal;
          background-color: #fff;
          padding: 0px;
          text-aling: center;
          color: #7FCC9E;
          width: 20px;
          transition: box-shadow 0.2s linear 0s, background-color 0.2s linear 0s, border 0.2s linear 0s;
        }
        .contents div[data-type="dropdown"] button[data-type="button"]:hover {
          box-shadow: 0px 1px 3px rgba(0,0,0,0.2);
          background-color: #f2f5f8;
        }
        .contents div[data-type="dropdown"] button[data-type="button"]:active {
          box-shadow: 0px 1px 3px rgba(0,0,0,0.2) inset;
          background-color: #f2f5f8;
        }
        .contents div[data-type="dropdown"] button[data-type="button"]:focus {
          background-color: #f2f5f8;
          border-color: #00ABFF;
          box-shadow: 0px 1px 3px rgba(0,0,0,0.2) inset, 0 1px 5px rgba(0,171,255,0.25);
          outline: none;
        }
        .contents div[data-type="dropdown"].open ul[data-type="list"] {
          display: block;
          user-select: none;
          -moz-user-select: none;
          -webkit-user-select: none;
          -ms-user-select: none;  
        }
        .contents div[data-type="dropdown"] ul[data-type="list"] {
          display: none;
          position: absolute;
          height: auto;
          background-color: #fff;
          border: 1px solid silver;
          border-radius: 0px 0px 4px 4px;
          z-index: 2; <!-- Changed from 1 by Polus (2015/06/09) because the buttons "+" were appearing inside the dropdown -->
          top: 32px;
          right: 0px;
          box-shadow: 0px 2px 4px rgba(0,0,0,0.3);
          overflow: hidden;
        }
        .contents div.top[data-type="dropdown"] ul[data-type="list"] {
          bottom: 100%;
          top: auto;
          border-radius: 4px 4px 0px 0px;
        }
        .contents div[data-type="dropdown"] ul.scroll[data-type="list"] {
          max-height: 158px;
          overflow-y: auto;
        }
        .contents div[data-type="dropdown"] ul[data-type="list"] li hr {
          margin: 0px;
        }
        .contents div[data-type="dropdown"] ul[data-type="list"] li[data-type="item"] {
          padding: 0px;
          min-width: 76px;
          text-align: left;
          cursor: pointer;
          white-space: nowrap;
        }
        .contents div[data-type="dropdown"] ul[data-type="list"] li[data-type="item"]:hover {
          background-color: #f2f5f8;
        }

        .contents div[data-type="dropdown"] ul[data-type="list"] li[data-type="item"]:hover hr {
          margin: 4px;
        }
        
        .contents div[data-type="dropdown"] ul[data-type="list"] li[data-type="item"].close-option {
          text-align: center;
          width: 100%;
          margin: 0px;
        }
        .contents div[data-type="dropdown"] ul[data-type="list"] li[data-type="item"] a {
          padding: 4px 16px;
          display: block;
          width: 100%;
          text-decoration: none;
        }
        .contents div[data-type="dropdown"] ul[data-type="list"] li[data-type="item"] a:empty {
          height: 24px;
        }
        .contents div[data-type="dropdown"] ul[data-type="list"] li[data-type="item"] a:focus {
          background-color: #f2f5f8;
          outline: none;
        }
        
        .contents div[data-type="dropdown"] ul[data-type="list"] li[data-type="item"].close-option .closeButton {
          text-decoration: none;
          display: block;
          height: 30px;
          line-height: 30px;
          width: 100%;
        }
        .ajax-status-start {
          width: 100%;
          height: 100%;
          background-color: transparent;
          position: absolute;
          top: 0px;
          left: 0px;
          z-index: 1;
          text-align: center;
          font-size: 20px;
          color: #666;
        }
        .ajax-status-start-page {
          width: 100%;
          height: 100%;
          background-color: transparent;
          position: fixed;
          top: 0px;
          left: 0px;
          z-index: 10000;
          text-align: center;
          font-size: 20px;
          color: #666;
        }
        .ajax-status-start .ajax-status-start-inner {
          position: absolute;
          top: 0px;
          left: 0px;
          right: 0px;
          height: 100%;
          margin: auto;
        }
        .ajax-loading:before {
          content: "";
          background-repeat: no-repeat;
          background-image: url("{!URLFOR($Resource.JEOL_CustomizedMaterials, 'JEOL_CustomizedMaterials/images/ajax-2.gif')}");
          background-position: center center;
          display: block;
          position: absolute;
          top: 0px;
          left: 0px;
          right: 0px;
          bottom: 0px;
          height: 100%;
          width: 100%;
          z-index: 2;
        }
        .ajax-loading:after {
          content: "";
          width: 100%;
          height: 100%;
          position: absolute;
          top: 0px;
          left: 0px;
          z-index: 1;
          background-image: url("{!URLFOR($Resource.JEOL_CustomizedMaterials, 'JEOL_CustomizedMaterials/images/alpha-bg.png')}");
        }
        .contents .contents-body .section.error-area {
          padding: 0px;
          margin-bottom: 0px;
        }
        .field.ajaxRequestStatus {
          width: 100%;
          padding-left: 100px;
          margin: 0px;
        }
        .field.ajaxRequestStatus .ajaxStatusView {
          line-height: 30px;
          margin-left: 8px;
          color: #22816b;
        }
        .contents .field input.field-value.reference-field-hidden {
          height: 0px;
          width: 0px;
          padding: 0px !important;
          border: none;
          visibility: collapse;
        }
        .requireField:before {
          content: "※";
          display: inline;
          color: #e34b4b;
        }
        input::-webkit-calendar-picker-indicator {
          display: none;
        }
        .rate-title {
          text-align:center;
          background-color: #E6E6E6;
        }


        .profitCalcTotalProfitRate {
          font-size: 13px;
          display: inline-block;
          width: 50px !important;
        }

        .mightOverflow {
          overflow: hidden;
          white-space: nowrap;
          text-overflow: ellipsis;
        }

      </style>
      <apex:includeScript value="{!URLFOR($Resource.JQuery)}" />
      <apex:includeScript value="{!URLFOR($Resource.JQueryUI, 'JQueryUI/jquery-ui.min.js')}" />
      <apex:includeScript value="{!URLFOR($Resource.JEOL_CustomizedMaterials, 'JEOL_CustomizedMaterials/bootstrap/js/bootstrap.min.js')}" />
      <apex:includeScript value="{!URLFOR($Resource.JEOL_CustomizedMaterials, 'JEOL_CustomizedMaterials/PagerHelper.js')}" />
<!--
      
      <apex:outputPanel id="enhanceContractAccount">
      <script>
          var $j = jQuery.noConflict();
           function enhanceContractAccountLookup(){        
            $j('input[id$= contractAccountId_lkid]').val('{!qdm.parentRec.ContractAccount__c}');
            $j('input[id$= contractAccountId_lkold]').val('{!qdm.parentRec.ContractAccount__r.Name}');
            }
      </script>
      </apex:outputPanel>

      <apex:outputPanel id="enhanceShipmentAccount">
      <script>
          var $j = jQuery.noConflict();
           function enhanceShipmentAccountLookupxxx(){        
            $j('input[id$= shipmentAccountId_lkid]').val('{!qdm.parentRec.ShipmentAccount__c}');
            $j('input[id$= shipmentAccountId_lkold]').val('{!qdm.parentRec.ShipmentAccount__r.Name}');
            }
      </script>
      </apex:outputPanel>
-->
      <script>
        var $j = jQuery.noConflict();
        var safety = {!ISBLANK(qdm.parentRec.id)};
        var makeSafetyCheck = true;
        var makeSafetyCheck2 = true;
        var lastSuggest = 0;
        var lastsuggestval = '';
        var isMouseDown = false;
        var isRemoveMode = true;

        $j(document).on('mouseenter', '.mightOverflow', function() {
            var $this = $j(this);

            if(this.offsetWidth < this.scrollWidth && !$this.attr('title')){
                $this.attr('title', $this.text());
            }
        });

        $j(document).on('mouseenter', '.showTooltipEnglishText', function() {
            var $this = $j(this);
            $j('.EibunText').val($this.attr('title'));
        });

        $j(function(){
            var windwTransitions = (function(e){
                if (makeSafetyCheck2 && (makeSafetyCheck || document.activeElement.type === 'text')) {
                    var currentFocus = document.querySelector(':focus');
                    if (currentFocus && typeof currentFocus !== 'undefined') {
                        currentFocus.blur();
                    }
                    if (safety) {
                        e.returnValue = '内容に変更がありました。保存せずにページから離れますか？';
                    } else {
                        safety = true;
                    }
                }
            });
            if (window.addEventListener) {
                window.addEventListener('beforeunload', windwTransitions);
            } else if (window.attachEvent) {
                window.attachEvent('onbeforeunload', windwTransitions);
            } else {
                alert("画面遷移時に警告を出せません。ご注意ください。");
            }
            var $window = $j(window);
            $window.on('click',clearAction);
            $window.on('scroll',function(e){
                var beforeTop = window.beforeTop;
                var currentTop = $window.scrollTop();
                if (!beforeTop) {
                    beforeTop = 0;
                }
                if (beforeTop < currentTop && currentTop > 48) {
                    $j('.navi-area').addClass('fixed-top');
                } else if ((beforeTop > currentTop && currentTop <= 48) || currentTop == 0) {
                    $j('.navi-area').removeClass('fixed-top');
                }
                window.beforeTop = currentTop; 
            });
            $window.on('keydown',function(e){
                var $dropdown = $j('.open[data-type="dropdown"]');
                if (/(38|40|27)/.test(e.which) && $dropdown.length) {
                    e.preventDefault();
                    e.stopPropagation();
                    
                    if (e.which == 27) {
                        $dropdown.removeClass('open');
                        $dropdown.find('[data-type="button"]').trigger('focus');
                    }
                    
                    var $items = $dropdown.find('[data-type="list"] [data-type="item"]');
                    var $target = $j(e.target);
                    if ($target.attr('data-type') !== 'item') {
                        $target = $target.closest('[data-type="item"]');
                    }

                    var target = null;
                    if ($target.length) {
                      target = $target[0];
                    }
                    var index = 0;
                    if (target) {
                        index = $items.index(target);
                        if (e.which == 38 && index > 0) {
                            index--;
                        }
                        if (e.which == 40 && index < $items.length - 1) {
                            index++;
                        }
                    }
                    $items.eq(index).find('a,input').trigger('focus');
                }
            });
            contentInit();
        });

        function getCurrentJProdCostCurrency() {

            var salesPriceUnitValue = $j('.currencyCostIsoCode').val();
            if (!salesPriceUnitValue) {
                salesPriceUnitValue = $j("[id$='currencyCostIsoCodeView']").text();
            }

            return salesPriceUnitValue;
        }

        function getCurrentSalesCurrency() {

            var salesPriceUnitValue = $j('.currencySalesIsoCode').val();
            if (!salesPriceUnitValue) {
                salesPriceUnitValue = $j("[id$='currencySalesIsoCodeView']").text();
            }

            return salesPriceUnitValue;
        }


        function unlockSafety() {
            safety = false;
        }
        function lockSafety() {
            safety = true;
        }
        function contentInit() {
            initWithCalcurate();
            $j('#selected-list-A').droppable(droppableOption);
            $j('#selected-list-B').droppable(droppableOption);
            $j('#selected-list-G1').droppable(droppableOption);
            $j('#selected-list-G2').droppable(droppableOption);
            $j('#selected-list-catalog-A').droppable(droppableOption_catalogA);
            $j('#selected-list-catalog-G').droppable(droppableOption_catalogG);
            //$j('.content-panel').draggable({handle: ".content-header"});
            //$j('.subwindow').draggable({handle: '.content-header'});
            $j('#detailProductItemView').on('hidden.bs.modal', function () {
                $j('#detailProductItemView .selected-list .drop-target').empty();
                detailProductAItemManage.setTargetNode(null);
                detailProductBItemManage.setTargetNode(null);
                detailProductG1ItemManage.setTargetNode(null);
                detailProductG2ItemManage.setTargetNode(null);
                detailProductACatalogManage.setTargetNode(null);
                detailProductGCatalogManage.setTargetNode(null);
            });
        }
        function dorpdownAction(target) {
            var $target = $j(target).closest('[data-type="dropdown"]');
            if ($target.hasClass('open')) {
                $target.removeClass('open');
            } else {
                $j('.open').removeClass('open');
                $target.addClass('open');
            }
        }
        function clearAction(e) {
            var $target = $j(e.target).closest('[data-type="dropdown"]');
            if (!$target.hasClass('open')) {
                var $dropdown = $j('.open[data-type="dropdown"]');
                $dropdown.removeClass('open');
                //$dropdown.find('[data-type="button"]').trigger('focus');
            }
        }
        
        function setInputField(target) {
            var $target = $j(target);
            var $dropdown = $target.closest('[data-type="dropdown"]');
            var $inputField = $dropdown.find('[data-type="input-field"]');
            if ($target.attr('data-type') !== 'item') {
                $target = $target.closest('[data-type="item"]');
            }
            $inputField.val($target[0].getAttribute('data-value'));
            $inputField.trigger('focus');
            dorpdownAction(target);
        }
        function setSortableA() {
            var sortableArea = $j('.quotation-detail-listA');
            sortableArea.sortable(sortableOptionA);
        }
        function setSortableB() {
            var sortableArea = $j('.quotation-detail-listB');
            sortableArea.sortable(sortableOptionB);
        }
        function setSortableC() {
            var sortableArea = $j('.quotation-detail-listC');
            sortableArea.sortable(sortableOptionC);
        }
        function setSortableD() {
            var sortableArea = $j('.quotation-detail-listD');
            sortableArea.sortable(sortableOptionD);
        }
        function setSortableE() {
            var sortableArea = $j('.quotation-detail-listE');
            sortableArea.sortable(sortableOptionE);
        }
        function setSortableF() {
            var sortableArea = $j('.quotation-detail-listF');
            sortableArea.sortable(sortableOptionF);
        }
        function setSortableG() {
            var sortableArea = $j('.quotation-detail-listG');
            sortableArea.sortable(sortableOptionG);
        }

        function formatRate(target){
            var rateVal = transformCurrencyToInteger($j(target).val(), 9);
            if (rateVal == 0) rateVal = 1;
            $j(target).val(currencyFormat(rateVal.toFixed(9)));
        }

        function addDepth(target){
            var targetRow = $j(target).closest('.quotation-detail-item');
            var targetBefore = targetRow.prev('.quotation-detail-item');
            var depth = parseInt(targetRow[0].getAttribute('data-depth'), 10);
            if (targetBefore[0]) {
                var beforeDepth = parseInt(targetBefore[0].getAttribute('data-depth'), 10);
                var resultVal =  1 + depth;
                if (resultVal - beforeDepth > 1) {
                    resultVal--;
                }
                if (resultVal > 5) {
                    resultVal = 5;
                }
                targetRow[0].setAttribute('data-depth', resultVal);
                targetRow.find('.quotation-detail-depth').val(resultVal);
                initWithCalcurate();
            }
        }

        function removeDepth(target, isChain){
            var targetRow = $j(target).closest('.quotation-detail-item');
            var targetBefore = targetRow.prev('.quotation-detail-item');
            var depth = parseInt(targetRow[0].getAttribute('data-depth'), 10);
            var resultVal = 0;
            if (targetBefore[0]) {
                var beforeDepth = parseInt(targetBefore[0].getAttribute('data-depth'), 10);
                var resultVal =  0 + depth - 1;
                if (resultVal < 0) {
                    resultVal = 0;
                }
                targetRow[0].setAttribute('data-depth', resultVal);
                targetRow.find('.quotation-detail-depth').val(resultVal);
            }
            var targetAfter = targetRow.next('.quotation-detail-item');
            if (targetAfter[0]) {
                var nextNodeDepth = parseInt(targetAfter[0].getAttribute('data-depth'), 10);
                var conpareNum = (isChain ? 0 : 1);
                if (nextNodeDepth - resultVal > conpareNum) {
                    removeDepth(targetAfter[0], true);
                }
            }
            initWithCalcurate();
            
        }
        function eraseDepth(target) {
            var targetRow = $j(target).closest('.quotation-detail-item');
            var depth = parseInt(targetRow[0].getAttribute('data-depth'), 10);
            for (var i = depth; i >= 0; i--) {
                removeDepth(target);
            }
        }
        
        function initWithCalcurate() {
            RowManageA.create();
            RowManageB.create();
            RowManageC.create();
            RowManageD.create();
            RowManageE.create();
            RowManageF.create();
            RowManageG.create();
            calcurate();
        }

        function calcurate() {
            myDivObj = document.getElementById("isReadOnly");
            if ( !myDivObj || myDivObj.innerHTML != "1") {

              myDivObj2 = document.getElementById("isQTRestricted");

                if ( !myDivObj2 || myDivObj2.innerHTML != "1") {
                    RowManageA.calcurate();
                    RowManageB.calcurate();
                    RowManageC.calcurate();
                    RowManageD.calcurate();
                    RowManageE.calcurate();
                    RowManageF.calcurate();
                    RowManageG.calcurate();
                    calculate2spallMainForm();
                    setHeaderSubtotal();
                }

                setTotalAmount();
            }
        }

        // Fuction changing the discount type from Rate to Value and vice versa
        function discountChangeRateValueType() {
          var discountType= $j('.discountType').val();
          if (discountType === 'Rate') {
            $j('.discountType').val('Value');
          } else {
            $j('.discountType').val('Rate');
          }
        }

        function setHeaderSubtotal() {

            var isFixedPC = $j('.isFixedPC').text();

            var amt2spCostPriceJProdUnit = 0;
            var amt2spCostPriceSalesUnit = 0;
            var amt2spSalesPrice = 0;

            var $item2sprowitm = $j('.CostPriceJPYWithoutSales');
            var arrayLength = $item2sprowitm.length;
            for (var i = 0; i < arrayLength; i++) {
    
                var $targetRow = $j($item2sprowitm[i]).closest('.quotation-detail-itemA2SP');

                amt2spCostPriceJProdUnit += transformCurrencyToInteger($targetRow.find('.CostPriceJProdUnit').val(), 2);
                amt2spCostPriceSalesUnit += transformCurrencyToInteger($targetRow.find('.quotation-detailA2SP-CostPriceSalesUnit').text(), 2);
                amt2spSalesPrice += transformCurrencyToInteger($targetRow.find('.quotation-detailA2SP-SalesPrice').text(), 2);

            }

            amt2spCostPriceJProdUnit = parseFloat(parseFloat(amt2spCostPriceJProdUnit.toFixed(10)).toFixed(2));
            amt2spCostPriceSalesUnit = parseFloat(parseFloat(amt2spCostPriceSalesUnit.toFixed(10)).toFixed(2));
            amt2spSalesPrice = parseFloat(parseFloat(amt2spSalesPrice.toFixed(10)).toFixed(2));

            RowManageA.subTotalACostUnit += amt2spCostPriceJProdUnit;
            RowManageA.subTotalASalesUnit += amt2spCostPriceSalesUnit;
            RowManageA.subTotalAAfterDiscount += amt2spCostPriceSalesUnit;
            RowManageA.subTotalSalesA += amt2spSalesPrice;


            $j('.quotationSubtotalACostUnitOutput').text(currencyFormat(RowManageA.subTotalACostUnit.toFixed(2)));
            $j('.fieldSubtotalACostUnit').val(RowManageA.subTotalACostUnit);
            
            $j('.quotationSubtotalASalesUnitOutput').text(currencyFormat(RowManageA.subTotalASalesUnit.toFixed(2)));
            $j('.fieldSubtotalASalesUnit').val(RowManageA.subTotalASalesUnit);

            $j('.quotationSubtotalA').text(currencyFormat(RowManageA.subTotalAAfterDiscount.toFixed(2)));
            $j('.fieldSubtotalA').val(RowManageA.subTotalAAfterDiscount);

            $j('.quotationSubtotalBOutput').text(currencyFormat(RowManageB.subTotalB.toFixed(2)));
            $j('.fieldSubtotalB').val(RowManageB.subTotalB);

            $j('.quotationSubtotalCOutput').text(currencyFormat(RowManageC.subTotalC.toFixed(2)));
            $j('.fieldSubtotalC').val(RowManageC.subTotalC);

            $j('.quotationSubtotalDOutput').text(currencyFormat(RowManageD.subTotalD.toFixed(2)));
            $j('.fieldSubtotalD').val(RowManageD.subTotalD);

            $j('.quotationSubtotalEOutput').text(currencyFormat(RowManageE.subTotalE.toFixed(2)));
            $j('.fieldSubtotalE').val(RowManageE.subTotalE);

            $j('.quotationSubtotalFOutput').text(currencyFormat(RowManageF.subTotalF.toFixed(2)));
            $j('.fieldSubtotalF').val(RowManageF.subTotalF);

            var sumGrandTotal = RowManageA.subTotalAAfterDiscount + RowManageB.subTotalB + RowManageC.subTotalC + RowManageD.subTotalD + RowManageE.subTotalE + RowManageF.subTotalF;
            if (isFixedPC && isFixedPC == "0") {
              $j('.profitCalcGrandTotal').text(currencyFormat(sumGrandTotal.toFixed(2)));
              $j('.fieldGrandTotal').val(sumGrandTotal);
            }

            var sumSalesTotal = RowManageA.subTotalSalesA + RowManageB.subTotalSalesB + RowManageC.subTotalSalesC + RowManageD.subTotalSalesD + RowManageE.subTotalSalesE + RowManageF.subTotalSalesF;

            if (isFixedPC && isFixedPC == "0") {
              $j('.profitCalcStandardOfferAmount').text(currencyFormat(sumSalesTotal.toFixed(2)));
              $j('.fieldStandardOfferAmount').val(sumSalesTotal);
            }

            $j('.quotationSubtitleOutput').text(currencyFormat(sumSalesTotal.toFixed(2)));
            $j('.fieldQuotationSubtitleOutput').val(sumSalesTotal);

            if (isFixedPC && isFixedPC == "0") {
              // Get the Offer amount
              var offerAmount = transformCurrencyToInteger($j('.profitCalcOfferAmount').val(), 2);
              if (offerAmount !== 0) {
                $j('.profitCalcOfferAmount').val(currencyFormat(offerAmount.toFixed(2)));
              } else {
                $j('.profitCalcOfferAmount').val('');
              }

              var ProfitValue = offerAmount - sumGrandTotal;
              if (ProfitValue < 0) ProfitValue = 0;

              $j('.profitCalcTotalProfitValue').text(currencyFormat(ProfitValue.toFixed(2)));
              $j('.fieldProfitTotalValue').val(ProfitValue);

              var ProfitRate = ProfitValue / offerAmount * 100;
              var ProfitRateVal = ProfitValue / offerAmount;
              ProfitRate = parseFloat(ProfitRate.toFixed(10));
              ProfitRateVal = parseFloat(ProfitRateVal.toFixed(10));
              if (offerAmount === 0) {
                ProfitRate = 0;
                ProfitRateVal = 0;
              }

              $j('.profitCalcTotalProfitRate').text(currencyFormat(ProfitRate.toFixed(1) + '%'));
              $j('.fieldProfitTotalRate').val(ProfitRateVal.toFixed(3));
            }

        }
        
        var ItemWrap = function(target, parent) {
            this.target = target;
            this.$target = $j(target);
            if (target) {
                this.type = target.getAttribute('data-type');
            }
            this.parent = parent;
            var layerNum = 0;
            if (parent) {
                layerNum = parent.layer + 1;
            }
            this.layer = layerNum;
            this.children = new Array();
        };
        ItemWrap.prototype = {
            calc: function() {
                this.amountCalc();
            },

            getCostPriceJProdUnit: function(){
                var $row = this.$target;
                var amount = $row.find('.quotation-detail-CostPriceJProdUnit').val();
                return parseFloat(parseFloat(amount).toFixed(2));
            },

            getCostPriceSalesUnit: function(){
                var $row = this.$target;
                var amount = $row.find('.quotation-detail-CostPrice-input').val();
                return parseFloat(parseFloat(amount).toFixed(2));
            },

            getSalesPriceSalesUnit: function(){
                var $row = this.$target;
                var amount = $row.find('.quotation-detail-SalesPrice').val();
                if (!amount) amount = $row.find('.quotation-detail-SalesPrice').attr("placeholder");
                return transformCurrencyToInteger(amount, 2);
            },

            setAmount: function(section, amountCostPrice, amountCostPriceJProdUnit, amountSalesPrice){
                var $row = this.$target;
                var $quantity = $row.find('.quotation-detail-quantity');
                var $unitPrice = $row.find('.quotation-detail-UnitPrice');
                var $salesPrice = $row.find('.quotation-detail-SalesPrice');

                var quantityValue;
                if (section === 'D') {
                  quantityValue = transformCurrencyToInteger($quantity.val(), 3);
                } else {
                  quantityValue = transformCurrencyToInteger($quantity.val(), 1);
                }
                
                var unitPriceValue = transformCurrencyToInteger($unitPrice.val(), 2);
                var salesPriceValue = transformCurrencyToInteger($salesPrice.val(), 2);
                if (section === 'D') {
                  $quantity.val(quantityValue.toFixed(3));
                } else {
                  $quantity.val(quantityValue.toFixed(1));
                }
                $unitPrice.val(currencyFormat(unitPriceValue.toFixed(2)));
                if ($salesPrice.val()) $salesPrice.val(currencyFormat(salesPriceValue.toFixed(2)));
                
                amountCostPrice = parseFloat(amountCostPrice.toFixed(2));
                $row.find('.quotation-detail-CostPrice-input').val(amountCostPrice);
                $row.find('.quotation-detail-CostPrice').text(currencyFormat(amountCostPrice.toFixed(2)));

                amountCostPriceJProdUnit = parseFloat(amountCostPriceJProdUnit.toFixed(2));
                $row.find('.quotation-detail-CostPriceJProdUnit').val(amountCostPriceJProdUnit);

                if (amountSalesPrice && amountSalesPrice != 'N/A') {
                  amountSalesPrice = parseFloat(amountSalesPrice.toFixed(2));
                  $row.find('.quotation-detail-SalesPrice').attr("placeholder", currencyFormat(amountSalesPrice.toFixed(2)));
                  $row.find('.quotation-detail-SalesPriceCalculated-input').val(amountSalesPrice);
                } else {
                  $row.find('.quotation-detail-SalesPrice').attr("placeholder", '');
                  $row.find('.quotation-detail-SalesPriceCalculated-input').val(null);
                }

                if (section === 'D') {
                    // Make the calculation of the cost %
                    // Get the amount
                    var offerAmount = transformCurrencyToInteger($j('.profitCalcOfferAmount').val(), 2);
                    if (!offerAmount || offerAmount == 0) {
                      var offerAmount = transformCurrencyToInteger($j('.profitCalcOfferAmount').text(), 2);
                    }

                    var ratePct = "";
                    var ratePctValue = 0;
                    if (offerAmount && offerAmount != 0) {
                        if (amountCostPrice) ratePct = parseFloat((amountCostPrice / offerAmount * 100.).toFixed(10)).toFixed(1) + '%';
                        if (amountCostPrice) ratePctValue = parseFloat((amountCostPrice / offerAmount * 100.).toFixed(10)).toFixed(1);
                    } 
                    $row.find('.quotation-detail-CostPct').text(ratePct);
                    $row.find('.quotation-detail-CostPct-input').val(ratePctValue);
                }                  


            },
            setUnitprice: function(amount) {
                var $row = this.$target;
                $row.find('.quotation-detail-UnitPrice').val(currencyFormat(0));
            },

            amountCalc: function() {
                var $row = this.$target;
                var $quantity = $row.find('.quotation-detail-quantity');
                var $unitPrice = $row.find('.quotation-detail-UnitPrice');
                var section = $row.attr('data-section-type');

                var quantityValue;

                if (section === 'D') {
                  quantityValue = transformCurrencyToInteger($quantity.val(), 3);
                } else {
                  quantityValue = transformCurrencyToInteger($quantity.val(), 1);
                }
                var unitPriceValue = transformCurrencyToInteger($unitPrice.val(), 2);
                if (section === 'D') {
                  $quantity.val(quantityValue.toFixed(3));
                } else {
                  $quantity.val(quantityValue.toFixed(1));
                }
                $unitPrice.val(currencyFormat(unitPriceValue.toFixed(2)));

                var costPrice;
                if(unitPriceValue<0 && quantityValue ==0)
                  costPrice = unitPriceValue;
                else
                  costPrice = quantityValue * unitPriceValue;

                var isSectionGandJProd = false;
                if (section === 'G') {
                  if ($row.attr('data-jprod-target') == 'true') {
                    isSectionGandJProd = true;
                  }
                }

                if (section === 'A' || isSectionGandJProd) {           

                  var catalogCurValue= $row.find('.quotation-detail-CatalogCurrency').val();
                  var costPriceJProdUnitValue= getCurrentJProdCostCurrency();

                  // Calcul of Cost Price in J-Prod cost currency, using J-Prod rates
                  var rateJProdValue = $j('.rate-JProd-' + catalogCurValue + '-To-' + costPriceJProdUnitValue).val();
                  var costPriceJProd = costPrice;
                  if (rateJProdValue) costPriceJProd = costPriceJProd * rateJProdValue;

                  // Calcul of Cost Price in Sales Currency (from J-Prod cost currency, using others rate)
                  var salesPriceUnitValue = getCurrentSalesCurrency();
                  var rateValue = $j('.rate-Other-' + costPriceJProdUnitValue + '-To-' + salesPriceUnitValue).val();

                  var costPriceSalesCurrency = costPriceJProd;
                  if (rateValue) costPriceSalesCurrency = costPriceSalesCurrency * rateValue;

                  var salesPriceCoef= $row.find('.quotation-detail-SalesPriceCoefficient').val();
                  var salesPrice;
                  if (salesPriceCoef && salesPriceCoef != 0) salesPrice = costPriceSalesCurrency * salesPriceCoef;

                  costPriceSalesCurrency = parseFloat(costPriceSalesCurrency.toFixed(10));
                  costPriceJProd = parseFloat(costPriceJProd.toFixed(10));
                  if (salesPrice) salesPrice = parseFloat(salesPrice.toFixed(10));
                  this.setAmount(section, costPriceSalesCurrency, costPriceJProd, salesPrice);

                } else {

                  var catalogCurValue= $row.find('.quotation-detail-CatalogCurrency').val();

                  var costPriceUnitValue = getCurrentSalesCurrency();

                  var rateValue = $j('.rate-Other-' + catalogCurValue + '-To-' + costPriceUnitValue).val();

                  if (rateValue) costPrice = costPrice * rateValue;

                  costPrice = parseFloat(costPrice.toFixed(10));

                  this.setAmount(section, costPrice, costPrice, (section === 'D' ? costPrice : ""));

                }
            }
        }
        var RowManageA = function(){};
        RowManageA.prototype = {
            init : function (){
                this.root = new ItemWrap();
                this.list = new Array();
                this.subTotalACostUnit = 0;
                this.subTotalASalesUnit = 0;
                this.subTotalAAfterDiscount = 0;
                this.subTotalSalesA = 0;
            },
            push: function(row) {
                var rootItem = this.root;
                var lastChildItem = rootItem;

                while (lastChildItem.children.length > 0) {
                    var length = lastChildItem.children.length;
                    lastChildItem = lastChildItem.children[length - 1];
                }
                var currentTarget = lastChildItem;
                if (currentTarget.target) {
                    var targetDepth = parseInt(row.getAttribute('data-depth'), 10);
                    var currentTargetDepth = parseInt(currentTarget.target.getAttribute('data-depth'), 10);
    
                    if (targetDepth == currentTargetDepth) {
                        currentTarget = currentTarget.parent;
                    } else if (targetDepth < currentTargetDepth) {
                        while (currentTarget.target) {
                            currentTargetDepth = parseInt(currentTarget.target.getAttribute('data-depth'), 10);
                            if (targetDepth == currentTargetDepth) {
                                currentTarget = currentTarget.parent;
                                break;
                            }
                            currentTarget = currentTarget.parent;
                        }
                    }
                }
                var item = new ItemWrap(row, currentTarget);
                currentTarget.children.push(item);
                this.list.push(item);
            },
            create: function() {
                var details = $j('.quotation-detail-itemA');
                this.init();
                for (var i = 0; i < details.length; i++) {
                    this.push(details[i]);
                }
            },

            calcurate: function() {
                var topArray = this.root;
                if (topArray == null || topArray == undefined) {
                    throw 'root なし';
                }
                amount = this.fixCalc(this.root);
                this.subTotalACostUnit = amount.totalCostPriceJProdUnit;

                // Get the rate Cost Unit -> Sales Unit
//                this.subTotalASalesUnit = this.subTotalACostUnit;
                this.subTotalASalesUnit = amount.totalCostPriceSalesUnit;
                var costPriceJProdUnitValue = getCurrentJProdCostCurrency();
                var salesPriceJUnitValue= getCurrentSalesCurrency();
                var rateValue = $j('.rate-Other-' + costPriceJProdUnitValue + '-To-' + salesPriceJUnitValue).val();
                if (rateValue) {
//                  this.subTotalASalesUnit = parseFloat((this.subTotalASalesUnit * rateValue).toFixed(2));
                } else {
                  rateValue = 1.0;
                }



                // Calculate the discount

                var discountType = $j('.discountType').val();
                var discountValueFinal = 0;

                if (discountType === 'Rate') {
                  var discountRate = transformCurrencyToInteger($j('.discountSubtotalARateInput').val(), 2);
                  if (discountRate === '') discountRate = 0;
                  if (discountRate > 100) discountRate = 100;
                  $j('.discountSubtotalARateInput').val(discountRate.toFixed(2));

//                  var discountValueCalculated = discountRate * amount.totalDiscountApplicableCostPrice * rateValue / 100;
                  var discountValueCalculated = discountRate * amount.totalDiscountApplicableCostPrice / 100;
                  discountValueCalculated = parseFloat(parseFloat(discountValueCalculated.toFixed(10)).toFixed(2));

                  $j('.discountSubtotalAValueInput').val(currencyFormat(discountValueCalculated.toFixed(2)));
                  $j('.discountSubtotalAValueOutput').text(currencyFormat(discountValueCalculated.toFixed(2)));

                  discountValueFinal = discountValueCalculated;
                } else {

                  var discountValue = transformCurrencyToInteger($j('.discountSubtotalAValueInput').val(), 2);
                  if (discountValue === '') discountValue = 0;
//                  if (discountValue > (amount.totalDiscountApplicableCostPrice * rateValue)) discountValue = (amount.totalDiscountApplicableCostPrice * rateValue);
                  if (discountValue > amount.totalDiscountApplicableCostPrice) discountValue = amount.totalDiscountApplicableCostPrice;
                  discountValue = parseFloat(discountValue.toFixed(10));

                  $j('.discountSubtotalAValueInput').val(currencyFormat(discountValue.toFixed(2)));

                  if (amount.totalDiscountApplicableCostPrice === 0) {
                    $j('.discountSubtotalARateInput').val('0.00');
                    $j('.discountSubtotalARateOutput').text('0.00');
                  } else {
//                    var discountRateCalculated = discountValue / (amount.totalDiscountApplicableCostPrice * rateValue) * 100;
                    var discountRateCalculated = discountValue / amount.totalDiscountApplicableCostPrice * 100;
                    discountRateCalculated = parseFloat(discountRateCalculated.toFixed(10));

                    $j('.discountSubtotalARateInput').val(currencyFormat(discountRateCalculated.toFixed(2)));
                    $j('.discountSubtotalARateOutput').text(currencyFormat(discountRateCalculated.toFixed(2)));
                  }

                  discountValueFinal = discountValue;
                }

                // Calculate the JProd Subtotal after discount
                this.subTotalAAfterDiscount = this.subTotalASalesUnit - discountValueFinal; 
                this.subTotalSalesA = amount.totalSalesPriceSalesUnit;

            },


            fixCalc: function(targetItem) {
                var children = targetItem.children;
                var amount = {
                    totalCostPriceJProdUnit: 0,
                    totalCostPriceSalesUnit: 0,
                    totalDiscountApplicableCostPrice: 0,
                    totalSalesPriceSalesUnit: 0,
                    section: ""
                };

                for (var i = 0; i < children.length; i++) {
                    var childItem = children[i];
                    var childNode = childItem.target;
                    var $childNode = $j(childNode);
                    amount.section = childNode.getAttribute('data-section-type');
                    var childRowType = childNode.getAttribute('data-type');
                    var isTotalCalcTarget = (childRowType === '1');

                    var isDiscountTarget = childNode.getAttribute('data-discount-target');
                    var childrenAmount = null;
                    if (childItem.children.length > 0) {
                        childrenAmount = this.fixCalc(childItem);
                    }
                    if (childRowType === '1') {
                        // This is a normal row

                        if (childrenAmount) {
                            // The row has some child -> Put the amount of this row to 0
                            childItem.setAmount("A", 0, 0, "N/A");
                        } else {
                            // Make the calculation
                            childItem.calc();
                        }

                        var costPriceJProd = childItem.getCostPriceJProdUnit();
                        amount.totalCostPriceJProdUnit += costPriceJProd;

                        var costPriceSalesUnit = childItem.getCostPriceSalesUnit();
                        amount.totalCostPriceSalesUnit += costPriceSalesUnit;

                        var salesPriceSalesUnit = childItem.getSalesPriceSalesUnit();
                        amount.totalSalesPriceSalesUnit += salesPriceSalesUnit;

                        if (!childrenAmount && isDiscountTarget === 'true') {
                          amount.totalDiscountApplicableCostPrice += costPriceSalesUnit;
                        }
                        
                    }
                    if (childrenAmount) {
                        amount.totalCostPriceJProdUnit += childrenAmount.totalCostPriceJProdUnit;
                        amount.totalCostPriceSalesUnit += childrenAmount.totalCostPriceSalesUnit;
                        amount.totalSalesPriceSalesUnit += childrenAmount.totalSalesPriceSalesUnit;
                    }
                    if (childrenAmount) {
                        amount.totalDiscountApplicableCostPrice += childrenAmount.totalDiscountApplicableCostPrice;
                    }
                    
                }
                return amount;
            }
        }
        RowManageA = new RowManageA();




        var RowManageB = function(){};
        RowManageB.prototype = {
            init : function (){
                this.root = new ItemWrap();
                this.list = new Array();
                this.subTotalB = 0;
                this.subTotalSalesB = 0;
            },
            push: function(row) {
                var rootItem = this.root;
                var lastChildItem = rootItem;

                while (lastChildItem.children.length > 0) {
                    var length = lastChildItem.children.length;
                    lastChildItem = lastChildItem.children[length - 1];
                }
                var currentTarget = lastChildItem;
                if (currentTarget.target) {
                    var targetDepth = parseInt(row.getAttribute('data-depth'), 10);
                    var currentTargetDepth = parseInt(currentTarget.target.getAttribute('data-depth'), 10);
    
                    if (targetDepth == currentTargetDepth) {
                        currentTarget = currentTarget.parent;
                    } else if (targetDepth < currentTargetDepth) {
                        while (currentTarget.target) {
                            currentTargetDepth = parseInt(currentTarget.target.getAttribute('data-depth'), 10);
                            if (targetDepth == currentTargetDepth) {
                                currentTarget = currentTarget.parent;
                                break;
                            }
                            currentTarget = currentTarget.parent;
                        }
                    }
                }
                var item = new ItemWrap(row, currentTarget);
                currentTarget.children.push(item);
                this.list.push(item);
            },
            create: function() {
                var details = $j('.quotation-detail-itemB');
                this.init();
                for (var i = 0; i < details.length; i++) {
                    this.push(details[i]);
                }
            },

            calcurate: function() {
                var topArray = this.root;
                if (topArray == null || topArray == undefined) {
                    throw 'root なし';
                }
                amount = this.fixCalc(this.root);
                this.subTotalB = amount.totalCostPriceJProdUnit;
                this.subTotalSalesB = amount.totalSalesPriceSalesUnit;
            },

            fixCalc: function(targetItem) {
                var children = targetItem.children;
                var amount = {
                    totalCostPriceJProdUnit: 0,
                    totalSalesPriceSalesUnit: 0,
                    section: ""
                };

                for (var i = 0; i < children.length; i++) {
                    var childItem = children[i];
                    var childNode = childItem.target;
                    var $childNode = $j(childNode);
                    amount.section = childNode.getAttribute('data-section-type');
                    var childRowType = childNode.getAttribute('data-type');

                    var childrenAmount = null;
                    if (childItem.children.length > 0) {
                        childrenAmount = this.fixCalc(childItem);
                    }
                    if (childRowType === '1') {
                        // This is a normal row

                        if (childrenAmount) {
                            // The row has some child -> Put the amount of this row to 0
                            childItem.setAmount("B", 0, 0, "");
                        } else {
                            // Make the calculation
                            childItem.calc();
                        }

                        var costPriceJProd = childItem.getCostPriceJProdUnit();
                        amount.totalCostPriceJProdUnit += costPriceJProd;

                        var salesPriceSalesUnit = childItem.getSalesPriceSalesUnit();
                        amount.totalSalesPriceSalesUnit += salesPriceSalesUnit;

                    }
                    if (childrenAmount) {
                        amount.totalCostPriceJProdUnit += childrenAmount.totalCostPriceJProdUnit;
                        amount.totalSalesPriceSalesUnit += childrenAmount.totalSalesPriceSalesUnit;
                    }
                    
                }
                return amount;
            }

        }
        RowManageB = new RowManageB();



        var RowManageC = function(){};
        RowManageC.prototype = {
            init : function (){
                this.root = new ItemWrap();
                this.list = new Array();
                this.subTotalC = 0;
                this.subTotalSalesC = 0;
            },
            push: function(row) {
                var rootItem = this.root;
                var lastChildItem = rootItem;

                while (lastChildItem.children.length > 0) {
                    var length = lastChildItem.children.length;
                    lastChildItem = lastChildItem.children[length - 1];
                }
                var currentTarget = lastChildItem;
                if (currentTarget.target) {
                    var targetDepth = parseInt(row.getAttribute('data-depth'), 10);
                    var currentTargetDepth = parseInt(currentTarget.target.getAttribute('data-depth'), 10);
    
                    if (targetDepth == currentTargetDepth) {
                        currentTarget = currentTarget.parent;
                    } else if (targetDepth < currentTargetDepth) {
                        while (currentTarget.target) {
                            currentTargetDepth = parseInt(currentTarget.target.getAttribute('data-depth'), 10);
                            if (targetDepth == currentTargetDepth) {
                                currentTarget = currentTarget.parent;
                                break;
                            }
                            currentTarget = currentTarget.parent;
                        }
                    }
                }
                var item = new ItemWrap(row, currentTarget);
                currentTarget.children.push(item);
                this.list.push(item);
            },

            create: function() {
                var details = $j('.quotation-detail-itemC');
                this.init();
                for (var i = 0; i < details.length; i++) {
                    this.push(details[i]);
                }
            },

            calcurate: function() {
                var topArray = this.root;
                if (topArray == null || topArray == undefined) {
                    throw 'root なし';
                }
                amount = this.fixCalc(this.root);
                this.subTotalC = amount.totalCostPriceJProdUnit;
                this.subTotalSalesC = amount.totalSalesPriceSalesUnit;
            },

            fixCalc: function(targetItem) {
                var children = targetItem.children;
                var amount = {
                    totalCostPriceJProdUnit: 0,
                    totalSalesPriceSalesUnit: 0,
                    section: ""
                };

                for (var i = 0; i < children.length; i++) {
                    var childItem = children[i];
                    var childNode = childItem.target;
                    var $childNode = $j(childNode);
                    amount.section = childNode.getAttribute('data-section-type');
                    var childRowType = childNode.getAttribute('data-type');

                    var childrenAmount = null;
                    if (childItem.children.length > 0) {
                        childrenAmount = this.fixCalc(childItem);
                    }
                    if (childRowType === '1') {
                        // This is a normal row

                        if (childrenAmount) {
                            // The row has some child -> Put the amount of this row to 0
                            childItem.setAmount("C", 0, 0, "");
                        } else {
                            // Make the calculation
                            childItem.calc();
                        }

                        var costPriceJProd = childItem.getCostPriceJProdUnit();
                        amount.totalCostPriceJProdUnit += costPriceJProd;

                        var salesPriceSalesUnit = childItem.getSalesPriceSalesUnit();
                        amount.totalSalesPriceSalesUnit += salesPriceSalesUnit;

                    }
                   if (childrenAmount) {
                        amount.totalCostPriceJProdUnit += childrenAmount.totalCostPriceJProdUnit;
                        amount.totalSalesPriceSalesUnit += childrenAmount.totalSalesPriceSalesUnit;
                    }
                    
                }
                return amount;
            }

        }
        RowManageC = new RowManageC();


        var RowManageD = function(){};
        RowManageD.prototype = {
            init : function (){
                this.root = new ItemWrap();
                this.list = new Array();
                this.subTotalD = 0;
                this.subTotalSalesD = 0;
            },
            push: function(row) {
                var rootItem = this.root;
                var lastChildItem = rootItem;

                while (lastChildItem.children.length > 0) {
                    var length = lastChildItem.children.length;
                    lastChildItem = lastChildItem.children[length - 1];
                }
                var currentTarget = lastChildItem;
                if (currentTarget.target) {
                    var targetDepth = parseInt(row.getAttribute('data-depth'), 10);
                    var currentTargetDepth = parseInt(currentTarget.target.getAttribute('data-depth'), 10);
    
                    if (targetDepth == currentTargetDepth) {
                        currentTarget = currentTarget.parent;
                    } else if (targetDepth < currentTargetDepth) {
                        while (currentTarget.target) {
                            currentTargetDepth = parseInt(currentTarget.target.getAttribute('data-depth'), 10);
                            if (targetDepth == currentTargetDepth) {
                                currentTarget = currentTarget.parent;
                                break;
                            }
                            currentTarget = currentTarget.parent;
                        }
                    }
                }
                var item = new ItemWrap(row, currentTarget);
                currentTarget.children.push(item);
                this.list.push(item);
            },
            create: function() {
                var details = $j('.quotation-detail-itemD');
                this.init();
                for (var i = 0; i < details.length; i++) {
                    this.push(details[i]);
                }
            },

            calcurate: function() {
                var topArray = this.root;
                if (topArray == null || topArray == undefined) {
                    throw 'root なし';
                }
                amount = this.fixCalc(this.root);
                this.subTotalD = amount.totalCostPriceJProdUnit;
                this.subTotalSalesD = amount.totalSalesPriceSalesUnit;
            },

            fixCalc: function(targetItem) {
                var children = targetItem.children;
                var amount = {
                    totalCostPriceJProdUnit: 0,
                    totalSalesPriceSalesUnit: 0,
                    section: ""
                };

                for (var i = 0; i < children.length; i++) {
                    var childItem = children[i];
                    var childNode = childItem.target;
                    var $childNode = $j(childNode);
                    amount.section = childNode.getAttribute('data-section-type');
                    var childRowType = childNode.getAttribute('data-type');

                    var childrenAmount = null;
                    if (childItem.children.length > 0) {
                        childrenAmount = this.fixCalc(childItem);
                    }
                    if (childRowType === '1') {
                        // This is a normal row

                        if (childrenAmount) {
                            // The row has some child -> Put the amount of this row to 0
                            childItem.setAmount("D", 0, 0, "");
                        } else {
                            // Make the calculation
                            childItem.calc();
                        }

                        var costPriceJProd = childItem.getCostPriceJProdUnit();
                        amount.totalCostPriceJProdUnit += costPriceJProd;

                        var salesPriceSalesUnit = childItem.getSalesPriceSalesUnit();
                        amount.totalSalesPriceSalesUnit += salesPriceSalesUnit;

                    }
                    if (childrenAmount) {
                        amount.totalCostPriceJProdUnit += childrenAmount.totalCostPriceJProdUnit;
                        amount.totalSalesPriceSalesUnit += childrenAmount.totalSalesPriceSalesUnit;
                    }
                    
                }
                return amount;
            }

        }
        RowManageD = new RowManageD();



        var RowManageE = function(){};
        RowManageE.prototype = {
            init : function (){
                this.root = new ItemWrap();
                this.list = new Array();
                this.subTotalE = 0;
                this.subTotalSalesE = 0;
            },
            push: function(row) {
                var rootItem = this.root;
                var lastChildItem = rootItem;

                while (lastChildItem.children.length > 0) {
                    var length = lastChildItem.children.length;
                    lastChildItem = lastChildItem.children[length - 1];
                }
                var currentTarget = lastChildItem;
                if (currentTarget.target) {
                    var targetDepth = parseInt(row.getAttribute('data-depth'), 10);
                    var currentTargetDepth = parseInt(currentTarget.target.getAttribute('data-depth'), 10);
    
                    if (targetDepth == currentTargetDepth) {
                        currentTarget = currentTarget.parent;
                    } else if (targetDepth < currentTargetDepth) {
                        while (currentTarget.target) {
                            currentTargetDepth = parseInt(currentTarget.target.getAttribute('data-depth'), 10);
                            if (targetDepth == currentTargetDepth) {
                                currentTarget = currentTarget.parent;
                                break;
                            }
                            currentTarget = currentTarget.parent;
                        }
                    }
                }
                var item = new ItemWrap(row, currentTarget);
                currentTarget.children.push(item);
                this.list.push(item);
            },
            create: function() {
                var details = $j('.quotation-detail-itemE');
                this.init();
                for (var i = 0; i < details.length; i++) {
                    this.push(details[i]);
                }
            },
            calcurate: function() {
                var topArray = this.root;
                if (topArray == null || topArray == undefined) {
                    throw 'root なし';
                }
                amount = this.fixCalc(this.root);
                this.subTotalE = amount.totalCostPriceJProdUnit;
                this.subTotalSalesE = amount.totalSalesPriceSalesUnit;
            },

            fixCalc: function(targetItem) {
                var children = targetItem.children;
                var amount = {
                    totalCostPriceJProdUnit: 0,
                    totalSalesPriceSalesUnit: 0,
                    section: ""
                };

                for (var i = 0; i < children.length; i++) {
                    var childItem = children[i];
                    var childNode = childItem.target;
                    var $childNode = $j(childNode);
                    amount.section = childNode.getAttribute('data-section-type');
                    var childRowType = childNode.getAttribute('data-type');

                    var childrenAmount = null;
                    if (childItem.children.length > 0) {
                        childrenAmount = this.fixCalc(childItem);
                    }
                    if (childRowType === '1') {
                        // This is a normal row

                        if (childrenAmount) {
                            // The row has some child -> Put the amount of this row to 0
                            childItem.setAmount("E", 0, 0, "");
                        } else {
                            // Make the calculation
                            childItem.calc();
                        }

                        var costPriceJProd = childItem.getCostPriceJProdUnit();
                        amount.totalCostPriceJProdUnit += costPriceJProd;

                        var salesPriceSalesUnit = childItem.getSalesPriceSalesUnit();
                        amount.totalSalesPriceSalesUnit += salesPriceSalesUnit;

                    }
                    if (childrenAmount) {
                        amount.totalCostPriceJProdUnit += childrenAmount.totalCostPriceJProdUnit;
                        amount.totalSalesPriceSalesUnit += childrenAmount.totalSalesPriceSalesUnit;
                    }
                    
                }
                return amount;
            }

        }
        RowManageE = new RowManageE();


        var RowManageF = function(){};
        RowManageF.prototype = {
            init : function (){
                this.root = new ItemWrap();
                this.list = new Array();
                this.subTotalF = 0;
                this.subTotalSalesF = 0;
            },
            push: function(row) {
                var rootItem = this.root;
                var lastChildItem = rootItem;

                while (lastChildItem.children.length > 0) {
                    var length = lastChildItem.children.length;
                    lastChildItem = lastChildItem.children[length - 1];
                }
                var currentTarget = lastChildItem;
                if (currentTarget.target) {
                    var targetDepth = parseInt(row.getAttribute('data-depth'), 10);
                    var currentTargetDepth = parseInt(currentTarget.target.getAttribute('data-depth'), 10);
    
                    if (targetDepth == currentTargetDepth) {
                        currentTarget = currentTarget.parent;
                    } else if (targetDepth < currentTargetDepth) {
                        while (currentTarget.target) {
                            currentTargetDepth = parseInt(currentTarget.target.getAttribute('data-depth'), 10);
                            if (targetDepth == currentTargetDepth) {
                                currentTarget = currentTarget.parent;
                                break;
                            }
                            currentTarget = currentTarget.parent;
                        }
                    }
                }
                var item = new ItemWrap(row, currentTarget);
                currentTarget.children.push(item);
                this.list.push(item);
            },
            create: function() {
                var details = $j('.quotation-detail-itemF');
                this.init();
                for (var i = 0; i < details.length; i++) {
                    this.push(details[i]);
                }
            },

            calcurate: function() {
                var topArray = this.root;
                if (topArray == null || topArray == undefined) {
                    throw 'root なし';
                }
                amount = this.fixCalc(this.root);
                this.subTotalF = amount.totalCostPriceJProdUnit;
                this.subTotalSalesF = amount.totalSalesPriceSalesUnit;
            },

            fixCalc: function(targetItem) {
                var children = targetItem.children;
                var amount = {
                    totalCostPriceJProdUnit: 0,
                    totalSalesPriceSalesUnit: 0,
                    section: ""
                };

                for (var i = 0; i < children.length; i++) {
                    var childItem = children[i];
                    var childNode = childItem.target;
                    var $childNode = $j(childNode);
                    amount.section = childNode.getAttribute('data-section-type');
                    var childRowType = childNode.getAttribute('data-type');

                    var childrenAmount = null;
                    if (childItem.children.length > 0) {
                        childrenAmount = this.fixCalc(childItem);
                    }
                    if (childRowType === '1') {
                        // This is a normal row

                        if (childrenAmount) {
                            // The row has some child -> Put the amount of this row to 0
                            childItem.setAmount("F", 0, 0, "");
                        } else {
                            // Make the calculation
                            childItem.calc();
                        }

                        var costPriceJProd = childItem.getCostPriceJProdUnit();
                        amount.totalCostPriceJProdUnit += costPriceJProd;

                        var salesPriceSalesUnit = childItem.getSalesPriceSalesUnit();
                        amount.totalSalesPriceSalesUnit += salesPriceSalesUnit;

                    }
                    if (childrenAmount) {
                        amount.totalCostPriceJProdUnit += childrenAmount.totalCostPriceJProdUnit;
                        amount.totalSalesPriceSalesUnit += childrenAmount.totalSalesPriceSalesUnit;
                    }
                    
                }
                return amount;
            }

        }
        RowManageF = new RowManageF();



        var RowManageG = function(){};
        RowManageG.prototype = {
            init : function (){
                this.root = new ItemWrap();
                this.list = new Array();
                this.subTotalG = 0;
                this.subTotalSalesG = 0;
            },
            push: function(row) {
                var rootItem = this.root;
                var lastChildItem = rootItem;

                while (lastChildItem.children.length > 0) {
                    var length = lastChildItem.children.length;
                    lastChildItem = lastChildItem.children[length - 1];
                }
                var currentTarget = lastChildItem;
                if (currentTarget.target) {
                    var targetDepth = parseInt(row.getAttribute('data-depth'), 10);
                    var currentTargetDepth = parseInt(currentTarget.target.getAttribute('data-depth'), 10);
    
                    if (targetDepth == currentTargetDepth) {
                        currentTarget = currentTarget.parent;
                    } else if (targetDepth < currentTargetDepth) {
                        while (currentTarget.target) {
                            currentTargetDepth = parseInt(currentTarget.target.getAttribute('data-depth'), 10);
                            if (targetDepth == currentTargetDepth) {
                                currentTarget = currentTarget.parent;
                                break;
                            }
                            currentTarget = currentTarget.parent;
                        }
                    }
                }
                var item = new ItemWrap(row, currentTarget);
                currentTarget.children.push(item);
                this.list.push(item);
            },
            create: function() {
                var details = $j('.quotation-detail-itemG');
                this.init();
                for (var i = 0; i < details.length; i++) {
                    this.push(details[i]);
                }
            },
            calcurate: function() {
                var topArray = this.root;
                if (topArray == null || topArray == undefined) {
                    throw 'root なし';
                }
                amount = this.fixCalc(this.root);
                this.subTotalG = amount.totalCostPriceJProdUnit;
                this.subTotalSalesG = amount.totalSalesPriceSalesUnit;
            },

            fixCalc: function(targetItem) {
                var children = targetItem.children;
                var amount = {
                    totalCostPriceJProdUnit: 0,
                    totalSalesPriceSalesUnit: 0,
                    section: ""
                };

                for (var i = 0; i < children.length; i++) {
                    var childItem = children[i];
                    var childNode = childItem.target;
                    var $childNode = $j(childNode);
                    amount.section = childNode.getAttribute('data-section-type');
                    var childRowType = childNode.getAttribute('data-type');

                    var childrenAmount = null;
                    if (childItem.children.length > 0) {
                        childrenAmount = this.fixCalc(childItem);
                    }
                    if (childRowType === '1') {
                        // This is a normal row

                        if (childrenAmount) {
                            // The row has some child -> Put the amount of this row to 0
                            childItem.setAmount("G", 0, 0, "");
                        } else {
                            // Make the calculation
                            childItem.calc();
                        }

                        var costPriceJProd = childItem.getCostPriceJProdUnit();
                        amount.totalCostPriceJProdUnit += costPriceJProd;

                        var salesPriceSalesUnit = childItem.getSalesPriceSalesUnit();
                        amount.totalSalesPriceSalesUnit += salesPriceSalesUnit;

                    }
                    if (childrenAmount) {
                        amount.totalCostPriceJProdUnit += childrenAmount.totalCostPriceJProdUnit;
                        amount.totalSalesPriceSalesUnit += childrenAmount.totalSalesPriceSalesUnit;
                    }
                    
                }
                return amount;
            }

        }
        RowManageG = new RowManageG();        


        function currencyFormat(value) {
            if (!value && value !== 0) {
                value = 0;
            }
            var valueParts = String(value).split(".");
            valueParts[0] = valueParts[0].replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,");
            return valueParts.join('.');
        }
        var transform2ByteNumericBase = '０１２３４５６７８９';
        function transformCurrencyToInteger(value, iNbDigits) {

            value = String(value);
            if ((!value && value !== 0) || !value.match(/^-?(?!,)[0-9０-９,]*(\.?(?=[0-9０-９]+)[0-9０-９]+)$/g)) {
                value = '0';
            } else {
                value = value.replace(/[０-９]/g,function(s){return transform2ByteNumericBase.indexOf(s);});
            }
            value = parseFloat(value.replace(/,/g,''));

            value = parseFloat(parseFloat(parseFloat((parseFloat((value * Math.pow(10, iNbDigits)).toFixed(10)).toFixed(0))) / Math.pow(10, iNbDigits)).toFixed(iNbDigits));

            return value;
        }

        function optionSetting(target) {
            var $targetRow = $j(target).closest('.quotation-detail-item');
            var value = $j(target).prop('checked');
            $targetRow[0].setAttribute(target.getAttribute('data-target'),value);
        }

        function calculate2spallMainForm() {
            var $item2sprowitm = $j('.CostPriceJPYWithoutSales');
            var arrayLength = $item2sprowitm.length;
            for (var i = 0; i < arrayLength; i++) {
                calculate2spMainForm($item2sprowitm[i]);
            }
        }


        function calculate2spMainForm(target) {

            var $targetRow = $j(target).closest('.quotation-detail-itemA2SP');

            var costPriceJPYWithoutSales = $targetRow.find('.CostPriceJPYWithoutSales').val();
            var salesPriceByUser = parseFloat($targetRow.find('.SalesPriceSalesUnitSetUser').val());
            var costPriceJPY = $targetRow.find('.CostPriceJPY').val();
            





            var costPriceJProdUnitValue= getCurrentJProdCostCurrency();

            // Calcul of Cost Price in J-Prod cost currency, using J-Prod rates
            var rateJProdValue = $j('.rate-JProd-JPY-To-' + costPriceJProdUnitValue).val();
            var costPriceJProd = costPriceJPY;
            var costPriceJProdWithoutSales = costPriceJPYWithoutSales;
            if (rateJProdValue) costPriceJProd = costPriceJProd * rateJProdValue;
            if (rateJProdValue) costPriceJProdWithoutSales = costPriceJProdWithoutSales * rateJProdValue;

            // Calcul of Cost Price in Sales Currency (from J-Prod cost currency, using others rate)
            var salesPriceUnitValue = getCurrentSalesCurrency();
            var rateValue = $j('.rate-Other-' + costPriceJProdUnitValue + '-To-' + salesPriceUnitValue).val();

            var costPriceSalesCurrency = costPriceJProd;
            var costPriceSalesCurrencyWithoutSales = costPriceJProdWithoutSales;
            if (rateValue) costPriceSalesCurrency = costPriceSalesCurrency * rateValue;
            if (rateValue) costPriceSalesCurrencyWithoutSales = costPriceSalesCurrencyWithoutSales * rateValue;

            var salesPriceCoef = $j('.standardCoef').val();

            var salesPrice = parseFloat('0');
            if (salesPriceCoef && salesPriceCoef != 0) salesPrice = costPriceSalesCurrencyWithoutSales * salesPriceCoef;
            if (salesPriceByUser) salesPrice = parseFloat(salesPrice) + parseFloat(salesPriceByUser);

            if (salesPrice) salesPrice = parseFloat(salesPrice.toFixed(10));
            $targetRow.find('.quotation-detailA2SP-SalesPrice').text(currencyFormat(salesPrice.toFixed(2)));
            $targetRow.find('.SalesPriceSalesUnit').val(salesPrice.toFixed(2));

            if (costPriceSalesCurrency) costPriceSalesCurrency = parseFloat(costPriceSalesCurrency.toFixed(10));
            $targetRow.find('.quotation-detailA2SP-CostPriceSalesUnit').text(currencyFormat(costPriceSalesCurrency.toFixed(2)));
            $targetRow.find('.CostPriceSalesUnit').val(costPriceSalesCurrency.toFixed(2));

            if (costPriceJProd) costPriceJProd = parseFloat(costPriceJProd.toFixed(10));
            $targetRow.find('.CostPriceJProdUnit').val(parseFloat(costPriceJProd.toFixed(2)));

/*
                  costPriceSalesCurrency = parseFloat(costPriceSalesCurrency.toFixed(10));
                  costPriceJProd = parseFloat(costPriceJProd.toFixed(10));
                  if (salesPrice) salesPrice = parseFloat(salesPrice.toFixed(10));


                  costPrice = transformCurrencyToInteger(costPrice, 2);
                  $targetRow.find('.costPriceJPY2spinput').val(costPrice);




                costPriceSalesCurrency = transformCurrencyToInteger(costPriceSalesCurrency, 2);
                $targetRow.find('.costPrice2sp').text(currencyFormat(costPriceSalesCurrency.toFixed(2)));


                if (salesPrice) {
                  salesPrice = transformCurrencyToInteger(salesPrice, 2);
                  $targetRow.find('.salesPrice2sp').attr('placeholder', currencyFormat(salesPrice.toFixed(2)));
                  $targetRow.find('.salesPrice2spCalcul').val(salesPrice);
                } else {
                  $targetRow.find('.salesPrice2sp').attr('placeholder', '');
                  $targetRow.find('.salesPrice2spCalcul').val(null);
                }





            } else {
              $quantity.val(null);
              $quantityInput.val(-1);

              $targetRow.find('.costPrice2sp').text('');
              $targetRow.find('.salesPrice2sp').attr("placeholder", '');
            }


            var $salesPrice = $targetRow.find('.salesPrice2sp');
            var $salesPriceInput = $targetRow.find('.salesPrice2spinput');

            if ($salesPrice.val()) {
              salesPriceValue = transformCurrencyToInteger($salesPrice.val(), 2);
              if (salesPriceValue < 0) {
                salesPriceValue = 0;
              }
              $salesPrice.val(currencyFormat(salesPriceValue.toFixed(2)));
              $salesPriceInput.val(salesPriceValue);
            } else {
              $salesPrice.val(null);
              $salesPriceInput.val(-1);
            }







alert (salesPriceByUser);

/*
            var $quantityInput = $targetRow.find('.qty2spinput');

            if ($quantity.val()) {
              quantityValue = transformCurrencyToInteger($quantity.val(), 1);
              if (quantityValue < 0) {
                quantityValue = 0;
              }
              $quantity.val(currencyFormat(quantityValue.toFixed(1)));
              $quantityInput.val(quantityValue);

              unitPriceValue = transformCurrencyToInteger($targetRow.find('.unitPrice2sp').text(), 1);











                var costPrice = quantityValue * unitPriceValue;





                  var costPriceJProdUnitValue= getCurrentJProdCostCurrency();

                  // Calcul of Cost Price in J-Prod cost currency, using J-Prod rates
                  var rateJProdValue = $j('.rate-JProd-JPY-To-' + costPriceJProdUnitValue).val();
                  var costPriceJProd = costPrice;
                  if (rateJProdValue) costPriceJProd = costPriceJProd * rateJProdValue;

                  // Calcul of Cost Price in Sales Currency (from J-Prod cost currency, using others rate)
                  var salesPriceUnitValue = getCurrentSalesCurrency();
                  var rateValue = $j('.rate-Other-' + costPriceJProdUnitValue + '-To-' + salesPriceUnitValue).val();

                  var costPriceSalesCurrency = costPriceJProd;
                  if (rateValue) costPriceSalesCurrency = costPriceSalesCurrency * rateValue;

                  var salesPriceCoef = $j('.standardCoef').val();

                  var salesPrice;
                  if (salesPriceCoef && salesPriceCoef != 0) salesPrice = costPriceSalesCurrency * salesPriceCoef;

                  costPriceSalesCurrency = parseFloat(costPriceSalesCurrency.toFixed(10));
                  costPriceJProd = parseFloat(costPriceJProd.toFixed(10));
                  if (salesPrice) salesPrice = parseFloat(salesPrice.toFixed(10));


                  costPrice = transformCurrencyToInteger(costPrice, 2);
                  $targetRow.find('.costPriceJPY2spinput').val(costPrice);




                costPriceSalesCurrency = transformCurrencyToInteger(costPriceSalesCurrency, 2);
                $targetRow.find('.costPrice2sp').text(currencyFormat(costPriceSalesCurrency.toFixed(2)));


                if (salesPrice) {
                  salesPrice = transformCurrencyToInteger(salesPrice, 2);
                  $targetRow.find('.salesPrice2sp').attr('placeholder', currencyFormat(salesPrice.toFixed(2)));
                  $targetRow.find('.salesPrice2spCalcul').val(salesPrice);
                } else {
                  $targetRow.find('.salesPrice2sp').attr('placeholder', '');
                  $targetRow.find('.salesPrice2spCalcul').val(null);
                }





            } else {
              $quantity.val(null);
              $quantityInput.val(-1);

              $targetRow.find('.costPrice2sp').text('');
              $targetRow.find('.salesPrice2sp').attr("placeholder", '');
            }


            var $salesPrice = $targetRow.find('.salesPrice2sp');
            var $salesPriceInput = $targetRow.find('.salesPrice2spinput');

            if ($salesPrice.val()) {
              salesPriceValue = transformCurrencyToInteger($salesPrice.val(), 2);
              if (salesPriceValue < 0) {
                salesPriceValue = 0;
              }
              $salesPrice.val(currencyFormat(salesPriceValue.toFixed(2)));
              $salesPriceInput.val(salesPriceValue);
            } else {
              $salesPrice.val(null);
              $salesPriceInput.val(-1);
            }
*/
        }







        function calculate2spall() {
            var $quantity = $j('.qty2sp');
            var arrayLength = $quantity.length;
            for (var i = 0; i < arrayLength; i++) {
                calculate2sp($quantity[i]);
            }
        }




        function calculate2sp(target) {

            var $targetRow = $j(target).closest('.row2SPdetail');

            var $quantity = $targetRow.find('.qty2sp');
            var $quantityInput = $targetRow.find('.qty2spinput');

            if ($quantity.val()) {
              quantityValue = transformCurrencyToInteger($quantity.val(), 1);
              if (quantityValue < 0) {
                quantityValue = 0;
              }
              $quantity.val(currencyFormat(quantityValue.toFixed(1)));
              $quantityInput.val(quantityValue);

              unitPriceValue = transformCurrencyToInteger($targetRow.find('.unitPrice2sp').text(), 1);











                var costPrice = quantityValue * unitPriceValue;





                  var costPriceJProdUnitValue= getCurrentJProdCostCurrency();

                  // Calcul of Cost Price in J-Prod cost currency, using J-Prod rates
                  var rateJProdValue = $j('.rate-JProd-JPY-To-' + costPriceJProdUnitValue).val();
                  var costPriceJProd = costPrice;
                  if (rateJProdValue) costPriceJProd = costPriceJProd * rateJProdValue;

                  // Calcul of Cost Price in Sales Currency (from J-Prod cost currency, using others rate)
                  var salesPriceUnitValue = getCurrentSalesCurrency();
                  var rateValue = $j('.rate-Other-' + costPriceJProdUnitValue + '-To-' + salesPriceUnitValue).val();

                  var costPriceSalesCurrency = costPriceJProd;
                  if (rateValue) costPriceSalesCurrency = costPriceSalesCurrency * rateValue;

                  var salesPriceCoef = $j('.standardCoef').val();

                  var salesPrice;
                  if (salesPriceCoef && salesPriceCoef != 0) salesPrice = costPriceSalesCurrency * salesPriceCoef;

                  costPriceSalesCurrency = parseFloat(costPriceSalesCurrency.toFixed(10));
                  costPriceJProd = parseFloat(costPriceJProd.toFixed(10));
                  if (salesPrice) salesPrice = parseFloat(salesPrice.toFixed(10));


                  costPrice = transformCurrencyToInteger(costPrice, 2);
                  $targetRow.find('.costPriceJPY2spinput').val(costPrice);




                costPriceSalesCurrency = transformCurrencyToInteger(costPriceSalesCurrency, 2);
                $targetRow.find('.costPrice2sp').text(currencyFormat(costPriceSalesCurrency.toFixed(2)));


                if (salesPrice) {
                  salesPrice = transformCurrencyToInteger(salesPrice, 2);
                  $targetRow.find('.salesPrice2sp').attr('placeholder', currencyFormat(salesPrice.toFixed(2)));
                  $targetRow.find('.salesPrice2spgrey').text(currencyFormat(salesPrice.toFixed(2)));
                  $targetRow.find('.salesPrice2spCalcul').val(salesPrice);
                } else {
                  $targetRow.find('.salesPrice2sp').attr('placeholder', '');
                  $targetRow.find('.salesPrice2spgrey').text('');
                  $targetRow.find('.salesPrice2spCalcul').val(null);
                }





            } else {
              $quantity.val(null);
              $quantityInput.val(-1);

              $targetRow.find('.costPrice2sp').text('');
              $targetRow.find('.salesPrice2sp').attr("placeholder", '');
              $targetRow.find('.salesPrice2spgrey').text('');
            }


            var $salesPrice = $targetRow.find('.salesPrice2sp');
            var $salesPriceInput = $targetRow.find('.salesPrice2spinput');

            if ($salesPrice.val()) {
              salesPriceValue = transformCurrencyToInteger($salesPrice.val(), 2);
              if (salesPriceValue < 0) {
                salesPriceValue = 0;
              }
              $salesPrice.val(currencyFormat(salesPriceValue.toFixed(2)));
              $salesPriceInput.val(salesPriceValue);
            } else {
              $salesPrice.val(null);
              $salesPriceInput.val(-1);
            }

        }


        function optionSettingFromPanelClick(target) {
            var $targetRow = $j(target).closest('.quotation-detail-item');
            var targetClass = target.getAttribute('data-target-class');
            var $targetChackbox = $targetRow.find('.' + targetClass);
            var value = $targetChackbox.prop('checked');
            $targetChackbox.prop('checked', !value);
            optionSetting($targetChackbox[0]);
        }

        var sortableOptionA = {
                axis:'y',
                opacity: 0.7,
                placeholder: 'drag-placeholder',
                cursor: 'row-resize',
                handle: '.sortableActionA',
                start: function(e,ui){isExecuteSortableA = true;},
                activate: createPlaceholderBodyA,
                stop: changeSortNoA
        };
        var sortableOptionB = {
                axis:'y',
                opacity: 0.7,
                placeholder: 'drag-placeholder',
                cursor: 'row-resize',
                handle: '.sortableActionB',
                start: function(e,ui){isExecuteSortableB = true;},
                activate: createPlaceholderBodyB,
                stop: changeSortNoB
        };
        var sortableOptionC = {
                axis:'y',
                opacity: 0.7,
                placeholder: 'drag-placeholder',
                cursor: 'row-resize',
                handle: '.sortableActionC',
                start: function(e,ui){isExecuteSortableC = true;},
                activate: createPlaceholderBodyC,
                stop: changeSortNoC
        };
        var sortableOptionD = {
                axis:'y',
                opacity: 0.7,
                placeholder: 'drag-placeholder',
                cursor: 'row-resize',
                handle: '.sortableActionD',
                start: function(e,ui){isExecuteSortableD = true;},
                activate: createPlaceholderBodyD,
                stop: changeSortNoD
        };
        var sortableOptionE = {
                axis:'y',
                opacity: 0.7,
                placeholder: 'drag-placeholder',
                cursor: 'row-resize',
                handle: '.sortableActionE',
                start: function(e,ui){isExecuteSortableE = true;},
                activate: createPlaceholderBodyE,
                stop: changeSortNoE
        };
        var sortableOptionF = {
                axis:'y',
                opacity: 0.7,
                placeholder: 'drag-placeholder',
                cursor: 'row-resize',
                handle: '.sortableActionF',
                start: function(e,ui){isExecuteSortableF = true;},
                activate: createPlaceholderBodyF,
                stop: changeSortNoF
        };
        var sortableOptionG = {
                axis:'y',
                opacity: 0.7,
                placeholder: 'drag-placeholder',
                cursor: 'row-resize',
                handle: '.sortableActionG',
                start: function(e,ui){isExecuteSortableG = true;},
                activate: createPlaceholderBodyG,
                stop: changeSortNoG
        };
        var isExecuteSortableA = false;
        var isExecuteSortableB = false;
        var isExecuteSortableC = false;
        var isExecuteSortableD = false;
        var isExecuteSortableE = false;
        var isExecuteSortableF = false;
        var isExecuteSortableG = false;
        function createPlaceholderBodyA(e, ui) {
            var body = ui.item.find('.quotation-detail-itemA');
            var placeHolder = $j('.drag-placeholder');
            var bodyItem = document.createElement('div');
            for (var i = 0; i < body.length; i++) {
                var item = bodyItem.cloneNode();
                item.setAttribute('data-depth', body[i].getAttribute('data-depth'));
                placeHolder.append(item);
            }
        }
        function createPlaceholderBodyB(e, ui) {
            var body = ui.item.find('.quotation-detail-itemB');
            var placeHolder = $j('.drag-placeholder');
            var bodyItem = document.createElement('div');
            for (var i = 0; i < body.length; i++) {
                var item = bodyItem.cloneNode();
                item.setAttribute('data-depth', body[i].getAttribute('data-depth'));
                placeHolder.append(item);
            }
        }
        function createPlaceholderBodyC(e, ui) {
            var body = ui.item.find('.quotation-detail-itemC');
            var placeHolder = $j('.drag-placeholder');
            var bodyItem = document.createElement('div');
            for (var i = 0; i < body.length; i++) {
                var item = bodyItem.cloneNode();
                item.setAttribute('data-depth', body[i].getAttribute('data-depth'));
                placeHolder.append(item);
            }
        }
        function createPlaceholderBodyD(e, ui) {
            var body = ui.item.find('.quotation-detail-itemD');
            var placeHolder = $j('.drag-placeholder');
            var bodyItem = document.createElement('div');
            for (var i = 0; i < body.length; i++) {
                var item = bodyItem.cloneNode();
                item.setAttribute('data-depth', body[i].getAttribute('data-depth'));
                placeHolder.append(item);
            }
        }
        function createPlaceholderBodyE(e, ui) {
            var body = ui.item.find('.quotation-detail-itemE');
            var placeHolder = $j('.drag-placeholder');
            var bodyItem = document.createElement('div');
            for (var i = 0; i < body.length; i++) {
                var item = bodyItem.cloneNode();
                item.setAttribute('data-depth', body[i].getAttribute('data-depth'));
                placeHolder.append(item);
            }
        }
        function createPlaceholderBodyF(e, ui) {
            var body = ui.item.find('.quotation-detail-itemF');
            var placeHolder = $j('.drag-placeholder');
            var bodyItem = document.createElement('div');
            for (var i = 0; i < body.length; i++) {
                var item = bodyItem.cloneNode();
                item.setAttribute('data-depth', body[i].getAttribute('data-depth'));
                placeHolder.append(item);
            }
        }
        function createPlaceholderBodyG(e, ui) {
            var body = ui.item.find('.quotation-detail-itemG');
            var placeHolder = $j('.drag-placeholder');
            var bodyItem = document.createElement('div');
            for (var i = 0; i < body.length; i++) {
                var item = bodyItem.cloneNode();
                item.setAttribute('data-depth', body[i].getAttribute('data-depth'));
                placeHolder.append(item);
            }
        }
        function dragActionA(targetRow) {

            detailBodyBlur(lasttarget);
        
            setSortableA();
            var $sortableArea = $j('.quotation-detail-listA');
            var target = $j(targetRow).closest('.quotation-detail-itemA')[0];
            var $details = $j('.quotation-detail-itemA');
            var wrapdiv = document.createElement('div');
            $j(wrapdiv).addClass('quotation-detail-childWrap-itemA');
            $sortableArea.empty();
            var block = wrapdiv.cloneNode();
            var isChildNode = false;
            var targetDepth = parseInt(target.getAttribute('data-depth'), 10);
            var lastDepth = 0;
            
            var targetDetailType = target.getAttribute('data-type');
            for (var i = 0; i < $details.length; i++) {
                var detail = $details[i];
                var currentDetailDepth = parseInt(detail.getAttribute('data-depth'), 10);
                lastDepth = currentDetailDepth;
                if (targetDepth === currentDetailDepth || (isChildNode && targetDepth - currentDetailDepth >= 0)) {
                    if (block.childNodes.length > 0) {
                        $sortableArea.append(block);
                    }
                    block = wrapdiv.cloneNode();
                    isChildNode = (targetDepth === currentDetailDepth)
                }
                block.appendChild(detail);
                if (!isChildNode && targetDepth !== 0 && targetDepth - currentDetailDepth < 2) {
                    if (block.childNodes.length > 0) {
                        $sortableArea.append(block);
                    }
                    block = wrapdiv.cloneNode();
                }
            }
            if (block.childNodes.length > 0) {
                $sortableArea.append(block);
            }
            var sortableTarget = ' .quotation-detail-childWrap-itemA';
            var excludeSelectors = [];
            if (targetDepth - lastDepth > 1 && targetDepth !== 0 && !(targetDetailType === '4' || targetDetailType === '3' || targetDetailType === '5')) {
                excludeSelectors.push(':last');
            }
            if (targetDepth !== 0) {
                excludeSelectors.push(':first');
            }
            if (excludeSelectors.length > 0) {
                sortableTarget += ':not(' + excludeSelectors.join(',') +')'
            }
            $sortableArea.sortable('option', 'items', sortableTarget);
            $sortableArea.sortable('refresh');
            $j(document).on("mouseup",childWrapEraserA);
            
        }
        function dragActionB(targetRow) {
            detailBodyBlur(lasttarget);
        
            setSortableB();
            var $sortableArea = $j('.quotation-detail-listB');
            var target = $j(targetRow).closest('.quotation-detail-itemB')[0];
            var $details = $j('.quotation-detail-itemB');
            var wrapdiv = document.createElement('div');
            $j(wrapdiv).addClass('quotation-detail-childWrap-itemB');
            $sortableArea.empty();
            var block = wrapdiv.cloneNode();
            var isChildNode = false;
            var targetDepth = parseInt(target.getAttribute('data-depth'), 10);
            var lastDepth = 0;
            
            var targetDetailType = target.getAttribute('data-type');
            for (var i = 0; i < $details.length; i++) {
                var detail = $details[i];
                var currentDetailDepth = parseInt(detail.getAttribute('data-depth'), 10);
                lastDepth = currentDetailDepth;
                if (targetDepth === currentDetailDepth || (isChildNode && targetDepth - currentDetailDepth >= 0)) {
                    if (block.childNodes.length > 0) {
                        $sortableArea.append(block);
                    }
                    block = wrapdiv.cloneNode();
                    isChildNode = (targetDepth === currentDetailDepth)
                }
                block.appendChild(detail);
                if (!isChildNode && targetDepth !== 0 && targetDepth - currentDetailDepth < 2) {
                    if (block.childNodes.length > 0) {
                        $sortableArea.append(block);
                    }
                    block = wrapdiv.cloneNode();
                }
            }
            if (block.childNodes.length > 0) {
                $sortableArea.append(block);
            }
            var sortableTarget = ' .quotation-detail-childWrap-itemB';
            var excludeSelectors = [];
            if (targetDepth - lastDepth > 1 && targetDepth !== 0 && !(targetDetailType === '4' || targetDetailType === '3' || targetDetailType === '5')) {
                excludeSelectors.push(':last');
            }
            if (targetDepth !== 0) {
                excludeSelectors.push(':first');
            }
            if (excludeSelectors.length > 0) {
                sortableTarget += ':not(' + excludeSelectors.join(',') +')'
            }
            $sortableArea.sortable('option', 'items', sortableTarget);
            $sortableArea.sortable('refresh');
            $j(document).on("mouseup",childWrapEraserB);
            
        }
        function dragActionC(targetRow) {
            detailBodyBlur(lasttarget);
        
            setSortableC();
            var $sortableArea = $j('.quotation-detail-listC');
            var target = $j(targetRow).closest('.quotation-detail-itemC')[0];
            var $details = $j('.quotation-detail-itemC');
            var wrapdiv = document.createElement('div');
            $j(wrapdiv).addClass('quotation-detail-childWrap-itemC');
            $sortableArea.empty();
            var block = wrapdiv.cloneNode();
            var isChildNode = false;
            var targetDepth = parseInt(target.getAttribute('data-depth'), 10);
            var lastDepth = 0;
            
            var targetDetailType = target.getAttribute('data-type');
            for (var i = 0; i < $details.length; i++) {
                var detail = $details[i];
                var currentDetailDepth = parseInt(detail.getAttribute('data-depth'), 10);
                lastDepth = currentDetailDepth;
                if (targetDepth === currentDetailDepth || (isChildNode && targetDepth - currentDetailDepth >= 0)) {
                    if (block.childNodes.length > 0) {
                        $sortableArea.append(block);
                    }
                    block = wrapdiv.cloneNode();
                    isChildNode = (targetDepth === currentDetailDepth)
                }
                block.appendChild(detail);
                if (!isChildNode && targetDepth !== 0 && targetDepth - currentDetailDepth < 2) {
                    if (block.childNodes.length > 0) {
                        $sortableArea.append(block);
                    }
                    block = wrapdiv.cloneNode();
                }
            }
            if (block.childNodes.length > 0) {
                $sortableArea.append(block);
            }
            var sortableTarget = ' .quotation-detail-childWrap-itemC';
            var excludeSelectors = [];
            if (targetDepth - lastDepth > 1 && targetDepth !== 0 && !(targetDetailType === '4' || targetDetailType === '3' || targetDetailType === '5')) {
                excludeSelectors.push(':last');
            }
            if (targetDepth !== 0) {
                excludeSelectors.push(':first');
            }
            if (excludeSelectors.length > 0) {
                sortableTarget += ':not(' + excludeSelectors.join(',') +')'
            }
            $sortableArea.sortable('option', 'items', sortableTarget);
            $sortableArea.sortable('refresh');
            $j(document).on("mouseup",childWrapEraserC);
            
        }
        function dragActionD(targetRow) {
            detailBodyBlur(lasttarget);
        
            setSortableD();
            var $sortableArea = $j('.quotation-detail-listD');
            var target = $j(targetRow).closest('.quotation-detail-itemD')[0];
            var $details = $j('.quotation-detail-itemD');
            var wrapdiv = document.createElement('div');
            $j(wrapdiv).addClass('quotation-detail-childWrap-itemD');
            $sortableArea.empty();
            var block = wrapdiv.cloneNode();
            var isChildNode = false;
            var targetDepth = parseInt(target.getAttribute('data-depth'), 10);
            var lastDepth = 0;
            
            var targetDetailType = target.getAttribute('data-type');
            for (var i = 0; i < $details.length; i++) {
                var detail = $details[i];
                var currentDetailDepth = parseInt(detail.getAttribute('data-depth'), 10);
                lastDepth = currentDetailDepth;
                if (targetDepth === currentDetailDepth || (isChildNode && targetDepth - currentDetailDepth >= 0)) {
                    if (block.childNodes.length > 0) {
                        $sortableArea.append(block);
                    }
                    block = wrapdiv.cloneNode();
                    isChildNode = (targetDepth === currentDetailDepth)
                }
                block.appendChild(detail);
                if (!isChildNode && targetDepth !== 0 && targetDepth - currentDetailDepth < 2) {
                    if (block.childNodes.length > 0) {
                        $sortableArea.append(block);
                    }
                    block = wrapdiv.cloneNode();
                }
            }
            if (block.childNodes.length > 0) {
                $sortableArea.append(block);
            }
            var sortableTarget = ' .quotation-detail-childWrap-itemD';
            var excludeSelectors = [];
            if (targetDepth - lastDepth > 1 && targetDepth !== 0 && !(targetDetailType === '4' || targetDetailType === '3' || targetDetailType === '5')) {
                excludeSelectors.push(':last');
            }
            if (targetDepth !== 0) {
                excludeSelectors.push(':first');
            }
            if (excludeSelectors.length > 0) {
                sortableTarget += ':not(' + excludeSelectors.join(',') +')'
            }
            $sortableArea.sortable('option', 'items', sortableTarget);
            $sortableArea.sortable('refresh');
            $j(document).on("mouseup",childWrapEraserD);
            
        }
        function dragActionE(targetRow) {
            detailBodyBlur(lasttarget);
        
            setSortableE();
            var $sortableArea = $j('.quotation-detail-listE');
            var target = $j(targetRow).closest('.quotation-detail-itemE')[0];
            var $details = $j('.quotation-detail-itemE');
            var wrapdiv = document.createElement('div');
            $j(wrapdiv).addClass('quotation-detail-childWrap-itemE');
            $sortableArea.empty();
            var block = wrapdiv.cloneNode();
            var isChildNode = false;
            var targetDepth = parseInt(target.getAttribute('data-depth'), 10);
            var lastDepth = 0;
            
            var targetDetailType = target.getAttribute('data-type');
            for (var i = 0; i < $details.length; i++) {
                var detail = $details[i];
                var currentDetailDepth = parseInt(detail.getAttribute('data-depth'), 10);
                lastDepth = currentDetailDepth;
                if (targetDepth === currentDetailDepth || (isChildNode && targetDepth - currentDetailDepth >= 0)) {
                    if (block.childNodes.length > 0) {
                        $sortableArea.append(block);
                    }
                    block = wrapdiv.cloneNode();
                    isChildNode = (targetDepth === currentDetailDepth)
                }
                block.appendChild(detail);
                if (!isChildNode && targetDepth !== 0 && targetDepth - currentDetailDepth < 2) {
                    if (block.childNodes.length > 0) {
                        $sortableArea.append(block);
                    }
                    block = wrapdiv.cloneNode();
                }
            }
            if (block.childNodes.length > 0) {
                $sortableArea.append(block);
            }
            var sortableTarget = ' .quotation-detail-childWrap-itemE';
            var excludeSelectors = [];
            if (targetDepth - lastDepth > 1 && targetDepth !== 0 && !(targetDetailType === '4' || targetDetailType === '3' || targetDetailType === '5')) {
                excludeSelectors.push(':last');
            }
            if (targetDepth !== 0) {
                excludeSelectors.push(':first');
            }
            if (excludeSelectors.length > 0) {
                sortableTarget += ':not(' + excludeSelectors.join(',') +')'
            }
            $sortableArea.sortable('option', 'items', sortableTarget);
            $sortableArea.sortable('refresh');
            $j(document).on("mouseup",childWrapEraserE);
            
        }
        function dragActionF(targetRow) {
            detailBodyBlur(lasttarget);
        
            setSortableF();
            var $sortableArea = $j('.quotation-detail-listF');
            var target = $j(targetRow).closest('.quotation-detail-itemF')[0];
            var $details = $j('.quotation-detail-itemF');
            var wrapdiv = document.createElement('div');
            $j(wrapdiv).addClass('quotation-detail-childWrap-itemF');
            $sortableArea.empty();
            var block = wrapdiv.cloneNode();
            var isChildNode = false;
            var targetDepth = parseInt(target.getAttribute('data-depth'), 10);
            var lastDepth = 0;
            
            var targetDetailType = target.getAttribute('data-type');
            for (var i = 0; i < $details.length; i++) {
                var detail = $details[i];
                var currentDetailDepth = parseInt(detail.getAttribute('data-depth'), 10);
                lastDepth = currentDetailDepth;
                if (targetDepth === currentDetailDepth || (isChildNode && targetDepth - currentDetailDepth >= 0)) {
                    if (block.childNodes.length > 0) {
                        $sortableArea.append(block);
                    }
                    block = wrapdiv.cloneNode();
                    isChildNode = (targetDepth === currentDetailDepth)
                }
                block.appendChild(detail);
                if (!isChildNode && targetDepth !== 0 && targetDepth - currentDetailDepth < 2) {
                    if (block.childNodes.length > 0) {
                        $sortableArea.append(block);
                    }
                    block = wrapdiv.cloneNode();
                }
            }
            if (block.childNodes.length > 0) {
                $sortableArea.append(block);
            }
            var sortableTarget = ' .quotation-detail-childWrap-itemF';
            var excludeSelectors = [];
            if (targetDepth - lastDepth > 1 && targetDepth !== 0 && !(targetDetailType === '4' || targetDetailType === '3' || targetDetailType === '5')) {
                excludeSelectors.push(':last');
            }
            if (targetDepth !== 0) {
                excludeSelectors.push(':first');
            }
            if (excludeSelectors.length > 0) {
                sortableTarget += ':not(' + excludeSelectors.join(',') +')'
            }
            $sortableArea.sortable('option', 'items', sortableTarget);
            $sortableArea.sortable('refresh');
            $j(document).on("mouseup",childWrapEraserF);
            
        }
        function dragActionG(targetRow) {
            detailBodyBlur(lasttarget);
        
            setSortableG();
            var $sortableArea = $j('.quotation-detail-listG');
            var target = $j(targetRow).closest('.quotation-detail-itemG')[0];
            var $details = $j('.quotation-detail-itemG');
            var wrapdiv = document.createElement('div');
            $j(wrapdiv).addClass('quotation-detail-childWrap-itemG');
            $sortableArea.empty();
            var block = wrapdiv.cloneNode();
            var isChildNode = false;
            var targetDepth = parseInt(target.getAttribute('data-depth'), 10);
            var lastDepth = 0;
            
            var targetDetailType = target.getAttribute('data-type');
            for (var i = 0; i < $details.length; i++) {
                var detail = $details[i];
                var currentDetailDepth = parseInt(detail.getAttribute('data-depth'), 10);
                lastDepth = currentDetailDepth;
                if (targetDepth === currentDetailDepth || (isChildNode && targetDepth - currentDetailDepth >= 0)) {
                    if (block.childNodes.length > 0) {
                        $sortableArea.append(block);
                    }
                    block = wrapdiv.cloneNode();
                    isChildNode = (targetDepth === currentDetailDepth)
                }
                block.appendChild(detail);
                if (!isChildNode && targetDepth !== 0 && targetDepth - currentDetailDepth < 2) {
                    if (block.childNodes.length > 0) {
                        $sortableArea.append(block);
                    }
                    block = wrapdiv.cloneNode();
                }
            }
            if (block.childNodes.length > 0) {
                $sortableArea.append(block);
            }
            var sortableTarget = ' .quotation-detail-childWrap-itemG';
            var excludeSelectors = [];
            if (targetDepth - lastDepth > 1 && targetDepth !== 0 && !(targetDetailType === '4' || targetDetailType === '3' || targetDetailType === '5')) {
                excludeSelectors.push(':last');
            }
            if (targetDepth !== 0) {
                excludeSelectors.push(':first');
            }
            if (excludeSelectors.length > 0) {
                sortableTarget += ':not(' + excludeSelectors.join(',') +')'
            }
            $sortableArea.sortable('option', 'items', sortableTarget);
            $sortableArea.sortable('refresh');
            $j(document).on("mouseup",childWrapEraserG);
            
        }
        function childWrapEraserA() {
            if (!isExecuteSortableA) {
                var details = $j('.quotation-detail-itemA');
                $j('.quotation-detail-childWrap-itemA').remove();
                $j('.quotation-detail-listA').append(details);
            }
            isExecuteSortableA = false;
            $j(document).off("mouseup",childWrapEraserA);                       
        }
        function childWrapEraserB() {
            if (!isExecuteSortableB) {
                var details = $j('.quotation-detail-itemB');
                $j('.quotation-detail-childWrap-itemB').remove();
                $j('.quotation-detail-listB').append(details);
            }
            isExecuteSortableB = false;
            $j(document).off("mouseup",childWrapEraserB);                       
        }
        function childWrapEraserC() {
            if (!isExecuteSortableC) {
                var details = $j('.quotation-detail-itemC');
                $j('.quotation-detail-childWrap-itemC').remove();
                $j('.quotation-detail-listC').append(details);
            }
            isExecuteSortableC = false;
            $j(document).off("mouseup",childWrapEraserC);                       
        }
        function childWrapEraserD() {
            if (!isExecuteSortableD) {
                var details = $j('.quotation-detail-itemD');
                $j('.quotation-detail-childWrap-itemD').remove();
                $j('.quotation-detail-listD').append(details);
            }
            isExecuteSortableD = false;
            $j(document).off("mouseup",childWrapEraserD);                       
        }
        function childWrapEraserE() {
            if (!isExecuteSortableE) {
                var details = $j('.quotation-detail-itemE');
                $j('.quotation-detail-childWrap-itemE').remove();
                $j('.quotation-detail-listE').append(details);
            }
            isExecuteSortableE = false;
            $j(document).off("mouseup",childWrapEraserE);                       
        }
        function childWrapEraserF() {
            if (!isExecuteSortableF) {
                var details = $j('.quotation-detail-itemF');
                $j('.quotation-detail-childWrap-itemF').remove();
                $j('.quotation-detail-listF').append(details);
            }
            isExecuteSortableF = false;
            $j(document).off("mouseup",childWrapEraserF);                       
        }
        function childWrapEraserG() {
            if (!isExecuteSortableG) {
                var details = $j('.quotation-detail-itemG');
                $j('.quotation-detail-childWrap-itemG').remove();
                $j('.quotation-detail-listG').append(details);
            }
            isExecuteSortableG = false;
            $j(document).off("mouseup",childWrapEraserG);                       
        }
        function changeSortNoA(e, ui) {
            var details = $j('.quotation-detail-itemA');
            var sortableArea = $j('.quotation-detail-listA');
            sortableArea.empty();
            
            RowManageA.init();
            for (var i = 0; i < details.length; i++) {
                var detail = details[i];
                setSortNo(detail, i);
                sortableArea.append(detail);
                RowManageA.push(detail);
            }
            RowManageA.calcurate();
            calcurate();
        }
        function changeSortNoB(e, ui) {
            var details = $j('.quotation-detail-itemB');
            var sortableArea = $j('.quotation-detail-listB');
            sortableArea.empty();
            
            RowManageB.init();
            for (var i = 0; i < details.length; i++) {
                var detail = details[i];
                setSortNo(detail, i);
                sortableArea.append(detail);
                RowManageB.push(detail);
            }
            RowManageB.calcurate();
            calcurate();
        }
        function changeSortNoC(e, ui) {
            var details = $j('.quotation-detail-itemC');
            var sortableArea = $j('.quotation-detail-listC');
            sortableArea.empty();
            
            RowManageC.init();
            for (var i = 0; i < details.length; i++) {
                var detail = details[i];
                setSortNo(detail, i);
                sortableArea.append(detail);
                RowManageC.push(detail);
            }
            RowManageC.calcurate();
            calcurate();
        }
        function changeSortNoD(e, ui) {
            var details = $j('.quotation-detail-itemD');
            var sortableArea = $j('.quotation-detail-listD');
            sortableArea.empty();
            
            RowManageD.init();
            for (var i = 0; i < details.length; i++) {
                var detail = details[i];
                setSortNo(detail, i);
                sortableArea.append(detail);
                RowManageD.push(detail);
            }
            RowManageD.calcurate();
            calcurate();
        }
        function changeSortNoE(e, ui) {
            var details = $j('.quotation-detail-itemE');
            var sortableArea = $j('.quotation-detail-listE');
            sortableArea.empty();
            
            RowManageE.init();
            for (var i = 0; i < details.length; i++) {
                var detail = details[i];
                setSortNo(detail, i);
                sortableArea.append(detail);
                RowManageE.push(detail);
            }
            RowManageE.calcurate();
            calcurate();
        }
        function changeSortNoF(e, ui) {
            var details = $j('.quotation-detail-itemF');
            var sortableArea = $j('.quotation-detail-listF');
            sortableArea.empty();
            
            RowManageF.init();
            for (var i = 0; i < details.length; i++) {
                var detail = details[i];
                setSortNo(detail, i);
                sortableArea.append(detail);
                RowManageF.push(detail);
            }
            RowManageF.calcurate();
            calcurate();
        }
        function changeSortNoG(e, ui) {
            var details = $j('.quotation-detail-itemG');
            var sortableArea = $j('.quotation-detail-listG');
            sortableArea.empty();
            
            RowManageG.init();
            for (var i = 0; i < details.length; i++) {
                var detail = details[i];
                setSortNo(detail, i);
                sortableArea.append(detail);
                RowManageG.push(detail);
            }
            RowManageG.calcurate();
            calcurate();
        }
        function setSortNo(target, sortNo) {
            var $target = $j(target)
            target.setAttribute('data-sortNo', sortNo);
            $target.find('.quotation-detail-sortNo').val(sortNo);
        }
        
        /*-----------------------------------------------*/
        var productAConfig = {
            fields: [
                {sobjectField:['ParentModelType__c'], label: 'Model Type', className: 'master-ModelType', targetFormClassName: "quotation-detail-ModelType"},
                {sobjectField:['ParentEnglishName__c'], label: 'Item', className: 'master-productName', targetFormClassName: 'quotation-detail-productName'},
                {sobjectField:['ProductItem__r','Kikaku__c'], label:['Spec']},
                {sobjectField:['Price__c'], label: 'Price', className: 'number', targetFormClassName: 'quotation-detail-UnitPrice'},
                {sobjectField:['CostCurrency__c'], label: 'Cur', className: 'costCurrency', targetFormClassName: 'quotation-detail-CostCurrency'},
                {sobjectField:['QuantityUnit__c'], label: 'Unit', className: 'QuantityUnit', targetFormClassName: 'quotation-detail-QuantityUnit'}
            ]
        };
        var productBConfig = {
            fields: [
                {sobjectField:['ParentModelType__c'], label: 'Model Type', className: 'master-ModelType', targetFormClassName: "quotation-detail-ModelType", hidden: true},
                {sobjectField:['ParentEnglishName__c'], label: 'Item', className: 'master-productName', targetFormClassName: 'quotation-detail-productName'},
                {sobjectField:['Price__c'], label: 'Price', className: 'number', targetFormClassName: 'quotation-detail-UnitPrice'},
                {sobjectField:['ProductItem__r','Supplier__c'], label: 'Supplier', className: 'master-supplier', targetFormClassName: 'quotation-detail-Supplier'},
                {sobjectField:['CostCurrency__c'], label: 'Cur', className: 'costCurrency', targetFormClassName: 'quotation-detail-CostCurrency'},
                {sobjectField:['QuantityUnit__c'], label: 'Unit', className: 'QuantityUnit', targetFormClassName: 'quotation-detail-QuantityUnit'}
            ]
        };
        var productG1Config = {
            fields: [
                {sobjectField:['ParentModelType__c'], label: 'Model Type', className: 'master-ModelType', targetFormClassName: "quotation-detail-ModelType"},
                {sobjectField:['ParentEnglishName__c'], label: 'Item', className: 'master-productName', targetFormClassName: 'quotation-detail-productName'},
                {sobjectField:['ProductItem__r','Kikaku__c'], label:['Spec']},
                {sobjectField:['Price__c'], label: 'Price', className: 'number', targetFormClassName: 'quotation-detail-UnitPrice'},
                {sobjectField:['CostCurrency__c'], label: 'Cur', className: 'costCurrency', targetFormClassName: 'quotation-detail-CostCurrency'},
                {sobjectField:['QuantityUnit__c'], label: 'Unit', className: 'QuantityUnit', targetFormClassName: 'quotation-detail-QuantityUnit'}
            ]
        };
        var productG2Config = {
            fields: [
                {sobjectField:['ParentModelType__c'], label: 'Model Type', className: 'master-ModelType', targetFormClassName: "quotation-detail-ModelType", hidden: true},
                {sobjectField:['ParentEnglishName__c'], label: 'Item', className: 'master-productName', targetFormClassName: 'quotation-detail-productName'},
                {sobjectField:['Price__c'], label: 'Price', className: 'number', targetFormClassName: 'quotation-detail-UnitPrice'},
                {sobjectField:['ProductItem__r','Supplier__c'], label: 'Supplier', className: 'master-supplier', targetFormClassName: 'quotation-detail-Supplier'},
                {sobjectField:['CostCurrency__c'], label: 'Cur', className: 'costCurrency', targetFormClassName: 'quotation-detail-CostCurrency'},
                {sobjectField:['QuantityUnit__c'], label: 'Unit', className: 'QuantityUnit', targetFormClassName: 'quotation-detail-QuantityUnit'}
            ]
        };
        var catalogAConfig = {
            fields: [
                {sobjectField:['ProductItem__r','Name'], appendTargetField:['Name'], className: 'master-catalogModelType', targetFormClassName: 'catalogModelType', hidden: true},
                {sobjectField:['ProductItem__r','EnglishName__c'], appendTargetField:['ParentEnglishName__c'], className: 'master-catalogProductName', targetFormClassName: 'catalogProductName'},
                {sobjectField:['ProductItem__r','ModelTypeDisplay__c'], appendTargetField:['ParentModelType__c'], className: 'master-catalogProductModelType', targetFormClassName: 'catalogProductModelType'},
                {sobjectField:['AdditionalInformation__c'], appendTargetField:['ParentFullName__c'], className: 'master-catalogProductModelType2', targetFormClassName: 'catalogProductModelType2'},
                {sobjectField:['NumberOfMounting__c'], appendTargetField:['NumberOfMounting__c'], className: 'master-NumberOfMounting__c', targetFormClassName: 'NumberOfMounting', hidden: true},
                {sobjectField:['LocalSupplyFlag__c'], appendTargetField:['LocalSupplyFlag__c'], className: 'master-LocalSupplyFlag', targetFormClassName: 'LocalSupplyFlag', hidden: true},
                {sobjectField:['ProductItem__c'], appendTargetField:['ProductItem__c'], className: 'master-catalogProductItem', targetFormClassName: 'catalogProductItem', hidden: true}
            ]
        };
        var catalogGConfig = {
            fields: [
                {sobjectField:['ProductItem__r','Name'], appendTargetField:['Name'], className: 'master-catalogModelType', targetFormClassName: 'catalogModelType', hidden: true},
                {sobjectField:['ProductItem__r','EnglishName__c'], appendTargetField:['ParentEnglishName__c'], className: 'master-catalogProductName', targetFormClassName: 'catalogProductName'},
                {sobjectField:['ProductItem__r','ModelTypeDisplay__c'], appendTargetField:['ParentModelType__c'], className: 'master-catalogProductModelType', targetFormClassName: 'catalogProductModelType'},
                {sobjectField:['AdditionalInformation__c'], appendTargetField:['ParentFullName__c'], className: 'master-catalogProductModelType2', targetFormClassName: 'catalogProductModelType2'},
                {sobjectField:['NumberOfMounting__c'], appendTargetField:['NumberOfMounting__c'], className: 'master-NumberOfMounting__c', targetFormClassName: 'NumberOfMounting', hidden: true},
                {sobjectField:['LocalSupplyFlag__c'], appendTargetField:['LocalSupplyFlag__c'], className: 'master-LocalSupplyFlag', targetFormClassName: 'LocalSupplyFlag', hidden: true},
                {sobjectField:['ProductItem__c'], appendTargetField:['ProductItem__c'], className: 'master-catalogProductItem', targetFormClassName: 'catalogProductItem', hidden: true}
            ]
        };

        var detailTypes = ['明細','見出し','諸経費','小計','口銭'];
        var detailFieldConfigures = {
                fields: [
                    {sobjectField: ['Type__c'], label: '明細タイプ', resultFunc: function(resultValue){
                            var ret = '';
                            if (resultValue) {
                                ret = detailTypes[parseInt(resultValue, 10) - 1];
                            }
                            return ret;
                        }
                    },
                    {sobjectField: ['Body__c'], label: '内容'},
                    {sobjectField: ['ModelType__c'], label: '{!$Label.JEOL_QuotEdit_Label_ItemNo}'},
                    {sobjectField: ['Quantity__c'], label: '数量', className: 'number'},
                    {sobjectField: ['QuantityUnit__c'], label: '単位'},
                    {sobjectField: ['UnitPrice__c'], label: '単価',className: 'number'},
                    {sobjectField: ['Amount__c'], label: '金額',className: 'number'}
                ]
        };

        var divNode = document.createElement('div');
        function render(records, renderTarget, renderConfigure, eventFunction) {
            var records = records;
            var body = renderTarget;
            body.empty();
            var $table = $j(divNode.cloneNode());
            $table.addClass('table');
            var $headerRow = $j(divNode.cloneNode());
            $headerRow.addClass('item');
            $table.append($headerRow);
            var config = renderConfigure;
            var fieldSettings = config.fields;
            for (var i = 0; i < records.length; i++) {
                var currentTarget = records[i];
                var $item = $j(divNode.cloneNode());
                $item.addClass('item');
                for (key in eventFunction) {
                    $item.on(key, eventFunction[key]);
                }
                if (fieldSettings) {
                    for (var j = 0; j < fieldSettings.length; j++) {
                        var fieldConfigure = fieldSettings[j];
                        if (fieldConfigure.sobjectField) {
                            var fieldValue = getFieldValue(currentTarget,fieldConfigure.sobjectField);
                            if (i === 0) {
                                var $headItem = createField(fieldConfigure.label);
                                $headItem.addClass('head');
                                if (fieldConfigure.hidden) {
                                    $headItem.css({display: 'none'});
                                }
                                $headerRow.append($headItem);
                            }
                            $headerRow.append($headItem);
                            if (fieldConfigure.resultFunc && typeof fieldConfigure.resultFunc === "function") {
                                fieldValue = fieldConfigure.resultFunc(fieldValue);
                            }
                            $field = createField(fieldValue, fieldConfigure.className);
                            $item.append($field)
                            if (fieldConfigure.hidden) {
                                $field.css({display: 'none'});
                            }
                        }
                    }
                    $table.append($item);
                }
            }
            body.append($table);
            return body.find('.item');
        }
        function getFieldValue(targetSobject, fieldNameArray) {
            var target = targetSobject;
            for (var i = 0; i < fieldNameArray.length; i++) {
                var fieldName = fieldNameArray[i];
                if (fieldName && typeof target[fieldName] !== "undefined") {
                    target = target[fieldName];
                    if (typeof target == "string") {
                      target = convert(target);
                    }
                } else {
                    target = '';
                    break;
                }
            }
            return target;
        }

        var convert = function(convert){
            return $j("<span />", { html: convert }).text();
        };

        function createField(value, fieldClass) {
            var field = $j(divNode.cloneNode());
            field.addClass('field');
            var fieldValue = $j(divNode.cloneNode());
            fieldClass = ' ' + (fieldClass ? fieldClass : '');
            fieldValue.addClass('field-value' + fieldClass);

            fieldValue.text(value);
            field.append(fieldValue);
            return field;
        }
        function pagerInfo(manage, targetNode) {
            var manager = manage;
            var $pagerArea = $j(targetNode).find('.pager-area');
            var currentPageNum = manager.getPageNumber();
            $pagerArea.find('.current-page-number').text(currentPageNum);
            if (currentPageNum > 1) {
                $pagerArea.find('.prev.customButton').show();
                $pagerArea.find('.prev.disabled-button').hide();
            } else {
                $pagerArea.find('.prev.customButton').hide();
                $pagerArea.find('.prev.disabled-button').show();
            }
            var maxPageNum = manager.maxPageNumber();
            $pagerArea.find('.max-page-number').text(maxPageNum);
            if (maxPageNum > currentPageNum) {
                $pagerArea.find('.next.customButton').show();
                $pagerArea.find('.next.disabled-button').hide();
            } else {
                $pagerArea.find('.next.customButton').hide();
                $pagerArea.find('.next.disabled-button').show();
            }
        }
        
        function deleteMultipleRows() {

            var $rowToDelete = $j('.todelete');
            var conditions = [];
            for (var i = 0; i < $rowToDelete.length; i++) {
                var field = $rowToDelete[i];
                var fieldName = field.getAttribute('data-rowguid');
                conditions.push(fieldName);
            }
            $j('input[id$=fieldListRowToDel]').val(conditions);
        }



        function getDiscountTotalAmountNb(nbDiscount) {
            var $reductionForms = $j('.customReductionAmount');
            var $reductionFormsPlusMinus = $j('.customReductionPlusMinus');          

            var totalReduction = 0;
            var headerSubtitleAmount = transformCurrencyToInteger($j('.fieldQuotationSubtitleOutput').val(), 2);

            for (var i = 0; i < nbDiscount; i++) {
                var $reduction =  $j($reductionForms[i]);
                var reductionValue = transformCurrencyToInteger($reduction.val(), 2);
                if (reductionValue && $j($reductionFormsPlusMinus[i]).find("input:checked").val() != '-') {
                  reductionValue = -reductionValue;
                }

                if (reductionValue || reductionValue === 0) {
                    if (totalReduction + reductionValue > headerSubtitleAmount) {
                        reductionValue = parseFloat((headerSubtitleAmount - totalReduction).toFixed(10));
                    }
                    if ($j($reductionFormsPlusMinus[i]).find("input:checked").val() != '-') {
                      $reduction.val(currencyFormat((-reductionValue).toFixed(2)));
                    } else {
                      $reduction.val(currencyFormat(reductionValue.toFixed(2)));                      
                    }
                    totalReduction = parseFloat((totalReduction + reductionValue).toFixed(10));;                    
                }
            }
            return totalReduction;
        }

        function getDiscountTotalAmount() {
            return getDiscountTotalAmountNb(3);
        }
        function getDiscountTotalAmount1() {
            return getDiscountTotalAmountNb(1);
        }
        function getDiscountTotalAmount12() {
            return getDiscountTotalAmountNb(2);
        }

        function setTotalAmount() {
            var headerSubtitleAmount = transformCurrencyToInteger($j('.fieldQuotationSubtitleOutput').val(), 2);
            var totalReduction = getDiscountTotalAmount();
            var totalReduction1 = getDiscountTotalAmount1();
            var totalReduction12 = getDiscountTotalAmount12();

            var toalAmount = parseFloat((headerSubtitleAmount - totalReduction).toFixed(10));
            var toalAmount1 = parseFloat((headerSubtitleAmount - totalReduction1).toFixed(10));
            var toalAmount12 = parseFloat((headerSubtitleAmount - totalReduction12).toFixed(10));

            var totalReductionPercent = 0;
            if (headerSubtitleAmount > 0 || totalReduction > 0) {
                totalReductionPercent = Math.round(totalReduction / headerSubtitleAmount * 10000) / 100;
            }

            $j('.quotationTotalAmount').val(parseFloat(toalAmount.toFixed(2)));
            $j('.quotationTotalAmountOutput').text(currencyFormat(toalAmount.toFixed(2)));
            $j('.quotationSubtotalReductionAmount1').val(parseFloat(toalAmount1.toFixed(2)));
            $j('.quotationSubtotalReductionAmount1Output').text(currencyFormat(toalAmount1.toFixed(2)));
            $j('.quotationSubtotalReductionAmount2').val(parseFloat(toalAmount12.toFixed(2)));
            $j('.quotationSubtotalReductionAmount2Output').text(currencyFormat(toalAmount12.toFixed(2)));

            setTaxAmount();
            var taxAmount = transformCurrencyToInteger($j('.quotationConsumptionTaxAmount').val(), 2);

            var fixedTotalAmount = Math.round(parseFloat(toalAmount + taxAmount).toPrecision(10) * 100) / 100;
            $j('.quotationTotalTaxAmountOutput').text(currencyFormat(fixedTotalAmount.toFixed(2)));
            $j('.quotationTotalTaxAmount').val(parseFloat(fixedTotalAmount.toFixed(2)));

            $j('#totalReductionPercent').text('' + totalReductionPercent + '%');

        }

        function setTaxAmount() {
            var headerSubtitleAmount = transformCurrencyToInteger($j('.fieldQuotationSubtitleOutput').val(), 2);
            var discountAmount = getDiscountTotalAmount();
            var fixedAmount = headerSubtitleAmount - discountAmount;
            if (fixedAmount < 0) {
                fixedAmount = 0;
            }
            var $taxRate = $j('.taxRate');
            var rate = transformCurrencyToInteger($taxRate.val(), 1);
            $taxRate.val(rate);
            var value = Math.floor(parseFloat(fixedAmount*rate).toFixed(10)) / 100;

            $j('.quotationConsumptionTaxAmountOutput').text(currencyFormat(value.toFixed(2)));
            $j('.quotationConsumptionTaxAmount').val(value);
        }




/*------------------------------------------------------------*/
//
//  品目複数選択画面    品目検索 カタログ検索 SECTION A
//
/*------------------------------------------------------------*/

        function initDetailProductAItemManage($targetNode) {

            $j('#productAItemSearch').removeClass("hidden");
            $j('#productBItemSearch').addClass("hidden");
            $j('#productG1ItemSearch').addClass("hidden");
            $j('#productG2ItemSearch').addClass("hidden");

            if ($j( "select[name*=':quotationType']" ).find("option:selected").text() == $j( "input[name*=':quotation-unit-label']" ).val()) {
              $j('#catalogAItemSearch').removeClass("hidden");
            } else {
              $j('#catalogAItemSearch').addClass("hidden");
            }
            $j('#catalogGItemSearch').addClass("hidden");

            tabSelection($j('#productAItemSearch'));
            
            detailProductAItemManage.setTargetNode($targetNode);
            detailProductACatalogManage.setTargetNode($targetNode);

            var catalogCurrency = $targetNode.find('.quotation-detail-CatalogCurrency').val();
            $j('#currencySearchA').val(catalogCurrency);
            $j('#currencySearchACat').val(catalogCurrency);
            var radioItems = $j('#radio-currencyA-' + catalogCurrency).prop('checked', true);
            var radioItems = $j('#radio-currencyACat-' + catalogCurrency).prop('checked', true);

        }

        var detailProductAItemManage = new PagerHelper();
        detailProductAItemManage.setPageSize(13);
        detailProductAItemManage.setConfig(productAConfig);
        
        function productAItemSearchJS() {
            var conditions = queryCondition($j('#detailProductAItemSearchArea'));
            conditions['sectionItem'] = 'A';
            detailProductAItemsQuery(conditions);
        }
        function detailProductAItemsQuery(conditions) {
            $j('#detailProductItemView .modal-content').addClass('ajax-loading');

            var quotationCompany = $j( "input[name*=':quotation-company']" ).val();
            var quotationDateQT = $j( "input[name*=':quotation-dateQT']" ).val();
            var quotationListPriceBooks = $j( "input[name*=':quotation-listPriceBooks']" ).val();
            var quotationType = $j( "select[name*=':quotationType']" ).val();
            
            if (!quotationDateQT) {
                showAlert('Please enter the creation date of the quotation before adding items.');
                $j('#detailProductItemView .modal-content').removeClass('ajax-loading');
            } else {
                JEOLAsia_ProfitCalculationEditorPageCtrl.getProductMaster(conditions, '', quotationCompany, quotationDateQT, quotationListPriceBooks, quotationType, function(result){
                    if (result) {
                        var manage = detailProductAItemManage;
                        manage.setRecords(result);
                        var $modal = $j('#detailProductItemView');
                        var $items = render(manage.getRecords(), $modal.find('#productAItemTabPanel .item-list'), manage.getConfig());
                        $items.draggable(draggableOption);
                        var errorText = '';
                        if (manage.size() >= 10000) {
                            errorText = 'The search returned too many rows. Only the 10,000 first datas will be displayed.';
                            showAlert(errorText);
                        }
                        pagerInfo(detailProductAItemManage, $j('#productAItemTabPanel'));
                        if($modal.find('#productAItemTabPanel .auto-close-check').prop('checked')) {
                            $j('#detailProductAItemSearchArea').collapse('hide');
                        }
                    } else {
                        showAlert('Information could not be retrieved. Try again later.');
                    }
                    $j('#detailProductItemView .modal-content').removeClass('ajax-loading');
                });
            }
        }
        function nextRecordsAddDraggableA() {
            var $modal = $j('#detailProductItemView');
            var $items = render(detailProductAItemManage.next(), $modal.find('#productAItemTabPanel .item-list'), detailProductAItemManage.getConfig());
            $items.draggable(draggableOption);
            pagerInfo(detailProductAItemManage, $j('#productAItemTabPanel'));
        } 
        function prevRecordsAddDraggableA() {
            var $modal = $j('#detailProductItemView');
            var $items = render(detailProductAItemManage.prev(), $modal.find('#productAItemTabPanel .item-list'), detailProductAItemManage.getConfig());
            $items.draggable(draggableOption);
            pagerInfo(detailProductAItemManage, $j('#productAItemTabPanel'));
        }
        
        function chooseItemDetailProductA() {
            var items = [];
            var config = detailProductAItemManage.getConfig();
            var fields = config.fields;
            var $modal = $j('#detailProductItemView');
            var $selectedItems = $modal.find('#productAItemTabPanel .item.selected');
            if ($selectedItems.length) {
                for (var i = 0; i < $selectedItems.length; i++) {
                    var $selectedItem = $j($selectedItems[i]);
                    var values = [];
                    for (var j = 0; j < fields.length; j++) {
                        var field = fields[j];
                        if (field.targetFormClassName) {
                            var value = $selectedItem.find('.' + field.className).text();
                            values.push('"' + field.sobjectField.join('.') + '":"' + value + '"');
                        }
                    }
                    items.push('{' + values.join(',') + '}');
                }
                var $targetNode = detailProductAItemManage.getTargetNode();
                var targetSortNo = $targetNode[0].getAttribute('data-sortNo');
                var jsonText = '{' + 
                                    '"sortNo":"' + targetSortNo + '",' +
                                    '"items":[' + items.join(',') +']' +
                                '}';

                var quotationDateQT = $j( "input[name*=':quotation-dateQT']" ).val();
                var quotationListPriceBooks = $j( "input[name*=':quotation-listPriceBooks']" ).val();

                createSelectedProductAItemDetails(jsonText, '', quotationDateQT, quotationListPriceBooks);
                $modal.modal('hide');
            } else {
                showAlert('Please select the items to add.');
            }
        }

        var detailProductACatalogManage = new PagerHelper();
        detailProductACatalogManage.setPageSize(10000);
        detailProductACatalogManage.setConfig(catalogAConfig);

        function productACatalogSearch() {
            var conditions = queryCondition($j('#detailProductACatalogSearchArea'));
            detailProductACatalogQuery(conditions);
        }

        function detailProductACatalogQuery(conditions) {
            $j('#detailProductItemView .modal-content').addClass('ajax-loading');
            var quotationCompany = $j( "input[name*=':quotation-company']" ).val();
            JEOLAsia_ProfitCalculationEditorPageCtrl.getCatalogHead(conditions, quotationCompany, function(result){
                if (result) {
                    var manage = detailProductACatalogManage;
                    manage.setRecords(result);
                    var $modal = $j('#detailProductItemView');
                    var $items = catalogRenderA(manage.getRecords(), $modal.find('#productACatalogTabPanel .item-list'), manage.getConfig(),{"click":getChildCatalogStructureA}, true);
                    $items.draggable(draggableOption);
                    var errorText = '';
                    if (manage.size() >= 10000) {
                        errorText = '検索結果が多いため10000件まで表示します。';
                        showAlert(errorText);
                    }
                    //pagerInfo(detailProductACatalogManage, $j('#productACatalogTabPanel'));
                    if($modal.find('#productACatalogTabPanel .auto-close-check').prop('checked')) {
                        $j('#detailProductACatalogSearchArea').collapse('hide');
                    }
                } else {
                    showAlert('情報を取得できませんでした。再度検索してみてください。');
                }
                $j('#detailProductItemView .modal-content').removeClass('ajax-loading');
            });
        }
        
        function getChildCatalogStructureA(e) {
            var $target = $j(e.target);
            var $parentItem = $target.closest('.item');
            if (!$parentItem.hasClass('got-items')) {
                $j('#detailProductItemView .modal-content').addClass('ajax-loading');
                var quotationCompany = $j( "input[name*=':quotation-company']" ).val();
                JEOLAsia_ProfitCalculationEditorPageCtrl.getChildCatalogStructure($parentItem[0].getAttribute('data-catalog'), $parentItem[0].getAttribute('data-target'), $parentItem[0].getAttribute('data-position'), quotationCompany, function(result, event){
                    childCatalogStructureCallBackA(result, event, $parentItem);
                    $j('#detailProductItemView .modal-content').removeClass('ajax-loading');
                });
            }
            $parentItem.toggleClass('open');
            e.preventDefault();
            return false;
        }
        function childCatalogStructureCallBackA(result, event, $parentItem) {
            var ret = null;
            if (event.status) {
                var $childWrapper = $j(divNode.cloneNode());
                $childWrapper.addClass('children');
                $parentItem.append($childWrapper);
                var manage = detailProductACatalogManage;
                manage.setRecords(result);
                var $modal = $j('#detailProductItemView');
                var $items = catalogRenderA(manage.getRecords(), $childWrapper, manage.getConfig(),{"click":getChildCatalogStructureA});
                if (!$parentItem.hasClass('non-select-drag')) {
                    $items.draggable(draggableOption);
                } else {
                    $items.addClass('selected non-select-drag');
                    $items.draggable(selectedDraggableOption);
                }
                var errorText = '';
                if (manage.size() >= 10000) {
                    errorText = '検索結果が多いため10000件まで表示します。';
                    showAlert(errorText);
                }
                ret = $items;
            } else {
                showAlert('情報を取得できませんでした。再度検索してみてください。');
            }
            $parentItem.addClass('got-items');
            return ret;
        }
        function catalogRenderA(records, renderTarget, renderConfigure, eventFunction, isRoot) {    
            var records = records;
            var body = renderTarget;
            body.empty();
            var $tree = $j(divNode.cloneNode());
            $tree.addClass('tree');
            var config = renderConfigure;
            var fieldSettings = config.fields;
            for (var i = 0; i < records.length; i++) {
                var currentTarget = records[i];
                var $item = $j(divNode.cloneNode());
                $item.addClass('item');
                
                var $view = $j(divNode.cloneNode());
                $view.addClass('tree-view');
                $item.append($view);
                var $fieldSet = $j(divNode.cloneNode());
                $fieldSet.addClass('tree-fieldset');
                $item.append($fieldSet);
                if (fieldSettings) {
                    createCatalogItemDetailA(currentTarget, $view, $fieldSet, fieldSettings);
                    if ((currentTarget.Position__c === 1 && isRoot) || currentTarget.ClassificationType__c == 1) {
                        for (key in eventFunction) {
                            $view.on(key, eventFunction[key]);
                        }
                        var structure = null;
                        if (currentTarget.Position__c === 1) {
                            structure = currentTarget.CatalogStructure__c;
                        } else {
                            structure = currentTarget.ClassificationNo__c;
                        }
                        $item[0].setAttribute('data-target', structure);
                        $item[0].setAttribute('data-catalog', currentTarget.ProductCatalog__c);
                    }
                    if (currentTarget.Position__c === 1 && !isRoot) {
<!--                        $item[0].setAttribute('data-exclude-json-data', true); -->
                    }
                    var targetPosition = currentTarget.Position__c;
                    $item[0].setAttribute('data-position', targetPosition);
                    if (currentTarget.EnglishText__c) {
                      $item[0].setAttribute('title', currentTarget.EnglishText__c);
                    } else {
                      $item[0].setAttribute('title', '');
                    }

                    $item[0].className += " showTooltipEnglishText";
                    $tree.append($item);
                }
            }
            body.append($tree);
            return body.find('.item');
        }
        function createCatalogItemDetailA(target, $view, $fieldSet, fieldSettings) {
            var viewTexts = [];
            for (var i = 0; i < fieldSettings.length; i++) {
                var fieldConfigure = fieldSettings[i];
                if (fieldConfigure.sobjectField) {
                    var fieldValue = getFieldValue(target,fieldConfigure.sobjectField);
                    if (fieldConfigure.resultFunc && typeof fieldConfigure.resultFunc === "function") {
                        fieldValue = fieldConfigure.resultFunc(fieldValue);
                    }
                    if (!fieldConfigure.hidden && fieldValue.length > 0) {
                        viewTexts.push(fieldValue);
                    }
                    var $field = createField(fieldValue, fieldConfigure.className);
                    $fieldSet.append($field);
                    /*if (fieldConfigure.hidden) {
                        $field.css({display: 'none'});
                    }*/
                }
            }
            $view.text(viewTexts.join(' '));
        }
        
        var asyncGetStructrueQueue = null;
        var fAlreadySent = true; <!-- Used to send it only once. If not, when the main folder has been opened, but not the child folders, the content of the child folder is added twice (reason unknown) (By Polus on 2015/06/16) -->
        
        function chooseCatalogDetailProductA() {
            var items = [];
            asyncGetStructrueQueue = {};
            fAlreadySent = false;
            var config = detailProductACatalogManage.getConfig();
            var fields = config.fields;
            var $modal = $j('#detailProductItemView');
            var $selectedItems = $modal.find('#productACatalogTabPanel .item.selected');
            if ($selectedItems.length) {
                $j('#detailProductItemView .modal-content').addClass('ajax-loading');
                getAllStructureA($selectedItems);
            } else {
                showAlert('Please select the items to add.');
            }                
        }
        function getAllStructureA($targets) {
            if ($targets.length) {
                for (var i = 0; i < $targets.length; i++) {
                    var item = $targets[i];
                    var $item = $j(item);
                    var targetCatalog = item.getAttribute('data-catalog');
                    var targetStructure = item.getAttribute('data-target');
                    var targetPosition = item.getAttribute('data-position');
                    if ($item.hasClass('got-items') && targetStructure && targetStructure.length) {
                        <!-- The folder has been opened -->
                        asyncGetStructrueQueue[targetStructure] = item;
                        getAllStructureA($item.find('.children>.tree>.item'));
                        delete asyncGetStructrueQueue[targetStructure];
                    } else if (targetStructure && targetStructure.length) {
                        <!-- The folder has not been opened, all childs should be added -->
                        asyncGetStructrueQueue[targetStructure] = item;
                        getCatalogStructureCallA($item, targetCatalog, targetStructure, targetPosition);
                    }
                }
            }
            var queueLen = 0;
            for (key in asyncGetStructrueQueue) {
                queueLen++;
            }
            if (queueLen <= 0 && !fAlreadySent) {
                fAlreadySent = true;
                createImportCatalogJsonA();
            }
        }
        function getCatalogStructureCallA($item, targetCatalog, targetStructure, targetPosition) {
            var quotationCompany = $j( "input[name*=':quotation-company']" ).val();
            JEOLAsia_ProfitCalculationEditorPageCtrl.getChildCatalogStructure(targetCatalog, targetStructure, targetPosition, quotationCompany, function(result, event){
                var $items = childCatalogStructureCallBackA(result, event, $item);
                delete asyncGetStructrueQueue[targetStructure];
                if ($items) {
                    getAllStructureA($items);
                }
            });
        }
        function createImportCatalogJsonA() {
            var $items = $j('#detailProductItemView #productACatalogTabPanel #selected-list-catalog-A>.tree>.item');
            var jsonItems = [];
            getCatalogJsonA($items, jsonItems, 0);
            var $targetNode = detailProductACatalogManage.getTargetNode();
            var targetSortNo = $targetNode[0].getAttribute('data-sortNo');
            var jsonText = '{' + 
                                '"sortNo":"' + targetSortNo + '",' +
                                '"items":[' + jsonItems.join(',') +']' +
                            '}';
            var parsedJson = JSON.parse(jsonText);

            var quotationDateQT = $j( "input[name*=':quotation-dateQT']" ).val();
            var quotationListPriceBooks = $j( "input[name*=':quotation-listPriceBooks']" ).val();

            createSelectedProductAItemDetails(jsonText, 'FromCatalog', quotationDateQT, quotationListPriceBooks);
            $j('#detailProductItemView .modal-content').removeClass('ajax-loading');
            $j('#detailProductItemView').modal('hide');
        }
        
        function getCatalogJsonA($items, jsonItems, depth) {
        
            var config = detailProductACatalogManage.getConfig();
            var fields = config.fields;
            for (var i = 0; i < $items.length; i++) {
                var item = $items[i];
                var $item = $j(item);
                
                var isExcludeTarget = (depth != 0 && item.getAttribute('data-exclude-json-data') === 'true');
                if (!isExcludeTarget) {
                    var values = [];
                    for (var j = 0; j < fields.length; j++) {
                        var field = fields[j];
                        if (field.targetFormClassName) {
                            var $fieldset = $item.children('.tree-fieldset');
                            var value = $fieldset.find('.' + field.className).text();
                            values.push('"' + field.appendTargetField.join('.') + '":"' + value + '"');
                        }
                    }
                    values.push('"depth":' + depth);
                    jsonItems.push('{' + values.join(',') + '}');
                    var structure = item.getAttribute('data-target');
                    if (structure && structure.length > 0) {
                        var children = $item.children('.children').children('.tree').children('.item');
                        getCatalogJsonA(children, jsonItems, depth + 1);
                    }
                }
            }
        }



/*------------------------------------------------------------*/
//
//  品目複数選択画面    品目検索 カタログ検索 SECTION B
//
/*------------------------------------------------------------*/

        function initDetailProductBItemManage($targetNode) {

            $j('#productAItemSearch').addClass("hidden");
            $j('#productBItemSearch').removeClass("hidden");
            $j('#productG1ItemSearch').addClass("hidden");
            $j('#productG2ItemSearch').addClass("hidden");
            $j('#catalogAItemSearch').addClass("hidden");
            $j('#catalogGItemSearch').addClass("hidden");

            tabSelection($j('#productBItemSearch'));

            detailProductBItemManage.setTargetNode($targetNode);

            var catalogCurrency = $targetNode.find('.quotation-detail-CatalogCurrency').val();
            $j('#currencySearchB').val(catalogCurrency);
            var radioItems = $j('#radio-currencyB-' + catalogCurrency).prop('checked', true);

        }

        var detailProductBItemManage = new PagerHelper();
        detailProductBItemManage.setPageSize(13);
        detailProductBItemManage.setConfig(productBConfig);
        
        function productBItemSearchJS() {
            var conditions = queryCondition($j('#detailProductBItemSearchArea'));
            conditions['sectionItem'] = 'B';
            detailProductBItemsQuery(conditions);
        }
        function detailProductBItemsQuery(conditions) {
            $j('#detailProductItemView .modal-content').addClass('ajax-loading');

            var quotationCompany = $j( "input[name*=':quotation-company']" ).val();
            var quotationDateQT = $j( "input[name*=':quotation-dateQT']" ).val();
            var quotationListPriceBooks = $j( "input[name*=':quotation-listPriceBooks']" ).val();
            var quotationType = $j( "select[name*=':quotationType']" ).val();

            if (!quotationDateQT) {
                showAlert('Please enter the creation date of the quotation before adding items.');
                $j('#detailProductItemView .modal-content').removeClass('ajax-loading');
            } else {
                JEOLAsia_ProfitCalculationEditorPageCtrl.getProductMaster(conditions, '', quotationCompany, quotationDateQT, quotationListPriceBooks, quotationType, function(result){
                    if (result) {
                        var manage = detailProductBItemManage;
                        manage.setRecords(result);
                        var $modal = $j('#detailProductItemView');
                        var $items = render(manage.getRecords(), $modal.find('#productBItemTabPanel .item-list'), manage.getConfig());
                        $items.draggable(draggableOption);
                        var errorText = '';
                        if (manage.size() >= 10000) {
                            errorText = 'The search returned too many rows. Only the 10,000 first datas will be displayed.';
                            showAlert(errorText);
                        }
                        pagerInfo(detailProductBItemManage, $j('#productBItemTabPanel'));
                        if($modal.find('#productBItemTabPanel .auto-close-check').prop('checked')) {
                            $j('#detailProductBItemSearchArea').collapse('hide');
                        }
                    } else {
                        showAlert('情報を取得できませんでした。再度検索してみてください。');
                    }
                    $j('#detailProductItemView .modal-content').removeClass('ajax-loading');
                });
            }
        }
        function nextRecordsAddDraggableB() {
            var $modal = $j('#detailProductItemView');
            var $items = render(detailProductBItemManage.next(), $modal.find('#productBItemTabPanel .item-list'), detailProductBItemManage.getConfig());
            $items.draggable(draggableOption);
            pagerInfo(detailProductBItemManage, $j('#productBItemTabPanel'));
        } 
        function prevRecordsAddDraggableB() {
            var $modal = $j('#detailProductItemView');
            var $items = render(detailProductBItemManage.prev(), $modal.find('#productBItemTabPanel .item-list'), detailProductBItemManage.getConfig());
            $items.draggable(draggableOption);
            pagerInfo(detailProductBItemManage, $j('#productBItemTabPanel'));
        }
        
        function chooseItemDetailProductB() {
            var items = [];
            var config = detailProductBItemManage.getConfig();
            var fields = config.fields;
            var $modal = $j('#detailProductItemView');
            var $selectedItems = $modal.find('#productBItemTabPanel .item.selected');
            if ($selectedItems.length) {
                for (var i = 0; i < $selectedItems.length; i++) {
                    var $selectedItem = $j($selectedItems[i]);
                    var values = [];
                    for (var j = 0; j < fields.length; j++) {
                        var field = fields[j];
                        if (field.targetFormClassName) {
                            var value = $selectedItem.find('.' + field.className).text();
                            values.push('"' + field.sobjectField.join('.') + '":"' + value + '"');
                        }
                    }
                    items.push('{' + values.join(',') + '}');
                }
                var $targetNode = detailProductBItemManage.getTargetNode();
                var targetSortNo = $targetNode[0].getAttribute('data-sortNo');
                var jsonText = '{' + 
                                    '"sortNo":"' + targetSortNo + '",' +
                                    '"items":[' + items.join(',') +']' +
                                '}';
                createSelectedProductBItemDetails(jsonText);
                $modal.modal('hide');
            } else {
                showAlert('Please select the items to add.');
            }
        }



/*------------------------------------------------------------*/
//
//  品目複数選択画面    品目検索 カタログ検索 SECTION G
//
/*------------------------------------------------------------*/

        function initDetailProductGItemManage($targetNode) {

            $j('#productAItemSearch').addClass("hidden");
            $j('#productBItemSearch').addClass("hidden");
            $j('#productG1ItemSearch').removeClass("hidden");
            $j('#productG2ItemSearch').removeClass("hidden");

            $j('#catalogAItemSearch').addClass("hidden");

            if ($j( "select[name*=':quotationType']" ).find("option:selected").text() == $j( "input[name*=':quotation-unit-label']" ).val()) {
              $j('#catalogGItemSearch').removeClass("hidden");
            } else {
              $j('#catalogGItemSearch').addClass("hidden");
            }


            tabSelection($j('#productG1ItemSearch'));

            detailProductG1ItemManage.setTargetNode($targetNode);
            detailProductG2ItemManage.setTargetNode($targetNode);
            detailProductGCatalogManage.setTargetNode($targetNode);

            var catalogCurrency = $targetNode.find('.quotation-detail-CatalogCurrency').val();
            $j('#currencySearchG1').val(catalogCurrency);
            $j('#currencySearchG2').val(catalogCurrency);
            var radioItems = $j('#radio-currencyG1-' + catalogCurrency).prop('checked', true);
            var radioItems = $j('#radio-currencyG2-' + catalogCurrency).prop('checked', true);

        }

        var detailProductG1ItemManage = new PagerHelper();
        var detailProductG2ItemManage = new PagerHelper();
        detailProductG1ItemManage.setPageSize(13);
        detailProductG2ItemManage.setPageSize(13);
        detailProductG1ItemManage.setConfig(productG1Config);
        detailProductG2ItemManage.setConfig(productG2Config);
        
        function productG1ItemSearchJS() {
            var conditions = queryCondition($j('#detailProductG1ItemSearchArea'));
            conditions['sectionItem'] = 'G1';
            detailProductG1ItemsQuery(conditions);
        }
        function productG2ItemSearchJS() {
            var conditions = queryCondition($j('#detailProductG2ItemSearchArea'));
            conditions['sectionItem'] = 'G2';
            detailProductG2ItemsQuery(conditions);
        }
        function detailProductG1ItemsQuery(conditions) {
            $j('#detailProductItemView .modal-content').addClass('ajax-loading');

            var quotationCompany = $j( "input[name*=':quotation-company']" ).val();
            var quotationDateQT = $j( "input[name*=':quotation-dateQT']" ).val();
            var quotationListPriceBooks = $j( "input[name*=':quotation-listPriceBooks']" ).val();
            var quotationType = $j( "select[name*=':quotationType']" ).val();

            if (!quotationDateQT) {
                showAlert('Please enter the creation date of the quotation before adding items.');
                $j('#detailProductItemView .modal-content').removeClass('ajax-loading');
            } else {
                JEOLAsia_ProfitCalculationEditorPageCtrl.getProductMaster(conditions, '', quotationCompany, quotationDateQT, quotationListPriceBooks, quotationType, function(result){
                    if (result) {
                        var manage = detailProductG1ItemManage;
                        manage.setRecords(result);
                        var $modal = $j('#detailProductItemView');
                        var $items = render(manage.getRecords(), $modal.find('#productG1ItemTabPanel .item-list'), manage.getConfig());
                        $items.draggable(draggableOption);
                        var errorText = '';
                        if (manage.size() >= 10000) {
                            errorText = 'The search returned too many rows. Only the 10,000 first datas will be displayed.';
                            showAlert(errorText);
                        }
                        pagerInfo(detailProductG1ItemManage, $j('#productG1ItemTabPanel'));
                        if($modal.find('#productG1ItemTabPanel .auto-close-check').prop('checked')) {
                            $j('#detailProductG1ItemSearchArea').collapse('hide');
                        }
                    } else {
                        showAlert('情報を取得できませんでした。再度検索してみてください。');
                    }
                    $j('#detailProductItemView .modal-content').removeClass('ajax-loading');
                });
            }
        }
        function detailProductG2ItemsQuery(conditions) {
            $j('#detailProductItemView .modal-content').addClass('ajax-loading');

            var quotationCompany = $j( "input[name*=':quotation-company']" ).val();
            var quotationDateQT = $j( "input[name*=':quotation-dateQT']" ).val();
            var quotationListPriceBooks = $j( "input[name*=':quotation-listPriceBooks']" ).val();
            var quotationType = $j( "select[name*=':quotationType']" ).val();

            if (!quotationDateQT) {
                showAlert('Please enter the creation date of the quotation before adding items.');
                $j('#detailProductItemView .modal-content').removeClass('ajax-loading');
            } else {
                JEOLAsia_ProfitCalculationEditorPageCtrl.getProductMaster(conditions, '', quotationCompany, quotationDateQT, quotationListPriceBooks, quotationType, function(result){
                    if (result) {
                        var manage = detailProductG2ItemManage;
                        manage.setRecords(result);
                        var $modal = $j('#detailProductItemView');
                        var $items = render(manage.getRecords(), $modal.find('#productG2ItemTabPanel .item-list'), manage.getConfig());
                        $items.draggable(draggableOption);
                        var errorText = '';
                        if (manage.size() >= 10000) {
                            errorText = 'The search returned too many rows. Only the 10,000 first datas will be displayed.';
                            showAlert(errorText);
                        }
                        pagerInfo(detailProductG2ItemManage, $j('#productG2ItemTabPanel'));
                        if($modal.find('#productG2ItemTabPanel .auto-close-check').prop('checked')) {
                            $j('#detailProductG2ItemSearchArea').collapse('hide');
                        }
                    } else {
                        showAlert('情報を取得できませんでした。再度検索してみてください。');
                    }
                    $j('#detailProductItemView .modal-content').removeClass('ajax-loading');
                });
            }
        }
        function nextRecordsAddDraggableG1() {
            var $modal = $j('#detailProductItemView');
            var $items = render(detailProductG1ItemManage.next(), $modal.find('#productG1ItemTabPanel .item-list'), detailProductG1ItemManage.getConfig());
            $items.draggable(draggableOption);
            pagerInfo(detailProductG1ItemManage, $j('#productG1ItemTabPanel'));
        } 
        function nextRecordsAddDraggableG2() {
            var $modal = $j('#detailProductItemView');
            var $items = render(detailProductG2ItemManage.next(), $modal.find('#productG2ItemTabPanel .item-list'), detailProductG2ItemManage.getConfig());
            $items.draggable(draggableOption);
            pagerInfo(detailProductG2ItemManage, $j('#productG2ItemTabPanel'));
        } 
        function prevRecordsAddDraggableG1() {
            var $modal = $j('#detailProductItemView');
            var $items = render(detailProductG1ItemManage.prev(), $modal.find('#productG1ItemTabPanel .item-list'), detailProductG1ItemManage.getConfig());
            $items.draggable(draggableOption);
            pagerInfo(detailProductG1ItemManage, $j('#productG1ItemTabPanel'));
        }
        function prevRecordsAddDraggableG2() {
            var $modal = $j('#detailProductItemView');
            var $items = render(detailProductG2ItemManage.prev(), $modal.find('#productG2ItemTabPanel .item-list'), detailProductG2ItemManage.getConfig());
            $items.draggable(draggableOption);
            pagerInfo(detailProductG2ItemManage, $j('#productG2ItemTabPanel'));
        }
        
        function chooseItemDetailProductG1() {
            var items = [];
            var config = detailProductG1ItemManage.getConfig();
            var fields = config.fields;
            var $modal = $j('#detailProductItemView');
            var $selectedItems = $modal.find('#productG1ItemTabPanel .item.selected');
            if ($selectedItems.length) {
                for (var i = 0; i < $selectedItems.length; i++) {
                    var $selectedItem = $j($selectedItems[i]);
                    var values = [];
                    for (var j = 0; j < fields.length; j++) {
                        var field = fields[j];
                        if (field.targetFormClassName) {
                            var value = $selectedItem.find('.' + field.className).text();
                            values.push('"' + field.sobjectField.join('.') + '":"' + value + '"');
                        }
                    }
                    items.push('{' + values.join(',') + '}');
                }
                var $targetNode = detailProductG1ItemManage.getTargetNode();
                var targetSortNo = $targetNode[0].getAttribute('data-sortNo');
                var jsonText = '{' + 
                                    '"sortNo":"' + targetSortNo + '",' +
                                    '"JProd":"1",' +
                                    '"items":[' + items.join(',') +']' +
                                '}';

                var quotationDateQT = $j( "input[name*=':quotation-dateQT']" ).val();
                var quotationListPriceBooks = $j( "input[name*=':quotation-listPriceBooks']" ).val();

                createSelectedProductGItemDetails(jsonText, '', quotationDateQT, quotationListPriceBooks);

                $modal.modal('hide');
            } else {
                showAlert('Please select the items to add.');
            }
        }


        function chooseItemDetailProductG2() {
            var items = [];
            var config = detailProductG2ItemManage.getConfig();
            var fields = config.fields;
            var $modal = $j('#detailProductItemView');
            var $selectedItems = $modal.find('#productG2ItemTabPanel .item.selected');
            if ($selectedItems.length) {
                for (var i = 0; i < $selectedItems.length; i++) {
                    var $selectedItem = $j($selectedItems[i]);
                    var values = [];
                    for (var j = 0; j < fields.length; j++) {
                        var field = fields[j];
                        if (field.targetFormClassName) {
                            var value = $selectedItem.find('.' + field.className).text();
                            values.push('"' + field.sobjectField.join('.') + '":"' + value + '"');
                        }
                    }
                    items.push('{' + values.join(',') + '}');
                }
                var $targetNode = detailProductG2ItemManage.getTargetNode();
                var targetSortNo = $targetNode[0].getAttribute('data-sortNo');
                var jsonText = '{' + 
                                    '"sortNo":"' + targetSortNo + '",' +
                                    '"JProd":"2",' +
                                    '"items":[' + items.join(',') +']' +
                                '}';

                var quotationDateQT = $j( "input[name*=':quotation-dateQT']" ).val();
                var quotationListPriceBooks = $j( "input[name*=':quotation-listPriceBooks']" ).val();

                createSelectedProductGItemDetails(jsonText, '', quotationDateQT, quotationListPriceBooks);

                $modal.modal('hide');
            } else {
                showAlert('Please select the items to add.');
            }
        }



        var detailProductGCatalogManage = new PagerHelper();
        detailProductGCatalogManage.setPageSize(10000);
        detailProductGCatalogManage.setConfig(catalogGConfig);

        function productGCatalogSearch() {
            var conditions = queryCondition($j('#detailProductGCatalogSearchArea'));
            detailProductGCatalogQuery(conditions);
        }

        function detailProductGCatalogQuery(conditions) {
            $j('#detailProductItemView .modal-content').addClass('ajax-loading');
            var quotationCompany = $j( "input[name*=':quotation-company']" ).val();
            JEOLAsia_ProfitCalculationEditorPageCtrl.getCatalogHead(conditions, quotationCompany, function(result){
                if (result) {
                    var manage = detailProductGCatalogManage;
                    manage.setRecords(result);
                    var $modal = $j('#detailProductItemView');
                    var $items = catalogRenderG(manage.getRecords(), $modal.find('#productGCatalogTabPanel .item-list'), manage.getConfig(),{"click":getChildCatalogStructureG}, true);
                    $items.draggable(draggableOption);
                    var errorText = '';
                    if (manage.size() >= 10000) {
                        errorText = '検索結果が多いため10000件まで表示します。';
                        showAlert(errorText);
                    }
                    //pagerInfo(detailProductGCatalogManage, $j('#productGCatalogTabPanel'));
                    if($modal.find('#productGCatalogTabPanel .auto-close-check').prop('checked')) {
                        $j('#detailProductGCatalogSearchArea').collapse('hide');
                    }
                } else {
                    showAlert('情報を取得できませんでした。再度検索してみてください。');
                }
                $j('#detailProductItemView .modal-content').removeClass('ajax-loading');
            });
        }
        
        function getChildCatalogStructureG(e) {
            var $target = $j(e.target);
            var $parentItem = $target.closest('.item');
            if (!$parentItem.hasClass('got-items')) {
                $j('#detailProductItemView .modal-content').addClass('ajax-loading');
                var quotationCompany = $j( "input[name*=':quotation-company']" ).val();
                JEOLAsia_ProfitCalculationEditorPageCtrl.getChildCatalogStructure($parentItem[0].getAttribute('data-catalog'), $parentItem[0].getAttribute('data-target'), $parentItem[0].getAttribute('data-position'), quotationCompany, function(result, event){
                    childCatalogStructureCallBackG(result, event, $parentItem);
                    $j('#detailProductItemView .modal-content').removeClass('ajax-loading');
                });
            }
            $parentItem.toggleClass('open');
            e.preventDefault();
            return false;
        }
        function childCatalogStructureCallBackG(result, event, $parentItem) {
            var ret = null;
            if (event.status) {
                var $childWrapper = $j(divNode.cloneNode());
                $childWrapper.addClass('children');
                $parentItem.append($childWrapper);
                var manage = detailProductGCatalogManage;
                manage.setRecords(result);
                var $modal = $j('#detailProductItemView');
                var $items = catalogRenderG(manage.getRecords(), $childWrapper, manage.getConfig(),{"click":getChildCatalogStructureG});
                if (!$parentItem.hasClass('non-select-drag')) {
                    $items.draggable(draggableOption);
                } else {
                    $items.addClass('selected non-select-drag');
                    $items.draggable(selectedDraggableOption);
                }
                var errorText = '';
                if (manage.size() >= 10000) {
                    errorText = '検索結果が多いため10000件まで表示します。';
                    showAlert(errorText);
                }
                ret = $items;
            } else {
                showAlert('情報を取得できませんでした。再度検索してみてください。');
            }
            $parentItem.addClass('got-items');
            return ret;
        }
        function catalogRenderG(records, renderTarget, renderConfigure, eventFunction, isRoot) {    
            var records = records;
            var body = renderTarget;
            body.empty();
            var $tree = $j(divNode.cloneNode());
            $tree.addClass('tree');
            var config = renderConfigure;
            var fieldSettings = config.fields;
            for (var i = 0; i < records.length; i++) {
                var currentTarget = records[i];
                var $item = $j(divNode.cloneNode());
                $item.addClass('item');
                
                var $view = $j(divNode.cloneNode());
                $view.addClass('tree-view');
                $item.append($view);
                var $fieldSet = $j(divNode.cloneNode());
                $fieldSet.addClass('tree-fieldset');
                $item.append($fieldSet);
                if (fieldSettings) {
                    createCatalogItemDetailG(currentTarget, $view, $fieldSet, fieldSettings);
                    if ((currentTarget.Position__c === 1 && isRoot) || currentTarget.ClassificationType__c == 1) {
                        for (key in eventFunction) {
                            $view.on(key, eventFunction[key]);
                        }
                        var structure = null;
                        if (currentTarget.Position__c === 1) {
                            structure = currentTarget.CatalogStructure__c;
                        } else {
                            structure = currentTarget.ClassificationNo__c;
                        }
                        $item[0].setAttribute('data-target', structure);
                        $item[0].setAttribute('data-catalog', currentTarget.ProductCatalog__c);
                    }
                    if (currentTarget.Position__c === 1 && !isRoot) {
<!--                        $item[0].setAttribute('data-exclude-json-data', true); -->
                    }
                    var targetPosition = currentTarget.Position__c;
                    $item[0].setAttribute('data-position', targetPosition);
                    if (currentTarget.EnglishText__c) {
                      $item[0].setAttribute('title', currentTarget.EnglishText__c);
                    } else {
                      $item[0].setAttribute('title', '');
                    }

                    $item[0].className += " showTooltipEnglishText";
                    $tree.append($item);
                }
            }
            body.append($tree);
            return body.find('.item');
        }
        function createCatalogItemDetailG(target, $view, $fieldSet, fieldSettings) {
            var viewTexts = [];
            for (var i = 0; i < fieldSettings.length; i++) {
                var fieldConfigure = fieldSettings[i];
                if (fieldConfigure.sobjectField) {
                    var fieldValue = getFieldValue(target,fieldConfigure.sobjectField);
                    if (fieldConfigure.resultFunc && typeof fieldConfigure.resultFunc === "function") {
                        fieldValue = fieldConfigure.resultFunc(fieldValue);
                    }
                    if (!fieldConfigure.hidden && fieldValue.length > 0) {
                        viewTexts.push(fieldValue);
                    }
                    var $field = createField(fieldValue, fieldConfigure.className);
                    $fieldSet.append($field);
                    /*if (fieldConfigure.hidden) {
                        $field.css({display: 'none'});
                    }*/
                }
            }
            $view.text(viewTexts.join(' '));
        }
        
        var asyncGetStructrueQueue = null;
        var fAlreadySent = true; <!-- Used to send it only once. If not, when the main folder has been opened, but not the child folders, the content of the child folder is added twice (reason unknown) (By Polus on 2015/06/16) -->
        
        function chooseCatalogDetailProductG() {
            var items = [];
            asyncGetStructrueQueue = {};
            fAlreadySent = false;
            var config = detailProductGCatalogManage.getConfig();
            var fields = config.fields;
            var $modal = $j('#detailProductItemView');
            var $selectedItems = $modal.find('#productGCatalogTabPanel .item.selected');
            if ($selectedItems.length) {
                $j('#detailProductItemView .modal-content').addClass('ajax-loading');
                getAllStructureG($selectedItems);
            } else {
                showAlert('Please select the items to add.');
            }                
        }
        function getAllStructureG($targets) {
            if ($targets.length) {
                for (var i = 0; i < $targets.length; i++) {
                    var item = $targets[i];
                    var $item = $j(item);
                    var targetCatalog = item.getAttribute('data-catalog');
                    var targetStructure = item.getAttribute('data-target');
                    var targetPosition = item.getAttribute('data-position');
                    if ($item.hasClass('got-items') && targetStructure && targetStructure.length) {
                        <!-- The folder has been opened -->
                        asyncGetStructrueQueue[targetStructure] = item;
                        getAllStructureG($item.find('.children>.tree>.item'));
                        delete asyncGetStructrueQueue[targetStructure];
                    } else if (targetStructure && targetStructure.length) {
                        <!-- The folder has not been opened, all childs should be added -->
                        asyncGetStructrueQueue[targetStructure] = item;
                        getCatalogStructureCallG($item, targetCatalog, targetStructure, targetPosition);
                    }
                }
            }
            var queueLen = 0;
            for (key in asyncGetStructrueQueue) {
                queueLen++;
            }
            if (queueLen <= 0 && !fAlreadySent) {
                fAlreadySent = true;
                createImportCatalogJsonG();
            }
        }
        function getCatalogStructureCallG($item, targetCatalog, targetStructure, targetPosition) {
            var quotationCompany = $j( "input[name*=':quotation-company']" ).val();
            JEOLAsia_ProfitCalculationEditorPageCtrl.getChildCatalogStructure(targetCatalog, targetStructure, targetPosition, quotationCompany, function(result, event){
                var $items = childCatalogStructureCallBackG(result, event, $item);
                delete asyncGetStructrueQueue[targetStructure];
                if ($items) {
                    getAllStructureG($items);
                }
            });
        }
        function createImportCatalogJsonG() {
            var $items = $j('#detailProductItemView #productGCatalogTabPanel #selected-list-catalog-G>.tree>.item');
            var jsonItems = [];
            getCatalogJsonG($items, jsonItems, 0);
            var $targetNode = detailProductGCatalogManage.getTargetNode();
            var targetSortNo = $targetNode[0].getAttribute('data-sortNo');
            var jsonText = '{' + 
                                '"sortNo":"' + targetSortNo + '",' +
                                '"items":[' + jsonItems.join(',') +']' +
                            '}';
            var parsedJson = JSON.parse(jsonText);

            var quotationDateQT = $j( "input[name*=':quotation-dateQT']" ).val();
            var quotationListPriceBooks = $j( "input[name*=':quotation-listPriceBooks']" ).val();

            createSelectedProductGItemDetails(jsonText, 'FromCatalog', quotationDateQT, quotationListPriceBooks);
            $j('#detailProductItemView .modal-content').removeClass('ajax-loading');
            $j('#detailProductItemView').modal('hide');
        }
        
        function getCatalogJsonG($items, jsonItems, depth) {
        
            var config = detailProductGCatalogManage.getConfig();
            var fields = config.fields;
            for (var i = 0; i < $items.length; i++) {
                var item = $items[i];
                var $item = $j(item);
                
                var isExcludeTarget = (depth != 0 && item.getAttribute('data-exclude-json-data') === 'true');
                if (!isExcludeTarget) {
                    var values = [];
                    for (var j = 0; j < fields.length; j++) {
                        var field = fields[j];
                        if (field.targetFormClassName) {
                            var $fieldset = $item.children('.tree-fieldset');
                            var value = $fieldset.find('.' + field.className).text();
                            values.push('"' + field.appendTargetField.join('.') + '":"' + value + '"');
                        }
                    }
                    values.push('"depth":' + depth);
                    jsonItems.push('{' + values.join(',') + '}');
                    var structure = item.getAttribute('data-target');
                    if (structure && structure.length > 0) {
                        var children = $item.children('.children').children('.tree').children('.item');
                        getCatalogJsonG(children, jsonItems, depth + 1);
                    }
                }
            }
        }





        




        
        function queryCondition($targetNode) {
            var $searchFields = $targetNode.find('input.field-value[data-field]');
            var conditions = {};
            for (var i = 0; i < $searchFields.length; i++) {
                var field = $searchFields[i];
                var fieldName = field.getAttribute('data-field');
                var fieldValue = field.value;
                if (fieldName && fieldName.length != 0) {
                    conditions[fieldName] = fieldValue;
//alert('fieldName: ' + fieldName + ' | fieldValue: ' + fieldValue); //todobp
                }
            }
            return conditions;
        }
        
        function deleteConfirm() {
            if (confirm('This quotation will be deleted. Are you sure?')) {
                unlockSafety();
                qotationDelete();
            }
        }
        var draggableOption = {
            helper: 'clone',
            opacity: 0.7,
            zIndex: 102,
            scroll: false,
            start: function(e, ui) {
                ui.helper.addClass('item-drag');
            }
        };
        var selectedDraggableOption = {
            helper: 'clone',
            opacity: 0.7,
            zIndex: 102,
            cursorAt: {left: 5, top: 5},
            start: function(e, ui) {
                ui.helper.addClass('item-drag');
                $j(ui.helper.context).css({'background-color':'#eee'});
            },
            stop: function(e, ui) {
                var $draggable = $j(ui.helper.context);
                if($draggable.hasClass('remove-target') && $draggable.hasClass('selected')) {
                    $draggable.remove();
                } else {
                    $draggable.css({'background-color':''});
                }
            }
        }
        var droppableOption = {
            greedy: true,
            accept: '.item',
            tolerance: 'intersect',
            activeClass: 'drop-active', 
            hoverClass: 'drop-hover', 
            drop: function(e, ui){
                if (!ui.draggable.hasClass('selected')) {
                    $selectedItem = ui.draggable.removeAttr('style').clone();
                    $selectedItem.addClass('selected');
                    $selectedItem.draggable(selectedDraggableOption);
                    $j(e.target).find('.drop-target').append($selectedItem); 
                }
            },
            out: function(e, ui){
                if (ui.draggable.hasClass('selected')) {
                    ui.draggable.addClass('remove-target');
                }
            },
            over: function(e, ui) {
                if (ui.draggable.hasClass('selected')) {
                    ui.draggable.removeClass('remove-target');
                }
            }
        };
        var droppableOption_catalogA = {
            greedy: true,
            accept: '.item',
            tolerance: 'intersect',
            activeClass: 'drop-active', 
            hoverClass: 'drop-hover', 
            drop: function(e, ui){
                if (!ui.draggable.hasClass('selected')) {
                    var $selectedItem = ui.draggable.removeAttr('style').clone();
                    $selectedItem.find('.item').addClass('selected non-select-drag');
                    $selectedItem.addClass('selected non-select-drag');
                    $selectedItem.draggable(selectedDraggableOption);
                    $selectedItem.find('.item').draggable(selectedDraggableOption);
                    var items = $selectedItem.find('.item[data-target] > .tree-view');
                    items.on('click',getChildCatalogStructureA);
                    var structrue = $selectedItem[0].getAttribute('data-target');
                    if (structrue && structrue.length > 0 ) {
                        $selectedItem.children('.tree-view').on('click',getChildCatalogStructureA);
                    }
                    $j(e.target).find('.drop-target').append($selectedItem); 
                }
            },
            out: function(e, ui){
                if (ui.draggable.hasClass('selected')) {
                    ui.draggable.addClass('remove-target');
                }
            },
            over: function(e, ui) {
                if (ui.draggable.hasClass('selected')) {
                    ui.draggable.removeClass('remove-target');
                }
            }
        };
        var droppableOption_catalogG = {
            greedy: true,
            accept: '.item',
            tolerance: 'intersect',
            activeClass: 'drop-active', 
            hoverClass: 'drop-hover', 
            drop: function(e, ui){
                if (!ui.draggable.hasClass('selected')) {
                    var $selectedItem = ui.draggable.removeAttr('style').clone();
                    $selectedItem.find('.item').addClass('selected non-select-drag');
                    $selectedItem.addClass('selected non-select-drag');
                    $selectedItem.draggable(selectedDraggableOption);
                    $selectedItem.find('.item').draggable(selectedDraggableOption);
                    var items = $selectedItem.find('.item[data-target] > .tree-view');
                    items.on('click',getChildCatalogStructureG);
                    var structrue = $selectedItem[0].getAttribute('data-target');
                    if (structrue && structrue.length > 0 ) {
                        $selectedItem.children('.tree-view').on('click',getChildCatalogStructureG);
                    }
                    $j(e.target).find('.drop-target').append($selectedItem); 
                }
            },
            out: function(e, ui){
                if (ui.draggable.hasClass('selected')) {
                    ui.draggable.addClass('remove-target');
                }
            },
            over: function(e, ui) {
                if (ui.draggable.hasClass('selected')) {
                    ui.draggable.removeClass('remove-target');
                }
            }
        };

        function searchProductItemAsia(target) {
            var $row = $j(target).closest('.quotation-detail-item');
            var ModelType = $row.find('.quotation-detail-ModelType').val();
            var section = $row.attr('data-section-type');
            var catalogCurrency = $row.find('.quotation-detailA-CatalogCurrency').val();
            var quotationCompany = $j( "input[name*=':quotation-company']" ).val();
            var quotationDateQT = $j( "input[name*=':quotation-dateQT']" ).val();
            var quotationListPriceBooks = $j( "input[name*=':quotation-listPriceBooks']" ).val();
            var quotationType = $j( "select[name*=':quotationType']" ).val();
            var series = $j('.series').val();
            var country = $j('.shipmentCountry').val();
            var agency = $j('.contractAgency').val();
            var recordTypeID = $j('.quotationType').val();

            JEOLAsia_ProfitCalculationEditorPageCtrl.searchProductItemAsia(ModelType, section, catalogCurrency, quotationCompany, quotationDateQT, quotationListPriceBooks, quotationType, series, country, agency, recordTypeID, function(result) {
                if (result) {

                    if (result['ParentIsDisplayedAsiaSignal__c']) {
                      $row.find('.quotation-detail-IsForbiddenTarget').val('false');
                      $row.attr('data-forbidden-target', 'false');
                      $row.find('.quotation-detail-QuantityUnit').val(result['QuantityUnit__c']);
                      $row.find('.quotation-detail-ModelType').removeClass('not-found-alert');
                      $row.find('.quotation-detail-productName').val(convert(result['ParentEnglishName__c']));
                      $row.find('.quotation-detail-UnitPrice').val(result['Price__c']);
                      $row.find('.quotation-detail-SalesPriceCoefficient').val(result['TechnicalAlways1__c']);
                      $row.find('.quotation-detail-CatalogCurrency').val(result['CostCurrency__c']);    
                      calcurate();
                      showAlert('The search for the item is finished.');
                    } else {
                      $row.find('.quotation-detail-IsForbiddenTarget').val('true');
                      $row.attr('data-forbidden-target', 'true');
                      $row.find('.quotation-detail-UnitPrice').val(0);
                      $row.find('.quotation-detail-SalesPriceCoefficient').val('');
                      calcurate();
                      showAlert('The item entered is not available for sell.');
                    }
                } else {
                    $row.find('.quotation-detail-IsForbiddenTarget').val('false');
                    $row.attr('data-forbidden-target', 'false');
                    $row.find('.quotation-detail-ModelType').addClass('not-found-alert');
                    $row.find('.quotation-detail-UnitPrice').val(0);
                    $row.find('.quotation-detail-SalesPriceCoefficient').val('');
                    calcurate();
                    showAlert('No item corresponding has been found.');
                }
            });
        }
        
        var alertAnime = null;
        function showAlert(target) {
            var alert = document.getElementById('alert');
            if (alertAnime) {
                clearTimeout(alertAnime);
                alert.style.top = '0px';
                alert.style.opacity = '0';
                alert.style.transition = 'none';
            }
            if (target instanceof $j) {
                $j(alert).find('.description').append(target);
            } else if (target instanceof $j || typeof target === 'string') {
                $j(alert).find('.description').text(target);
            }
            alert.style.display = 'block';
            alertAnime = setTimeout(function(){
                alert.style.top = '20px';
                alert.style.opacity = '1';
                alert.style.transition = '';
            }, 100);
            alertAnime = setTimeout(hideAleart, 3200);
        }
        function hideAleart() {
            var alert = document.getElementById('alert');
            alert.style.top = '';
            alert.style.opacity = '';
            alertAnime = setTimeout(function(){
                alert.style.display = '';
                alertAnime = null;
                $j(alert).find('.description').empty();
            }, 500);
        }
        function openPreview() {
            window.open("{!PreviewUrl}","_blank","width=960,height=600,resizable=no,toolbar=no,location=no,menubar=no,status=no,scrollbars=yes");
        }
        function openPrintWindow() {
            window.open('{!PrintUrl}',"_blank","width=960,height=600,resizable=no,toolbar=no,location=no,menubar=no,status=no,scrollbars=yes");
        }
        function changeTaxAmountOutput(node) {
            var $target = $j(node);
            var value = $target.prop('checked');
            if (value) {
                $j('.includeTaxOutput').prop('checked', false);
            } else {
                $j('.includeTaxOutput').prop('checked', true);
            }
        }
        var errorAreaId = '#{!$Component.form.apexMessage}';
        function getErrorArea() {
            return $j(errorAreaId.replace(/(:)/ig,'\\\$1'));
        }
        function showResult(text) {
            var $error = getErrorArea();
            var $children = $error.children();
            if ($children.length > 0) {
                $children = $children.clone();
                $children.css({'text-align': 'left'});
                showAlert($children);
            } else {
                showAlert(text);
            }
        }

        function transformInputTextBranchNo(text) {
            var ret = '';
            if (text || text === 0) {
                ret = text.replace(/[０-９]/ig,function(s){
                    return String.fromCharCode(s.charCodeAt(0) - 65248);
                })
                ret = ret.match(/^[0-9]*/ig)[0];
            }
            if (ret.length < 2) {
                for (var i = ret.length; i < 2; i++) {
                    ret = '0' + ret;
                }
            }
            return ret;
        }
        function transformSafeInputText(text) {
            var ret = '';
            if (text) {
                ret = text.replace(/[０-９ａ-ｚＡ-Ｚ]/g,function(s){
                    return String.fromCharCode(s.charCodeAt(0) - 65248);
                })
                ret = ret.toUpperCase().match(/^[0-9A-Z]*/g)[0];
            }
            return ret;
        }
        function transformInputText(text) {
            var ret = '';
            if (text) {
                ret = text.replace(/[０-９ａ-ｚＡ-Ｚ]/g,function(s){
                    return String.fromCharCode(s.charCodeAt(0) - 65248);
                })
                ret = ret.toUpperCase();
            }
            return ret;
        }
        function tabSelection(self) {
            var $self = $j(self);
            if (!$self.hasClass('active')) {
                var $modal = $j('#detailProductItemView');
                var tabs = $modal.find('.tab');
                tabs.removeClass('active');
                var targetTabName = $self.attr('data-target');
                $modal[0].setAttribute('data-tab-target', targetTabName);
                $self.addClass('active');
            }
            $j('#detailProductItemView').css({'display':'block'});
        }
        
        var openModalDetailId = null;
        function setOpenModalDetailId(target) {
            var $detail = $j(target).closest('.quotation-detail-item');
            openModalDetailId = $detail.attr('id');
        }
        function focusOpenModalDetail() {
            var $detail = $j(document.getElementById(openModalDetailId));
            var $targetButton = $detail.find('.productSelectButton');
            openModalDetailId = null;
            $targetButton.trigger('focus');
        }
    
        function safetyLockCheck(targetNode) {
            var value = targetNode.getAttribute('data-compare-value');
            var type = targetNode.getAttribute('type');
            var currentValue = null;
            if (type === 'checkbox' || type === 'radio') {
                currentValue = targetNode.checked;
            } else {
                currentValue = targetNode.value;
            }
            if (value !== currentValue) {
                lockSafety();
            }
        }
        function unlockSafety() {
            safety = false;
        }
        function lockSafety() {
            safety = true;
        }
        var lasttarget;
        function detailBodyFocus(target) {
            lasttarget = target;
            $j(target).parent().css('left','0px');
        }
        function detailBodyBlur(target) {
            $j(target).parent().css('left','');
            $j(target).css({height:'30px'});
        }
        function openSearchToggleButton(target) {
            $j('.field.toggle').removeClass('toggle');
            $j(target).closest('.field').addClass('toggle');
        }
        /**
         * detect IE
         * returns version of IE or false, if browser is not Internet Explorer
         */
        function detectIE() {
            var ua = window.navigator.userAgent;
        
            var msie = ua.indexOf('MSIE ');
            if (msie > 0) {
                // IE 10 or older => return version number
                return parseInt(ua.substring(msie + 5, ua.indexOf('.', msie)), 10);
            }
        
            var trident = ua.indexOf('Trident/');
            if (trident > 0) {
                // IE 11 => return version number
                var rv = ua.indexOf('rv:');
                return parseInt(ua.substring(rv + 3, ua.indexOf('.', rv)), 10);
            }
        
            var edge = ua.indexOf('Edge/');
            if (edge > 0) {
               // IE 12 => return version number
               return parseInt(ua.substring(edge + 5, ua.indexOf('.', edge)), 10);
            }
        
            // other browser
            return false;
        }
        function makeSuggestions(target) {

            var quotationType = $j( "select[name*=':quotationType']" ).val();

            var val = target.value;
            if (val == lastsuggestval) return;
            lastsuggestval = val;
            
            lastSuggest += 1;
            var localLastSuggest = lastSuggest;
            
            target.removeAttribute("list");

            var dataList = $j("#suggest_listA");
            dataList.empty();

            var isIE = detectIE();
            var isFirefox = navigator.userAgent.toLowerCase().indexOf('firefox') > -1;
            
            if (isIE || isFirefox) {
                if(val.length < 2) return;
            } else {
                if(val.length < 3) return;
            }

            JEOLAsia_ProfitCalculationEditorPageCtrl.getSuggestions(val, quotationType, function(result) {
                if (result) {
                    if(result.length) {

                        for(var i = 0, len = result.length; i < len; i++) {

                            if (localLastSuggest === lastSuggest)
                            {
                                var idxseparator = result[i].indexOf(",");
                                var opt = $j("<option></option>").attr("value", convert(result[i].substring(0,idxseparator)));
                                if (isIE || isFirefox) {
                                    opt.attr("label", convert(result[i].substring(0,idxseparator)) + " " + convert(result[i].substring(idxseparator + 1)));
                                } else {
                                    opt.attr("label", convert(result[i].substring(idxseparator + 1)));
                                }
                                dataList.append(opt);
                            }
                        }
        
                    }
                                     
                }
            });
                    
            if (localLastSuggest === lastSuggest)
            {
                target.setAttribute("list", "suggest_listA");
            }                        
        }

        function ignoreEnterKey(e){
            if ((window.event&&window.event.keyCode==13) || e.which==13) {
                return false;
            } else {
                return true;
            };
        } 

        function disableEnterKey(e)
                {
                    var key;     
                    if(window.event)
                        key = window.event.keyCode; //IE
                    else
                        key = e.which; //firefox     
                    return (key != 13);
                }

    </script>
    </head>
    <body >
      <apex:actionStatus layout="block" onstop="contentInit();" id="ajaxPageStatus" startStyleClass="ajax-status-start-page">
        <apex:facet name="start">
          <div class="ajax-status-start-inner ajax-loading"></div>
        </apex:facet>
      </apex:actionStatus>
      <apex:outputPanel layout="block" styleClass="contents" id="contents" >
        <div class="page-header">
          <apex:include pageName="{!$Page.JEOL_VisualforceHeader}" />
        </div>
        <div class="contents-body">
          <apex:form id="form">
            <apex:inputHidden value="{!quotationRecordtypeLabelUnit}" id="quotation-unit-label"/>
            <apex:inputHidden value="{!qdm.parentRec.Company__c}" id="quotation-company"/>
            <apex:inputHidden value="{!dateQT}" id="quotation-dateQT"/>
            <apex:inputHidden value="{!listPriceBooks}" id="quotation-listPriceBooks"/>
            <apex:inputText id="fieldScrollValue" styleclass="hidden" value="{!currentScrollValue}" />          
            <apex:inputText id="fieldListRowToDel" styleclass="hidden" value="{!ListRowToDel}" />          
            <div class="section navi-area" >
              <div class="section-body base-width clearfix">
                <ul class="navi-buttons clearfix">
                  <li class="navi-item">
                    <apex:commandLink action="{!saveAction}" styleClass="customButton save" onclick="unlockSafety();" status="ajaxPageStatus" >{!$Label.JEOLAsia_QuotEdit_Label_Save}</apex:commandLink>
                  </li>
                </ul>
                <ul class="navi-buttons clearfix">

                  <apex:outputPanel layout="none" id="buttonsBar" rendered="{!!isNew}" style="margin-left: 100px;">

                  <!-- BUTTON COPY -->
                  <li class="{!IF(isCopyForbidden,'hidden','navi-item')}">
                    <div data-type="dropdown">
                      <button class="customButton" type="button" data-type="button" onclick="dorpdownAction(this);">
                        <span >Copy</span>
                        <span class="caret"></span>
                      </button>
                      <ul data-type="list">
                        <li data-type="item">
                          <apex:commandLink value="Create with a new Quotation No" action="{!profitCalculationCopy}"/>
                        </li>
                        <li data-type="item">
                          <apex:commandLink value="Create existing Quotation No + Suffix" action="{!profitCalculationCopyAndBranch}" />
                        </li>
                      </ul>
                    </div>
                  </li>

                  <!-- BUTTON PRINT OUT QT -->
                  <li class=" navi-item">
                    <apex:outputPanel layout="none" >
                      <button type="button" class="customButton" data-toggle="modal" data-target="#OutputPrintView">{!IF(qdm.parentRec.Status__c == '3', 'Print Out QT', 'Print Preview')}</button>
                    </apex:outputPanel>
                  </li>

                  <!-- BUTTON APPLICATION FOR APPROVAL -->
                  <li class=" navi-item" style="margin-left: 15px;">
                    <apex:commandLink action="{!requestApproval}" rendered="{!(qdm.parentRec.Status__c == '1' || qdm.parentRec.Status__c == '4') && (!isSVC)}" styleClass="customButton" onclick="unlockSafety();" status="ajaxPageStatus" rerender="contentPage">Application for Approval</apex:commandLink>
                  </li>

                  <!-- BUTTON APPLICATION FOR APPROVAL -->
                  <li class=" navi-item" style="margin-left: 15px;">
                    <apex:commandLink action="{!requestApprovalSVCAssistant1}" rendered="{!(qdm.parentRec.Status__c == '1' || qdm.parentRec.Status__c == '4') && (isSVC)}" styleClass="customButton" onclick="unlockSafety();" status="ajaxPageStatus" rerender="contentPage">Request Approval (Assistant 1)</apex:commandLink>
                  </li>

                  <!-- BUTTON APPLICATION FOR APPROVAL -->
                  <li class=" navi-item" style="margin-left: 15px;">
                    <apex:commandLink action="{!requestApprovalSVCAssistant2}" rendered="{!(qdm.parentRec.Status__c == '1' || qdm.parentRec.Status__c == '4') && (isSVC)}" styleClass="customButton" onclick="unlockSafety();" status="ajaxPageStatus" rerender="contentPage">Request Approval (Assistant 2)</apex:commandLink>
                  </li>

                  <!-- BUTTON APPLICATION FOR APPROVAL -->
                  <li class=" navi-item" style="margin-left: 15px;">
                    <apex:commandLink action="{!requestApprovalSVCDirector}" rendered="{!(qdm.parentRec.Status__c == '1' || qdm.parentRec.Status__c == '4') && (isSVC)}" styleClass="customButton" onclick="unlockSafety();" status="ajaxPageStatus" rerender="contentPage">Request Approval (Director)</apex:commandLink>
                  </li>

                  <!-- BUTTON RECALL APPROVAL REQUEST -->
                  <li class=" navi-item" style="margin-left: 15px;">
                    <apex:commandLink action="{!recallApprovalRequest}"
                                      rendered="{!qdm.parentRec.Status__c == '2' || 
                                                  qdm.parentRec.Status__c == '21' || 
                                                  qdm.parentRec.Status__c == '22' || 
                                                  qdm.parentRec.Status__c == '23' || 
                                                  qdm.parentRec.Status__c == '3' || 
                                                  qdm.parentRec.Status__c == '5' || 
                                                  qdm.parentRec.Status__c == '51'}"
                                      styleClass="customButton" 
                                      onclick="unlockSafety();" 
                                      status="ajaxPageStatus" 
                                      rerender="contentPage">Recall Approval Request</apex:commandLink>
                  </li>

                  <!-- BUTTON APPROVE -->
                  <li class=" navi-item" >
                    <apex:commandLink action="{!approveRequest}"
                                      rendered="{!((qdm.parentRec.Status__c == '2' && isUnit && isApproverSales) || 
                                                   (qdm.parentRec.Status__c == '2' && !isUnit && isApproverSVCManager) || 
                                                   (qdm.parentRec.Status__c == '21' && isApproverSVCAssistant1) || 
                                                   (qdm.parentRec.Status__c == '22' && isApproverSVCAssistant2) || 
                                                   (qdm.parentRec.Status__c == '23' && isApproverSVCDirector) || 
                                                   (qdm.parentRec.Status__c == '5' && isApproverSalesEscalatedDirector) || 
                                                   (qdm.parentRec.Status__c == '51' && isApproverSalesEscalatedMD)
                                                  )}"
                                      styleClass="customButton" 
                                      onclick="unlockSafety();" 
                                      status="ajaxPageStatus" 
                                      rerender="contentPage">Approve</apex:commandLink>
                  </li>

                  <!-- BUTTON REJECT -->
                  <li class=" navi-item" >
                    <apex:outputPanel layout="none"
                                      rendered="{!((qdm.parentRec.Status__c == '2' && isUnit && isApproverSales) || 
                                                   (qdm.parentRec.Status__c == '2' && !isUnit && isApproverSVCManager) || 
                                                   (qdm.parentRec.Status__c == '21' && isApproverSVCAssistant1) || 
                                                   (qdm.parentRec.Status__c == '22' && isApproverSVCAssistant2) || 
                                                   (qdm.parentRec.Status__c == '23' && isApproverSVCDirector) || 
                                                   (qdm.parentRec.Status__c == '5' && isApproverSalesEscalatedDirector) || 
                                                   (qdm.parentRec.Status__c == '51' && isApproverSalesEscalatedMD)
                                                  )}" >
                      <button type="button" class="customButton" data-toggle="modal" data-target="#OutputRejectComment">Reject</button>
                    </apex:outputPanel>
                  </li>

                  <li class=" navi-item" style="margin-left: 15px;">
                    <apex:outputPanel layout="none" rendered="{!(qdm.parentRec.Status__c == '2' && isUnit && isApproverSales)}" >
                      <button type="button" class="customButton" data-toggle="modal" data-target="#OutputEscalateCommentDirector">Escalate (Director)</button>
                    </apex:outputPanel>
                  </li>

                  <li class=" navi-item">
                    <apex:outputPanel layout="none" rendered="{!(qdm.parentRec.Status__c == '2' && isUnit && isApproverSales)}" >
                      <button type="button" class="customButton" data-toggle="modal" data-target="#OutputEscalateCommentMD">Escalate (MD)</button>
                    </apex:outputPanel>
                  </li>


                  </apex:outputPanel>
                </ul>
                <ul class="navi-buttons right clearfix">
                  <li class=" navi-item">
                    <apex:outputPanel layout="none" rendered="{!(!isNew && !isQTRestricted && hasDeletePermission)}" >
                      <button class="{!IF(isReadOnly,'hidden','customButton')}" type="button" data-toggle="modal" data-target="#deleteConfirm">{!$Label.JEOL_QuotEdit_Label_Delete}</button>
                    </apex:outputPanel>
                  </li>
                </ul>
              </div>
            </div>
            <div class="section base-width">
              <div class="hidden" id="isReadOnly" >{!IF(isReadOnly, 1, 0)}</div>
              <div class="hidden" id="isQTRestricted" >{!IF(isQTRestricted, 1, 0)}</div>
              <div class="screenname">
                <h1 class="small">{!$Label.JEOLAsia_Quotation_Quotation}</h1>
                <div class="big" >
                  <apex:outputText rendered="{!isNew}" >
                    <span>{!$Label.JEOLAsia_Quotation_NewQuotation}</span>
                  </apex:outputText>


                  <apex:outputText rendered="{!!isNew}" value="{!$Label.JEOL_QuotEdit_Label_ReferringKeyword}">
                    <apex:param value="{!qdm.parentRec.Name}"/>

<!--                    <span> 
                    「{!qdm.parentRec.Name}」の参照
<!--                    </span> -->
                  </apex:outputText>

                </div>
              </div>
            </div>
            <apex:outputPanel layout="none" rendered="{!!isValid}">
              <div class="section base-width" >
                <apex:messages layout="table" />
                <apex:outputText >
                  <apex:outputText value="Please start again from " />
                  <apex:outputLink value="{!$Page.JEOLAsia_ProfitCalculationListPage}">here</apex:outputLink>
                  <apex:outputText value="." />
                </apex:outputText>
              </div>
            </apex:outputPanel>
            <apex:outputPanel layout="none" id="listview" rendered="{!isValid}">

              <apex:actionFunction name="createSelectedProductAItemDetails"  action="{!qdm.createSelectedProductItemDetailsA}" rerender="detailAreaA, detailAreaB, detailAreaC, detailAreaD, detailAreaE, detailAreaF, detailAreaG, modalListView, modalListViewDel, apexMessage" status="ajaxStatusA" >
                <apex:param value="" name="jsonText" assignTo="{!qdm.createdItemInfos}" />
                <apex:param value="" name="curSelected" assignTo="{!qdm.currencyForCatalogAdd}" />
                <apex:param value="" name="dateQT" assignTo="{!qdm.dateQuotation}" />
                <apex:param value="" name="listPBCode" assignTo="{!qdm.listPriceBooksCode}" />
              </apex:actionFunction>
              
              <apex:actionFunction name="createSelectedProductBItemDetails"  action="{!qdm.createSelectedProductItemDetailsB}" rerender="detailAreaA, detailAreaB, detailAreaC, detailAreaD, detailAreaE, detailAreaF, detailAreaG, modalListView, modalListViewDel, apexMessage" status="ajaxStatusB" >
                <apex:param value="" name="jsonText" assignTo="{!qdm.createdItemInfos}" />
              </apex:actionFunction>

              <apex:actionFunction name="createSelectedProductGItemDetails"  action="{!qdm.createSelectedProductItemDetailsG}" rerender="detailAreaA, detailAreaB, detailAreaC, detailAreaD, detailAreaE, detailAreaF, detailAreaG, modalListView, modalListViewDel, apexMessage" status="ajaxStatusG" >
                <apex:param value="" name="jsonText" assignTo="{!qdm.createdItemInfos}" />
                <apex:param value="" name="curSelected" assignTo="{!qdm.currencyForCatalogAdd}" />
                <apex:param value="" name="dateQT" assignTo="{!qdm.dateQuotation}" />
                <apex:param value="" name="listPBCode" assignTo="{!qdm.listPriceBooksCode}" />
              </apex:actionFunction>
              
              <apex:actionFunction name="importDetailFromQuotation" action="{!qdm.importDetailFromQuotation}" rerender="detailAreaA, detailAreaB, detailAreaC, detailAreaD, detailAreaE, detailAreaF, detailAreaG, modalListView, modalListViewDel" status="ajaxStatusA" >
                <apex:param value="" name="targetId" assignTo="{!qdm.selectedQuotationId}" />
              </apex:actionFunction>
              <apex:actionFunction name="qotationDelete" action="{!deleteAction}" />

              <div class="section button-area base-width" >
                <div class="section-body clearfix">
                  <apex:outputLink value="{!$Page.JEOLAsia_ProfitCalculationListPage}" >&laquo;&nbsp;{!$Label.JEOLAsia_Quotation_BackMenu}</apex:outputLink>
                </div>
              </div>
              <div class="section base-width error-area" >
                <apex:pageMessages id="apexMessage" />
              </div>
              <div class="section quotation-area base-width">
                <div class="section-header">
                </div>

                <div class="section-body">
                           
                  <div class="quotation-information clearfix">

                    <div style="float: left;">

                        <!-- QUOTATION INFORMATION -->
                        <div class="quotation-item basic-information-area">
                          <div class="quotation-item-header clearfix">
                            <div class="header-title">{!$Label.JEOLAsia_ProfitCalculation_BasicInformations}</div>
                          </div>
                          <div class="quotation-item-body clearfix">
        <div style="min-height: 273px;">                
                            <div class="field">
                              <label for="quoteNo" class="field-label" >Quotation No</label>
                              <span style="{!IF(isReadOnly,'margin-left: -4px;','margin-left: 5px;margin-right: 20px;')}" >
                                  <apex:outputField id="quoteNo-output" styleClass="field-value quoteNo" value="{!qdm.parentRec.ProfitCalculationNo__c}" />
                              </span>
                            </div>
                            <div class="field">
                              <apex:outputLabel value="{!$Label.JEOLAsia_QuotEdit_Label_BranchNo}" for="branchNo" styleClass="field-label" />
                              <apex:outputField id="branchNo" styleClass="field-value branchNo" value="{!qdm.parentRec.BranchNo__c}"/>
                            </div>
                            <div class="field ajaxRequestStatus" >
                              <apex:actionStatus layout="block" id="ajaxQuotationTypeField" onstop="$j('.quotationType').trigger('focus');">
                                <apex:facet name="start">
                                  <div class="ajaxStatusView" >{!$Label.JEOL_QuotEdit_Label_Searching}</div>
                                </apex:facet>
                              </apex:actionStatus>
                            </div>

                            <!-- PROFIT CALCULATION TYPE -->
                            <apex:outputPanel layout="block" id="quotationTypeField" styleClass="field" html-data-type="dropdown" style="min-width: 200px;">
                              <Label for="quotationType" html-data-type="label" class="{!IF(isReadOnly || isQTRestricted,'','requireField ')}field-label" style="float: left;">Quot Type</label>
                              <apex:SelectList rendered="{!!(isReadOnly || isQTRestricted)}" id="quotationType" value="{!qdm.parentRec.RecordTypeID}" styleClass="quotationType field-value" size="1" html-data-compare-value="{!qdm.baseParentRec.RecordTypeID}" onblur="safetyLockCheck(this);" required="true" style="color: #000000;" onkeypress="return disableEnterKey(event)">
                                <apex:selectOptions value="{!QuotationTypeOptions}" />
                                <apex:actionSupport event="onchange" action="{!dummyAction}" rerender="buttonsBar" immediate="false" status="ajaxPageStatus"/>

                              </apex:SelectList>
                              <apex:outputText rendered="{!(isReadOnly || isQTRestricted)}" id="quotationTypeView" html-data-type="input-field" styleClass="departmentView" value="{!qdm.parentRec.RecordType.Name}" />



                            </apex:outputPanel>

                            <!-- STATUS -->
                            <div class="field" style="min-width: 400px;">

                              <apex:outputText value="{!isFixedPC}" styleclass="hidden isFixedPC" />

                              <label for="status" class="field-label" >Status</label>
                              <div class="field-value status" style="margin-left: 13px;" >
                                <apex:outputField id="status" value="{!qdm.parentRec.Status__c}" />
                              </div>
                            </div>

                            <!-- CREATED DATE -->
                            <div class="field" style="min-width: 400px;" >

                              <label for="issueDate" class="field-label requireField" >Created Date</label>
                              <span class="{!IF(isReadOnly,'hidden','')}" onclick="makeSafetyCheck=false;" onblur="makeSafetyCheck=true;" onmouseout="makeSafetyCheck=true;" >
                                  <apex:inputField rendered="{!!isReadOnly}" id="issueDate" styleClass="field-value issueDate" value="{!qdm.parentRec.IssueDate__c}" html-data-compare-value="{!qdm.baseParentRec.IssueDate__c}" onblur="safetyLockCheck(this);" onkeypress="return disableEnterKey(event)">
                                      <apex:actionSupport event="onchange" action="{!refreshDateQT}" rerender="quotation-dateQT, quotation-listPriceBooks" immediate="false" status="ajaxPageStatus"/>
                                  </apex:inputField>
                              </span>
                              <span class="{!IF(!isReadOnly,'hidden','')}" style="margin-left: -4px" >
                                  <apex:outputField rendered="{!isReadOnly}" id="issueDateView" styleClass="field-value issueDate" value="{!qdm.parentRec.IssueDate__c}" html-data-compare-value="{!qdm.baseParentRec.IssueDate__c}"/>
                              </span>
                            </div>


                            <!-- CUSTOMER PO -->
                            <div class="field" style="min-width: 400px;" >

                              <label for="CustomerPurchaseOrder" class="field-label" >Customer PO</label>
                              <span class="{!IF(isReadOnly,'hidden','')}" onclick="makeSafetyCheck=false;" onblur="makeSafetyCheck=true;" onmouseout="makeSafetyCheck=true;" >
                                  <apex:inputField rendered="{!!isReadOnly}" id="CustomerPurchaseOrder" styleClass="field-value CustomerPurchaseOrder" value="{!qdm.parentRec.CustomerPurchaseOrder__c}" html-data-compare-value="{!qdm.baseParentRec.CustomerPurchaseOrder__c}" onblur="safetyLockCheck(this);" onkeypress="return disableEnterKey(event)" />
                              </span>
                              <span class="{!IF(!isReadOnly,'hidden','')}" style="margin-left: -4px" >
                                  <apex:outputField rendered="{!isReadOnly}" id="CustomerPurchaseOrderView" styleClass="field-value CustomerPurchaseOrder" value="{!qdm.parentRec.CustomerPurchaseOrder__c}" html-data-compare-value="{!qdm.baseParentRec.CustomerPurchaseOrder__c}"/>
                              </span>
                            </div>

                            <hr />

                            <!-- INSTALLATION DURATION 
                            <div class="field month">
                              <apex:outputLabel value="{!$Label.JEOL_QuotEdit_Label_InstallationDuration}" for="deliveryPeriod" html-data-target="deliveryPeriod" styleClass="{!IF(isReadOnly,'','requireField ')}field-label" />
                              <apex:inputField rendered="{!!isReadOnly}" id="deliveryPeriod" styleClass="field-value deliveryPeriod number" value="{!qdm.parentRec.DeliveryPeriod__c}" html-data-compare-value="{!qdm.baseParentRec.DeliveryPeriod__c}" onblur="safetyLockCheck(this);" />
                              <apex:outputField rendered="{!isReadOnly}" id="deliveryPeriodView" styleClass="field-value deliveryPeriod number" value="{!qdm.parentRec.DeliveryPeriod__c}" />
                            </div> -->

                            <!-- INSTALLATION DATE -->
                            <div class="field">
                              <apex:outputLabel value="Estimated Shipment Date" for="deliveryDeadline" html-data-target="deliveryDeadline" styleClass="{!IF(isReadOnly,'','requireField ')}field-label" />
                              <apex:inputField rendered="{!!isReadOnly}" id="deliveryDeadline" styleClass="field-value deliveryDeadline" value="{!qdm.parentRec.DeliveryDeadline__c}" html-data-compare-value="{!qdm.baseParentRec.DeliveryDeadline__c}" onclick="makeSafetyCheck2=false;" onblur="safetyLockCheck(this);makeSafetyCheck2=true;" onmouseout="makeSafetyCheck2=true;" onkeypress="return disableEnterKey(event)"/>
                              <apex:outputField rendered="{!isReadOnly}" id="deliveryDeadlineView" styleClass="field-value deliveryDeadline" value="{!qdm.parentRec.DeliveryDeadline__c}" />
                            </div>

                            <!-- INSTALLATION DATE FREE INPUT -->
                            <div class="field" style="min-width: 400px;">
                              <apex:outputLabel value="" for="deliveryDate_Arbitrarily" html-data-target="deliveryDate_Arbitrarily" styleClass="field-label" />

                              <apex:inputField rendered="{!!isReadOnly}" id="deliveryDate_ArbitrarilyTitle" styleClass="field-value deliveryDate_ArbitrarilyTitle" value="{!qdm.parentRec.DeliveryDate_ArbitrarilyTitle__c}" html-data-compare-value="{!qdm.baseParentRec.DeliveryDate_ArbitrarilyTitle__c}" html-placeholder="Manufacturing :" onblur="safetyLockCheck(this);" onkeypress="return disableEnterKey(event)"/>
                              <apex:outputField rendered="{!isReadOnly}" id="deliveryDate_ArbitrarilyTitleView" styleClass="field-value deliveryDate_ArbitrarilyTitle" value="{!qdm.parentRec.DeliveryDate_ArbitrarilyTitle__c}" />

                              <apex:inputField rendered="{!!isReadOnly}" id="deliveryDate_Arbitrarily" styleClass="field-value deliveryDate_Arbitrarily" value="{!qdm.parentRec.DeliveryDate_Arbitrarily__c}" html-data-compare-value="{!qdm.baseParentRec.DeliveryDate_Arbitrarily__c}" html-placeholder="6 Months After Receiving LC" onblur="safetyLockCheck(this);" onkeypress="return disableEnterKey(event)"/>
                              <apex:outputField rendered="{!isReadOnly}" id="deliveryDate_ArbitrarilyView" styleClass="field-value deliveryDate_Arbitrarily" value="{!qdm.parentRec.DeliveryDate_Arbitrarily__c}" />
                            </div>

                            <hr />

                            <!-- PERIOD OF VALIDITY -->
                            <div class="field month">
                              <apex:outputLabel value="{!$Label.JEOLAsia_QuotEdit_Label_QuotValidDuration}" for="quoteValidityPeriod" styleClass="{!IF(isReadOnly,'','requireField ')}field-label quotationLimitDateLabel" />
                              <apex:inputField rendered="{!!isReadOnly}" id="quoteValidityPeriod" styleClass="field-value quoteValidityPeriod number" value="{!qdm.parentRec.QuoteValidityPeriod__c}" html-data-compare-value="{!qdm.baseParentRec.QuoteValidityPeriod__c}" onblur="safetyLockCheck(this);" onkeypress="return disableEnterKey(event)"/>
                              <apex:outputField rendered="{!isReadOnly}" id="quoteValidityPeriodView" styleClass="field-value quoteValidityPeriod number" value="{!qdm.parentRec.QuoteValidityPeriod__c}" />
                            </div>

                            <div class="field day">
                              <apex:outputLabel value="&nbsp;<br/>&nbsp;" escape="false" styleClass="field-label quotationLimitDateLabel" style="width: 50px;" />

                              <apex:inputField rendered="{!!isReadOnly}" id="quoteValidityPeriodDays" styleClass="field-value quoteValidityPeriodDays number" value="{!qdm.parentRec.QuoteValidityPeriodDays__c}" html-data-compare-value="{!qdm.baseParentRec.QuoteValidityPeriodDays__c}" onblur="safetyLockCheck(this);" onkeypress="return disableEnterKey(event)"/>
                              <apex:outputField rendered="{!isReadOnly}" id="quoteValidityPeriodDaysView" styleClass="field-value quoteValidityPeriodDays number" value="{!qdm.parentRec.QuoteValidityPeriodDays__c}" />
                            </div>


                            <div class="field" style="{!IF(isReadOnly,'','height: 42px;')}">
                              <apex:outputLabel value="{!$Label.JEOLAsia_QuotEdit_Label_QuotValidUntil}" for="quoteExpirationDate" styleClass="field-label quotationLimitDateLabel" />
                              <apex:inputField rendered="{!!isReadOnly}" id="quoteExpirationDate" styleClass="field-value quoteExpirationDate" value="{!qdm.parentRec.QuoteExpirationDate__c}" html-data-compare-value="{!qdm.baseParentRec.QuoteExpirationDate__c}" onclick="makeSafetyCheck2=false;" onblur="safetyLockCheck(this);makeSafetyCheck2=true;" onmouseout="makeSafetyCheck2=true;" onkeypress="return disableEnterKey(event)"/>
                              <apex:outputField rendered="{!isReadOnly}" id="quoteExpirationDateView" styleClass="field-value quoteExpirationDate" value="{!qdm.parentRec.QuoteExpirationDate__c}" />
                            </div>


                            <!-- PROJECT NO -->
                            <div class="field" style="min-width: 400px;">
                              <apex:outputLabel value="Project No" for="ProjectNumber" styleClass="field-label quotationLimitDateLabel" />
                              <apex:inputField rendered="{!!isReadOnly}" id="ProjectNumber" styleClass="field-value ProjectNumber" value="{!qdm.parentRec.AsiaProjectMaster__c}" html-data-compare-value="{!qdm.baseParentRec.AsiaProjectMaster__c}" onblur="safetyLockCheck(this);" onkeypress="return disableEnterKey(event)"/>
                              <apex:outputField rendered="{!isReadOnly}" id="ProjectNumberView" styleClass="field-value ProjectNumber" value="{!qdm.parentRec.AsiaProjectMaster__c}" />
                            </div>

                        </div>



                            
                          </div>
                        </div>
                        
                        <!-- COMPANY INFORMATION -->
                        <apex:outputPanel id="organizationInformation" layout="block" styleClass="quotation-item organization-information-area">

                          <div class="quotation-item-header clearfix">
                            <div class="header-title">{!$Label.JEOLAsia_ProfitCalculation_CompanyInformations}</div>
                          </div>
                          <div class="quotation-item-body clearfix">


                            <div class="field">
                              <apex:outputLabel value="Company" for="companyName" styleClass="{!IF(isReadOnly,'','requireField ')}field-label rightcol" />
                              <apex:outputText id="companyNameView" styleClass="field-value orgName" value="{!qdm.parentRec.CompanyName__c}" />
                            </div>

                            
                            <div class="field" style="{!IF(isReadOnly,'min-width: 400px;','')}">
                              <apex:outputLabel value="{!$Label.JEOLAsia_ProfitCalculation_CompanyName}" for="orgName" styleClass="field-label rightcol" />
                              <apex:inputField rendered="{!!isReadOnly}" id="orgName" styleClass="field-value orgName" value="{!qdm.parentRec.OrgName__c}" html-data-compare-value="{!qdm.baseParentRec.OrgName__c}" onblur="safetyLockCheck(this);" style="width: 376px;" onkeypress="return disableEnterKey(event)"/>
                              <apex:outputField rendered="{!isReadOnly}" id="orgNameView" styleClass="field-value orgName" value="{!qdm.parentRec.OrgName__c}" />
                            </div>

                            <!-- ADDRESS -->
                            <div class="field">
                              <apex:outputLabel value="Address" for="orgAddress" styleClass="field-label rightcol" />
                              <apex:inputField rendered="{!!isReadOnly}" id="orgAddress" styleClass="field-value orgAddress" value="{!qdm.parentRec.OrgAddress__c}" html-data-compare-value="{!qdm.baseParentRec.OrgAddress__c}" onblur="safetyLockCheck(this);" style="width: 376px;" />
                              <apex:outputField rendered="{!isReadOnly}" id="orgAddressView" styleClass="field-value orgAddress" value="{!qdm.parentRec.OrgAddress__c}" />
                            </div>

                            <!-- PHONE NUMBER -->
                            <div class="field">
                              <apex:outputLabel value="Phone Number" for="orgPhone" styleClass="field-label" />
                              <apex:inputField rendered="{!!isReadOnly}" id="orgPhone" styleClass="field-value orgPhone" value="{!qdm.parentRec.OrgPhone__c}" html-data-compare-value="{!qdm.baseParentRec.OrgPhone__c}" onblur="safetyLockCheck(this);" onkeypress="return disableEnterKey(event)"/>
                              <apex:outputField rendered="{!isReadOnly}" id="orgPhoneView" styleClass="field-value orgPhone" value="{!qdm.parentRec.OrgPhone__c}" />
                            </div>

                            <!-- FAX NUMBER -->
                            <div class="field">
                              <apex:outputLabel value="Fax Number" for="orgFax" styleClass="field-label" />
                              <apex:inputField rendered="{!!isReadOnly}" id="orgFax" styleClass="field-value orgFax" value="{!qdm.parentRec.OrgFax__c}" html-data-compare-value="{!qdm.baseParentRec.OrgFax__c}" onblur="safetyLockCheck(this);" onkeypress="return disableEnterKey(event)"/>
                              <apex:outputField rendered="{!isReadOnly}" id="orgFaxView" styleClass="field-value orgFax" value="{!qdm.parentRec.OrgFax__c}" />
                            </div>

                            <!-- SERIES -->
                            <div class="field" data-type="dropdown">
                              <apex:outputLabel value="{!$Label.JEOLAsia_ProfitCalculation_Series}" html-data-type="label" for="series" styleClass="{!IF(isReadOnly || isQTRestricted,'','requireField ')}field-label rightcol" style="float: left;"/>
                              <apex:inputText rendered="{!!(isReadOnly || isQTRestricted)}" id="series" html-data-type="input-field" styleClass="field-value series" onchange="this.value=transformInputText(this.value);" value="{!qdm.parentRec.Series__c}" html-data-compare-value="{!qdm.baseParentRec.Series__c}" onblur="safetyLockCheck(this);" onkeypress="return disableEnterKey(event)"/>
                              <apex:inputHidden rendered="{!(isReadOnly || isQTRestricted)}" html-class="series" value="{!qdm.parentRec.Series__c}" />
                              <apex:outputText rendered="{!(isReadOnly || isQTRestricted)}" id="seriesView" html-data-type="input-field" styleClass="departmentView" value="{!qdm.parentRec.Series__c}" />
                              <button class="{!IF(isReadOnly || isQTRestricted,'hidden','')}" type="button" data-type="button" onclick="dorpdownAction(this);">▼</button>
                              <ul class="scroll" data-type="list">
                                <apex:repeat value="{!SeriesOptions}" var="option">
                                  <li data-type="item" data-value="{!option.value}" >
                                    <a href="javascript: void(0);" onclick="setInputField(this);return false;" ><apex:outputText value="{!option.label}" rendered="{!!ISBLANK(option.label)}"/></a>
                                  </li>
                                </apex:repeat>
                              </ul>
                            </div>

                            <!-- SALES PERSON -->
                            <div class="field" style="min-width: 400px;">

                              <apex:outputLabel rendered="{!(!isReadOnly && isAsia)}" value="{!$Label.JEOLAsia_ProfitCalculation_SalesPerson}" for="salesPersonAsia" styleClass="field-label rightcol" />
                              <apex:inputField rendered="{!(!isReadOnly && isAsia)}" id="salesPersonAsia" styleClass="field-value salesPerson" value="{!qdm.parentRec.SalesPersonAsia__c}" html-data-compare-value="{!qdm.baseParentRec.SalesPersonAsia__c}" onclick="makeSafetyCheck=false;" onblur="safetyLockCheck(this);makeSafetyCheck=true;" onmouseout="makeSafetyCheck=true;" onkeypress="return disableEnterKey(event)"/>

                              <apex:outputLabel rendered="{!(!isReadOnly && !isAsia)}" value="{!$Label.JEOLAsia_ProfitCalculation_SalesPerson}" for="salesPersonUS" styleClass="field-label rightcol" />
                              <apex:inputField rendered="{!(!isReadOnly && !isAsia)}" id="salesPersonUS" styleClass="field-value salesPerson" value="{!qdm.parentRec.SalesPersonUS__c}" html-data-compare-value="{!qdm.baseParentRec.SalesPersonUS__c}" onclick="makeSafetyCheck=false;" onblur="safetyLockCheck(this);makeSafetyCheck=true;" onmouseout="makeSafetyCheck=true;" onkeypress="return disableEnterKey(event)"/>

                              <apex:outputLabel rendered="{!isReadOnly}" value="{!$Label.JEOLAsia_ProfitCalculation_SalesPerson}" for="salesPersonView" styleClass="field-label rightcol" />
                              <apex:outputField rendered="{!isReadOnly}" id="salesPersonView" styleClass="field-value salesPerson" value="{!qdm.parentRec.SalesPerson__c}" />

                            </div>

                            <!-- SALES ASSISTANT -->
                            <div class="field" style="min-width: 400px;">
                              <apex:outputLabel rendered="{!(!isReadOnly && isAsia)}" value="{!$Label.JEOLAsia_ProfitCalculation_SalesAssistant}" for="salesAssistantAsia" styleClass="field-label rightcol" />
                              <apex:inputField rendered="{!(!isReadOnly && isAsia)}" id="salesAssistantAsia" styleClass="field-value salesAssistant" value="{!qdm.parentRec.SalesAssistantAsia__c}" html-data-compare-value="{!qdm.baseParentRec.SalesAssistantAsia__c}" onclick="makeSafetyCheck=false;" onblur="safetyLockCheck(this);makeSafetyCheck=true;" onmouseout="makeSafetyCheck=true;" onkeypress="return disableEnterKey(event)"/>

                              <apex:outputLabel rendered="{!(!isReadOnly && !isAsia)}" value="{!$Label.JEOLAsia_ProfitCalculation_SalesAssistant}" for="salesAssistantUS" styleClass="field-label rightcol" />
                              <apex:inputField rendered="{!(!isReadOnly && !isAsia)}" id="salesAssistantUS" styleClass="field-value salesAssistant" value="{!qdm.parentRec.SalesAssistantUS__c}" html-data-compare-value="{!qdm.baseParentRec.SalesAssistantUS__c}" onclick="makeSafetyCheck=false;" onblur="safetyLockCheck(this);makeSafetyCheck=true;" onmouseout="makeSafetyCheck=true;" onkeypress="return disableEnterKey(event)"/>

                              <apex:outputLabel rendered="{!isReadOnly}" value="{!$Label.JEOLAsia_ProfitCalculation_SalesAssistant}" for="salesAssistant" styleClass="field-label rightcol" />
                              <apex:outputField rendered="{!isReadOnly}" id="salesAssistantView" styleClass="field-value salesAssistant" value="{!qdm.parentRec.SalesAssistant__c}" />
                            </div>

                          </div>

                          <apex:outputPanel layout="block" styleClass="field" style="float: right; margin-top: 25px; margin-right: 8px;" >
                            <apex:commandButton title="Edit Terms & Conditions" value="Edit Terms & Conditions" styleClass="customButtonDisabled" rendered="{!IsNew}" disabled="true" />
                            <apex:commandLink action="{!goToTermsAndConditions}" title="Edit Termsss & Conditions" target="_blank" styleClass="customButton" rendered="{!!IsNew}">
                              <span style="vertical-align: middle;">Edit Terms &amp; Conditions</span>
                            </apex:commandLink>
                          </apex:outputPanel>

                        </apex:outputPanel>
                    </div>



                    <div style="float: left;">
                        
                        <!-- 契約先 section -->
                        <div class="quotation-item contract-account-area">
                          <div class="quotation-item-header clearfix" style="height: 38px;">
                            <div class="header-title">{!$Label.JEOLAsia_ProfitCalculation_SoldToInformations}</div>
                          </div>
                          <div class="quotation-item-body clearfix">
                            <div class="field ajaxRequestStatus" >
                              <apex:actionStatus layout="block"  id="ajaxContractAccountAttach">
                                <apex:facet name="start">
                                  <div class="ajaxStatusView" >{!$Label.JEOL_QuotEdit_Label_Searching}</div>
                                </apex:facet>
                              </apex:actionStatus>
                            </div>

                            <apex:inputHidden id="contractCountry" html-class="contractCountry" value="{!qdm.parentRec.ContractCountry__c}" />
                            <apex:inputHidden id="contractAgency" html-class="contractAgency" value="{!qdm.parentRec.ContractAgency__c}" />

                            <div class="field">
                              <apex:outputLabel value="{!$Label.JEOL_QuotEdit_Label_Contractor}" for="contractCode" styleClass="{!IF((isReadOnly || isQTRestricted),'','requireField ')}field-label" />
                              <apex:inputField rendered="{!!(isReadOnly || isQTRestricted)}" id="contractCode" styleClass="field-value contractCode" html-placeholder="{!$Label.JEOL_QuotEdit_Label_ContractorCode}" value="{!qdm.parentRec.ContractCode__c}" html-data-compare-value="{!qdm.baseParentRec.ContractCode__c}" onfocus="openSearchToggleButton(this);" onblur="safetyLockCheck(this);" onkeypress="return disableEnterKey(event)"/>
                              <apex:commandLink rendered="{!!(isReadOnly || isQTRestricted)}" action="{!ContractAttachmentFromCode}" title="コード検索" rerender="enhanceContractAccount, contractCode, contractName, contractName1, contractName2, contractAddress, contractUndergraduate, contractCountry, contractAgency, contractPersonInCharge, contractPhone, contractEmail, contractFax, contractBelong, contractPost" styleClass="productSearchButton" status="ajaxContractAccountAttach" oncomplete="enhanceContractAccountLookup();">
                                <span class="refresh-icon"></span>
                              </apex:commandLink>
                              <apex:outputText rendered="{!(isReadOnly || isQTRestricted)}" id="contractCodeView" styleClass="contractCodeView" html-placeholder="{!$Label.JEOL_QuotEdit_Label_ContractorCode}" value="{!qdm.parentRec.ContractCode__c}" />
                              <!--
                              <apex:inputField rendered="{!!(isReadOnly || isQTRestricted)}" id="contractName" styleClass="field-value contractName" html-placeholder="{!$Label.JEOL_QuotEdit_Label_ContractorName}" value="{!qdm.parentRec.ContractName__c}" html-data-compare-value="{!qdm.baseParentRec.ContractName__c}" onblur="safetyLockCheck(this);"/>
                              -->
                              <apex:outputText rendered="{!!(isReadOnly || isQTRestricted)}" id="contractName" styleClass="contractNameView2" html-placeholder="{!$Label.JEOL_QuotEdit_Label_ContractorName}" value="{!qdm.parentRec.ContractName__c}" />
                              <apex:outputText rendered="{!(isReadOnly || isQTRestricted)}" id="contractNameView" styleClass="contractNameView mightOverflow" html-placeholder="{!$Label.JEOL_QuotEdit_Label_ContractorName}" value="{!qdm.parentRec.ContractName__c}" />
                              <apex:inputField rendered="{!!(isReadOnly || isQTRestricted)}" id="contractAccountId" styleClass="field-value reference-field-hidden" value="{!qdm.parentRec.ContractAccount_dummyField__c}" onclick="makeSafetyCheck=false;" onblur="makeSafetyCheck=true;" onmouseout="makeSafetyCheck=true;" >
                                <apex:actionSupport focus="contractName" event="onchange" action="{!ContractAttachment}" rerender="enhanceContractAccount, contractCode, contractName, contractName1, contractName2, contractAddress, contractUndergraduate, contractCountry, contractAgency, contractPersonInCharge, contractPhone, contractEmail, contractFax, contractBelong, contractPost" status="ajaxContractAccountAttach" oncomplete="enhanceContractAccountLookup();"/> <!-- rerender contractAccountId -->
                             </apex:inputField>
                            </div>
    
                            <div class="field">
                              <apex:outputLabel value="{!$ObjectType.AsiaProfitCalculation__c.fields.ContractName1__c.Label}" for="ContractName1" styleClass="field-label" />
                              <apex:inputText rendered="{!!isReadOnly}" id="contractName1" styleClass="field-value" value="{!qdm.parentRec.ContractName1__c}" style="width: 400px;" maxlength="100" onkeypress="return disableEnterKey(event)"/>
                              <apex:outputText rendered="{!isReadOnly}" id="contractName1View" styleClass="field-value" value="{!qdm.parentRec.ContractName1__c}" style="width: 400px;" />
                            </div>
                            
                            <div class="field">
                              <apex:outputLabel value="{!$ObjectType.AsiaProfitCalculation__c.fields.ContractName2__c.Label}" for="ContractName2" styleClass="field-label" />
                              <apex:inputText rendered="{!!isReadOnly}" id="contractName2" styleClass="field-value" value="{!qdm.parentRec.ContractName2__c}" style="width: 400px;" maxlength="50" onkeypress="return disableEnterKey(event)"/>
                              <apex:outputText rendered="{!isReadOnly}" id="contractName2View" styleClass="field-value" value="{!qdm.parentRec.ContractName2__c}" style="width: 400px;" />
                            </div>
                            
                            <div class="field">
                              <apex:outputLabel value="{!$Label.JEOL_QuotEdit_Label_BranchOffice}" for="contractUndergraduate" styleClass="field-label" />
                              <apex:outputText id="contractUndergraduate" styleClass="field-value contractUndergraduate" value="{!qdm.parentRec.ContractUndergraduate__c}" />
                            </div>
                            <div class="field">
                              <apex:outputLabel value="{!$Label.JEOL_QuotEdit_Label_Address}" for="contractAddress" styleClass="field-label" />
    <!--                          <apex:inputHidden id="contractAddress_hidden" value="{!qdm.parentRec.ContractAddress__c}" /> 
                              <apex:outputText id="contractAddress" styleClass="field-value contractAddress mightOverflow" value="{!qdm.parentRec.ContractAddress__c}" />
    --> 
                             <apex:inputText id="contractAddress" styleClass="field-value" value="{!qdm.parentRec.ContractAddress__c}" style="width: 400px;" onkeypress="return disableEnterKey(event)"/>
                            </div>
                            <div class="field">
                              <apex:outputLabel value="{!$Label.JEOL_QuotEdit_Label_Department}" for="contractBelong" styleClass="field-label" />
                              <apex:inputField rendered="{!!isReadOnly}" id="contractBelong" styleClass="field-value contractBelong" value="{!qdm.parentRec.ContractBelong__c}" html-data-compare-value="{!qdm.baseParentRec.ContractBelong__c}" onblur="safetyLockCheck(this);" onkeypress="return disableEnterKey(event)"/>
                              <apex:outputText rendered="{!isReadOnly}" id="contractBelongView" styleClass="contractBelongView" value="{!qdm.parentRec.ContractBelong__c}"  />
                            </div>
                            <div class="field">
                              <apex:outputLabel value="{!$Label.JEOL_QuotEdit_Label_Designation}" for="contactPost" styleClass="field-label" />
                              <apex:inputField rendered="{!!isReadOnly}" id="contractPost" styleClass="field-value contractPost" value="{!qdm.parentRec.ContractPost__c}" html-data-compare-value="{!qdm.baseParentRec.ContractPost__c}" onblur="safetyLockCheck(this);" onkeypress="return disableEnterKey(event)"/>
                              <apex:outputText rendered="{!isReadOnly}" id="contractPostView" styleClass="contractBelongView" value="{!qdm.parentRec.ContractPost__c}" />
                            </div>

                            <div class="field" style="height: 33px;">
                              <apex:outputLabel value="{!$Label.JEOLAsia_ProfitCalculation_PersonInCharge}" for="contractPersonInCharge" styleClass="field-label" style="padding-top: 0px; padding-bottom: 0px;" />
                              <apex:inputField rendered="{!!isReadOnly}" id="contractPersonInCharge" styleClass="field-value contractPersonInCharge" value="{!qdm.parentRec.ContractPersonInCharge__c}" html-data-compare-value="{!qdm.baseParentRec.ContractPersonInCharge__c}" onblur="safetyLockCheck(this);" onkeypress="return disableEnterKey(event)"/>
                              <apex:outputText rendered="{!isReadOnly}" id="contractPersonInChargeView" styleClass="contractBelongView" value="{!qdm.parentRec.ContractPersonInCharge__c}" />
                              <apex:inputField rendered="{!!isReadOnly}" styleClass="field-value reference-field-hidden" value="{!qdm.parentRec.ContractContact_dummyField__c}" onclick="makeSafetyCheck=false;" onblur="makeSafetyCheck=true;" onmouseout="makeSafetyCheck=true;" >
                                <apex:actionSupport focus="contractPersonInCharge" event="onchange" action="{!contractContactAttachment}" rerender="enhanceContractAccount, contractCode, contractName, contractName1, contractName2, contractAddress, contractUndergraduate, contractCountry, contractAgency, contractPersonInCharge, contractPhone, contractEmail, contractFax, contractBelong, contractPost" status="ajaxContractAccountAttach" oncomplete="enhanceContractAccountLookup();"/>
                              </apex:inputField>
                            </div>
                            <div class="field" style="height: 33px;padding-top: 2px;">
                              <apex:outputLabel value="{!$Label.JEOL_QuotEdit_Label_Contact}" for="contractPhone" styleClass="field-label" />
                              <apex:inputField rendered="{!!isReadOnly}" id="contractPhone" styleClass="field-value contractPhone" value="{!qdm.parentRec.ContractPhone__c}" html-data-compare-value="{!qdm.baseParentRec.ContractPhone__c}" onblur="safetyLockCheck(this);" onkeypress="return disableEnterKey(event)"/>
                              <apex:outputText rendered="{!isReadOnly}" id="contractPhoneView" styleClass="contractBelongView" value="{!qdm.parentRec.ContractPhone__c}" />
                            </div>

                            <!-- ContractEmail -->
                            <div class="field">
                              <apex:outputLabel value="{!$Label.JEOL_QuotEdit_Label_Email}" for="contractEmail" styleClass="field-label" />
                              <apex:inputField rendered="{!!isReadOnly}" id="contractEmail" styleClass="field-value contractEmail" value="{!qdm.parentRec.ContractEmail__c}" html-data-compare-value="{!qdm.baseParentRec.ContractEmail__c}" onblur="safetyLockCheck(this);" onkeypress="return disableEnterKey(event)"/>
                              <apex:outputText rendered="{!isReadOnly}" id="contractEmailView" styleClass="contractBelongView" value="{!qdm.parentRec.ContractEmail__c}" />
                            </div>

                            <div class="field">
                              <apex:outputLabel value="{!$Label.JEOL_QuotEdit_Label_FAX}" for="contractFax" styleClass="field-label" />
                              <apex:inputField rendered="{!!isReadOnly}" id="contractFax" styleClass="field-value contractPhone" value="{!qdm.parentRec.ContractFax__c}" html-data-compare-value="{!qdm.baseParentRec.ContractFax__c}" onblur="safetyLockCheck(this);" onkeypress="return disableEnterKey(event)"/>
                              <apex:outputText rendered="{!isReadOnly}" id="contractFaxView" styleClass="contractBelongView" value="{!qdm.parentRec.ContractFax__c}" />
                            </div>
                            <div class="field" style="min-width: 400px;">
                              <apex:outputLabel for="salesPipeLine" styleClass="field-label" >
                                <span>{!$Label.JEOL_QuotEdit_Label_Sales}</span><br />
                                <span>{!$Label.JEOL_QuotEdit_Label_Pipeline}</span>
                              </apex:outputLabel>
                              <apex:inputField rendered="{!!isReadOnly}" id="salesPipeLine" styleClass="field-value salesPipeLine" value="{!qdm.parentRec.SalesPipelineLkup__c}" html-data-compare-value="{!qdm.baseParentRec.SalesPipelineLkup__c}" onclick="makeSafetyCheck=false;" onblur="safetyLockCheck(this);makeSafetyCheck=true;" onmouseout="makeSafetyCheck=true;" onkeypress="return disableEnterKey(event)"/>
                              <apex:outputField rendered="{!isReadOnly}" id="salesPipeLineView" styleClass="field-value salesPipeLine" value="{!qdm.parentRec.SalesPipelineLkup__c}" />
                            </div>
                          </div>
                        </div>
                        
                        <!-- 納入先 section -->
                        <div class="quotation-item shipment-account-area">
                          <div class="quotation-item-header clearfix" style="height: 38px;">
                            <div class="header-title">{!$Label.JEOLAsia_ProfitCalculation_ShipToInformations}</div>
                            <apex:commandLink rendered="{!!(isReadOnly || isQTRestricted)}" value="{!$Label.JEOL_QuotEdit_Label_CopyCustomer}" styleClass="customButton" oncomplete="enhanceShipmentAccountLookup();lockSafety();" action="{!contractAccountInputCopy}" status="ajaxShipmentAttach" rerender="enhanceShipmentAccount, shipmentCode, shipmentName, shipmentName1, shipmentName2, shipmentAddress, shipmentUndergraduate, shipmentCountry, shipmentAgency, shipmentBelong, shipmentPost, shipmentPersonInCharge, shipmentPhone, shipmentEmail, shipmentFax,  unitBodyField, durationYear, acceptanceDate, kikaku, shipmentDistanceZone, shipmentDistanceSection" />
                          </div >
                          <div class="quotation-item-body clearfix">
                            <div class="field ajaxRequestStatus">
                              <apex:actionStatus layout="block"  id="ajaxShipmentAttach">
                                <apex:facet name="start">
                                  <div class="ajaxStatusView" >{!$Label.JEOL_QuotEdit_Label_Searching}</div>
                                </apex:facet>
                              </apex:actionStatus>
                            </div>

                            <apex:inputHidden id="shipmentCountry" html-class="shipmentCountry" value="{!qdm.parentRec.ShipmentCountry__c}" />
                            <apex:inputHidden id="shipmentAgency" html-class="shipmentAgency" value="{!qdm.parentRec.ShipmentAgency__c}" />

                            <div class="field">
                              <apex:outputLabel value="{!$Label.JEOL_QuotEdit_Label_Contractor}" for="shipmentCode" styleClass="{!IF((isReadOnly || isQTRestricted),'','requireField ')}field-label" />
                              <apex:inputField rendered="{!!(isReadOnly || isQTRestricted)}" id="shipmentCode" styleClass="field-value shipmentCode" html-placeholder="{!$Label.JEOL_QuotEdit_Label_ContractorCode}" value="{!qdm.parentRec.ShipmentCode__c}"  html-data-compare-value="{!qdm.baseParentRec.ShipmentCode__c}" onfocus="openSearchToggleButton(this);" onblur="safetyLockCheck(this);" onkeypress="return disableEnterKey(event)"/>
                              <apex:commandLink rendered="{!!(isReadOnly || isQTRestricted)}" action="{!ShipmentAttachmentFromCode}" title="コード検索" rerender="enhanceShipmentAccount, shipmentCode, shipmentName, shipmentName1, shipmentName2, shipmentAddress, shipmentUndergraduate, shipmentCountry, shipmentAgency, shipmentPersonInCharge, shipmentPhone, shipmentEmail, shipmentFax, shipmentBelong, shipmentPost, unitBodyField, durationYear, acceptanceDate, kikaku, shipmentDistanceZone, shipmentDistanceSection" styleClass="productSearchButton" status="ajaxShipmentAttach" oncomplete="enhanceShipmentAccountLookup();">
                                <span class="refresh-icon"></span>
                              </apex:commandLink>
                              <apex:outputText rendered="{!(isReadOnly || isQTRestricted)}" id="shipmentCodeView" styleClass="contractCodeView" html-placeholder="{!$Label.JEOL_QuotEdit_Label_ContractorCode}" value="{!qdm.parentRec.ShipmentCode__c}" />
                              <!--
                              <apex:inputField rendered="{!!(isReadOnly || isQTRestricted)}" id="shipmentName" styleClass="field-value shipmentName" html-placeholder="{!$Label.JEOL_QuotEdit_Label_ContractorName}" value="{!qdm.parentRec.ShipmentName__c}" html-data-compare-value="{!qdm.baseParentRec.ShipmentName__c}" onblur="safetyLockCheck(this);" />
                              -->
                              <apex:outputText rendered="{!!(isReadOnly || isQTRestricted)}" id="shipmentName" styleClass="contractNameView2" html-placeholder="{!$Label.JEOL_QuotEdit_Label_ContractorName}" value="{!qdm.parentRec.ShipmentName__c}" />
                              <apex:outputText rendered="{!(isReadOnly || isQTRestricted)}" id="shipmentNameView" styleClass="contractNameView mightOverflow" html-placeholder="{!$Label.JEOL_QuotEdit_Label_ContractorName}" value="{!qdm.parentRec.ShipmentName__c}" />
                              <apex:inputField rendered="{!!(isReadOnly || isQTRestricted)}" id="shipmentAccountId" styleClass="field-value reference-field-hidden" value="{!qdm.parentRec.ShipmentAccount_dummyField__c}" onclick="makeSafetyCheck=false;" onblur="makeSafetyCheck=true;" onmouseout="makeSafetyCheck=true;">
                                <apex:actionSupport focus="shipmentName" event="onchange" action="{!ShipmentAttachment}" rerender="enhanceShipmentAccount, shipmentCode, shipmentName, shipmentName1, shipmentName2, shipmentAddress, shipmentUndergraduate, shipmentCountry, shipmentAgency, unitBodyField, durationYear, acceptanceDate, kikaku, shipmentDistanceZone, shipmentDistanceSection, shipmentPersonInCharge, shipmentPhone, shipmentEmail, shipmentFax,  shipmentBelong, shipmentPost" status="ajaxShipmentAttach" oncomplete="enhanceShipmentAccountLookup();" /> <!-- rerender="shipmentAccountId"  -->
                              </apex:inputField>
                            </div>
                            
                            <div class="field">
                              <apex:outputLabel value="{!$ObjectType.AsiaProfitCalculation__c.fields.ShipmentName1__c.Label}" for="ShipmentName1" styleClass="field-label" />
                              <apex:inputText rendered="{!!isReadOnly}" id="shipmentName1" styleClass="field-value" value="{!qdm.parentRec.ShipmentName1__c}" style="width: 400px;" maxlength="100" onkeypress="return disableEnterKey(event)"/>
                              <apex:outputText rendered="{!isReadOnly}" id="shipmentName1View" styleClass="field-value" value="{!qdm.parentRec.ShipmentName1__c}" style="width: 400px;" />
                            </div>
                            
                            <div class="field">
                              <apex:outputLabel value="{!$ObjectType.AsiaProfitCalculation__c.fields.ShipmentName2__c.Label}" for="ShipmentName2" styleClass="field-label" />
                              <apex:inputText rendered="{!!isReadOnly}" id="shipmentName2" styleClass="field-value" value="{!qdm.parentRec.ShipmentName2__c}" style="width: 400px;" maxlength="50" onkeypress="return disableEnterKey(event)"/>
                              <apex:outputText rendered="{!isReadOnly}" id="shipmentName2View" styleClass="field-value" value="{!qdm.parentRec.ShipmentName2__c}" style="width: 400px;" />
                            </div>
                            
                            <div class="field">
                              <apex:outputLabel value="{!$Label.JEOL_QuotEdit_Label_BranchOffice}" for="shipmentUndergraduate" styleClass="field-label" />
                              <apex:outputText id="shipmentUndergraduate" styleClass="field-value shipmentUndergraduate" value="{!qdm.parentRec.ShipmentUndergraduate__c}" />
                            </div>
                            <div class="field">
                              <apex:outputLabel value="{!$Label.JEOL_QuotEdit_Label_Address}" for="shipmentAddress" styleClass="field-label" />
    <!--                          <apex:inputHidden id="shipmentAddress_hidden" value="{!qdm.parentRec.ShipmentAddress__c}" /> -->
<!--                              <apex:outputText id="shipmentAddress" styleClass="field-value shipmentAddress mightOverflow" value="{!qdm.parentRec.ShipmentAddress__c}" />
      -->
                             <apex:inputText id="shipmentAddress" styleClass="field-value" value="{!qdm.parentRec.ShipmentAddress__c}" style="width: 400px;" onkeypress="return disableEnterKey(event)"/>

                            </div>
                            <div class="field">
                              <apex:outputLabel value="{!$Label.JEOL_QuotEdit_Label_Department}" for="shipmentBelong" styleClass="field-label" />
                              <apex:inputField rendered="{!!isReadOnly}" id="shipmentBelong" styleClass="field-value shipmentBelong" value="{!qdm.parentRec.ShipmentBelong__c}" html-data-compare-value="{!qdm.baseParentRec.ShipmentBelong__c}" onblur="safetyLockCheck(this);" onkeypress="return disableEnterKey(event)"/>
                              <apex:outputText rendered="{!isReadOnly}" id="shipmentBelongView" styleClass="contractBelongView" value="{!qdm.parentRec.ShipmentBelong__c}" />
                            </div>
                            <div class="field">
                              <apex:outputLabel value="{!$Label.JEOL_QuotEdit_Label_Designation}" for="shipmentPost" styleClass="field-label" />
                              <apex:inputField rendered="{!!isReadOnly}" id="shipmentPost" styleClass="field-value shipmentPost" value="{!qdm.parentRec.ShipmentPost__c}" html-data-compare-value="{!qdm.baseParentRec.ShipmentPost__c}" onblur="safetyLockCheck(this);" onkeypress="return disableEnterKey(event)"/>
                              <apex:outputText rendered="{!isReadOnly}" id="shipmentPostView" styleClass="contractBelongView" value="{!qdm.parentRec.ShipmentPost__c}" />
                            </div>
                            <div class="field" style="height: 33px;">
                              <apex:outputLabel value="{!$Label.JEOLAsia_ProfitCalculation_PersonInCharge}" for="shipmentPersonInCharge" styleClass="field-label" style="padding-top: 0px; padding-bottom: 0px;" />
                              <apex:inputField rendered="{!!isReadOnly}" id="shipmentPersonInCharge" styleClass="field-value shipmentPersonInCharge" value="{!qdm.parentRec.ShipmentPersonInCharge__c}" html-data-compare-value="{!qdm.baseParentRec.ShipmentPersonInCharge__c}" onblur="safetyLockCheck(this);" onkeypress="return disableEnterKey(event)"/>
                              <apex:outputText rendered="{!isReadOnly}" id="shipmentPersonInChargeView" styleClass="contractBelongView" value="{!qdm.parentRec.ShipmentPersonInCharge__c}" />
                              <apex:inputField rendered="{!!isReadOnly}" styleClass="field-value reference-field-hidden" value="{!qdm.parentRec.ShipmentContact_dummyField__c}" onclick="makeSafetyCheck=false;" onblur="makeSafetyCheck=true;" onmouseout="makeSafetyCheck=true;" >
                                <apex:actionSupport focus="shipmentPersonInCharge" event="onchange" action="{!shipmentContactAttachment}" rerender="enhanceShipmentAccount, shipmentCode, shipmentName, shipmentName1, shipmentName2, shipmentAddress, shipmentUndergraduate, shipmentCountry, shipmentAgency, shipmentPersonInCharge, shipmentPhone, shipmentEmail, shipmentFax,  shipmentBelong, shipmentPost, unitBodyField, durationYear, acceptanceDate, kikaku, shipmentDistanceZone, shipmentDistanceSection" status="ajaxShipmentAttach" oncomplete="enhanceShipmentAccountLookup();"/>
                              </apex:inputField>
                           </div>
                            <div class="field" style="height: 33px;padding-top: 2px;">
                              <apex:outputLabel value="{!$Label.JEOL_QuotEdit_Label_Contact}" for="shipmentPhone" styleClass="field-label" />
                              <apex:inputField rendered="{!!isReadOnly}" id="shipmentPhone" styleClass="field-value shipmentPhone" value="{!qdm.parentRec.ShipmentPhone__c}" html-data-compare-value="{!qdm.baseParentRec.ShipmentPhone__c}" onblur="safetyLockCheck(this);" onkeypress="return disableEnterKey(event)"/>
                              <apex:outputText rendered="{!isReadOnly}" id="shipmentPhoneView" styleClass="contractBelongView" value="{!qdm.parentRec.ShipmentPhone__c}" />
                            </div>

                            <!-- ShipmentEmail -->
                            <div class="field">
                              <apex:outputLabel value="{!$Label.JEOL_QuotEdit_Label_Email}" for="shipmentEmail" styleClass="field-label" />
                              <apex:inputField rendered="{!!isReadOnly}" id="shipmentEmail" styleClass="field-value shipmentEmail" value="{!qdm.parentRec.ShipmentEmail__c}" html-data-compare-value="{!qdm.baseParentRec.ShipmentEmail__c}" onblur="safetyLockCheck(this);" onkeypress="return disableEnterKey(event)"/>
                              <apex:outputText rendered="{!isReadOnly}" id="shipmentEmailView" styleClass="contractBelongView" value="{!qdm.parentRec.ShipmentEmail__c}" />
                            </div>

                            <div class="field">
                              <apex:outputLabel value="{!$Label.JEOL_QuotEdit_Label_FAX}" for="shipmentFax" styleClass="field-label" />
                              <apex:inputField rendered="{!!isReadOnly}" id="shipmentFax" styleClass="field-value shipmentPhone" value="{!qdm.parentRec.ShipmentFax__c}" html-data-compare-value="{!qdm.baseParentRec.ShipmentFax__c}" onblur="safetyLockCheck(this);" onkeypress="return disableEnterKey(event)"/>
                              <apex:outputText rendered="{!isReadOnly}" id="shipmentFaxView" styleClass="contractBelongView" value="{!qdm.parentRec.ShipmentFax__c}" />
                            </div>

                            <apex:outputPanel layout="block" styleClass="field" style="float: right; margin-top: 25px; margin-right: 8px; margin-left: 300px;" >
                              <apex:commandButton title="Create CI" value="Create CI" styleClass="customButtonDisabled" rendered="{!IsNew}" disabled="true" />
                              <apex:commandLink action="{!goToCustomerInformation}" title="Create CI" target="_blank" styleClass="customButton" rendered="{!!IsNew}">
                                <span style="vertical-align: middle;">Create CI</span>
                              </apex:commandLink>
                            </apex:outputPanel>

                            <apex:outputPanel layout="block" styleClass="field" style="float: right; margin-top: 9px; margin-right: 8px;" >
                              <apex:commandButton title="Create EU/I" value="Create EU/I" styleClass="customButtonDisabled" rendered="{!IsNew}" disabled="true" />
                              <apex:commandLink action="{!goToEndUserInformation}" title="Create EU/I" target="_blank" styleClass="customButton" rendered="{!!IsNew}">
                                <span style="vertical-align: middle;">Create EU/I</span>
                              </apex:commandLink>
                            </apex:outputPanel>

                          </div>
                        </div>
                    </div>
                    





                    <!-- SECTION Other / Title -->
                    <apex:outputPanel id="panMainInfoArea" layout="block" styleClass="quotation-item main-information-area">
                      <div class="quotation-item-body clearfix">

                          <!-- DELIVERY TERM -->
                          <div class="field ajaxRequestStatus">
                            <apex:actionStatus layout="block"  id="ajaxDelivConditionAttach" onstop="$j('.deliveryCondition1').trigger('focus');">
                              <apex:facet name="start">
                                <div class="ajaxStatusView" >{!$Label.JEOL_QuotEdit_Label_Searching}</div>
                              </apex:facet>
                            </apex:actionStatus>
                          </div>
                          <div class="field">
                            <apex:outputLabel value="Incoterms" for="deliveryCondition1" styleClass="field-label" />
                          </div>

                          <div class="field" data-type="dropdown">
                            <apex:inputText rendered="{!!isReadOnly}" disabled="true" html-data-type="input-field" id="deliveryCondition1" styleClass="field-value deliveryCondition1" value="{!qdm.parentRec.DeliveryCondition1__c}" html-data-compare-value="{!qdm.baseParentRec.DeliveryCondition1__c}" onchange="this.value=transformInputText(this.value);" onblur="safetyLockCheck(this);" />
                            <apex:inputHidden id="deliveryCondition1hidden"  html-data-type="input-field" value="{!qdm.parentRec.DeliveryCondition1__c}"  />

                            <button class="{!IF(isReadOnly,'hidden','')}" type="button" data-type="button" onclick="dorpdownAction(this);">▼</button>
                            <ul class="scroll" data-type="list">
                              <apex:repeat value="{!IncotermsOptions}" var="option">
                                <li data-type="item" data-value="{!option.value}" >
                                  <apex:commandLink action="{!delivConditionAttachment}" onclick="setInputField(this);" rerender="deliveryCondition1,deliveryCondition2,deliveryCondition3,apexMessage" status="ajaxDelivConditionAttach" >
                                    <apex:outputText value="{!option.label}" />
                                  </apex:commandLink>
                                </li>
                              </apex:repeat>
                            </ul>
                            <apex:outputText rendered="{!isReadOnly}" html-data-type="input-field" id="deliveryCondition1View" styleClass="deliveryLocationSectionView" value="{!qdm.parentRec.DeliveryCondition1__c}" />
                          </div>




                          <!-- DELIVERY TERM -->
                          <div class="field" data-type="dropdown">
                            <apex:inputText rendered="{!!isReadOnly}" disabled="true" html-data-type="input-field" id="deliveryCondition2" styleClass="field-value deliveryCondition2" value="{!qdm.parentRec.DeliveryCondition2__c}" html-data-compare-value="{!qdm.baseParentRec.DeliveryCondition2__c}" onchange="this.value=transformInputText(this.value);" onblur="safetyLockCheck(this);" />
                            <apex:inputHidden id="deliveryCondition2hidden"  html-data-type="input-field" value="{!qdm.parentRec.DeliveryCondition2__c}"  />

                            <button class="{!IF(isReadOnly,'hidden','')}" type="button" data-type="button" onclick="dorpdownAction(this);">▼</button>
                            <ul class="scroll" data-type="list">
                              <apex:repeat value="{!IncotermsDestinationOptions}" var="option">
                                <li data-type="item" data-value="{!option.value}" >
                                  <apex:commandLink action="{!delivConditionAttachment}" onclick="setInputField(this);" rerender="deliveryCondition1,deliveryCondition2,deliveryCondition3,apexMessage" status="ajaxDelivConditionAttach" >
                                    <apex:outputText value="{!option.label}" />
                                  </apex:commandLink>
                                </li>
                              </apex:repeat>
                            </ul>
                            <apex:outputText rendered="{!isReadOnly}" html-data-type="input-field" id="deliveryCondition2View" styleClass="deliveryLocationSectionView" value="{!qdm.parentRec.DeliveryCondition2__c}" />
                          </div>



                          <div class="field">
                            <apex:inputText rendered="{!!isReadOnly}" html-data-type="input-field" id="deliveryCondition3" styleClass="field-value deliveryCondition3" value="{!qdm.parentRec.DeliveryCondition3__c}" html-data-compare-value="{!qdm.baseParentRec.DeliveryCondition3__c}" onblur="safetyLockCheck(this);" onkeypress="return disableEnterKey(event)"/>

                            <apex:outputText rendered="{!isReadOnly}" html-data-type="input-field" id="deliveryCondition3View" styleClass="deliveryLocationSectionView" value="{!qdm.parentRec.DeliveryCondition3__c}" />
                          </div>


<!--
                          <div class="field" data-type="dropdown">
                            <apex:inputText rendered="{!!isReadOnly}" html-data-type="input-field" id="deliveryCondition1" styleClass="field-value deliveryCondition1" value="{!qdm.parentRec.DeliveryCondition1__c}" html-data-compare-value="{!qdm.baseParentRec.DeliveryCondition1__c}" onchange="this.value=transformInputText(this.value);" onfocus="openSearchToggleButton(this);" onblur="safetyLockCheck(this);" />
                            <apex:commandLink rendered="{!!isReadOnly}" action="{!delivConditionAttachment}" title="コード検索" rerender="deliveryCondition1, deliveryCondition2" styleClass="productSearchButton" status="ajaxDelivConditionAttach">
                              <span class="refresh-icon"></span>
                            </apex:commandLink>
                            <button class="{!IF(isReadOnly,'hidden','')}" type="button" data-type="button" onclick="dorpdownAction(this);">▼</button>
                            <ul class="scroll" data-type="list">
                              <apex:repeat value="{!DelivConditionOptions}" var="option">
                                <li data-type="item" data-value="{!option.value}" >
                                  <apex:commandLink action="{!delivConditionAttachment}" onclick="setInputField(this);" rerender="deliveryCondition1,deliveryCondition2,apexMessage" status="ajaxDelivConditionAttach" >
                                    <apex:outputText value="{!option.label}" />
                                  </apex:commandLink>
                                </li>
                              </apex:repeat>
                            </ul>
                            <apex:outputText rendered="{!isReadOnly}" html-data-type="input-field" id="deliveryCondition1View" styleClass="deliveryLocationSectionView" value="{!qdm.parentRec.DeliveryCondition1__c}" />
                          </div>
                          <div class="field">
                            <apex:inputField rendered="{!!isReadOnly}" id="deliveryCondition2" styleClass="field-value deliveryCondition2" value="{!qdm.parentRec.DeliveryCondition2__c}" html-data-compare-value="{!qdm.baseParentRec.DeliveryCondition2__c}" onblur="safetyLockCheck(this);" />
                            <apex:outputText rendered="{!isReadOnly}" id="deliveryCondition2View" styleClass="deliveryLocationTextView" value="{!qdm.parentRec.DeliveryCondition2__c}" />
                          </div>
-->


                          <!-- PAYMENT TERMS -->
                          <div class="field" style="width: 400px;">
                            <apex:outputLabel value="Payment Terms" for="paymentConditionSection" styleClass="field-label" />
                            <apex:inputField rendered="{!!isReadOnly}" id="paymentConditionSection" styleClass="field-value paymentConditionSection" value="{!qdm.parentRec.PaymentConditionSection__c}" html-data-compare-value="{!qdm.baseParentRec.PaymentConditionSection__c}" onblur="safetyLockCheck(this);" style="width: auto; max-width: 300px;" onkeypress="return disableEnterKey(event)"/>
                            <apex:outputText rendered="{!isReadOnly}" id="paymentConditionSectionView" styleClass="deliveryLocationSectionView" value="{!qdm.parentRec.PaymentConditionSection__c}" />
                          </div>

                          <div class="field" style="width: 622px;">
                            <apex:inputField rendered="{!!isReadOnly}" id="paymentConditionSectionText" styleClass="field-value paymentConditionSection" value="{!qdm.parentRec.PaymentConditionTextarea__c}" html-data-compare-value="{!qdm.baseParentRec.PaymentConditionTextarea__c}" onblur="safetyLockCheck(this);" style="width: auto; width: 602px;margin-left: 12px;margin-top: 6px;"/>
                            <apex:outputText rendered="{!isReadOnly}" id="paymentConditionSectionTextView" styleClass="deliveryLocationSectionView" value="{!qdm.parentRec.PaymentConditionTextarea__c}" />
                          </div>

                          <!-- OTHERS -->
                          <div class="field">
                            <apex:outputLabel value="{!$Label.JEOL_QuotEdit_Label_Others}" for="otherText" styleClass="field-label" />
                            <apex:inputField rendered="{!!isReadOnly}" id="otherText" styleClass="field-value otherText" value="{!qdm.parentRec.OtherText__c}" html-data-compare-value="{!qdm.baseParentRec.OtherText__c}" onblur="safetyLockCheck(this);" />
                            <apex:outputText rendered="{!isReadOnly}" id="otherTextView" styleClass="otherTextView" value="{!qdm.parentRec.OtherText__c}" />
                          </div>
                      </div>
                    </apex:outputPanel>





                    
                    
                    

                    <div style="float: left;width:100%;">
                        
                        <!-- Rate section -->
                        <div class="quotation-item rate-area">
                          <div class="quotation-item-header clearfix" style="height: 38px;">
                            <div class="header-title">{!$Label.JEOLAsia_ProfitCalculation_RateInformations}</div>
                            <apex:commandLink rendered="{!!(isReadOnly || isQTRestricted)}" value="Refresh" styleClass="customButton updateRateButton" oncomplete="calcurate();lockSafety();" action="{!refreshListRate}" status="ajaxPageStatus" rerender="rateGroup1, rateGroup2" />
                          </div>
                          <div style="float: left;width: 58%;overflow: auto;">
<apex:panelGroup id="rateGroup1">
                            <table style="width:95%;">
                              <tr>
                                <td colspan="3" style="border-left-style: solid;border-left-color: blue;border-left-width: 5px;padding-left: 5px;padding-top: 5px;padding-bottom: 5px;">
                                  <apex:outputText value="Exchange Rate for Cost (Except J-Products)" style="font-weight: bold;color: blue"/>
                                </td>
                              </tr>

                              <tr>

                                <apex:repeat value="{!rateListOther}" var="rowBlock">

                                  <td>
                                    <table style="width:100%;border: 1px solid #E6E6E6;">
                                      <apex:repeat value="{!rateListOther[rowBlock]}" var="rowLine">
                                        <tr style="height: 23px;"><td class="rate-title">
                                          <apex:outputField value="{!rowLine.CurrencyToConvert__c}"/>
                                        </td>
                                        <td style="width:50%;text-align:right;{!IF(rowLine.ReadOnly__c, 'padding-right:6px;color:#aaaaaa;', IF(isQTRestricted, 'padding-right:6px;', ''))}">
                                          <apex:outputField style="width:100px;text-align:right;" value="{!rowLine.Rate__c}" rendered="{!((rowLine.ReadOnly__c || isQTRestricted) && rowLine.CurrencyToConvert__c != NULL)}"/>
                                          <apex:inputField style="width:100px;text-align:right;padding-right: 3px;" value="{!rowLine.Rate__c}" rendered="{!((!(rowLine.ReadOnly__c || isQTRestricted)) && rowLine.CurrencyToConvert__c != NULL)}" onchange="formatRate(this);calcurate();" styleClass="rate-Other-{!rowLine.CurrencyToConvert__c}-To-{!rowLine.CurrencyBase__c}" onkeypress="return disableEnterKey(event)"/>
                                          <apex:inputHidden value="{!rowLine.Rate__c}" rendered="{!isQTRestricted}" Html-Class="rate-Other-{!rowLine.CurrencyToConvert__c}-To-{!rowLine.CurrencyBase__c}"/>
                                        </td></tr>                                      
                                      </apex:repeat>
                                    </table>
                                  </td>

                                </apex:repeat>

                              </tr>
                            </table>
</apex:panelGroup>
                          </div>

                          <div style="float: left;width: 42%;overflow: auto;">
<apex:panelGroup id="rateGroup2">
                            <table style="width:95%">
                              <tr>
                                <td colspan="3" style="border-left-style: solid;border-left-color: green;border-left-width: 5px;padding-left: 5px;padding-top: 5px;padding-bottom: 5px;">
                                  <apex:outputText value="Exchange Rate for Cost (for J-Products)" style="font-weight: bold;color: green"/>
                                </td>
                              </tr>

                              <tr>

                                <apex:repeat value="{!rateListJProd}" var="rowBlock2">

                                  <td>
                                    <table style="width:100%;border: 1px solid #E6E6E6;">
                                      <apex:repeat value="{!rateListJProd[rowBlock2]}" var="rowLine2">
                                        <tr style="height: 23px;"><td class="rate-title">
                                          <apex:outputField value="{!rowLine2.CurrencyToConvert__c}"/>
                                        </td>
                                        <td style="width:50%;text-align:right;{!IF(rowLine2.ReadOnly__c, 'padding-right:6px;color:#aaaaaa;', IF(isQTRestricted, 'padding-right:6px;', ''))}">
                                          <apex:outputField style="width:100px;text-align:right;" value="{!rowLine2.Rate__c}" rendered="{!(rowLine2.ReadOnly__c || isQTRestricted)}"/>
                                          <apex:inputField style="width:100px;text-align:right;padding-right: 3px;" value="{!rowLine2.Rate__c}" rendered="{!!(rowLine2.ReadOnly__c || isQTRestricted)}" onchange="formatRate(this);calcurate();" styleClass="rate-JProd-{!rowLine2.CurrencyToConvert__c}-To-{!rowLine2.CurrencyBase__c}" onkeypress="return disableEnterKey(event)"/>
                                          <apex:inputHidden value="{!rowLine2.Rate__c}" rendered="{!isQTRestricted}" Html-Class="rate-JProd-{!rowLine2.CurrencyToConvert__c}-To-{!rowLine2.CurrencyBase__c}"/>
                                        </td></tr>                                      
                                      </apex:repeat>
                                    </table>
                                  </td>

                                </apex:repeat>

                              </tr>

                            </table>
</apex:panelGroup>
                          </div>

                        </div>

                    </div>




                    

                    <apex:outputPanel layout="block" id="detailAreaA"  styleClass="quotation-item quotation-detail-informations" >
                      <apex:variable value="{!qdm.currentSize > 0}" var="hasDetails" />
                      <apex:variable value="{!qdm.currentSizeA > 0}" var="hasDetailsA" />
                      <apex:variable value="{!qdm.currentSizeA2SP > 0}" var="hasDetailsA2SP" />
                      <hr style="margin: 20px 0px 4px 0px; float: none;"/>

                      <div class="quotation-item-header clearfix" style="height: 38px;">
                        <div class="header-title">{!$Label.JEOLAsia_ProfitCalculation_ProductInformations}</div>

                        <apex:commandButton onclick="window.open('{!redirectExportCsvURL}');" value="{!$Label.JEOLAsia_MaintList_Label_ExportExcel}" style="float: right;margin-top:3px;margin-right:9px;" disabled="{!IsNew}" styleClass="{!IF(IsNew, 'customButtonDisabled', 'customButton')}"/>

                      </div>

                      <div style="overflow: hidden;width: 100%;">
                        <div class="optionArea clearfix" style="float: right;">


                          <div class="field">
                            <apex:outputLabel style="width: 150px;" value="J-Prod cost currency" for="currencyCostIsoCode" styleClass="field-label" />

                            <apex:selectList id="currencyCostIsoCode" rendered="{!(!isReadOnly && qdm.parentRec.Status__c != '2' && qdm.parentRec.Status__c != '3' && qdm.parentRec.Status__c != '5')}" value="{!qdm.parentRec.JProdCostCurrency__c}" styleClass="field-value currencyCostIsoCode" size="1" html-data-compare-value="{!qdm.baseParentRec.JProdCostCurrency__c}" onblur="safetyLockCheck(this);" required="true" onkeypress="return disableEnterKey(event)">
                                <apex:selectOptions value="{!targetCostCurrencyOption}"/>
                                <apex:actionSupport event="onchange" oncomplete="calcurate();" reRender="SubtotalA" status="ajaxStatusA"/>
                              </apex:selectList>

                            <apex:outputField rendered="{!(isReadOnly || qdm.parentRec.Status__c == '2' || qdm.parentRec.Status__c == '3' || qdm.parentRec.Status__c == '5')}" id="currencyCostIsoCodeView" styleClass="field-value currencyCostIsoCode" value="{!qdm.parentRec.JProdCostCurrency__c}" html-data-compare-value="{!qdm.baseParentRec.JProdCostCurrency__c}" />
                          </div>




                          <div class="field" style="{!IF(isReadOnly,'','margin-right: 8px;')}">
                            <apex:outputLabel style="width: 120px;" value="Sales Currency" for="currencySalesIsoCode" styleClass="field-label" />

                            <apex:selectList id="currencySalesIsoCode" rendered="{!(!isReadOnly && qdm.parentRec.Status__c != '2' && qdm.parentRec.Status__c != '3' && qdm.parentRec.Status__c != '5')}" value="{!qdm.parentRec.SalesCurrency__c}" styleClass="field-value currencySalesIsoCode" size="1" html-data-compare-value="{!qdm.baseParentRec.SalesCurrency__c}" onblur="safetyLockCheck(this);" required="true" onkeypress="return disableEnterKey(event)">
                                <apex:selectOptions value="{!targetSalesCurrencyOption}"/>
                                <apex:actionSupport event="onchange" oncomplete="calcurate();" reRender="detailAreaA, detailAreaB, detailAreaC, detailAreaD, detailAreaE, detailAreaF, detailAreaG, SubtotalA, SubtotalB, SubtotalC, SubtotalD, SubtotalE, SubtotalF, SubtotalG, SectionGrandTotalPC" status="ajaxStatusA"/>
                            </apex:selectList>

                            <apex:outputField rendered="{!(isReadOnly || qdm.parentRec.Status__c == '2' || qdm.parentRec.Status__c == '3' || qdm.parentRec.Status__c == '5')}" id="currencySalesIsoCodeView" styleClass="field-value currencySalesIsoCode" value="{!qdm.parentRec.SalesCurrency__c}" html-data-compare-value="{!qdm.baseParentRec.SalesCurrency__c}" />
                          </div>

                          <!-- CONTENTS REFRESH BUTTON -->
                          <apex:outputPanel layout="block" styleClass="field" style="margin-right: 8px;" rendered="{!(hasDetails && !isReadOnly && !isQTRestricted)}">
                            <apex:commandLink action="{!qdm.refreshDetailProductItem}" oncomplete="showResult('{!$Label.JEOL_QuotEdit_Message_ContentRefreshed}');lockSafety();" rerender="detailAreaA, modalListView, modalListViewDel, apexMessage" status="ajaxStatusA" title="{!$Label.JEOL_QuotEdit_Message_ContentRefreshing}" styleClass="refreshButton customButton">
                              <span class="refresh-icon" style="vertical-align: middle;"></span>
                              <span style="vertical-align: middle;">{!$Label.JEOL_QuotEdit_Label_ContentsRefresh}</span>
                            </apex:commandLink>
                          </apex:outputPanel>

                          <!-- Edit Specifications -->
                          <apex:outputPanel layout="block" styleClass="field" style="margin-right: 8px;" >
                            <apex:commandButton title="Edit Specifications" value="Edit Specifications" styleClass="customButtonDisabled" rendered="{!IsNew}" disabled="true" />
                            <apex:commandLink action="{!goToEditSpecifications}" title="Edit Specifications" target="_blank" styleClass="customButton" rendered="{!!IsNew}">
                              <span style="vertical-align: middle;">Edit Specifications</span>
                            </apex:commandLink>
                          </apex:outputPanel>

                          <!-- DELETE MULTIPLE LINES BUTTON -->
                          <div class="{!IF(isReadOnly || isQTRestricted,'hidden','field')}" >
                            <button type="button" class="customButton" data-toggle="modal" data-target="#multiDeleteView">{!$Label.JEOL_QuotEdit_Label_DeleteMultiLines}</button>
                          </div>
                        </div>
                      </div>
                      
                      <!-- GRID 1 -->
                      <!-- Grid of items -->
                      <div class="quotation-item-header quotation-detail-header backgroundcolorgrey clearfix">
                        <div class="quotation-detail-header-item quotation-detail-productName quotation-detailA-productName" style="margin-left: 94px;">Product Name</div>
                        <div class="quotation-detail-header-item quotation-detail-ModelType quotation-detailA-ModelType">Model Type</div>
                        <div class="quotation-detail-header-item quotation-detail-quantity quotation-detailA-quantity">Qty</div>
                        <div class="quotation-detail-header-item quotation-detail-QuantityUnit quotation-detailA-QuantityUnit">Unit</div>
                        <div class="quotation-detail-header-item quotation-detail-UnitPrice quotation-detailA-UnitPrice">Unit Price</div>
                        <div class="quotation-detail-header-item quotation-detail-CatalogCurrency quotation-detailA-CatalogCurrency">Cur</div>
                        <div class="quotation-detail-header-item quotation-detail-CostPrice quotation-detailA-CostPrice">Cost Price<br/>({!qdm.parentRec.SalesCurrency__c})</div>
                        <div class="quotation-detail-header-item quotation-detail-SalesPrice quotation-detailA-SalesPrice">Sales Price<br/>({!qdm.parentRec.SalesCurrency__c})</div>
                      </div>
                      <apex:outputPanel layout="block" styleClass="quotation-item-body clearfix quotation-detail-list quotation-detail-listA">
                        <apex:outputPanel layout="none" rendered="{!hasDetailsA}">
                          <apex:repeat value="{!qdm.itemsA}" var="item" >
                          
                            <!-- NORMAL ROW -->
                            <apex:outputPanel id="detail_productA" layout="block" html-data-depth="{!item.rec.Depth__c}" html-data-sortNo="{!item.rec.SortNo__c}" html-data-section-type="A" html-data-type="{!item.rec.Type__c}" html-data-discount-target="{!item.rec.IsDiscountTarget__c}" html-data-overhead-target="{!item.rec.IsOverheadTarget__c}" html-data-show-target="{!item.rec.IsShowDetailAmount__c}" html-data-forbidden-target="{!item.rec.IsForbiddenTarget__c}" styleClass="quotation-detail-item quotation-detail-itemA clearfix" rendered="{!item.rec.Type__c = '1'}">
                              <div class="{!IF((isReadOnly || isQTRestricted),'hidden','field')}">
                                <div class="quotation-detail-action sortableAction sortableActionA" onmousedown="dragActionA(this);" >
                                  <div class="sortable-pointer"></div>
                                </div>
                              </div>
                              <div class="{!IF((isReadOnly || isQTRestricted),'hidden','field')}">
                                <div class="quotation-detail-action configAction clearfix">
                                  <apex:outputLink value="javascript: void(0);" onclick="removeDepth(this);lockSafety();return false;" styleClass="paragraph-option paragraph-up">&lsaquo;</apex:outputLink>
                                  <apex:outputLink value="javascript: void(0);" onclick="addDepth(this);lockSafety();return false;" styleClass="paragraph-option paragraph-down">&rsaquo;</apex:outputLink>
                                </div>
                              </div>
                              <div class="hidden">
                                <apex:inputHidden html-class="quotation-detail-Amount-input" value="{!item.rec.Amount__c}" />
                                <apex:inputHidden html-class="quotation-detail-sortNo" value="{!item.rec.SortNo__c}" />
                                <apex:inputHidden html-class="quotation-detail-depth" value="{!item.rec.Depth__c}" />
                                <apex:inputHidden html-class="quotation-detail-CostPrice-input" value="{!item.rec.CostPrice__c}" />
                                <apex:inputHidden html-class="quotation-detail-CostPriceJProdUnit" value="{!item.rec.CostPriceJProdUnit__c}" />
                                <apex:inputHidden html-class="quotation-detail-SalesPriceCalculated-input" value="{!item.rec.SalesPriceCalculated__c}" />
                                <apex:inputHidden html-class="quotation-detail-SalesPriceCoefficient" value="{!item.rec.SalesPriceCoefficient__c}" />
                                <apex:inputHidden html-class="quotation-detail-IsForbiddenTarget" value="{!item.rec.IsForbiddenTarget__c}" />
                              </div>

                              <!-- BODY__c -->
                              <div class="field" style="overflow-x: hidden;{!IF((isReadOnly || isQTRestricted),'margin-left: 86px;width: 231px;','')}" >
                                <div class="indent-wrap" >
                                  <button class="{!IF((isReadOnly || isQTRestricted),'hidden','productSelectButton')}" type="button" data-toggle="modal" onclick="initDetailProductAItemManage($j(this).closest('.quotation-detail-item'));setOpenModalDetailId(this);" data-target="#detailProductItemView"></button>
                                  <apex:inputField rendered="{!!(isReadOnly || isQTRestricted)}" id="quotation-detail-productNameA" styleClass="field-value quotation-detail-productName quotation-detailA-productName" value="{!item.rec.Body__c}" html-data-compare-value="{!item.rec.Body__c}" onfocus="detailBodyFocus(this);" onblur="detailBodyBlur(this);safetyLockCheck(this);" html-placeholder="{!$Label.JEOL_QuotEdit_Label_ProductName}" ></apex:inputField>
                                  <apex:outputText rendered="{!(isReadOnly || isQTRestricted)}" id="quotation-detail-productNameAView" styleClass="field-value quotation-detail-productName quotation-detailA-productName mightOverflow" value="{!item.rec.Body__c}" style="width: 231px;"/>
                                </div>
                              </div>

                              <!-- MODELTYPE__c -->
                              <div class="field clearfix" style="{!IF((isReadOnly || isQTRestricted),'width: 110px;','')}">
                                <apex:inputField rendered="{!!(isReadOnly || isQTRestricted)}" value="{!item.rec.ModelType__c}" styleClass="field-value quotation-detail-ModelType quotation-detailA-ModelType" html-placeholder="Model Type" html-data-compare-value="{!item.rec.ModelType__c}" onfocus="openSearchToggleButton(this);makeSuggestions(this);" onblur="safetyLockCheck(this);" onkeyup="makeSuggestions(this);" onkeypress="return disableEnterKey(event)"/>
                                <a class="{!IF((isReadOnly || isQTRestricted),'hidden','productSearchButton')}" href="javascript: void(0);"  title="コード検索" onclick="searchProductItemAsia(this);lockSafety();return false;">
                                  <span class="refresh-icon"></span>
                                </a>
                                <apex:outputText rendered="{!(isReadOnly || isQTRestricted)}" value="{!item.rec.ModelType__c}" styleClass="field-value quotation-detail-ModelType quotation-detailA-ModelType" /> 
                              </div>
                              <datalist id="suggest_listA"></datalist>

                              <!-- QUANTITY -->
                              <div class="field">
                                <apex:inputField rendered="{!!(isReadOnly || isQTRestricted)}" styleClass="field-value quotation-detail-quantity quotation-detailA-quantity number " value="{!item.rec.Quantity__c}" onchange="calcurate();" html-data-compare-value="{!item.rec.Quantity__c}" onblur="safetyLockCheck(this);" onkeypress="return disableEnterKey(event)"/>

                                <apex:inputHidden rendered="{!(isReadOnly || isQTRestricted)}" Html-Class="field-value quotation-detail-quantity quotation-detailA-quantity number " value="{!item.rec.Quantity__c}" />

                                <apex:outputText rendered="{!(isReadOnly || isQTRestricted)}" styleClass="field-value quotation-detail-quantity quotation-detailA-quantity number " value="{0,number, ###,###,###,###,###,##0.0}" >
                                  <apex:param value="{!item.rec.Quantity__c}" />
                                </apex:outputText>
                              </div>

                              <!-- QUANTITY UNIT -->
                              <div class="field">

                                <apex:inputField rendered="{!!(isReadOnly || isQTRestricted)}" styleClass="field-value quotation-detail-QuantityUnit quotation-detailA-QuantityUnit" value="{!item.rec.QuantityUnit__c}" onchange="calcurate();" html-data-compare-value="{!item.rec.QuantityUnit__c}" onblur="safetyLockCheck(this);" onkeypress="return disableEnterKey(event)"/>

                                <apex:outputText rendered="{!(isReadOnly || isQTRestricted)}" styleClass="field-value quotation-detail-QuantityUnit quotation-detailA-QuantityUnit" value="{!item.rec.QuantityUnit__c}" />

                              </div>

                              <!-- UNIT PRICE -->
                              <div class="field">
                                <apex:inputField rendered="{!!(isReadOnly || isQTRestricted)}" styleClass="field-value quotation-detail-UnitPrice quotation-detailA-UnitPrice number " value="{!item.rec.UnitPrice__c}" onchange="calcurate();" html-data-compare-value="{!item.rec.UnitPrice__c}" onblur="safetyLockCheck(this);" onkeypress="return disableEnterKey(event)"/>

                                <apex:inputHidden rendered="{!(isReadOnly || isQTRestricted)}" Html-Class="field-value quotation-detail-UnitPrice quotation-detailA-UnitPrice number " value="{!item.rec.UnitPrice__c}" />

                                <apex:outputText rendered="{!(isReadOnly || isQTRestricted)}" styleClass="field-value quotation-detail-UnitPrice quotation-detailA-UnitPrice number " value="{0,number, ###,###,###,###,###,##0.00}" >
                                  <apex:param value="{!item.rec.UnitPrice__c}" />
                                </apex:outputText>
                              </div>

                              <!-- CATALOG CURRENCY -->
                              <div class="field">
                                <apex:selectList rendered="{!!(isReadOnly || isQTRestricted)}" styleClass="field-value quotation-detail-CatalogCurrency quotation-detailA-CatalogCurrency" value="{!item.rec.CatalogCurrency__c}" size="1" html-data-compare-value="{!item.rec.CatalogCurrency__c}" onblur="safetyLockCheck(this);" required="true" onchange="calcurate();" onkeypress="return disableEnterKey(event)">
                                    <apex:selectOptions value="{!listJProdCurrencyOption}"/> 
                                </apex:selectList>

                                <apex:inputHidden rendered="{!(isReadOnly || isQTRestricted)}" Html-Class="field-value quotation-detail-CatalogCurrency quotation-detailA-CatalogCurrency number " value="{!item.rec.CatalogCurrency__c}" />

                                <apex:outputText rendered="{!(isReadOnly || isQTRestricted)}" styleClass="field-value quotation-detail-CatalogCurrency quotation-detailA-CatalogCurrency number " value="{!item.rec.CatalogCurrency__c}" />

                              </div>

                              <!-- COST PRICE -->
                              <div class="field">
                                <apex:outputText styleClass="field-value quotation-detail-CostPrice quotation-detailA-CostPrice number" value="{0,number, ###,###,###,###,###,##0.00}" >
                                  <apex:param value="{!item.rec.CostPrice__c}" />
                                </apex:outputText>
                              </div> 

                              <!-- SALES PRICE -->
                              <div class="field">
                                <apex:inputField rendered="{!!(isReadOnly || isQTRestricted)}" styleClass="field-value quotation-detail-SalesPrice quotation-detailA-SalesPrice number " value="{!item.rec.SalesPrice__c}" onchange="calcurate();" html-data-compare-value="{!item.rec.SalesPrice__c}" onblur="safetyLockCheck(this);" onkeypress="return disableEnterKey(event)"/>

                                <apex:outputText rendered="{!((isReadOnly || isQTRestricted) && item.rec.SalesPrice__c != NULL)}" styleClass="field-value quotation-detail-SalesPrice quotation-detailA-SalesPrice number" value="{0,number, ###,###,###,###,###,##0.00}" >
                                  <apex:param value="{!item.rec.SalesPrice__c}" />
                                </apex:outputText>

                                <apex:outputText rendered="{!((isReadOnly || isQTRestricted) && item.rec.SalesPrice__c == NULL && item.rec.SalesPriceCalculated__c != 0)}" styleClass="field-value quotation-detail-SalesPrice quotation-detailA-SalesPrice number" style="color: #b3b3b3;" value="{0,number, ###,###,###,###,###,##0.00}" >
                                  <apex:param value="{!item.rec.SalesPriceCalculated__c}" />
                                </apex:outputText>

                                <apex:outputText rendered="{!((isReadOnly || isQTRestricted) && item.rec.SalesPrice__c == NULL && item.rec.SalesPriceCalculated__c == 0)}" styleClass="field-value quotation-detail-SalesPrice quotation-detailA-SalesPrice number" />

                              </div> 

                              <div class="field">
                                <div class="panel-area clearfix" >
                                  <div class="option-view-panel showAmount" data-target-class="isShowDetailAmountTarget" onclick="optionSettingFromPanelClick(this);lockSafety();">1</div>
                                  <div class="option-view-panel discountTarget" data-target-class="isDiscountTarget" onclick="{!IF((isReadOnly || isQTRestricted),'','optionSettingFromPanelClick(this);calcurate();lockSafety();')}">2</div>
                                  <div class="option-view-panel dummy" data-target-class="dummy" >3</div>
                                 <div class="option-view-panel forbiddenTarget" data-target-class="isForbiddenTarget">4</div>
                                </div>
                              </div>
                              <div class="field" data-type="dropdown">
                                <button type="button" onclick="dorpdownAction(this);" data-type="button" class="optionalButton">▼</button>
                                <ul class="detail-options" data-type="list"  style="{!IF(language <> 'ja', 'width: 225px;', '')}">

                                  <!-- Clone this row -->
                                  <li style="height: 30px; width:225px;" class="{!IF((isReadOnly || isQTRestricted),'hidden','field detail-options-item')}" data-type="item">
                                    <apex:commandLink action="{!item.copyAction}" title="{!$Label.JEOL_QuotEdit_Label_CloneRow}" onclick="lockSafety();clearAction(this);" rerender="detailAreaA,modalListView,modalListViewDel,SubtotalA,SubtotalB,SubtotalC,SubtotalD,SubtotalE,SubtotalF,SubtotalG,totalResult,apexMessage" styleClass="quotation-detail-action" status="ajaxStatusA"  style="{!IF(language <> 'ja', 'width: 225px;', '')}" >{!$Label.JEOL_QuotEdit_Label_CloneRow}</apex:commandLink>
                                  </li>

                                  <!-- Edit Spare Parts -->
                                  <li style="height: 30px; width:225px;" 
                                      class="{!IF((isReadOnly || isQTRestricted),'hidden','field detail-options-item')}" 
                                      data-type="item"
                                      data-toggle="modal"
                                      data-target="#certificatePrintView" >
                                    <apex:commandLink action="{!refreshCurrent2SP}" title="Edit Spare Parts" onclick="lockSafety();clearAction(this);" oncomplete="calculate2spall();" rerender="detailAreaA,modalListView,modalListViewDel,standardCoef,SubtotalA,SubtotalB,SubtotalC,SubtotalD,SubtotalE,SubtotalF,SubtotalG,totalResult,apexMessage,certificatePrintView" styleClass="quotation-detail-action" status="ajaxPageStatus"  style="{!IF(language <> 'ja', 'width: 225px;', '')}" >Edit Spare Parts
                                      <apex:param value="{!item.rec.ModelType__c}" assignTo="{!selectedModelType}" name="param1" />
                                      <apex:param value="{!item.idxRow}" assignTo="{!selectedRow}" name="param2" />
                                    </apex:commandLink>
                                  </li>


                                  <li class="{!IF((isReadOnly || isQTRestricted),'hidden','')}"><hr/></li>
                                  
                                  <!-- 1 -->
                                  <li style="height: 30px;{!IF(language <> 'ja', 'width: 225px;', '')}" class="field detail-options-item" data-type="item" >
                                    <div class="showAmount"></div>
                                    <apex:outputLabel for="isShowDetailAmountTargetA" value="1. Show detail amount" styleClass="field-label" style="{!IF(language <> 'ja', 'width: 175px;', '')}" />
                                    <apex:inputField id="isShowDetailAmountTargetA" value="{!item.rec.IsShowDetailAmount__c}" html-data-target="data-show-target" styleClass="isShowDetailAmountTarget" onchange="optionSetting(this);" html-data-compare-value="{!item.rec.IsShowDetailAmount__c}" onblur="safetyLockCheck(this);" onkeypress="return disableEnterKey(event)"/>
                                  </li>

                                  <!-- 2 -->
                                  <li style="height: 30px;{!IF(language <> 'ja', 'width: 225px;', '')}" class="field detail-options-item" data-type="item">
                                    <div class="discountTarget"></div>
                                    <apex:outputLabel for="isDiscountTargetA" value="2. Discount Applicable" styleClass="field-label" style="{!IF(language <> 'ja', 'width: 175px;', '')}" />
                                    <apex:inputField rendered="{!!(isReadOnly || isQTRestricted)}" id="isDiscountTargetA" value="{!item.rec.IsDiscountTarget__c}" html-data-target="data-discount-target" styleClass="isDiscountTarget"  onchange="optionSetting(this);calcurate();" html-data-compare-value="{!item.rec.IsDiscountTarget__c}" onblur="safetyLockCheck(this);" onkeypress="return disableEnterKey(event)"/>
                                    <apex:inputcheckbox rendered="{!(isReadOnly || isQTRestricted)}" disabled="true" id="isDiscountTargetAView" value="{!item.rec.IsDiscountTarget__c}" onkeypress="return disableEnterKey(event)"/>
                                  </li>

                                  <!-- 2 -->
<!--
                                  <li style="height: 30px;{!IF(language <> 'ja', 'width: 225px;', '')}" class="field detail-options-item" data-type="item" >
                                    <div class="overhead"></div>
                                    <apex:outputLabel for="isOverheadTargetA" value="{!$Label.JEOL_QuotEdit_Label_SundryRelated}" styleClass="field-label" style="{!IF(language <> 'ja', 'width: 175px;', '')}" />
                                    <apex:inputField rendered="{!!isReadOnly}" id="isOverheadTargetA" value="{!item.rec.IsOverheadTarget__c}" html-data-target="data-overhead-target" styleClass="isOverheadTarget" onchange="optionSetting(this);calcurate();" html-data-compare-value="{!item.rec.IsOverheadTarget__c}" onblur="safetyLockCheck(this);" />
                                    <apex:inputcheckbox rendered="{!isReadOnly}" disabled="true" id="isOverheadTargetAView" value="{!item.rec.IsOverheadTarget__c}" />
                                  </li>
-->
                                  <!-- 4 -->
                                  <li style="height: 30px;{!IF(language <> 'ja', 'width: 225px;', '')}" class="field detail-options-item" data-type="item" >
                                    <div class="forbiddenTarget"></div>
                                    <apex:outputLabel value="4. Item not available" styleClass="field-label" style="{!IF(language <> 'ja', 'width: 175px;', '')}" />

                                    <apex:inputcheckbox disabled="true" value="{!item.rec.IsForbiddenTarget__c}" onkeypress="return disableEnterKey(event)"/>

<!--
                                    <apex:inputField id="isForbiddenTargetA" value="{!item.rec.IsForbiddenTarget__c}" html-data-target="data-forbidden-target" styleClass="isForbiddenTarget" disabled="true" onchange="optionSetting(this);" html-data-compare-value="{!item.rec.IsForbiddenTarget__c}" onblur="safetyLockCheck(this);" />
-->                                    
                                  </li>

                                  <li><hr/></li>

                                  <li style="height: 30px;{!IF(language <> 'ja', 'width: 225px;', '')}" class="field detail-options-item close-option" data-type="item" >
                                    <apex:outputLink value="javascript: void(0);" styleClass="closeButton" onclick="clearAction(this);$j(this).closest('[data-type=\'dropdown\']').find('[data-type=\'button\']').trigger('focus');return false;"  style="{!IF(language <> 'ja', 'width: 225px;', '')}" >{!$Label.JEOL_QuotEdit_Label_Close}</apex:outputLink>
                                  </li>
                                </ul>
                              </div>
                              <div class="{!IF((isReadOnly || isQTRestricted),'hidden','field')}">
                                <apex:commandLink action="{!item.deleteAction}" title="{!$Label.JEOL_QuotEdit_Label_RemoveRow}" onclick="lockSafety();" rerender="detailAreaA,modalListView,modalListViewDel,SubtotalA,SubtotalB,SubtotalC,SubtotalD,SubtotalE,SubtotalF,SubtotalG,totalResult,apexMessage" styleClass="quotation-detail-action deleteAction" status="ajaxStatusA" >×</apex:commandLink>
                              </div>
                              
                            </apex:outputPanel>

                            
                            <!-- SUMMARY ROW -->
                            <apex:outputPanel id="detail_titleA" layout="block" html-data-depth="{!item.rec.Depth__c}" html-data-sortNo="{!item.rec.SortNo__c}" html-data-section-type="A" html-data-type="{!item.rec.Type__c}" html-data-forbidden-target="{!item.rec.AccompanyingPaperOutput__c}" styleClass="quotation-detail-item quotation-detail-itemA clearfix" rendered="{!item.rec.Type__c = '2'}">
                              <div class="{!IF((isReadOnly || isQTRestricted),'hidden','field')}">
                                <div class="quotation-detail-action sortableAction sortableActionA" onmousedown="dragActionA(this);" >
                                  <div class="sortable-pointer"></div>
                                </div>
                              </div>
                              <div class="{!IF((isReadOnly || isQTRestricted),'hidden','field')}">
                                <div class="quotation-detail-action configAction">
                                  <apex:outputLink value="javascript: void(0);" onclick="removeDepth(this);lockSafety();return false;" styleClass="paragraph-option paragraph-up">&lsaquo;</apex:outputLink>
                                  <apex:outputLink value="javascript: void(0);" onclick="addDepth(this);lockSafety();return false;" styleClass="paragraph-option paragraph-down">&rsaquo;</apex:outputLink>
                                </div>
                              </div>
                              <div class="hidden">
                                <apex:inputHidden html-class="quotation-detail-sortNo" value="{!item.rec.SortNo__c}" />
                                <apex:inputHidden html-class="quotation-detail-depth" value="{!item.rec.Depth__c}" />
                              </div>
                              <div class="field" style="overflow-x: hidden;{!IF((isReadOnly || isQTRestricted),'margin-left: 86px;width: 803px;','')}">
                                <div class="indent-wrap">
                                  <apex:inputField rendered="{!!(isReadOnly || isQTRestricted)}" styleClass="field-value quotation-detail-headingBody" value="{!item.rec.Body__c}" onfocus="detailBodyFocus(this);" onblur="safetyLockCheck(this);detailBodyBlur(this);" html-data-compare-value="{!item.rec.Body__c}" />
                                  <apex:outputText rendered="{!(isReadOnly || isQTRestricted)}"  styleClass="field-value quotation-detail-headingBody" value="{!item.rec.Body__c}" />
                                </div>
                              </div>
                              <div class="field">
                                <div class="panel-area clearfix" >
<!--
                                  <div class="option-view-panel" ></div>
                                  <div class="option-view-panel" ></div>
                                  <div class="option-view-panel" ></div>
                                  <div class="option-view-panel accompanyingPaperOutput" data-target-class="isAccompanyingPaperOutput" onclick="optionSettingFromPanelClick(this);lockSafety();">{!$Label.JEOL_QuotEdit_Label_SeparateSheetShort}</div>
                                  <div class="option-view-panel" ></div>
-->
                                </div>
                              </div>
                              <div class="{!IF((isReadOnly || isQTRestricted),'hidden','')} field" data-type="dropdown">
                                <button type="button" onclick="dorpdownAction(this);" data-type="button" class="optionalButton">▼</button>
                                <ul class="detail-options" data-type="list" style="{!IF(language <> 'ja', 'width: 225px;', '')}">
                                  <li style="height: 30px;{!IF(language <> 'ja', 'width: 225px;', '')}" class="{!IF(isReadOnly,'hidden','field detail-options-item')}" data-type="item">
                                    <apex:commandLink action="{!item.copyAction}" title="{!$Label.JEOL_QuotEdit_Label_CloneRow}" onclick="lockSafety();clearAction(this);" rerender="detailAreaA,modalListView,modalListViewDel,SubtotalA,SubtotalB,SubtotalC,SubtotalD,SubtotalE,SubtotalF,SubtotalG,totalResult,apexMessage" styleClass="quotation-detail-action" status="ajaxStatusA" style="{!IF(language <> 'ja', 'width: 225px;', '')}">{!$Label.JEOL_QuotEdit_Label_CloneRow}</apex:commandLink>
                                  </li>

                                  <li class="{!IF(isReadOnly,'hidden','')}" ><hr/></li>

<!--
                                  <li style="height: 30px;{!IF(language <> 'ja', 'width: 225px;', '')}" class="field detail-options-item" data-type="item">
                                    <div class="accompanyingPaperOutput"></div>
                                    <apex:outputLabel for="isAccompanyingPaperOutput-breakdownA" value="{!$Label.JEOL_QuotEdit_Label_SeparateSheet}" styleClass="field-label" style="{!IF(language <> 'ja', 'width: 175px;', '')}" />
                                    <apex:inputField id="isAccompanyingPaperOutput-breakdownA" value="{!item.rec.AccompanyingPaperOutput__c}" html-data-target="data-forbidden-target" styleClass="field-value isAccompanyingPaperOutput" onchange="optionSetting(this);" html-data-compare-value="{!item.rec.AccompanyingPaperOutput__c}" onblur="safetyLockCheck(this);" />
                                  </li>

                                  <li><hr/></li>
-->

                                  <li style="height: 30px;{!IF(language <> 'ja', 'width: 225px;', '')}" class="field detail-options-item close-option" data-type="item">
                                    <apex:outputLink value="javascript: void(0);" styleClass="closeButton" onclick="clearAction(this);$j(this).closest('[data-type=\'dropdown\']').find('[data-type=\'button\']').trigger('focus');return false;" >{!$Label.JEOL_QuotEdit_Label_Close}</apex:outputLink>
                                  </li>
                                </ul>
                              </div>
                              <div class="{!IF((isReadOnly || isQTRestricted),'hidden','field')}" >
                                <apex:commandLink action="{!item.deleteAction}" title="{!$Label.JEOL_QuotEdit_Label_RemoveRow}" onclick="lockSafety();" rerender="detailAreaA,modalListView,modalListViewDel,SubtotalA,SubtotalB,SubtotalC,SubtotalD,SubtotalE,SubtotalF,SubtotalG,totalResult,apexMessage" styleClass="quotation-detail-action deleteAction" status="ajaxStatusA" >×</apex:commandLink>
                              </div>
                            </apex:outputPanel>
                            
                          </apex:repeat>
                        </apex:outputPanel>
                        <apex:outputPanel layout="none" rendered="{!!hasDetailsA}">
                          <div style="padding: 10px; margin: 2px 0px;">{!$Label.JEOL_QuotEdit_Message_DetailNotCreated}</div>
                        </apex:outputPanel>
                      </apex:outputPanel>
                      <apex:actionStatus layout="block" onstop="initWithCalcurate();focusOpenModalDetail();" id="ajaxStatusA" startStyleClass="ajax-status-start">
                        <apex:facet name="start">
                          <div class="ajax-status-start-inner ajax-loading">
                            <span style="position:relative; z-index: 2;">{!$Label.JEOL_QuotEdit_Label_Searching}</span>
                          </div>
                        </apex:facet>
                      </apex:actionStatus>
                      <hr />




                      <!-- GRID 1 - Spare Parts -->
                      <!-- Grid of items -->
                      <apex:outputPanel >
                        <div class="quotation-item-header quotation-detail-header backgroundcolorgrey clearfix" style="margin-top: 20px;">
                          <div class="quotation-detail-header-item quotation-detail-productName quotation-detailA2SP-productName" style="margin-left: 94px;">Spare Parts</div>
                          <div class="quotation-detail-header-item quotation-detail-CostPriceJPY quotation-detailA2SP-CostPriceJPY">Cost Price<br/>(JPY)</div>
                          <div class="quotation-detail-header-item quotation-detail-CostPriceSalesUnit quotation-detailA2SP-CostPriceSalesUnit">Cost Price<br/>({!qdm.parentRec.SalesCurrency__c})</div>
                          <div class="quotation-detail-header-item quotation-detail-SalesPrice quotation-detailA2SP-SalesPrice">Sales Price<br/>({!qdm.parentRec.SalesCurrency__c})</div>
                        </div>
                        <apex:outputPanel layout="block" styleClass="quotation-item-body clearfix quotation-detail-list quotation-detail-listA-2SP">
                          <apex:outputPanel layout="none" rendered="{!hasDetailsA2SP}">
                            <apex:repeat value="{!qdm.itemsA2SP}" var="item" >
                            
                              <!-- NORMAL ROW -->
                              <apex:outputPanel id="detail_productA2SP" layout="block" html-data-depth="{!item.rec.Depth__c}" html-data-sortNo="{!item.rec.SortNo__c}" html-data-section-type="A2SP" html-data-type="{!item.rec.Type__c}" html-data-discount-target="{!item.rec.IsDiscountTarget__c}" html-data-overhead-target="{!item.rec.IsOverheadTarget__c}" html-data-show-target="{!item.rec.IsShowDetailAmount__c}" html-data-forbidden-target="{!item.rec.AccompanyingPaperOutput__c}" styleClass="quotation-detail-item quotation-detail-itemA2SP clearfix" rendered="{!item.rec.Type__c = '1'}">

                                <div class="hidden">
                                  <apex:inputHidden html-class="CostPriceJPYWithoutSales" value="{!item.d2SPCostPriceJPYWithoutSales}" />
                                  <apex:inputHidden html-class="SalesPriceSalesUnitSetUser" value="{!item.d2SPSalesPriceSalesUnit}" />
                                  <apex:inputHidden html-class="CostPriceJPY" value="{!item.rec.CostPriceJPY2SP__c}" />
                                  <apex:inputHidden html-class="CostPriceSalesUnit" value="{!item.rec.CostPriceSalesCur2SP__c}" />
                                  <apex:inputHidden html-class="SalesPriceSalesUnit" value="{!item.rec.SalesPriceSalesCur2SP__c}" />
                                  <apex:inputHidden html-class="CostPriceJProdUnit" value="{!item.rec.CostPriceJProdUnit2SP__c}"/>
                                </div>

                                <!-- DESCRIPTION -->
                                <div class="field" style="overflow-x: hidden;margin-left: 86px;" >
                                  <div class="indent-wrap" >
                                    <apex:outputText id="quotation-detail-productNameAView" styleClass="field-value quotation-detail-productName quotation-detailA2SP-productName" value="Spare Parts for {!item.rec.ModelType__c}" />
                                  </div>
                                </div>

                                <!-- COST PRICE JPY -->
                                <div class="field">

                                  <apex:outputText styleClass="field-value quotation-detail-CostPriceJPY quotation-detailA2SP-CostPriceJPY number" value="{0,number, ###,###,###,###,###,##0.00}" >
                                    <apex:param value="{!item.rec.CostPriceJPY2SP__c}" />
                                  </apex:outputText>
                                </div> 

                                <!-- COST PRICE SALES UNIT -->
                                <div class="field">
                                  <apex:outputText styleClass="field-value quotation-detail-CostPriceSalesUnit quotation-detailA2SP-CostPriceSalesUnit number" value="{0,number, ###,###,###,###,###,##0.00}" >
                                    <apex:param value="{!item.rec.CostPriceSalesCur2SP__c}" />
                                  </apex:outputText>
                                </div> 

                                <!-- SALES PRICE -->
                                <div class="field">
                                  <apex:outputText styleClass="field-value quotation-detail-SalesPrice quotation-detailA2SP-SalesPrice number" value="{0,number, ###,###,###,###,###,##0.00}" >
                                    <apex:param value="{!item.rec.SalesPriceSalesCur2SP__c}" />
                                  </apex:outputText>
                                </div> 

                                <div class="field">
                                  <div class="panel-area clearfix" >
<!--
                                    <div class="option-view-panel discountTarget" data-target-class="isDiscountTarget" onclick="{!IF(isReadOnly,'','optionSettingFromPanelClick(this);calcurate();lockSafety();')}">1</div>
                                    <div class="option-view-panel overhead" data-target-class="isOverheadTarget" onclick="{!IF(isReadOnly,'','optionSettingFromPanelClick(this);calcurate();lockSafety();')}">{!$Label.JEOL_QuotEdit_Label_SundryRelatedShort}</div>
                                    <div class="option-view-panel showAmount" data-target-class="isShowDetailAmountTarget" onclick="optionSettingFromPanelClick(this);lockSafety();">{!$Label.JEOL_QuotEdit_Label_ShowDetailAmountShort}</div>
                                    <div class="option-view-panel accompanyingPaperOutput" data-target-class="isAccompanyingPaperOutput" onclick="optionSettingFromPanelClick(this);lockSafety();">{!$Label.JEOL_QuotEdit_Label_SeparateSheetShort}</div>
-->
                                  </div>
                                </div>
                                <div class="field" data-type="dropdown">
                                  <button type="button" onclick="dorpdownAction(this);" data-type="button" class="optionalButton">▼</button>
                                  <ul class="detail-options" data-type="list"  style="{!IF(language <> 'ja', 'width: 225px;', '')}">

                                    <!-- Edit Spare Parts -->
                                    <li style="height: 30px; width:225px;" 
                                        class="field detail-options-item" 
                                        data-type="item"
                                        data-toggle="modal"
                                        data-target="#certificatePrintView" >
                                      <apex:commandLink action="{!refreshCurrent2SP}" title="{!IF((isReadOnly || isQTRestricted),'Show','Edit')} Spare Parts" onclick="lockSafety();clearAction(this);" oncomplete="calculate2spall();" rerender="detailAreaA,modalListView,modalListViewDel,standardCoef,SubtotalA,SubtotalB,SubtotalC,SubtotalD,SubtotalE,SubtotalF,SubtotalG,totalResult,apexMessage,certificatePrintView" styleClass="quotation-detail-action" status="ajaxPageStatus"  style="{!IF(language <> 'ja', 'width: 225px;', '')}" >{!IF((isReadOnly || isQTRestricted),'Show','Edit')} Spare Parts
                                        <apex:param value="{!item.rec.ModelType__c}" assignTo="{!selectedModelType}" name="param1" />
                                        <apex:param value="{!item.idxRow}" assignTo="{!selectedRow}" name="param2" />
                                      </apex:commandLink>
                                    </li>


                                    <!-- Delete Spare Parts -->
                                    <li style="height: 30px; width:225px;" 
                                        class="{!IF((isReadOnly || isQTRestricted),'hidden','field detail-options-item')}"
                                        data-type="item">
                                      <apex:commandLink action="{!deleteCurrent2SPInFullSP}" title="Delete Spare Parts" onclick="lockSafety();clearAction(this);" oncomplete="calculate2spall();" rerender="detailAreaA,modalListView,modalListViewDel,standardCoef,SubtotalA,SubtotalB,SubtotalC,SubtotalD,SubtotalE,SubtotalF,SubtotalG,totalResult,apexMessage,certificatePrintView" styleClass="quotation-detail-action" status="ajaxPageStatus"  style="{!IF(language <> 'ja', 'width: 225px;', '')}" >Delete Spare Parts
                                        <apex:param value="{!item.rec.ModelType__c}" assignTo="{!selectedModelType}" name="param1" />
                                        <apex:param value="{!item.idxRow}" assignTo="{!selectedRow}" name="param2" />
                                      </apex:commandLink>
                                    </li>

<!--
                                    <li class="{!IF(isReadOnly,'hidden','')}"><hr/></li>

                                    <li style="height: 30px;{!IF(language <> 'ja', 'width: 225px;', '')}" class="field detail-options-item" data-type="item">
                                      <div class="discountTarget"></div>
                                      <apex:outputLabel for="isDiscountTargetA" value="1. Discount Applicable" styleClass="field-label" style="{!IF(language <> 'ja', 'width: 175px;', '')}" />
                                      <apex:inputField rendered="{!!isReadOnly}" id="isDiscountTargetA" value="{!item.rec.IsDiscountTarget__c}" html-data-target="data-discount-target" styleClass="isDiscountTarget"  onchange="optionSetting(this);calcurate();" html-data-compare-value="{!item.rec.IsDiscountTarget__c}" onblur="safetyLockCheck(this);" />
                                      <apex:inputcheckbox rendered="{!isReadOnly}" disabled="true" id="isDiscountTargetAView" value="{!item.rec.IsDiscountTarget__c}" />
                                    </li>

                                    <li style="height: 30px;{!IF(language <> 'ja', 'width: 225px;', '')}" class="field detail-options-item" data-type="item" >
                                      <div class="overhead"></div>
                                      <apex:outputLabel for="isOverheadTargetA" value="{!$Label.JEOL_QuotEdit_Label_SundryRelated}" styleClass="field-label" style="{!IF(language <> 'ja', 'width: 175px;', '')}" />
                                      <apex:inputField rendered="{!!isReadOnly}" id="isOverheadTargetA" value="{!item.rec.IsOverheadTarget__c}" html-data-target="data-overhead-target" styleClass="isOverheadTarget" onchange="optionSetting(this);calcurate();" html-data-compare-value="{!item.rec.IsOverheadTarget__c}" onblur="safetyLockCheck(this);" />
                                      <apex:inputcheckbox rendered="{!isReadOnly}" disabled="true" id="isOverheadTargetAView" value="{!item.rec.IsOverheadTarget__c}" />
                                    </li>

                                    <li style="height: 30px;{!IF(language <> 'ja', 'width: 225px;', '')}" class="field detail-options-item" data-type="item" >
                                      <div class="showAmount"></div>
                                      <apex:outputLabel for="isShowDetailAmountTargetA" value="{!$Label.JEOL_QuotEdit_Label_ShowDetailAmount}" styleClass="field-label" style="{!IF(language <> 'ja', 'width: 175px;', '')}" />
                                      <apex:inputField id="isShowDetailAmountTargetA" value="{!item.rec.IsShowDetailAmount__c}" html-data-target="data-show-target" styleClass="isShowDetailAmountTarget" onchange="optionSetting(this);" html-data-compare-value="{!item.rec.IsShowDetailAmount__c}" onblur="safetyLockCheck(this);" />
                                    </li>

                                    <li style="height: 30px;{!IF(language <> 'ja', 'width: 225px;', '')}" class="field detail-options-item" data-type="item" >
                                      <div class="accompanyingPaperOutput"></div>
                                      <apex:outputLabel for="isAccompanyingPaperOutputA" value="{!$Label.JEOL_QuotEdit_Label_SeparateSheet}" styleClass="field-label" style="{!IF(language <> 'ja', 'width: 175px;', '')}" />
                                      <apex:inputField id="isAccompanyingPaperOutputA" value="{!item.rec.AccompanyingPaperOutput__c}" html-data-target="data-forbidden-target" styleClass="isAccompanyingPaperOutput" onchange="optionSetting(this);" html-data-compare-value="{!item.rec.AccompanyingPaperOutput__c}" onblur="safetyLockCheck(this);" />
                                    </li>
-->                                 

                                    <li><hr/></li>

                                    <li style="height: 30px;{!IF(language <> 'ja', 'width: 225px;', '')}" class="field detail-options-item close-option" data-type="item" >
                                      <apex:outputLink value="javascript: void(0);" styleClass="closeButton" onclick="clearAction(this);$j(this).closest('[data-type=\'dropdown\']').find('[data-type=\'button\']').trigger('focus');return false;"  style="{!IF(language <> 'ja', 'width: 225px;', '')}" >{!$Label.JEOL_QuotEdit_Label_Close}</apex:outputLink>
                                    </li>
                                  </ul>
                                </div>
                                
                              </apex:outputPanel>
                              
                              
                              
                            </apex:repeat>
                          </apex:outputPanel>
                          <apex:outputPanel layout="none" rendered="{!!hasDetailsA2SP}">
                            <div style="padding: 10px; margin: 2px 0px;">{!$Label.JEOL_QuotEdit_Message_DetailNotCreated}</div>
                          </apex:outputPanel>
                        </apex:outputPanel>
                        <hr />
                      </apex:outputPanel>
                    </apex:outputPanel>
                      
                    <!-- Add New Item button -->
                    <div class="quotation-item create-action-area" >
                      <div class="quotation-item-body clearfix" >
                        <div class="{!IF((isReadOnly || isQTRestricted),'hidden','field clearfix top')}" data-type="dropdown">
                          <apex:commandLink rerender="detailAreaA,modalListView,modalListViewDel,apexMessage" action="{!qdm.createQuotationDetailA}" oncomplete="lockSafety();showResult('{!$Label.JEOL_QuotEdit_Message_ProcessingCompleted}');" styleClass="add-default-detail customButton" status="ajaxStatusA" >{!$Label.JEOL_QuotEdit_Label_AddNewItem}</apex:commandLink>
                          <apex:outputLink value="javascript: void(0);" onclick="dorpdownAction(this);return false;" html-data-type="button" styleClass="add-optional-details customButton">▲</apex:outputLink>
                          <ul class="optional-list" data-type="list">
                            <li data-type="item">
                              <apex:commandLink styleClass="optional-item" oncomplete="lockSafety();showResult('{!$Label.JEOL_QuotEdit_Message_ProcessingCompleted}');" rerender="detailAreaA,modalListView,modalListViewDel,apexMessage" action="{!qdm.createQuotationDetailAx5}" status="ajaxStatusA" >{!$Label.JEOLAsia_QuotEdit_Label_AddNewItemx5}</apex:commandLink>
                            </li>
                            <li data-type="item">
                              <apex:commandLink styleClass="optional-item" oncomplete="lockSafety();showResult('{!$Label.JEOL_QuotEdit_Message_ProcessingCompleted}');" rerender="detailAreaA,modalListView,modalListViewDel,apexMessage" action="{!qdm.createQuotationDetailA}" status="ajaxStatusA" >{!$Label.JEOL_QuotEdit_Label_AddNewItem}</apex:commandLink>
                            </li>
                            <li data-type="item">
                              <apex:commandLink styleClass="optional-item" oncomplete="lockSafety();showResult('{!$Label.JEOL_QuotEdit_Message_ProcessingCompleted}');" rerender="detailAreaA,modalListView,modalListViewDel,apexMessage" action="{!qdm.createHeadingDetailA}" status="ajaxStatusA">{!$Label.JEOL_QuotEdit_Label_AddHeading}</apex:commandLink>
                            </li>
                            <li><hr/></li>
                            <li class="field close-option" data-type="item">
                              <apex:outputLink value="javascript: void(0);" styleClass="optional-item closeButton" onclick="clearAction(this);$j(this).closest('[data-type=\'dropdown\']').find('[data-type=\'button\']').trigger('focus');return false;" >{!$Label.JEOL_QuotEdit_Label_Close}</apex:outputLink>
                            </li>
                          </ul>
                        </div>
                      </div>
                    </div>


                    <!-- SUMMARY SECTION -->
                    <div class="quotation-item total-amount-area" >
                      <apex:outputPanel layout="block" styleClass="quotation-item-body clearfix" id="SubtotalA">
                        <div class="hidden" >
                          <apex:inputHidden html-class="fieldSubtotalACostUnit" value="{!qdm.parentRec.SubtotalACostUnit__c}" />
                          <apex:inputHidden html-class="fieldSubtotalASalesUnit" value="{!qdm.parentRec.SubtotalASalesUnit__c}" />
                          <apex:inputHidden html-class="fieldSubtotalA" value="{!qdm.parentRec.SubtotalA__c}" />
                        </div>

                        <!-- Subtotal (J-Prod cost currency) -->
                        <div class="field" >
                          <div class="field-label">
                            <apex:outputLabel for="quotationSubtotalACostUnit" value="Subtotal ({!qdm.parentRec.JProdCostCurrency__c})" style="padding-right: 8px;" />
                          </div>
                          <apex:outputText id="quotationSubtotalACostUnit" styleClass="field-value quotationSubtotalACostUnitOutput number" value="{0,number, ###,###,###,###,###,##0.00}" style="font-size: 13px;" >
                            <apex:param value="{!qdm.parentRec.SubtotalACostUnit__c}" />
                          </apex:outputText>
                        </div>

                        <!-- Subtotal (currencySales currency) -->
                        <apex:outputPanel rendered="{!qdm.parentRec.JProdCostCurrency__c != qdm.parentRec.SalesCurrency__c}">
                        <div class="field">
                          <div class="field-label">
                            <apex:outputLabel for="quotationSubtotalASalesUnit" value="Subtotal ({!qdm.parentRec.SalesCurrency__c})" style="padding-right: 8px;" />
                          </div>
                          <apex:outputText id="quotationSubtotalASalesUnit" styleClass="field-value quotationSubtotalASalesUnitOutput number" value="{0,number, ###,###,###,###,###,##0.00}" style="font-size: 13px;" >
                            <apex:param value="{!qdm.parentRec.SubtotalASalesUnit__c}" />
                          </apex:outputText>
                        </div>
                        </apex:outputPanel>

                        <!-- Discount -->
                        <apex:outputPanel id="discountRateSection">
                          <div class="field" >
                            <div class="field-label">
                              <apex:inputHidden value="{!qdm.parentRec.SubtotalADiscountType__c}" html-class="discountType"/>

                              <apex:outputLabel for="discountRateSubtotalA" value="Discount (" style="padding-right: 8px;" />

                              <apex:inputField id="discountRateSubtotalA" styleClass="field-value discountSubtotalARateInput number {!IF(qdm.parentRec.SubtotalADiscountType__c != 'Rate' || (isReadOnly || isQTRestricted), 'hidden', '')}" value="{!qdm.parentRec.SubtotalADiscountRate__c}" onchange="calcurate();" html-data-compare-value="{!qdm.baseParentRec.SubtotalADiscountRate__c}" onblur="safetyLockCheck(this);" onkeypress="return disableEnterKey(event)"/>
                              <apex:outputText rendered="{!qdm.parentRec.SubtotalADiscountType__c != 'Rate' || (isReadOnly || isQTRestricted)}" styleClass="discountSubtotalARateOutput number" value="{!qdm.parentRec.SubtotalADiscountRate__c}" />
                              <apex:outputText value=" %)" style="padding-left: 8px;padding-right: 8px;" />
<!--TODOBP-->
                            </div>

                            <apex:inputField id="discountSubtotalA" styleClass="field-value discountSubtotalAValueInput number {!IF(qdm.parentRec.SubtotalADiscountType__c == 'Rate' || (isReadOnly || isQTRestricted), 'hidden', '')}" value="{!qdm.parentRec.SubtotalADiscount__c}" onchange="calcurate();" html-data-compare-value="{!qdm.baseParentRec.SubtotalADiscount__c}" onblur="safetyLockCheck(this);" onkeypress="return disableEnterKey(event)"/>
                            <apex:outputText rendered="{!qdm.parentRec.SubtotalADiscountType__c == 'Rate' || (isReadOnly || isQTRestricted)}" id="discountSubtotalAOutput" styleClass="field-value discountSubtotalAValueOutput number" value="{0,number, ###,###,###,###,###,##0.00}" style="font-size: 13px;">
                              <apex:param value="{!qdm.parentRec.SubtotalADiscount__c}" />
                            </apex:outputText>

                          </div>
                        </apex:outputPanel>

                        <apex:outputPanel rendered="{!!(isReadOnly || isQTRestricted)}" layout="block" styleClass="field" style="float: right;" >
                          <apex:commandLink title="Rate / Value" target="_blank" styleClass="customButton" reRender="discountRateSection"
                                            onClick="discountChangeRateValueType();" status="ajaxStatusA">
                            <span class="refresh-icon" style="vertical-align: middle;"></span>
                          </apex:commandLink>
                        </apex:outputPanel>

                        <!-- JEOL Product Subtotal -->
                        <div class="field" >
                          <div class="field-label">
                            <apex:outputLabel for="quotationSubtotalA" value="JEOL Product Subtotal ({!qdm.parentRec.SalesCurrency__c})" style="padding: 8px; background-color: #DDDDDD;" />
                          </div>
                          <apex:outputText id="quotationSubtotalA" styleClass="field-value quotationSubtotalA number" value="{0,number, ###,###,###,###,###,##0.00}" style="font-size: 13px;" >
                            <apex:param value="{!qdm.parentRec.SubtotalA__c}" />
                          </apex:outputText>
                        </div>

                      </apex:outputPanel>
                    </div>





                    <apex:outputPanel >

                      <apex:outputPanel layout="block" id="detailAreaB"  styleClass="quotation-item quotation-detail-informations" >
                        <apex:variable value="{!qdm.currentSizeB > 0}" var="hasDetailsB" />

                        <div class="quotation-item-header clearfix" style="height: 38px;">
                          <div class="header-title">{!$Label.JEOLAsia_ProfitCalculation_LSInformations}</div>
                        </div>

                        <!-- GRID 2 -->
                        <!-- Grid of items -->
                        <div class="quotation-item-header quotation-detail-header backgroundcolorgrey clearfix">
                          <div class="quotation-detail-header-item quotation-detail-productName quotation-detailB-productName" style="margin-left: 94px;">Product Name</div>
                          <div class="quotation-detail-header-item quotation-detail-Description quotation-detailB-Description">Model Type</div>
                          <div class="quotation-detail-header-item quotation-detail-quantity quotation-detailB-quantity">Qty</div>
                          <div class="quotation-detail-header-item quotation-detail-QuantityUnit quotation-detailB-QuantityUnit">Unit</div>
                          <div class="quotation-detail-header-item quotation-detail-UnitPrice quotation-detailB-UnitPrice">Unit Price</div>
                          <div class="quotation-detail-header-item quotation-detail-CatalogCurrency quotation-detailB-CatalogCurrency">Cur</div>
                          <div class="quotation-detail-header-item quotation-detail-CostPrice quotation-detailB-CostPrice">Cost Price<br/>({!qdm.parentRec.SalesCurrency__c})</div>
                          <div class="quotation-detail-header-item quotation-detail-SalesPrice quotation-detailB-SalesPrice">Sales Price<br/>({!qdm.parentRec.SalesCurrency__c})</div>
                          <div class="quotation-detail-header-item quotation-detail-Supplier quotation-detailB-Supplier">Supplier</div>
                        </div>
                        <apex:outputPanel layout="block" styleClass="quotation-item-body clearfix quotation-detail-list quotation-detail-listB">
                          <apex:outputPanel layout="none" rendered="{!hasDetailsB}">
                            <apex:repeat value="{!qdm.itemsB}" var="item" >
                            
                              <!-- NORMAL ROW -->
                              <apex:outputPanel id="detail_productB" layout="block" html-data-depth="{!item.rec.Depth__c}" html-data-sortNo="{!item.rec.SortNo__c}" html-data-section-type="B" html-data-type="{!item.rec.Type__c}" html-data-discount-target="{!item.rec.IsDiscountTarget__c}" html-data-tax-target="{!item.rec.IsTaxationTarget__c}" html-data-overhead-target="{!item.rec.IsOverheadTarget__c}" html-data-show-target="{!item.rec.IsShowDetailAmount__c}" html-data-forbidden-target="{!item.rec.AccompanyingPaperOutput__c}" styleClass="quotation-detail-item quotation-detail-itemB clearfix" rendered="{!item.rec.Type__c = '1'}">
                                <div class="{!IF((isReadOnly || isQTRestricted),'hidden','field')}">
                                  <div class="quotation-detail-action sortableAction sortableActionB" onmousedown="dragActionB(this);" >
                                    <div class="sortable-pointer"></div>
                                  </div>
                                </div>
                                <div class="{!IF((isReadOnly || isQTRestricted),'hidden','field')}">
                                  <div class="quotation-detail-action configAction clearfix">
                                    <apex:outputLink value="javascript: void(0);" onclick="removeDepth(this);lockSafety();return false;" styleClass="paragraph-option paragraph-up">&lsaquo;</apex:outputLink>
                                    <apex:outputLink value="javascript: void(0);" onclick="addDepth(this);lockSafety();return false;" styleClass="paragraph-option paragraph-down">&rsaquo;</apex:outputLink>
                                  </div>
                                </div>
                                <div class="hidden">
                                  <apex:inputHidden html-class="quotation-detail-Amount-input" value="{!item.rec.Amount__c}" />
                                  <apex:inputHidden html-class="quotation-detail-sortNo" value="{!item.rec.SortNo__c}" />
                                  <apex:inputHidden html-class="quotation-detail-depth" value="{!item.rec.Depth__c}" />
                                  <apex:inputHidden html-class="quotation-detail-CostPrice-input" value="{!item.rec.CostPrice__c}" />
                                  <apex:inputHidden html-class="quotation-detail-CostPriceJProdUnit" value="{!item.rec.CostPriceJProdUnit__c}" />
                                </div>

                                <!-- BODY__c -->
                                <div class="field" style="overflow-x: hidden;{!IF((isReadOnly || isQTRestricted),'margin-left: 86px;width: 157px;','')}" >
                                  <div class="indent-wrap" >
                                    <button class="{!IF((isReadOnly || isQTRestricted),'hidden','productSelectButton')}" type="button" data-toggle="modal" onclick="initDetailProductBItemManage($j(this).closest('.quotation-detail-item'));setOpenModalDetailId(this);" data-target="#detailProductItemView"></button>
                                    <apex:inputField rendered="{!!(isReadOnly || isQTRestricted)}" id="quotation-detail-productNameB" styleClass="field-value quotation-detail-productName quotation-detailB-productName" value="{!item.rec.Body__c}" html-data-compare-value="{!item.rec.Body__c}" onfocus="detailBodyFocus(this);" onblur="detailBodyBlur(this);safetyLockCheck(this);" html-placeholder="{!$Label.JEOL_QuotEdit_Label_ProductName}" ></apex:inputField>
                                    <apex:outputText rendered="{!(isReadOnly || isQTRestricted)}" id="quotation-detail-productNameBView" styleClass="field-value quotation-detail-productName quotation-detailB-productName" value="{!item.rec.Body__c}" style="padding-left: 8px;width: 157px;"/>
                                  </div>
                                </div>

                                 <!-- MODELTYPE__c -->
                                <div class="field clearfix">
                                  <apex:inputField rendered="{!!(isReadOnly || isQTRestricted)}" value="{!item.rec.ModelType__c}" styleClass="field-value quotation-detail-Description quotation-detailB-Description" html-placeholder="Model Type" html-data-compare-value="{!item.rec.ModelType__c}" onblur="safetyLockCheck(this);" onkeypress="return disableEnterKey(event)"/>
                                  <apex:outputText rendered="{!(isReadOnly || isQTRestricted)}" value="{!item.rec.ModelType__c}" styleClass="field-value quotation-detail-Description quotation-detailB-Description" /> 
                                </div>

                                <!-- QUANTITY -->
                                <div class="field">
                                  <apex:inputField rendered="{!!(isReadOnly || isQTRestricted)}" styleClass="field-value quotation-detail-quantity quotation-detailB-quantity number " value="{!item.rec.Quantity__c}" onchange="calcurate();" html-data-compare-value="{!item.rec.Quantity__c}" onblur="safetyLockCheck(this);" onkeypress="return disableEnterKey(event)" />
                                  <apex:outputText rendered="{!(isReadOnly || isQTRestricted)}" styleClass="field-value quotation-detail-quantity quotation-detailB-quantity number " value="{0,number, ###,###,###,###,###,##0.0}">
                                    <apex:param value="{!item.rec.Quantity__c}" />
                                  </apex:outputText>

                                </div>

                                <!-- QUANTITY UNIT -->
                                <div class="field">
                                  <apex:inputField rendered="{!!(isReadOnly || isQTRestricted)}" styleClass="field-value quotation-detail-QuantityUnit quotation-detailB-QuantityUnit" value="{!item.rec.QuantityUnit__c}" onchange="calcurate();" html-data-compare-value="{!item.rec.QuantityUnit__c}" onblur="safetyLockCheck(this);" onkeypress="return disableEnterKey(event)" />
                                  <apex:outputText rendered="{!(isReadOnly || isQTRestricted)}" styleClass="field-value quotation-detail-QuantityUnit quotation-detailB-QuantityUnit" value="{!item.rec.QuantityUnit__c}" />
                                </div>

                                <!-- UNIT PRICE -->
                                <div class="field">
                                  <apex:inputField rendered="{!!(isReadOnly || isQTRestricted)}" styleClass="field-value quotation-detail-UnitPrice quotation-detailB-UnitPrice number " value="{!item.rec.UnitPrice__c}" onchange="calcurate();" html-data-compare-value="{!item.rec.UnitPrice__c}" onblur="safetyLockCheck(this);" onkeypress="return disableEnterKey(event)" />

                                  <apex:inputHidden rendered="{!(isReadOnly || isQTRestricted)}" Html-Class="field-value quotation-detail-UnitPrice quotation-detailB-UnitPrice number " value="{!item.rec.UnitPrice__c}" />

                                  <apex:outputText rendered="{!(isReadOnly || isQTRestricted)}" styleClass="field-value quotation-detail-UnitPrice quotation-detailB-UnitPrice number " value="{0,number, ###,###,###,###,###,##0.00}" >
                                    <apex:param value="{!item.rec.UnitPrice__c}" />
                                  </apex:outputText>

                                </div>

                                <!-- CATALOG CURRENCY -->
                                <div class="field">
                                  <apex:selectList rendered="{!!(isReadOnly || isQTRestricted)}" styleClass="field-value quotation-detail-CatalogCurrency quotation-detailB-CatalogCurrency" value="{!item.rec.CatalogCurrency__c}" size="1" html-data-compare-value="{!item.rec.CatalogCurrency__c}" onblur="safetyLockCheck(this);" required="true" onchange="calcurate();" onkeypress="return disableEnterKey(event)" >
                                      <apex:selectOptions value="{!listOtherCurrencyOption}"/> 
                                  </apex:selectList>

                                  <apex:inputHidden rendered="{!(isReadOnly || isQTRestricted)}" Html-Class="field-value quotation-detail-CatalogCurrency quotation-detailB-CatalogCurrency number " value="{!item.rec.CatalogCurrency__c}" />

                                  <apex:outputText rendered="{!(isReadOnly || isQTRestricted)}" styleClass="field-value quotation-detail-CatalogCurrency quotation-detailB-CatalogCurrency number " value="{!item.rec.CatalogCurrency__c}" />

                                </div>

                                <!-- COST PRICE -->
                                <div class="field">
                                  <apex:outputText styleClass="field-value quotation-detail-CostPrice quotation-detailB-CostPrice number" value="{0,number, ###,###,###,###,###,##0.00}" >
                                    <apex:param value="{!item.rec.CostPrice__c}" />
                                  </apex:outputText>
                                </div> 

                                <!-- SALES PRICE -->
                                <div class="field">
                                  <apex:inputField rendered="{!!(isReadOnly || isQTRestricted)}" styleClass="field-value quotation-detail-SalesPrice quotation-detailB-SalesPrice number " value="{!item.rec.SalesPrice__c}" onchange="calcurate();" html-data-compare-value="{!item.rec.SalesPrice__c}" onblur="safetyLockCheck(this);" onkeypress="return disableEnterKey(event)" />
                                  <apex:outputText rendered="{!(isReadOnly || isQTRestricted)}" styleClass="field-value quotation-detail-SalesPrice quotation-detailB-SalesPrice number" value="{0,number, ###,###,###,###,###,##0.00}" >
                                    <apex:param value="{!item.rec.SalesPrice__c}" />
                                  </apex:outputText>
                                </div> 

                                <!-- SUPPLIER__c -->
                                <div class="field clearfix">
                                  <apex:inputField rendered="{!!(isReadOnly || isQTRestricted)}" value="{!item.rec.Supplier__c}" styleClass="field-value quotation-detail-Supplier quotation-detailB-Supplier" html-placeholder="Supplier" html-data-compare-value="{!item.rec.Supplier__c}" onblur="safetyLockCheck(this);" onkeypress="return disableEnterKey(event)" />
                                  <apex:outputText rendered="{!(isReadOnly || isQTRestricted)}" value="{!item.rec.Supplier__c}" styleClass="field-value quotation-detail-Supplier quotation-detailB-Supplier" /> 
                                </div>









                                <div class="field">
                                  <div class="panel-area clearfix" >
                                    <div class="option-view-panel showAmount" data-target-class="isShowDetailAmountTarget" onclick="optionSettingFromPanelClick(this);lockSafety();">1</div>
<!--
                                    <div class="option-view-panel tax" data-target-class="isTaxationTarget" onclick="{!IF((isReadOnly || isQTRestricted),'','optionSettingFromPanelClick(this);calcurate();lockSafety();')}">{!$Label.JEOL_QuotEdit_Label_TaxableShort}</div>
                                    <div class="option-view-panel overhead" data-target-class="isOverheadTarget" onclick="{!IF((isReadOnly || isQTRestricted),'','optionSettingFromPanelClick(this);calcurate();lockSafety();')}">{!$Label.JEOL_QuotEdit_Label_SundryRelatedShort}</div>
                                    <div class="option-view-panel accompanyingPaperOutput" data-target-class="isAccompanyingPaperOutput" onclick="optionSettingFromPanelClick(this);lockSafety();">{!$Label.JEOL_QuotEdit_Label_SeparateSheetShort}</div>
-->
                                  </div>
                                </div>
                                <div class="field" data-type="dropdown">
                                  <button type="button" onclick="dorpdownAction(this);" data-type="button" class="optionalButton">▼</button>
                                  <ul class="detail-options" data-type="list"  style="{!IF(language <> 'ja', 'width: 225px;', '')}">
                                    <li style="height: 30px;width: 225px;" class="{!IF((isReadOnly || isQTRestricted),'hidden','field detail-options-item')}" data-type="item">
                                      <apex:commandLink action="{!item.copyAction}" title="{!$Label.JEOL_QuotEdit_Label_CloneRow}" onclick="lockSafety();clearAction(this);" rerender="detailAreaB,modalListView,modalListViewDel,SubtotalA,SubtotalB,SubtotalC,SubtotalD,SubtotalE,SubtotalF,SubtotalG,totalResult,apexMessage" styleClass="quotation-detail-action" status="ajaxStatusB"  style="{!IF(language <> 'ja', 'width: 225px;', '')}" >{!$Label.JEOL_QuotEdit_Label_CloneRow}</apex:commandLink>
                                    </li>

                                    <li class="{!IF((isReadOnly || isQTRestricted),'hidden','')}"><hr/></li>

                                    <li style="height: 30px;{!IF(language <> 'ja', 'width: 225px;', '')}" class="field detail-options-item" data-type="item" >
                                      <div class="showAmount"></div>
                                      <apex:outputLabel for="isShowDetailAmountTargetB" value="1. Show detail amount" styleClass="field-label" style="{!IF(language <> 'ja', 'width: 175px;', '')}" />
                                      <apex:inputField id="isShowDetailAmountTargetB" value="{!item.rec.IsShowDetailAmount__c}" html-data-target="data-show-target" styleClass="isShowDetailAmountTarget" onchange="optionSetting(this);" html-data-compare-value="{!item.rec.IsShowDetailAmount__c}" onblur="safetyLockCheck(this);" onkeypress="return disableEnterKey(event)"/>
                                    </li>

<!--
                                    <li style="height: 30px;{!IF(language <> 'ja', 'width: 225px;', '')}" class="field detail-options-item" data-type="item">
                                      <div class="tax"></div>
                                      <apex:outputLabel for="isTaxationTargetB" value="{!$Label.JEOL_QuotEdit_Label_Taxable}" styleClass="field-label" style="{!IF(language <> 'ja', 'width: 175px;', '')}" />
                                      <apex:inputField rendered="{!!(isReadOnly || isQTRestricted)}" id="isTaxationTargetB" value="{!item.rec.IsTaxationTarget__c}" html-data-target="data-tax-target" styleClass="isTaxationTarget"  onchange="optionSetting(this);calcurate();" html-data-compare-value="{!item.rec.IsTaxationTarget__c}" onblur="safetyLockCheck(this);" />
                                      <apex:inputcheckbox rendered="{!(isReadOnly || isQTRestricted)}" disabled="true" id="isTaxationTargetBView" value="{!item.rec.IsTaxationTarget__c}" />
                                    </li>
                                    <li style="height: 30px;{!IF(language <> 'ja', 'width: 225px;', '')}" class="field detail-options-item" data-type="item" >
                                      <div class="overhead"></div>
                                      <apex:outputLabel for="isOverheadTargetB" value="{!$Label.JEOL_QuotEdit_Label_SundryRelated}" styleClass="field-label" style="{!IF(language <> 'ja', 'width: 175px;', '')}" />
                                      <apex:inputField rendered="{!!(isReadOnly || isQTRestricted)}" id="isOverheadTargetB" value="{!item.rec.IsOverheadTarget__c}" html-data-target="data-overhead-target" styleClass="isOverheadTarget" onchange="optionSetting(this);calcurate();" html-data-compare-value="{!item.rec.IsOverheadTarget__c}" onblur="safetyLockCheck(this);" />
                                      <apex:inputcheckbox rendered="{!(isReadOnly || isQTRestricted)}" disabled="true" id="isOverheadTargetBView" value="{!item.rec.IsOverheadTarget__c}" />
                                    </li>
                                    <li style="height: 30px;{!IF(language <> 'ja', 'width: 225px;', '')}" class="field detail-options-item" data-type="item" >
                                      <div class="accompanyingPaperOutput"></div>
                                      <apex:outputLabel for="isAccompanyingPaperOutputB" value="{!$Label.JEOL_QuotEdit_Label_SeparateSheet}" styleClass="field-label" style="{!IF(language <> 'ja', 'width: 175px;', '')}" />
                                      <apex:inputField id="isAccompanyingPaperOutputB" value="{!item.rec.AccompanyingPaperOutput__c}" html-data-target="data-forbidden-target" styleClass="isAccompanyingPaperOutput" onchange="optionSetting(this);" html-data-compare-value="{!item.rec.AccompanyingPaperOutput__c}" onblur="safetyLockCheck(this);" />
                                    </li>
-->
                                    <li><hr/></li>
                                    <li style="height: 30px;{!IF(language <> 'ja', 'width: 225px;', '')}" class="field detail-options-item close-option" data-type="item" >
                                      <apex:outputLink value="javascript: void(0);" styleClass="closeButton" onclick="clearAction(this);$j(this).closest('[data-type=\'dropdown\']').find('[data-type=\'button\']').trigger('focus');return false;"  style="{!IF(language <> 'ja', 'width: 225px;', '')}" >{!$Label.JEOL_QuotEdit_Label_Close}</apex:outputLink>
                                    </li>
                                  </ul>
                                </div>
                                <div class="{!IF((isReadOnly || isQTRestricted),'hidden','field')}">
                                  <apex:commandLink action="{!item.deleteAction}" title="{!$Label.JEOL_QuotEdit_Label_RemoveRow}" onclick="lockSafety();" rerender="detailAreaB,modalListView,modalListViewDel,SubtotalA,SubtotalB,SubtotalC,SubtotalD,SubtotalE,SubtotalF,SubtotalG,totalResult,apexMessage" styleClass="quotation-detail-action deleteAction" status="ajaxStatusB" >×</apex:commandLink>
                                </div>
                                
                              </apex:outputPanel>
                              
                              
                              <!-- SUMMARY ROW -->
                              <apex:outputPanel id="detail_titleB" layout="block" html-data-depth="{!item.rec.Depth__c}" html-data-sortNo="{!item.rec.SortNo__c}" html-data-section-type="B" html-data-type="{!item.rec.Type__c}" html-data-forbidden-target="{!item.rec.AccompanyingPaperOutput__c}" styleClass="quotation-detail-item quotation-detail-itemB clearfix" rendered="{!item.rec.Type__c = '2'}">
                                <div class="{!IF((isReadOnly || isQTRestricted),'hidden','field')}">
                                  <div class="quotation-detail-action sortableAction sortableActionB" onmousedown="dragActionB(this);" >
                                    <div class="sortable-pointer"></div>
                                  </div>
                                </div>
                                <div class="{!IF((isReadOnly || isQTRestricted),'hidden','field')}">
                                  <div class="quotation-detail-action configAction">
                                    <apex:outputLink value="javascript: void(0);" onclick="removeDepth(this);lockSafety();return false;" styleClass="paragraph-option paragraph-up">&lsaquo;</apex:outputLink>
                                    <apex:outputLink value="javascript: void(0);" onclick="addDepth(this);lockSafety();return false;" styleClass="paragraph-option paragraph-down">&rsaquo;</apex:outputLink>
                                  </div>
                                </div>
                                <div class="hidden">
                                  <apex:inputHidden html-class="quotation-detail-sortNo" value="{!item.rec.SortNo__c}" />
                                  <apex:inputHidden html-class="quotation-detail-depth" value="{!item.rec.Depth__c}" />
                                </div>
                                <div class="field" style="overflow-x: hidden;{!IF((isReadOnly || isQTRestricted),'margin-left: 86px;width: 803px;','')}">
                                  <div class="indent-wrap">
                                    <apex:inputField rendered="{!!(isReadOnly || isQTRestricted)}" styleClass="field-value quotation-detail-headingBody" value="{!item.rec.Body__c}" onfocus="detailBodyFocus(this);" onblur="safetyLockCheck(this);detailBodyBlur(this);" html-data-compare-value="{!item.rec.Body__c}" />
                                    <apex:outputText rendered="{!(isReadOnly || isQTRestricted)}"  styleClass="field-value quotation-detail-headingBody" value="{!item.rec.Body__c}" />
                                  </div>
                                </div>
                                <div class="field">
                                  <div class="panel-area clearfix" >
<!--
                                    <div class="option-view-panel" ></div>
                                    <div class="option-view-panel" ></div>
                                    <div class="option-view-panel" ></div>
                                    <div class="option-view-panel accompanyingPaperOutput" data-target-class="isAccompanyingPaperOutput" onclick="optionSettingFromPanelClick(this);lockSafety();">{!$Label.JEOL_QuotEdit_Label_SeparateSheetShort}</div>
                                    <div class="option-view-panel" ></div>
-->
                                  </div>
                                </div>
                                <div class="{!IF((isReadOnly || isQTRestricted),'hidden','field')}" data-type="dropdown">
                                  <button type="button" onclick="dorpdownAction(this);" data-type="button" class="optionalButton">▼</button>
                                  <ul class="detail-options" data-type="list" style="{!IF(language <> 'ja', 'width: 225px;', '')}">
                                    <li style="height: 30px;{!IF(language <> 'ja', 'width: 225px;', '')}" class="{!IF((isReadOnly || isQTRestricted),'hidden','field detail-options-item')}" data-type="item">
                                      <apex:commandLink action="{!item.copyAction}" title="{!$Label.JEOL_QuotEdit_Label_CloneRow}" onclick="lockSafety();clearAction(this);" rerender="detailAreaB,modalListView,modalListViewDel,SubtotalA,SubtotalB,SubtotalC,SubtotalD,SubtotalE,SubtotalF,SubtotalG,totalResult,apexMessage" styleClass="quotation-detail-action" status="ajaxStatusB" style="{!IF(language <> 'ja', 'width: 225px;', '')}">{!$Label.JEOL_QuotEdit_Label_CloneRow}</apex:commandLink>
                                    </li>

<!--
                                    <li class="{!IF(isReadOnly,'hidden','')}" ><hr/></li>

                                    <li style="height: 30px;{!IF(language <> 'ja', 'width: 225px;', '')}" class="field detail-options-item" data-type="item">
                                      <div class="accompanyingPaperOutput"></div>
                                      <apex:outputLabel for="isAccompanyingPaperOutput-breakdownB" value="{!$Label.JEOL_QuotEdit_Label_SeparateSheet}" styleClass="field-label" style="{!IF(language <> 'ja', 'width: 175px;', '')}" />
                                      <apex:inputField id="isAccompanyingPaperOutput-breakdownB" value="{!item.rec.AccompanyingPaperOutput__c}" html-data-target="data-forbidden-target" styleClass="field-value isAccompanyingPaperOutput" onchange="optionSetting(this);" html-data-compare-value="{!item.rec.AccompanyingPaperOutput__c}" onblur="safetyLockCheck(this);" />
                                    </li>
-->

                                    <li><hr/></li>
                                    <li style="height: 30px;{!IF(language <> 'ja', 'width: 225px;', '')}" class="field detail-options-item close-option" data-type="item">
                                      <apex:outputLink value="javascript: void(0);" styleClass="closeButton" onclick="clearAction(this);$j(this).closest('[data-type=\'dropdown\']').find('[data-type=\'button\']').trigger('focus');return false;" >{!$Label.JEOL_QuotEdit_Label_Close}</apex:outputLink>
                                    </li>
                                  </ul>
                                </div>
                                <div class="{!IF((isReadOnly || isQTRestricted),'hidden','field')}" >
                                  <apex:commandLink action="{!item.deleteAction}" title="{!$Label.JEOL_QuotEdit_Label_RemoveRow}" onclick="lockSafety();" rerender="detailAreaB,modalListView,modalListViewDel,SubtotalA,SubtotalB,SubtotalC,SubtotalD,SubtotalE,SubtotalF,SubtotalG,totalResult,apexMessage" styleClass="quotation-detail-action deleteAction" status="ajaxStatusB" >×</apex:commandLink>
                                </div>
                              </apex:outputPanel>
                              
                            </apex:repeat>
                          </apex:outputPanel>
                          <apex:outputPanel layout="none" rendered="{!!hasDetailsB}">
                            <div style="padding: 10px; margin: 2px 0px;">{!$Label.JEOL_QuotEdit_Message_DetailNotCreated}</div>
                          </apex:outputPanel>
                        </apex:outputPanel>
                        <apex:actionStatus layout="block" onstop="initWithCalcurate();focusOpenModalDetail();" id="ajaxStatusB" startStyleClass="ajax-status-start">
                          <apex:facet name="start">
                            <div class="ajax-status-start-inner ajax-loading">
                              <span style="position:relative; z-index: 2;">{!$Label.JEOL_QuotEdit_Label_Searching}</span>
                            </div>
                          </apex:facet>
                        </apex:actionStatus>
                        <hr />

                      </apex:outputPanel>
                        
                      <!-- Add New Item button -->
                      <div class="quotation-item create-action-area" >
                        <div class="quotation-item-body clearfix" >
                          <div class="{!IF((isReadOnly || isQTRestricted),'hidden','field clearfix top')}" data-type="dropdown">
                            <apex:commandLink rerender="detailAreaB,modalListView,modalListViewDel,apexMessage" action="{!qdm.createQuotationDetailB}" oncomplete="lockSafety();showResult('{!$Label.JEOL_QuotEdit_Message_ProcessingCompleted}');" styleClass="add-default-detail customButton" status="ajaxStatusB" >{!$Label.JEOL_QuotEdit_Label_AddNewItem}</apex:commandLink>
                            <apex:outputLink value="javascript: void(0);" onclick="dorpdownAction(this);return false;" html-data-type="button" styleClass="add-optional-details customButton">▲</apex:outputLink>
                            <ul class="optional-list" data-type="list">
                              <li data-type="item">
                                <apex:commandLink styleClass="optional-item" oncomplete="lockSafety();showResult('{!$Label.JEOL_QuotEdit_Message_ProcessingCompleted}');" rerender="detailAreaB,modalListView,modalListViewDel,apexMessage" action="{!qdm.createQuotationDetailBx5}" status="ajaxStatusB" >{!$Label.JEOLAsia_QuotEdit_Label_AddNewItemx5}</apex:commandLink>
                              </li>
                              <li data-type="item">
                                <apex:commandLink styleClass="optional-item" oncomplete="lockSafety();showResult('{!$Label.JEOL_QuotEdit_Message_ProcessingCompleted}');" rerender="detailAreaB,modalListView,modalListViewDel,apexMessage" action="{!qdm.createQuotationDetailB}" status="ajaxStatusB" >{!$Label.JEOL_QuotEdit_Label_AddNewItem}</apex:commandLink>
                              </li>
                              <li data-type="item">
                                <apex:commandLink styleClass="optional-item" oncomplete="lockSafety();showResult('{!$Label.JEOL_QuotEdit_Message_ProcessingCompleted}');" rerender="detailAreaB,modalListView,modalListViewDel,apexMessage" action="{!qdm.createHeadingDetailB}" status="ajaxStatusB">{!$Label.JEOL_QuotEdit_Label_AddHeading}</apex:commandLink>
                              </li>
                              <li><hr/></li>
                              <li class="field close-option" data-type="item">
                                <apex:outputLink value="javascript: void(0);" styleClass="optional-item closeButton" onclick="clearAction(this);$j(this).closest('[data-type=\'dropdown\']').find('[data-type=\'button\']').trigger('focus');return false;" >{!$Label.JEOL_QuotEdit_Label_Close}</apex:outputLink>
                              </li>
                            </ul>
                          </div>
                        </div>
                      </div>

                      <!-- SUMMARY SECTION -->
                      <div class="quotation-item total-amount-area" >
                        <apex:outputPanel layout="block" styleClass="quotation-item-body clearfix" id="SubtotalB">
                          <div class="hidden" >
                            <apex:inputHidden html-class="fieldSubtotalB" value="{!qdm.parentRec.SubtotalB__c}" />
                          </div>

                          <div class="field" >
                            <div class="field-label">
                              <apex:outputLabel for="quotationSubtotalB" value="Subtotal ({!qdm.parentRec.SalesCurrency__c})" style="padding: 8px; background-color: #DDDDDD;" />
                            </div>
                            <apex:outputText id="quotationSubtotalB" styleClass="field-value quotationSubtotalBOutput number" value="{0,number, ###,###,###,###,###,##0.00}" style="font-size: 13px;" >
                              <apex:param value="{!qdm.parentRec.SubtotalB__c}" />
                            </apex:outputText>
                          </div>
                        </apex:outputPanel>
                      </div>
                    </apex:outputPanel>




                    <apex:outputPanel >


                      <apex:outputPanel layout="block" id="detailAreaC"  styleClass="quotation-item quotation-detail-informations" >
                        <apex:variable value="{!qdm.currentSizeC > 0}" var="hasDetailsC" />

                        <div class="quotation-item-header clearfix" style="height: 38px;">
                          <div class="header-title">{!$Label.JEOLAsia_ProfitCalculation_WarrantyInformations}</div>
                        </div>

                        <!-- GRID 3 -->
                        <!-- Grid of items -->
                        <div class="quotation-item-header quotation-detail-header backgroundcolorgrey clearfix">
                          <div class="quotation-detail-header-item quotation-detail-productName quotation-detailC-productName" style="margin-left: 94px;">Product Name</div>
                          <div class="quotation-detail-header-item quotation-detail-Description quotation-detailC-Description">Description</div>
                          <div class="quotation-detail-header-item quotation-detail-quantity quotation-detailC-quantity">Qty</div>
                          <div class="quotation-detail-header-item quotation-detail-UnitPrice quotation-detailC-UnitPrice">Unit Price</div>
                          <div class="quotation-detail-header-item quotation-detail-CatalogCurrency quotation-detailC-CatalogCurrency">Cur</div>
                          <div class="quotation-detail-header-item quotation-detail-CostPrice quotation-detailC-CostPrice">Cost Price<br/>({!qdm.parentRec.SalesCurrency__c})</div>
                          <div class="quotation-detail-header-item quotation-detail-SalesPrice quotation-detailC-SalesPrice">Sales Price<br/>({!qdm.parentRec.SalesCurrency__c})</div>
                          <div class="quotation-detail-header-item quotation-detail-Remarks quotation-detailC-Remarks">Remarks</div>
                        </div>
                        <apex:outputPanel layout="block" styleClass="quotation-item-body clearfix quotation-detail-list quotation-detail-listC">
                          <apex:outputPanel layout="none" rendered="{!hasDetailsC}">
                            <apex:repeat value="{!qdm.itemsC}" var="item" >
                            
                              <!-- NORMAL ROW -->
                              <apex:outputPanel id="detail_productC"
                                                layout="block"
                                                html-data-depth="{!item.rec.Depth__c}"
                                                html-data-sortNo="{!item.rec.SortNo__c}" 
                                                html-data-section-type="C"
                                                html-data-type="{!item.rec.Type__c}" 
                                                html-data-discount-target="{!item.rec.IsDiscountTarget__c}"
                                                html-data-tax-target="{!item.rec.IsTaxationTarget__c}" 
                                                html-data-overhead-target="{!item.rec.IsOverheadTarget__c}"
                                                html-data-show-target="{!item.rec.IsShowDetailAmount__c}"
                                                html-data-forbidden-target="{!item.rec.AccompanyingPaperOutput__c}"
                                                styleClass="quotation-detail-item quotation-detail-itemC clearfix"
                                                rendered="{!item.rec.Type__c = '1'}">
                                <div class="{!IF((isReadOnly || isQTRestricted),'hidden','field')}">
                                  <div class="quotation-detail-action sortableAction sortableActionC" onmousedown="dragActionC(this);" >
                                    <div class="sortable-pointer"></div>
                                  </div>
                                </div>
                                <div class="{!IF((isReadOnly || isQTRestricted),'hidden','field')}">
                                  <div class="quotation-detail-action configAction clearfix">
                                    <apex:outputLink value="javascript: void(0);" onclick="removeDepth(this);lockSafety();return false;" styleClass="paragraph-option paragraph-up">&lsaquo;</apex:outputLink>
                                    <apex:outputLink value="javascript: void(0);" onclick="addDepth(this);lockSafety();return false;" styleClass="paragraph-option paragraph-down">&rsaquo;</apex:outputLink>
                                  </div>
                                </div>
                                <div class="hidden">
                                  <apex:inputHidden html-class="quotation-detail-Amount-input" value="{!item.rec.Amount__c}" />
                                  <apex:inputHidden html-class="quotation-detail-sortNo" value="{!item.rec.SortNo__c}" />
                                  <apex:inputHidden html-class="quotation-detail-depth" value="{!item.rec.Depth__c}" />
                                  <apex:inputHidden html-class="quotation-detail-CostPrice-input" value="{!item.rec.CostPrice__c}" />
                                  <apex:inputHidden html-class="quotation-detail-CostPriceJProdUnit" value="{!item.rec.CostPriceJProdUnit__c}" />
                                </div>



                                <!-- BODY__c -->
                                <div class="field" style="overflow-x: hidden;{!IF((isReadOnly || isQTRestricted),'margin-left: 86px;width: 200px;','')}" >
                                  <div class="indent-wrap" >
                                    <apex:inputField rendered="{!!(isReadOnly || isQTRestricted)}" id="quotation-detail-productNameC" styleClass="field-value quotation-detail-productName quotation-detailC-productName" value="{!item.rec.Body__c}" html-data-compare-value="{!item.rec.Body__c}" onfocus="detailBodyFocus(this);" onblur="detailBodyBlur(this);safetyLockCheck(this);" html-placeholder="{!$Label.JEOL_QuotEdit_Label_ProductName}" ></apex:inputField>
                                    <apex:outputText rendered="{!(isReadOnly || isQTRestricted)}" id="quotation-detail-productNameCView" styleClass="field-value quotation-detail-productName quotation-detailC-productName" value="{!item.rec.Body__c}" style="width: 200px;"/>
                                  </div>
                                </div>

                                <!-- DESCRIPTION__c -->
                                <div class="field clearfix">
                                  <apex:inputField rendered="{!!(isReadOnly || isQTRestricted)}" value="{!item.rec.Description__c}" styleClass="field-value quotation-detail-Description quotation-detailC-Description" html-placeholder="Description" html-data-compare-value="{!item.rec.Description__c}" onblur="safetyLockCheck(this);" onkeypress="return disableEnterKey(event)"/>
                                  <apex:outputText rendered="{!(isReadOnly || isQTRestricted)}" value="{!item.rec.Description__c}" styleClass="field-value quotation-detail-Description quotation-detailC-Description" /> 
                                </div>

                                <!-- QUANTITY -->
                                <div class="field">
                                  <apex:inputField rendered="{!!(isReadOnly || isQTRestricted)}" styleClass="field-value quotation-detail-quantity quotation-detailC-quantity number " value="{!item.rec.Quantity__c}" onchange="calcurate();" html-data-compare-value="{!item.rec.Quantity__c}" onblur="safetyLockCheck(this);" onkeypress="return disableEnterKey(event)" />
                                  <apex:outputText rendered="{!(isReadOnly || isQTRestricted)}" styleClass="field-value quotation-detail-quantity quotation-detailC-quantity number " value="{0,number, ###,###,###,###,###,##0.0}">
                                    <apex:param value="{!item.rec.Quantity__c}" />
                                  </apex:outputText>

                                </div>

                                <!-- UNIT PRICE -->
                                <div class="field">
                                  <apex:inputField rendered="{!!(isReadOnly || isQTRestricted)}" styleClass="field-value quotation-detail-UnitPrice quotation-detailC-UnitPrice number " value="{!item.rec.UnitPrice__c}" onchange="calcurate();" html-data-compare-value="{!item.rec.UnitPrice__c}" onblur="safetyLockCheck(this);" onkeypress="return disableEnterKey(event)" />

                                  <apex:inputHidden rendered="{!(isReadOnly || isQTRestricted)}" Html-Class="field-value quotation-detail-UnitPrice quotation-detailC-UnitPrice number " value="{!item.rec.UnitPrice__c}" />

                                  <apex:outputText rendered="{!(isReadOnly || isQTRestricted)}" styleClass="field-value quotation-detail-UnitPrice quotation-detailC-UnitPrice number " value="{0,number, ###,###,###,###,###,##0.00}" >
                                    <apex:param value="{!item.rec.UnitPrice__c}" />
                                  </apex:outputText>

                                </div>

                                <!-- CATALOG CURRENCY -->
                                <div class="field">
                                  <apex:selectList rendered="{!!(isReadOnly || isQTRestricted)}" styleClass="field-value quotation-detail-CatalogCurrency quotation-detailC-CatalogCurrency" value="{!item.rec.CatalogCurrency__c}" size="1" html-data-compare-value="{!item.rec.CatalogCurrency__c}" onblur="safetyLockCheck(this);" required="true" onchange="calcurate();" onkeypress="return disableEnterKey(event)" >
                                      <apex:selectOptions value="{!listOtherCurrencyOption}"/> 
                                  </apex:selectList>

                                  <apex:inputHidden rendered="{!(isReadOnly || isQTRestricted)}" Html-Class="field-value quotation-detail-CatalogCurrency quotation-detailC-CatalogCurrency number " value="{!item.rec.CatalogCurrency__c}" />

                                  <apex:outputText rendered="{!(isReadOnly || isQTRestricted)}" styleClass="field-value quotation-detail-CatalogCurrency quotation-detailC-CatalogCurrency number " value="{!item.rec.CatalogCurrency__c}" />
                                </div>

                                <!-- COST PRICE -->
                                <div class="field">
                                  <apex:outputText styleClass="field-value quotation-detail-CostPrice quotation-detailC-CostPrice number" value="{0,number, ###,###,###,###,###,##0.00}" >
                                    <apex:param value="{!item.rec.CostPrice__c}" />
                                  </apex:outputText>
                                </div> 

                                <!-- SALES PRICE -->
                                <div class="field">
                                  <apex:inputField rendered="{!!(isReadOnly || isQTRestricted)}" styleClass="field-value quotation-detail-SalesPrice quotation-detailC-SalesPrice number " value="{!item.rec.SalesPrice__c}" onchange="calcurate();" html-data-compare-value="{!item.rec.SalesPrice__c}" onblur="safetyLockCheck(this);" onkeypress="return disableEnterKey(event)" />
                                  <apex:outputText rendered="{!(isReadOnly || isQTRestricted)}" styleClass="field-value quotation-detail-SalesPrice quotation-detailC-SalesPrice number" value="{0,number, ###,###,###,###,###,##0.00}" >
                                    <apex:param value="{!item.rec.SalesPrice__c}" />
                                  </apex:outputText>
                                </div> 

                                <!-- REMARKS__c -->
                                <div class="field clearfix">
                                  <apex:inputField rendered="{!!(isReadOnly || isQTRestricted)}" value="{!item.rec.Remarks__c}" styleClass="field-value quotation-detail-Remarks quotation-detailC-Remarks" html-placeholder="Remarks" html-data-compare-value="{!item.rec.Remarks__c}" onblur="safetyLockCheck(this);" onkeypress="return disableEnterKey(event)" />
                                  <apex:outputText rendered="{!(isReadOnly || isQTRestricted)}" value="{!item.rec.Remarks__c}" styleClass="field-value quotation-detail-Remarks quotation-detailC-Remarks" /> 
                                </div>



                                <div class="field">
                                  <div class="panel-area clearfix" >
                                    <div class="option-view-panel showAmount" data-target-class="isShowDetailAmountTarget" onclick="optionSettingFromPanelClick(this);lockSafety();">1</div>
<!--
                                    <div class="option-view-panel tax" data-target-class="isTaxationTarget" onclick="{!IF((isReadOnly || isQTRestricted),'','optionSettingFromPanelClick(this);calcurate();lockSafety();')}">{!$Label.JEOL_QuotEdit_Label_TaxableShort}</div>
                                    <div class="option-view-panel overhead" data-target-class="isOverheadTarget" onclick="{!IF((isReadOnly || isQTRestricted),'','optionSettingFromPanelClick(this);calcurate();lockSafety();')}">{!$Label.JEOL_QuotEdit_Label_SundryRelatedShort}</div>
                                    <div class="option-view-panel accompanyingPaperOutput" data-target-class="isAccompanyingPaperOutput" onclick="optionSettingFromPanelClick(this);lockSafety();">{!$Label.JEOL_QuotEdit_Label_SeparateSheetShort}</div>
-->
                                  </div>
                                </div>
                                <div class="field" data-type="dropdown">
                                  <button type="button" onclick="dorpdownAction(this);" data-type="button" class="optionalButton">▼</button>
                                  <ul class="detail-options" data-type="list"  style="{!IF(language <> 'ja', 'width: 225px;', '')}">
                                    <li style="height: 30px;width: 225px;" class="{!IF((isReadOnly || isQTRestricted),'hidden','field detail-options-item')}" data-type="item">
                                      <apex:commandLink action="{!item.copyAction}" title="{!$Label.JEOL_QuotEdit_Label_CloneRow}" onclick="lockSafety();clearAction(this);" rerender="detailAreaC,modalListView,modalListViewDel,SubtotalA,SubtotalB,SubtotalC,SubtotalD,SubtotalE,SubtotalF,SubtotalG,totalResult,apexMessage" styleClass="quotation-detail-action" status="ajaxStatusC"  style="{!IF(language <> 'ja', 'width: 225px;', '')}" >{!$Label.JEOL_QuotEdit_Label_CloneRow}</apex:commandLink>
                                    </li>

                                    <li class="{!IF((isReadOnly || isQTRestricted),'hidden','')}"><hr/></li>

                                    <li style="height: 30px;{!IF(language <> 'ja', 'width: 225px;', '')}" class="field detail-options-item" data-type="item" >
                                      <div class="showAmount"></div>
                                      <apex:outputLabel for="isShowDetailAmountTargetC" value="1. Show detail amount" styleClass="field-label" style="{!IF(language <> 'ja', 'width: 175px;', '')}" />
                                      <apex:inputField id="isShowDetailAmountTargetC" value="{!item.rec.IsShowDetailAmount__c}" html-data-target="data-show-target" styleClass="isShowDetailAmountTarget" onchange="optionSetting(this);" html-data-compare-value="{!item.rec.IsShowDetailAmount__c}" onblur="safetyLockCheck(this);" onkeypress="return disableEnterKey(event)" />
                                    </li>

<!--
                                    <li style="height: 30px;{!IF(language <> 'ja', 'width: 225px;', '')}" class="field detail-options-item" data-type="item">
                                      <div class="tax"></div>
                                      <apex:outputLabel for="isTaxationTargetC" value="{!$Label.JEOL_QuotEdit_Label_Taxable}" styleClass="field-label" style="{!IF(language <> 'ja', 'width: 175px;', '')}" />
                                      <apex:inputField rendered="{!!(isReadOnly || isQTRestricted)}" id="isTaxationTargetC" value="{!item.rec.IsTaxationTarget__c}" html-data-target="data-tax-target" styleClass="isTaxationTarget"  onchange="optionSetting(this);calcurate();" html-data-compare-value="{!item.rec.IsTaxationTarget__c}" onblur="safetyLockCheck(this);" />
                                      <apex:inputcheckbox rendered="{!(isReadOnly || isQTRestricted)}" disabled="true" id="isTaxationTargetCView" value="{!item.rec.IsTaxationTarget__c}" />
                                    </li>
                                    <li style="height: 30px;{!IF(language <> 'ja', 'width: 225px;', '')}" class="field detail-options-item" data-type="item" >
                                      <div class="overhead"></div>
                                      <apex:outputLabel for="isOverheadTargetC" value="{!$Label.JEOL_QuotEdit_Label_SundryRelated}" styleClass="field-label" style="{!IF(language <> 'ja', 'width: 175px;', '')}" />
                                      <apex:inputField rendered="{!!(isReadOnly || isQTRestricted)}" id="isOverheadTargetC" value="{!item.rec.IsOverheadTarget__c}" html-data-target="data-overhead-target" styleClass="isOverheadTarget" onchange="optionSetting(this);calcurate();" html-data-compare-value="{!item.rec.IsOverheadTarget__c}" onblur="safetyLockCheck(this);" />
                                      <apex:inputcheckbox rendered="{!(isReadOnly || isQTRestricted)}" disabled="true" id="isOverheadTargetCView" value="{!item.rec.IsOverheadTarget__c}" />
                                    </li>
                                    <li style="height: 30px;{!IF(language <> 'ja', 'width: 225px;', '')}" class="field detail-options-item" data-type="item" >
                                      <div class="accompanyingPaperOutput"></div>
                                      <apex:outputLabel for="isAccompanyingPaperOutputC" value="{!$Label.JEOL_QuotEdit_Label_SeparateSheet}" styleClass="field-label" style="{!IF(language <> 'ja', 'width: 175px;', '')}" />
                                      <apex:inputField id="isAccompanyingPaperOutputC" value="{!item.rec.AccompanyingPaperOutput__c}" html-data-target="data-forbidden-target" styleClass="isAccompanyingPaperOutput" onchange="optionSetting(this);" html-data-compare-value="{!item.rec.AccompanyingPaperOutput__c}" onblur="safetyLockCheck(this);" />
                                    </li>
-->
                                    <li><hr/></li>
                                    <li style="height: 30px;{!IF(language <> 'ja', 'width: 225px;', '')}" class="field detail-options-item close-option" data-type="item" >
                                      <apex:outputLink value="javascript: void(0);" styleClass="closeButton" onclick="clearAction(this);$j(this).closest('[data-type=\'dropdown\']').find('[data-type=\'button\']').trigger('focus');return false;"  style="{!IF(language <> 'ja', 'width: 225px;', '')}" >{!$Label.JEOL_QuotEdit_Label_Close}</apex:outputLink>
                                    </li>
                                  </ul>
                                </div>
                                <div class="{!IF((isReadOnly || isQTRestricted),'hidden','field')}">
                                  <apex:commandLink action="{!item.deleteAction}" title="{!$Label.JEOL_QuotEdit_Label_RemoveRow}" onclick="lockSafety();" rerender="detailAreaC,modalListView,modalListViewDel,SubtotalA,SubtotalB,SubtotalC,SubtotalD,SubtotalE,SubtotalF,SubtotalG,totalResult,apexMessage" styleClass="quotation-detail-action deleteAction" status="ajaxStatusC" >×</apex:commandLink>
                                </div>
                                
                              </apex:outputPanel>
                              
                              
                              <!-- SUMMARY ROW -->
                              <apex:outputPanel id="detail_titleC" layout="block" html-data-depth="{!item.rec.Depth__c}" html-data-sortNo="{!item.rec.SortNo__c}" html-data-section-type="C" html-data-type="{!item.rec.Type__c}" html-data-forbidden-target="{!item.rec.AccompanyingPaperOutput__c}" styleClass="quotation-detail-item quotation-detail-itemC clearfix" rendered="{!item.rec.Type__c = '2'}">
                                <div class="{!IF((isReadOnly || isQTRestricted),'hidden','field')}">
                                  <div class="quotation-detail-action sortableAction sortableActionC" onmousedown="dragActionC(this);" >
                                    <div class="sortable-pointer"></div>
                                  </div>
                                </div>
                                <div class="{!IF((isReadOnly || isQTRestricted),'hidden','field')}">
                                  <div class="quotation-detail-action configAction">
                                    <apex:outputLink value="javascript: void(0);" onclick="removeDepth(this);lockSafety();return false;" styleClass="paragraph-option paragraph-up">&lsaquo;</apex:outputLink>
                                    <apex:outputLink value="javascript: void(0);" onclick="addDepth(this);lockSafety();return false;" styleClass="paragraph-option paragraph-down">&rsaquo;</apex:outputLink>
                                  </div>
                                </div>
                                <div class="hidden">
                                  <apex:inputHidden html-class="quotation-detail-sortNo" value="{!item.rec.SortNo__c}" />
                                  <apex:inputHidden html-class="quotation-detail-depth" value="{!item.rec.Depth__c}" />
                                </div>
                                <div class="field" style="overflow-x: hidden;{!IF((isReadOnly || isQTRestricted),'margin-left: 86px;width: 803px;','')}">
                                  <div class="indent-wrap">
                                    <apex:inputField rendered="{!!(isReadOnly || isQTRestricted)}" styleClass="field-value quotation-detail-headingBody" value="{!item.rec.Body__c}" onfocus="detailBodyFocus(this);" onblur="safetyLockCheck(this);detailBodyBlur(this);" html-data-compare-value="{!item.rec.Body__c}" />
                                    <apex:outputText rendered="{!(isReadOnly || isQTRestricted)}"  styleClass="field-value quotation-detail-headingBody" value="{!item.rec.Body__c}" />
                                  </div>
                                </div>
                                <div class="field">
                                  <div class="panel-area clearfix" >
<!--
                                    <div class="option-view-panel" ></div>
                                    <div class="option-view-panel" ></div>
                                    <div class="option-view-panel" ></div>
                                    <div class="option-view-panel accompanyingPaperOutput" data-target-class="isAccompanyingPaperOutput" onclick="optionSettingFromPanelClick(this);lockSafety();">{!$Label.JEOL_QuotEdit_Label_SeparateSheetShort}</div>
                                    <div class="option-view-panel" ></div>
-->
                                  </div>
                                </div>
                                <div class="{!IF((isReadOnly || isQTRestricted),'hidden','field')}" data-type="dropdown">
                                  <button type="button" onclick="dorpdownAction(this);" data-type="button" class="optionalButton">▼</button>
                                  <ul class="detail-options" data-type="list" style="{!IF(language <> 'ja', 'width: 225px;', '')}">
                                    <li style="height: 30px;{!IF(language <> 'ja', 'width: 225px;', '')}" class="{!IF((isReadOnly || isQTRestricted),'hidden','field detail-options-item')}" data-type="item">
                                      <apex:commandLink action="{!item.copyAction}" title="{!$Label.JEOL_QuotEdit_Label_CloneRow}" onclick="lockSafety();clearAction(this);" rerender="detailAreaC,modalListView,modalListViewDel,SubtotalA,SubtotalB,SubtotalC,SubtotalD,SubtotalE,SubtotalF,SubtotalG,totalResult,apexMessage" styleClass="quotation-detail-action" status="ajaxStatusC" style="{!IF(language <> 'ja', 'width: 225px;', '')}">{!$Label.JEOL_QuotEdit_Label_CloneRow}</apex:commandLink>
                                    </li>

<!--
                                    <li class="{!IF((isReadOnly || isQTRestricted),'hidden','')}" ><hr/></li>

                                    <li style="height: 30px;{!IF(language <> 'ja', 'width: 225px;', '')}" class="field detail-options-item" data-type="item">
                                      <div class="accompanyingPaperOutput"></div>
                                      <apex:outputLabel for="isAccompanyingPaperOutput-breakdownC" value="{!$Label.JEOL_QuotEdit_Label_SeparateSheet}" styleClass="field-label" style="{!IF(language <> 'ja', 'width: 175px;', '')}" />
                                      <apex:inputField id="isAccompanyingPaperOutput-breakdownC" value="{!item.rec.AccompanyingPaperOutput__c}" html-data-target="data-forbidden-target" styleClass="field-value isAccompanyingPaperOutput" onchange="optionSetting(this);" html-data-compare-value="{!item.rec.AccompanyingPaperOutput__c}" onblur="safetyLockCheck(this);" />
                                    </li>
-->

                                    <li><hr/></li>

                                    <li style="height: 30px;{!IF(language <> 'ja', 'width: 225px;', '')}" class="field detail-options-item close-option" data-type="item">
                                      <apex:outputLink value="javascript: void(0);" styleClass="closeButton" onclick="clearAction(this);$j(this).closest('[data-type=\'dropdown\']').find('[data-type=\'button\']').trigger('focus');return false;" >{!$Label.JEOL_QuotEdit_Label_Close}</apex:outputLink>
                                    </li>
                                  </ul>
                                </div>
                                <div class="{!IF((isReadOnly || isQTRestricted),'hidden','field')}" >
                                  <apex:commandLink action="{!item.deleteAction}" title="{!$Label.JEOL_QuotEdit_Label_RemoveRow}" onclick="lockSafety();" rerender="detailAreaC,modalListView,modalListViewDel,SubtotalA,SubtotalB,SubtotalC,SubtotalD,SubtotalE,SubtotalF,SubtotalG,totalResult,apexMessage" styleClass="quotation-detail-action deleteAction" status="ajaxStatusC" >×</apex:commandLink>
                                </div>
                              </apex:outputPanel>
                              
                            </apex:repeat>
                          </apex:outputPanel>
                          <apex:outputPanel layout="none" rendered="{!!hasDetailsC}">
                            <div style="padding: 10px; margin: 2px 0px;">{!$Label.JEOL_QuotEdit_Message_DetailNotCreated}</div>
                          </apex:outputPanel>
                        </apex:outputPanel>
                        <apex:actionStatus layout="block" onstop="initWithCalcurate();focusOpenModalDetail();" id="ajaxStatusC" startStyleClass="ajax-status-start">
                          <apex:facet name="start">
                            <div class="ajax-status-start-inner ajax-loading">
                              <span style="position:relative; z-index: 2;">{!$Label.JEOL_QuotEdit_Label_Searching}</span>
                            </div>
                          </apex:facet>
                        </apex:actionStatus>
                        <hr />

                      </apex:outputPanel>
                        
                      <!-- Add New Item button -->
                      <div class="quotation-item create-action-area" >
                        <div class="quotation-item-body clearfix" >
                          <div class="{!IF((isReadOnly || isQTRestricted),'hidden','field clearfix top')}" data-type="dropdown">
                            <apex:commandLink rerender="detailAreaC,modalListView,modalListViewDel,apexMessage" action="{!qdm.createQuotationDetailC}" oncomplete="lockSafety();showResult('{!$Label.JEOL_QuotEdit_Message_ProcessingCompleted}');" styleClass="add-default-detail customButton" status="ajaxStatusC" >{!$Label.JEOL_QuotEdit_Label_AddNewItem}</apex:commandLink>
                            <apex:outputLink value="javascript: void(0);" onclick="dorpdownAction(this);return false;" html-data-type="button" styleClass="add-optional-details customButton">▲</apex:outputLink>
                            <ul class="optional-list" data-type="list">
                              <li data-type="item">
                                <apex:commandLink styleClass="optional-item" oncomplete="lockSafety();showResult('{!$Label.JEOL_QuotEdit_Message_ProcessingCompleted}');" rerender="detailAreaC,modalListView,modalListViewDel,apexMessage" action="{!qdm.createQuotationDetailCx5}" status="ajaxStatusC" >{!$Label.JEOLAsia_QuotEdit_Label_AddNewItemx5}</apex:commandLink>
                              </li>
                              <li data-type="item">
                                <apex:commandLink styleClass="optional-item" oncomplete="lockSafety();showResult('{!$Label.JEOL_QuotEdit_Message_ProcessingCompleted}');" rerender="detailAreaC,modalListView,modalListViewDel,apexMessage" action="{!qdm.createQuotationDetailC}" status="ajaxStatusC" >{!$Label.JEOL_QuotEdit_Label_AddNewItem}</apex:commandLink>
                              </li>
                              <li data-type="item">
                                <apex:commandLink styleClass="optional-item" oncomplete="lockSafety();showResult('{!$Label.JEOL_QuotEdit_Message_ProcessingCompleted}');" rerender="detailAreaC,modalListView,modalListViewDel,apexMessage" action="{!qdm.createHeadingDetailC}" status="ajaxStatusC">{!$Label.JEOL_QuotEdit_Label_AddHeading}</apex:commandLink>
                              </li>
                              <li><hr/></li>
                              <li class="field close-option" data-type="item">
                                <apex:outputLink value="javascript: void(0);" styleClass="optional-item closeButton" onclick="clearAction(this);$j(this).closest('[data-type=\'dropdown\']').find('[data-type=\'button\']').trigger('focus');return false;" >{!$Label.JEOL_QuotEdit_Label_Close}</apex:outputLink>
                              </li>
                            </ul>
                          </div>
                        </div>
                      </div>

                      <!-- SUMMARY SECTION -->
                      <div class="quotation-item total-amount-area" >
                        <apex:outputPanel layout="block" styleClass="quotation-item-body clearfix" id="SubtotalC">
                          <div class="hidden" >
                            <apex:inputHidden html-class="fieldSubtotalC" value="{!qdm.parentRec.SubtotalC__c}" />
                          </div>

                          <div class="field" >
                            <div class="field-label">
                              <apex:outputLabel for="quotationSubtotalC" value="Subtotal ({!qdm.parentRec.SalesCurrency__c})" style="padding: 8px; background-color: #DDDDDD;" />
                            </div>
                            <apex:outputText id="quotationSubtotalC" styleClass="field-value quotationSubtotalCOutput number" value="{0,number, ###,###,###,###,###,##0.00}" style="font-size: 13px;" >
                              <apex:param value="{!qdm.parentRec.SubtotalC__c}" />
                            </apex:outputText>
                          </div>
                        </apex:outputPanel>
                      </div>
                    </apex:outputPanel>








                    <apex:outputPanel >

                      <apex:outputPanel layout="block" id="detailAreaD"  styleClass="quotation-item quotation-detail-informations" >
                        <apex:variable value="{!qdm.currentSizeD > 0}" var="hasDetailsD" />

                        <div class="quotation-item-header clearfix" style="height: 38px;">
                          <div class="header-title">{!$Label.JEOLAsia_ProfitCalculation_CommissionInformations}</div>
                        </div>

                        <!-- GRID 4 -->
                        <!-- Grid of items -->
                        <div class="quotation-item-header quotation-detail-header backgroundcolorgrey clearfix">
                          <div class="quotation-detail-header-item quotation-detail-productName quotation-detailD-productName" style="margin-left: 94px;">Product Name</div>
                          <div class="quotation-detail-header-item quotation-detail-Description quotation-detailD-Description">Description</div>
                          <div class="quotation-detail-header-item quotation-detail-quantity quotation-detailD-quantity">Qty</div>
                          <div class="quotation-detail-header-item quotation-detail-UnitPrice quotation-detailD-UnitPrice">Unit Price</div>
                          <div class="quotation-detail-header-item quotation-detail-CatalogCurrency quotation-detailD-CatalogCurrency">Cur</div>
                          <div class="quotation-detail-header-item quotation-detail-CostPrice quotation-detailD-CostPrice">Cost Price<br/>({!qdm.parentRec.SalesCurrency__c})</div>
                          <div class="quotation-detail-header-item quotation-detail-SalesPrice quotation-detailD-SalesPrice">Sales Price<br/>({!qdm.parentRec.SalesCurrency__c})</div>
                          <div class="quotation-detail-header-item quotation-detail-CostPct quotation-detailD-CostPct">Cost %</div>
                          <div class="quotation-detail-header-item quotation-detail-Remarks quotation-detailD-Remarks">Remarks</div>
                        </div>
                        <apex:outputPanel layout="block" styleClass="quotation-item-body clearfix quotation-detail-list quotation-detail-listD">
                          <apex:outputPanel layout="none" rendered="{!hasDetailsD}">
                            <apex:repeat value="{!qdm.itemsD}" var="item" >
                            
                              <!-- NORMAL ROW -->
                              <apex:outputPanel id="detail_productD" layout="block" html-data-depth="{!item.rec.Depth__c}" html-data-sortNo="{!item.rec.SortNo__c}" html-data-section-type="D" html-data-type="{!item.rec.Type__c}" 
                                                html-data-discount-target="{!item.rec.IsDiscountTarget__c}"
                                                html-data-tax-target="{!item.rec.IsTaxationTarget__c}"
                                                html-data-overhead-target="{!item.rec.IsOverheadTarget__c}"
                                                html-data-show-target="{!item.rec.IsShowDetailAmount__c}" html-data-forbidden-target="{!item.rec.AccompanyingPaperOutput__c}"
                                                styleClass="quotation-detail-item quotation-detail-itemD clearfix" rendered="{!item.rec.Type__c = '1'}">
                                <div class="{!IF((isReadOnly || isQTRestricted),'hidden','field')}">
                                  <div class="quotation-detail-action sortableAction sortableActionD" onmousedown="dragActionD(this);" >
                                    <div class="sortable-pointer"></div>
                                  </div>
                                </div>
                                <div class="{!IF((isReadOnly || isQTRestricted),'hidden','field')}">
                                  <div class="quotation-detail-action configAction clearfix">
                                    <apex:outputLink value="javascript: void(0);" onclick="removeDepth(this);lockSafety();return false;" styleClass="paragraph-option paragraph-up">&lsaquo;</apex:outputLink>
                                    <apex:outputLink value="javascript: void(0);" onclick="addDepth(this);lockSafety();return false;" styleClass="paragraph-option paragraph-down">&rsaquo;</apex:outputLink>
                                  </div>
                                </div>
                                <div class="hidden">
                                  <apex:inputHidden html-class="quotation-detail-Amount-input" value="{!item.rec.Amount__c}" />
                                  <apex:inputHidden html-class="quotation-detail-sortNo" value="{!item.rec.SortNo__c}" />
                                  <apex:inputHidden html-class="quotation-detail-depth" value="{!item.rec.Depth__c}" />
                                  <apex:inputHidden html-class="quotation-detail-CostPrice-input" value="{!item.rec.CostPrice__c}" />
                                  <apex:inputHidden html-class="quotation-detail-CostPriceJProdUnit" value="{!item.rec.CostPriceJProdUnit__c}" />
                                  <apex:inputHidden html-class="quotation-detail-SalesPriceCalculated-input" value="{!item.rec.SalesPriceCalculated__c}" />
                                  <apex:inputHidden html-class="quotation-detail-CostPct-input" value="{!item.rec.CommissionCostPct__c}" />
                                </div>



                                <!-- BODY__c -->
                                <div class="field" style="overflow-x: hidden;{!IF((isReadOnly || isQTRestricted),'margin-left: 86px;width: 182px;','')}" >
                                  <div class="indent-wrap" >
                                    <apex:inputField rendered="{!!(isReadOnly || isQTRestricted)}" id="quotation-detail-productNameD" styleClass="field-value quotation-detail-productName quotation-detailD-productName" value="{!item.rec.Body__c}" html-data-compare-value="{!item.rec.Body__c}" onfocus="detailBodyFocus(this);" onblur="detailBodyBlur(this);safetyLockCheck(this);" html-placeholder="{!$Label.JEOL_QuotEdit_Label_ProductName}" ></apex:inputField>
                                    <apex:outputText rendered="{!(isReadOnly || isQTRestricted)}" id="quotation-detail-productNameDView" styleClass="field-value quotation-detail-productName quotation-detailD-productName" value="{!item.rec.Body__c}" style="width: 182px;" />
                                  </div>
                                </div>

                                <!-- DESCRIPTION__c -->
                                <div class="field clearfix">
                                  <apex:inputField rendered="{!!(isReadOnly || isQTRestricted)}" value="{!item.rec.Description__c}" styleClass="field-value quotation-detail-Description quotation-detailD-Description" html-placeholder="Description" html-data-compare-value="{!item.rec.Description__c}" onblur="safetyLockCheck(this);" onkeypress="return disableEnterKey(event)" />
                                  <apex:outputText rendered="{!(isReadOnly || isQTRestricted)}" value="{!item.rec.Description__c}" styleClass="field-value quotation-detail-Description quotation-detailD-Description" /> 
                                </div>

                                <!-- QUANTITY -->
                                <div class="field">
                                  <apex:inputField rendered="{!!(isReadOnly || isQTRestricted)}" styleClass="field-value quotation-detail-quantity quotation-detailD-quantity number " value="{!item.rec.Quantity__c}" onchange="calcurate();" html-data-compare-value="{!item.rec.Quantity__c}" onblur="safetyLockCheck(this);" onkeypress="return disableEnterKey(event)" />
                                  <apex:outputText rendered="{!(isReadOnly || isQTRestricted)}" styleClass="field-value quotation-detail-quantity quotation-detailD-quantity number " value="{!item.rec.Quantity__c}" />
                                </div>

                                <!-- UNIT PRICE -->
                                <div class="field">
                                  <apex:inputField rendered="{!!(isReadOnly || isQTRestricted)}" styleClass="field-value quotation-detail-UnitPrice quotation-detailD-UnitPrice number " value="{!item.rec.UnitPrice__c}" onchange="calcurate();" html-data-compare-value="{!item.rec.UnitPrice__c}" onblur="safetyLockCheck(this);" onkeypress="return disableEnterKey(event)" />

                                  <apex:inputHidden rendered="{!(isReadOnly || isQTRestricted)}" Html-Class="field-value quotation-detail-UnitPrice quotation-detailD-UnitPrice number " value="{!item.rec.UnitPrice__c}" />

                                  <apex:outputText rendered="{!(isReadOnly || isQTRestricted)}" styleClass="field-value quotation-detail-UnitPrice quotation-detailD-UnitPrice number " value="{0,number, ###,###,###,###,###,##0.00}" >
                                    <apex:param value="{!item.rec.UnitPrice__c}" />
                                  </apex:outputText>
                                </div>

                                <!-- CATALOG CURRENCY -->
                                <div class="field">
                                  <apex:selectList rendered="{!!(isReadOnly || isQTRestricted)}" styleClass="field-value quotation-detail-CatalogCurrency quotation-detailD-CatalogCurrency" value="{!item.rec.CatalogCurrency__c}" size="1" html-data-compare-value="{!item.rec.CatalogCurrency__c}" onblur="safetyLockCheck(this);" required="true" onchange="calcurate();" onkeypress="return disableEnterKey(event)" >
                                      <apex:selectOptions value="{!listOtherCurrencyOption}"/> 
                                  </apex:selectList>

                                  <apex:inputHidden rendered="{!(isReadOnly || isQTRestricted)}" Html-Class="field-value quotation-detail-CatalogCurrency quotation-detailD-CatalogCurrency number " value="{!item.rec.CatalogCurrency__c}" />

                                  <apex:outputText rendered="{!(isReadOnly || isQTRestricted)}" styleClass="field-value quotation-detail-CatalogCurrency quotation-detailD-CatalogCurrency number " value="{!item.rec.CatalogCurrency__c}" />
                                </div>

                                <!-- COST PRICE -->
                                <div class="field">
                                  <apex:outputText styleClass="field-value quotation-detail-CostPrice quotation-detailD-CostPrice number" value="{0,number, ###,###,###,###,###,##0.00}" >
                                    <apex:param value="{!item.rec.CostPrice__c}" />
                                  </apex:outputText>
                                </div> 

                                <!-- SALES PRICE -->
                                <div class="field">

                                  <apex:inputField rendered="{!!(isReadOnly || isQTRestricted)}" styleClass="field-value quotation-detail-SalesPrice quotation-detailD-SalesPrice number " value="{!item.rec.SalesPrice__c}" onchange="calcurate();" html-data-compare-value="{!item.rec.SalesPrice__c}" onblur="safetyLockCheck(this);" onkeypress="return disableEnterKey(event)" />

                                  <apex:outputText rendered="{!((isReadOnly || isQTRestricted) && item.rec.SalesPrice__c != NULL)}" styleClass="field-value quotation-detail-SalesPrice quotation-detailD-SalesPrice number" value="{0,number, ###,###,###,###,###,##0.00}" >
                                    <apex:param value="{!item.rec.SalesPrice__c}" />
                                  </apex:outputText>

                                  <apex:outputText rendered="{!((isReadOnly || isQTRestricted) && item.rec.SalesPrice__c == NULL && item.rec.SalesPriceCalculated__c != 0)}" styleClass="field-value quotation-detail-SalesPrice quotation-detailD-SalesPrice number" style="color: #b3b3b3;" value="{0,number, ###,###,###,###,###,##0.00}" >
                                    <apex:param value="{!item.rec.SalesPriceCalculated__c}" />
                                  </apex:outputText>

                                  <apex:outputText rendered="{!((isReadOnly || isQTRestricted) && item.rec.SalesPrice__c == NULL && item.rec.SalesPriceCalculated__c == 0)}" styleClass="field-value quotation-detail-SalesPrice quotation-detailD-SalesPrice number" />

                                </div> 

                                <!-- COST % -->
                                <div class="field">
                                  <apex:outputText styleClass="field-value quotation-detail-CostPct quotation-detailD-CostPct number" value="{0,number, ###,###,###,###,###,##0.0}%" >
                                    <apex:param value="{!item.rec.CommissionCostPct__c}" />
                                  </apex:outputText>
                                </div> 

                                <!-- REMARKS__c -->
                                <div class="field clearfix">
                                  <apex:inputField rendered="{!!(isReadOnly || isQTRestricted)}" value="{!item.rec.Remarks__c}" styleClass="field-value quotation-detail-Remarks quotation-detailD-Remarks" html-placeholder="Remarks" html-data-compare-value="{!item.rec.Remarks__c}" onblur="safetyLockCheck(this);" onkeypress="return disableEnterKey(event)" />
                                  <apex:outputText rendered="{!(isReadOnly || isQTRestricted)}" value="{!item.rec.Remarks__c}" styleClass="field-value quotation-detail-Remarks quotation-detailD-Remarks" /> 
                                </div>




                                <div class="field">
                                  <div class="panel-area clearfix" >
                                    <div class="option-view-panel showAmount" data-target-class="isShowDetailAmountTarget" onclick="optionSettingFromPanelClick(this);lockSafety();">1</div>
<!--
                                    <div class="option-view-panel tax" data-target-class="isTaxationTarget" onclick="{!IF((isReadOnly || isQTRestricted),'','optionSettingFromPanelClick(this);calcurate();lockSafety();')}">{!$Label.JEOL_QuotEdit_Label_TaxableShort}</div>
                                    <div class="option-view-panel overhead" data-target-class="isOverheadTarget" onclick="{!IF((isReadOnly || isQTRestricted),'','optionSettingFromPanelClick(this);calcurate();lockSafety();')}">{!$Label.JEOL_QuotEdit_Label_SundryRelatedShort}</div>
                                    <div class="option-view-panel accompanyingPaperOutput" data-target-class="isAccompanyingPaperOutput" onclick="optionSettingFromPanelClick(this);lockSafety();">{!$Label.JEOL_QuotEdit_Label_SeparateSheetShort}</div>
-->
                                  </div>
                                </div>
                                <div class="field" data-type="dropdown">
                                  <button type="button" onclick="dorpdownAction(this);" data-type="button" class="optionalButton">▼</button>
                                  <ul class="detail-options" data-type="list"  style="{!IF(language <> 'ja', 'width: 225px;', '')}">
                                    <li style="height: 30px;width: 225px;" class="{!IF((isReadOnly || isQTRestricted),'hidden','field detail-options-item')}" data-type="item">
                                      <apex:commandLink action="{!item.copyAction}" title="{!$Label.JEOL_QuotEdit_Label_CloneRow}" onclick="lockSafety();clearAction(this);" rerender="detailAreaD,modalListView,modalListViewDel,SubtotalA,SubtotalB,SubtotalC,SubtotalD,SubtotalE,SubtotalF,SubtotalG,totalResult,apexMessage" styleClass="quotation-detail-action" status="ajaxStatusD"  style="{!IF(language <> 'ja', 'width: 225px;', '')}" >{!$Label.JEOL_QuotEdit_Label_CloneRow}</apex:commandLink>
                                    </li>

                                    <li class="{!IF((isReadOnly || isQTRestricted),'hidden','')}"><hr/></li>

                                    <li style="height: 30px;{!IF(language <> 'ja', 'width: 225px;', '')}" class="field detail-options-item" data-type="item" >
                                      <div class="showAmount"></div>
                                      <apex:outputLabel for="isShowDetailAmountTargetD" value="1. Show detail amount" styleClass="field-label" style="{!IF(language <> 'ja', 'width: 175px;', '')}" />
                                      <apex:inputField id="isShowDetailAmountTargetD" value="{!item.rec.IsShowDetailAmount__c}" html-data-target="data-show-target" styleClass="isShowDetailAmountTarget" onchange="optionSetting(this);" html-data-compare-value="{!item.rec.IsShowDetailAmount__c}" onblur="safetyLockCheck(this);" onkeypress="return disableEnterKey(event)" />
                                    </li>

<!--
                                    <li style="height: 30px;{!IF(language <> 'ja', 'width: 225px;', '')}" class="field detail-options-item" data-type="item">
                                      <div class="tax"></div>
                                      <apex:outputLabel for="isTaxationTargetD" value="{!$Label.JEOL_QuotEdit_Label_Taxable}" styleClass="field-label" style="{!IF(language <> 'ja', 'width: 175px;', '')}" />
                                      <apex:inputField rendered="{!!(isReadOnly || isQTRestricted)}" id="isTaxationTargetD" value="{!item.rec.IsTaxationTarget__c}" html-data-target="data-tax-target" styleClass="isTaxationTarget"  onchange="optionSetting(this);calcurate();" html-data-compare-value="{!item.rec.IsTaxationTarget__c}" onblur="safetyLockCheck(this);" />
                                      <apex:inputcheckbox rendered="{!(isReadOnly || isQTRestricted)}" disabled="true" id="isTaxationTargetDView" value="{!item.rec.IsTaxationTarget__c}" />
                                    </li>
                                    <li style="height: 30px;{!IF(language <> 'ja', 'width: 225px;', '')}" class="field detail-options-item" data-type="item" >
                                      <div class="overhead"></div>
                                      <apex:outputLabel for="isOverheadTargetD" value="{!$Label.JEOL_QuotEdit_Label_SundryRelated}" styleClass="field-label" style="{!IF(language <> 'ja', 'width: 175px;', '')}" />
                                      <apex:inputField rendered="{!!(isReadOnly || isQTRestricted)}" id="isOverheadTargetD" value="{!item.rec.IsOverheadTarget__c}" html-data-target="data-overhead-target" styleClass="isOverheadTarget" onchange="optionSetting(this);calcurate();" html-data-compare-value="{!item.rec.IsOverheadTarget__c}" onblur="safetyLockCheck(this);" />
                                      <apex:inputcheckbox rendered="{!(isReadOnly || isQTRestricted)}" disabled="true" id="isOverheadTargetDView" value="{!item.rec.IsOverheadTarget__c}" />
                                    </li>
                                    <li style="height: 30px;{!IF(language <> 'ja', 'width: 225px;', '')}" class="field detail-options-item" data-type="item" >
                                      <div class="accompanyingPaperOutput"></div>
                                      <apex:outputLabel for="isAccompanyingPaperOutputD" value="{!$Label.JEOL_QuotEdit_Label_SeparateSheet}" styleClass="field-label" style="{!IF(language <> 'ja', 'width: 175px;', '')}" />
                                      <apex:inputField id="isAccompanyingPaperOutputD" value="{!item.rec.AccompanyingPaperOutput__c}" html-data-target="data-forbidden-target" styleClass="isAccompanyingPaperOutput" onchange="optionSetting(this);" html-data-compare-value="{!item.rec.AccompanyingPaperOutput__c}" onblur="safetyLockCheck(this);" />
                                    </li>
-->
                                    <li><hr/></li>

                                    <li style="height: 30px;{!IF(language <> 'ja', 'width: 225px;', '')}" class="field detail-options-item close-option" data-type="item" >
                                      <apex:outputLink value="javascript: void(0);" styleClass="closeButton" onclick="clearAction(this);$j(this).closest('[data-type=\'dropdown\']').find('[data-type=\'button\']').trigger('focus');return false;"  style="{!IF(language <> 'ja', 'width: 225px;', '')}" >{!$Label.JEOL_QuotEdit_Label_Close}</apex:outputLink>
                                    </li>
                                  </ul>
                                </div>
                                <div class="{!IF((isReadOnly || isQTRestricted),'hidden','field')}">
                                  <apex:commandLink action="{!item.deleteAction}" title="{!$Label.JEOL_QuotEdit_Label_RemoveRow}" onclick="lockSafety();" rerender="detailAreaD,modalListView,modalListViewDel,SubtotalA,SubtotalB,SubtotalC,SubtotalD,SubtotalE,SubtotalF,SubtotalG,totalResult,apexMessage" styleClass="quotation-detail-action deleteAction" status="ajaxStatusD" >×</apex:commandLink>
                                </div>
                                
                              </apex:outputPanel>
                              
                              
                              <!-- SUMMARY ROW -->
                              <apex:outputPanel id="detail_titleD" layout="block" html-data-depth="{!item.rec.Depth__c}" html-data-sortNo="{!item.rec.SortNo__c}" html-data-section-type="D" html-data-type="{!item.rec.Type__c}" html-data-forbidden-target="{!item.rec.AccompanyingPaperOutput__c}" styleClass="quotation-detail-item quotation-detail-itemD clearfix" rendered="{!item.rec.Type__c = '2'}">
                                <div class="{!IF((isReadOnly || isQTRestricted),'hidden','field')}">
                                  <div class="quotation-detail-action sortableAction sortableActionD" onmousedown="dragActionD(this);" >
                                    <div class="sortable-pointer"></div>
                                  </div>
                                </div>
                                <div class="{!IF((isReadOnly || isQTRestricted),'hidden','field')}">
                                  <div class="quotation-detail-action configAction">
                                    <apex:outputLink value="javascript: void(0);" onclick="removeDepth(this);lockSafety();return false;" styleClass="paragraph-option paragraph-up">&lsaquo;</apex:outputLink>
                                    <apex:outputLink value="javascript: void(0);" onclick="addDepth(this);lockSafety();return false;" styleClass="paragraph-option paragraph-down">&rsaquo;</apex:outputLink>
                                  </div>
                                </div>
                                <div class="hidden">
                                  <apex:inputHidden html-class="quotation-detail-sortNo" value="{!item.rec.SortNo__c}" />
                                  <apex:inputHidden html-class="quotation-detail-depth" value="{!item.rec.Depth__c}" />
                                </div>
                                <div class="field" style="overflow-x: hidden;{!IF((isReadOnly || isQTRestricted),'margin-left: 86px;width: 803px;','')}">
                                  <div class="indent-wrap">
                                    <apex:inputField rendered="{!!(isReadOnly || isQTRestricted)}" styleClass="field-value quotation-detail-headingBody" value="{!item.rec.Body__c}" onfocus="detailBodyFocus(this);" onblur="safetyLockCheck(this);detailBodyBlur(this);" html-data-compare-value="{!item.rec.Body__c}" />
                                    <apex:outputText rendered="{!(isReadOnly || isQTRestricted)}"  styleClass="field-value quotation-detail-headingBody" value="{!item.rec.Body__c}" />
                                  </div>
                                </div>
                                <div class="field">
                                  <div class="panel-area clearfix" >
<!--
                                    <div class="option-view-panel" ></div>
                                    <div class="option-view-panel" ></div>
                                    <div class="option-view-panel" ></div>
                                    <div class="option-view-panel accompanyingPaperOutput" data-target-class="isAccompanyingPaperOutput" onclick="optionSettingFromPanelClick(this);lockSafety();">{!$Label.JEOL_QuotEdit_Label_SeparateSheetShort}</div>
                                    <div class="option-view-panel" ></div>
-->
                                  </div>
                                </div>
                                <div class="{!IF((isReadOnly || isQTRestricted),'hidden','field')}" data-type="dropdown">
                                  <button type="button" onclick="dorpdownAction(this);" data-type="button" class="optionalButton">▼</button>
                                  <ul class="detail-options" data-type="list" style="{!IF(language <> 'ja', 'width: 225px;', '')}">
                                    <li style="height: 30px;{!IF(language <> 'ja', 'width: 225px;', '')}" class="{!IF((isReadOnly || isQTRestricted),'hidden','field detail-options-item')}" data-type="item">
                                      <apex:commandLink action="{!item.copyAction}" title="{!$Label.JEOL_QuotEdit_Label_CloneRow}" onclick="lockSafety();clearAction(this);" rerender="detailAreaD,modalListView,modalListViewDel,SubtotalA,SubtotalB,SubtotalC,SubtotalD,SubtotalE,SubtotalF,SubtotalG,totalResult,apexMessage" styleClass="quotation-detail-action" status="ajaxStatusD" style="{!IF(language <> 'ja', 'width: 225px;', '')}">{!$Label.JEOL_QuotEdit_Label_CloneRow}</apex:commandLink>
                                    </li>

<!--                                    
                                    <li class="{!IF((isReadOnly || isQTRestricted),'hidden','')}" ><hr/></li>

                                    <li style="height: 30px;{!IF(language <> 'ja', 'width: 225px;', '')}" class="field detail-options-item" data-type="item">
                                      <div class="accompanyingPaperOutput"></div>
                                      <apex:outputLabel for="isAccompanyingPaperOutput-breakdownD" value="{!$Label.JEOL_QuotEdit_Label_SeparateSheet}" styleClass="field-label" style="{!IF(language <> 'ja', 'width: 175px;', '')}" />
                                      <apex:inputField id="isAccompanyingPaperOutput-breakdownD" value="{!item.rec.AccompanyingPaperOutput__c}" html-data-target="data-forbidden-target" styleClass="field-value isAccompanyingPaperOutput" onchange="optionSetting(this);" html-data-compare-value="{!item.rec.AccompanyingPaperOutput__c}" onblur="safetyLockCheck(this);" />
                                    </li>
-->

                                    <li><hr/></li>

                                    <li style="height: 30px;{!IF(language <> 'ja', 'width: 225px;', '')}" class="field detail-options-item close-option" data-type="item">
                                      <apex:outputLink value="javascript: void(0);" styleClass="closeButton" onclick="clearAction(this);$j(this).closest('[data-type=\'dropdown\']').find('[data-type=\'button\']').trigger('focus');return false;" >{!$Label.JEOL_QuotEdit_Label_Close}</apex:outputLink>
                                    </li>
                                  </ul>
                                </div>
                                <div class="{!IF((isReadOnly || isQTRestricted),'hidden','field')}" >
                                  <apex:commandLink action="{!item.deleteAction}" title="{!$Label.JEOL_QuotEdit_Label_RemoveRow}" onclick="lockSafety();" rerender="detailAreaD,modalListView,modalListViewDel,SubtotalA,SubtotalB,SubtotalC,SubtotalD,SubtotalE,SubtotalF,SubtotalG,totalResult,apexMessage" styleClass="quotation-detail-action deleteAction" status="ajaxStatusD" >×</apex:commandLink>
                                </div>
                              </apex:outputPanel>
                              
                            </apex:repeat>
                          </apex:outputPanel>
                          <apex:outputPanel layout="none" rendered="{!!hasDetailsD}">
                            <div style="padding: 10px; margin: 2px 0px;">{!$Label.JEOL_QuotEdit_Message_DetailNotCreated}</div>
                          </apex:outputPanel>
                        </apex:outputPanel>
                        <apex:actionStatus layout="block" onstop="initWithCalcurate();focusOpenModalDetail();" id="ajaxStatusD" startStyleClass="ajax-status-start">
                          <apex:facet name="start">
                            <div class="ajax-status-start-inner ajax-loading">
                              <span style="position:relative; z-index: 2;">{!$Label.JEOL_QuotEdit_Label_Searching}</span>
                            </div>
                          </apex:facet>
                        </apex:actionStatus>
                        <hr />

                      </apex:outputPanel>
                        
                      <!-- Add New Item button -->
                      <div class="quotation-item create-action-area" >
                        <div class="quotation-item-body clearfix" >
                          <div class="{!IF((isReadOnly || isQTRestricted),'hidden','field clearfix top')}" data-type="dropdown">
                            <apex:commandLink rerender="detailAreaD,modalListView,modalListViewDel,apexMessage" action="{!qdm.createQuotationDetailD}" oncomplete="lockSafety();showResult('{!$Label.JEOL_QuotEdit_Message_ProcessingCompleted}');" styleClass="add-default-detail customButton" status="ajaxStatusD" >{!$Label.JEOL_QuotEdit_Label_AddNewItem}</apex:commandLink>
                            <apex:outputLink value="javascript: void(0);" onclick="dorpdownAction(this);return false;" html-data-type="button" styleClass="add-optional-details customButton">▲</apex:outputLink>
                            <ul class="optional-list" data-type="list">
                              <li data-type="item">
                                <apex:commandLink styleClass="optional-item" oncomplete="lockSafety();showResult('{!$Label.JEOL_QuotEdit_Message_ProcessingCompleted}');" rerender="detailAreaD,modalListView,modalListViewDel,apexMessage" action="{!qdm.createQuotationDetailDx5}" status="ajaxStatusD" >{!$Label.JEOLAsia_QuotEdit_Label_AddNewItemx5}</apex:commandLink>
                              </li>
                              <li data-type="item">
                                <apex:commandLink styleClass="optional-item" oncomplete="lockSafety();showResult('{!$Label.JEOL_QuotEdit_Message_ProcessingCompleted}');" rerender="detailAreaD,modalListView,modalListViewDel,apexMessage" action="{!qdm.createQuotationDetailD}" status="ajaxStatusD" >{!$Label.JEOL_QuotEdit_Label_AddNewItem}</apex:commandLink>
                              </li>
                              <li data-type="item">
                                <apex:commandLink styleClass="optional-item" oncomplete="lockSafety();showResult('{!$Label.JEOL_QuotEdit_Message_ProcessingCompleted}');" rerender="detailAreaD,modalListView,modalListViewDel,apexMessage" action="{!qdm.createHeadingDetailD}" status="ajaxStatusD">{!$Label.JEOL_QuotEdit_Label_AddHeading}</apex:commandLink>
                              </li>
                              <li><hr/></li>
                              <li class="field close-option" data-type="item">
                                <apex:outputLink value="javascript: void(0);" styleClass="optional-item closeButton" onclick="clearAction(this);$j(this).closest('[data-type=\'dropdown\']').find('[data-type=\'button\']').trigger('focus');return false;" >{!$Label.JEOL_QuotEdit_Label_Close}</apex:outputLink>
                              </li>
                            </ul>
                          </div>
                        </div>
                      </div>

                      <!-- SUMMARY SECTION -->
                      <div class="quotation-item total-amount-area" >
                        <apex:outputPanel layout="block" styleClass="quotation-item-body clearfix" id="SubtotalD">
                          <div class="hidden" >
                            <apex:inputHidden html-class="fieldSubtotalD" value="{!qdm.parentRec.SubtotalD__c}" />
                          </div>

                          <div class="field" >
                            <div class="field-label">
                              <apex:outputLabel for="quotationSubtotalD" value="Subtotal ({!qdm.parentRec.SalesCurrency__c})" style="padding: 8px; background-color: #DDDDDD;" />
                            </div>
                            <apex:outputText id="quotationSubtotalD" styleClass="field-value quotationSubtotalDOutput number" value="{0,number, ###,###,###,###,###,##0.00}" style="font-size: 13px;" >
                              <apex:param value="{!qdm.parentRec.SubtotalD__c}" />
                            </apex:outputText>
                          </div>
                        </apex:outputPanel>
                      </div>
                    </apex:outputPanel>





                    <apex:outputPanel >

                      <apex:outputPanel layout="block" id="detailAreaE"  styleClass="quotation-item quotation-detail-informations" >
                        <apex:variable value="{!qdm.currentSizeE > 0}" var="hasDetailsE" />

                        <div class="quotation-item-header clearfix" style="height: 38px;">
                          <div class="header-title">{!$Label.JEOLAsia_ProfitCalculation_OtherMiscellaneousInformations}</div>
                        </div>

                        <!-- GRID 5 -->
                        <!-- Grid of items -->
                        <div class="quotation-item-header quotation-detail-header backgroundcolorgrey clearfix">
                          <div class="quotation-detail-header-item quotation-detail-productName quotation-detailE-productName" style="margin-left: 94px;">Product Name</div>
                          <div class="quotation-detail-header-item quotation-detail-Description quotation-detailE-Description">Description</div>
                          <div class="quotation-detail-header-item quotation-detail-quantity quotation-detailE-quantity">Qty</div>
                          <div class="quotation-detail-header-item quotation-detail-UnitPrice quotation-detailE-UnitPrice">Unit Price</div>
                          <div class="quotation-detail-header-item quotation-detail-CatalogCurrency quotation-detailE-CatalogCurrency">Cur</div>
                          <div class="quotation-detail-header-item quotation-detail-CostPrice quotation-detailE-CostPrice">Cost Price<br/>({!qdm.parentRec.SalesCurrency__c})</div>
                          <div class="quotation-detail-header-item quotation-detail-SalesPrice quotation-detailE-SalesPrice">Sales Price<br/>({!qdm.parentRec.SalesCurrency__c})</div>
                          <div class="quotation-detail-header-item quotation-detail-Remarks quotation-detailE-Remarks">Remarks</div>
                        </div>
                        <apex:outputPanel layout="block" styleClass="quotation-item-body clearfix quotation-detail-list quotation-detail-listE">
                          <apex:outputPanel layout="none" rendered="{!hasDetailsE}">
                            <apex:repeat value="{!qdm.itemsE}" var="item" >
                            
                              <!-- NORMAL ROW -->
                              <apex:outputPanel id="detail_productE" layout="block" html-data-depth="{!item.rec.Depth__c}" html-data-sortNo="{!item.rec.SortNo__c}" html-data-section-type="E" html-data-type="{!item.rec.Type__c}"
                                                html-data-discount-target="{!item.rec.IsDiscountTarget__c}" html-data-tax-target="{!item.rec.IsTaxationTarget__c}" html-data-overhead-target="{!item.rec.IsOverheadTarget__c}"
                                                html-data-show-target="{!item.rec.IsShowDetailAmount__c}" html-data-forbidden-target="{!item.rec.AccompanyingPaperOutput__c}" styleClass="quotation-detail-item quotation-detail-itemE clearfix" rendered="{!item.rec.Type__c = '1'}">
                                <div class="{!IF((isReadOnly || isQTRestricted),'hidden','field')}">
                                  <div class="quotation-detail-action sortableAction sortableActionE" onmousedown="dragActionE(this);" >
                                    <div class="sortable-pointer"></div>
                                  </div>
                                </div>
                                <div class="{!IF((isReadOnly || isQTRestricted),'hidden','field')}">
                                  <div class="quotation-detail-action configAction clearfix">
                                    <apex:outputLink value="javascript: void(0);" onclick="removeDepth(this);lockSafety();return false;" styleClass="paragraph-option paragraph-up">&lsaquo;</apex:outputLink>
                                    <apex:outputLink value="javascript: void(0);" onclick="addDepth(this);lockSafety();return false;" styleClass="paragraph-option paragraph-down">&rsaquo;</apex:outputLink>
                                  </div>
                                </div>
                                <div class="hidden">
                                  <apex:inputHidden html-class="quotation-detail-Amount-input" value="{!item.rec.Amount__c}" />
                                  <apex:inputHidden html-class="quotation-detail-sortNo" value="{!item.rec.SortNo__c}" />
                                  <apex:inputHidden html-class="quotation-detail-depth" value="{!item.rec.Depth__c}" />
                                  <apex:inputHidden html-class="quotation-detail-CostPrice-input" value="{!item.rec.CostPrice__c}" />
                                  <apex:inputHidden html-class="quotation-detail-CostPriceJProdUnit" value="{!item.rec.CostPriceJProdUnit__c}" />
                                </div>





                                <!-- BODY__c -->
                                <div class="field" style="overflow-x: hidden;{!IF((isReadOnly || isQTRestricted),'margin-left: 86px;width: 200px;','')}" >
                                  <div class="indent-wrap" >
                                    <apex:inputField rendered="{!!(isReadOnly || isQTRestricted)}" id="quotation-detail-productNameE" styleClass="field-value quotation-detail-productName quotation-detailE-productName" value="{!item.rec.Body__c}" html-data-compare-value="{!item.rec.Body__c}" onfocus="detailBodyFocus(this);" onblur="detailBodyBlur(this);safetyLockCheck(this);" html-placeholder="{!$Label.JEOL_QuotEdit_Label_ProductName}" ></apex:inputField>
                                    <apex:outputText rendered="{!(isReadOnly || isQTRestricted)}" id="quotation-detail-productNameEView" styleClass="field-value quotation-detail-productName quotation-detailE-productName" value="{!item.rec.Body__c}" style="width: 200px;" />
                                  </div>
                                </div>

                                <!-- DESCRIPTION__c -->
                                <div class="field clearfix">
                                  <apex:inputField rendered="{!!(isReadOnly || isQTRestricted)}" value="{!item.rec.Description__c}" styleClass="field-value quotation-detail-Description quotation-detailE-Description" html-placeholder="Description" html-data-compare-value="{!item.rec.Description__c}" onblur="safetyLockCheck(this);" onkeypress="return disableEnterKey(event)"/>
                                  <apex:outputText rendered="{!(isReadOnly || isQTRestricted)}" value="{!item.rec.Description__c}" styleClass="field-value quotation-detail-Description quotation-detailE-Description" /> 
                                </div>

                                <!-- QUANTITY -->
                                <div class="field">
                                  <apex:inputField rendered="{!!(isReadOnly || isQTRestricted)}" styleClass="field-value quotation-detail-quantity quotation-detailE-quantity number " value="{!item.rec.Quantity__c}" onchange="calcurate();" html-data-compare-value="{!item.rec.Quantity__c}" onblur="safetyLockCheck(this);" onkeypress="return disableEnterKey(event)" />

                                  <apex:outputText rendered="{!(isReadOnly || isQTRestricted)}" styleClass="field-value quotation-detail-quantity quotation-detailE-quantity number " value="{0,number, ###,###,###,###,###,##0.0}">
                                    <apex:param value="{!item.rec.Quantity__c}" />
                                  </apex:outputText>
                                </div>

                                <!-- UNIT PRICE -->
                                <div class="field">
                                  <apex:inputField rendered="{!!(isReadOnly || isQTRestricted)}" styleClass="field-value quotation-detail-UnitPrice quotation-detailE-UnitPrice number " value="{!item.rec.UnitPrice__c}" onchange="calcurate();" html-data-compare-value="{!item.rec.UnitPrice__c}" onblur="safetyLockCheck(this);" onkeypress="return disableEnterKey(event)" />

                                  <apex:inputHidden rendered="{!(isReadOnly || isQTRestricted)}" Html-Class="field-value quotation-detail-UnitPrice quotation-detailE-UnitPrice number " value="{!item.rec.UnitPrice__c}" />

                                  <apex:outputText rendered="{!(isReadOnly || isQTRestricted)}" styleClass="field-value quotation-detail-UnitPrice quotation-detailE-UnitPrice number " value="{0,number, ###,###,###,###,###,##0.00}" >
                                    <apex:param value="{!item.rec.UnitPrice__c}" />
                                  </apex:outputText>
                                </div>

                                <!-- CATALOG CURRENCY -->
                                <div class="field">
                                  <apex:selectList rendered="{!!(isReadOnly || isQTRestricted)}" styleClass="field-value quotation-detail-CatalogCurrency quotation-detailE-CatalogCurrency" value="{!item.rec.CatalogCurrency__c}" size="1" html-data-compare-value="{!item.rec.CatalogCurrency__c}" onblur="safetyLockCheck(this);" required="true" onchange="calcurate();" onkeypress="return disableEnterKey(event)" >
                                      <apex:selectOptions value="{!listOtherCurrencyOption}"/> 
                                  </apex:selectList>

                                  <apex:inputHidden rendered="{!(isReadOnly || isQTRestricted)}" Html-Class="field-value quotation-detail-CatalogCurrency quotation-detailE-CatalogCurrency number " value="{!item.rec.CatalogCurrency__c}" />

                                  <apex:outputText rendered="{!(isReadOnly || isQTRestricted)}" styleClass="field-value quotation-detail-CatalogCurrency quotation-detailE-CatalogCurrency number " value="{!item.rec.CatalogCurrency__c}" />
                                </div>

                                <!-- COST PRICE -->
                                <div class="field">
                                  <apex:outputText styleClass="field-value quotation-detail-CostPrice quotation-detailE-CostPrice number" value="{0,number, ###,###,###,###,###,##0.00}" >
                                    <apex:param value="{!item.rec.CostPrice__c}" />
                                  </apex:outputText>
                                </div> 

                                <!-- SALES PRICE -->
                                <div class="field">
                                  <apex:inputField rendered="{!!(isReadOnly || isQTRestricted)}" styleClass="field-value quotation-detail-SalesPrice quotation-detailE-SalesPrice number " value="{!item.rec.SalesPrice__c}" onchange="calcurate();" html-data-compare-value="{!item.rec.SalesPrice__c}" onblur="safetyLockCheck(this);" onkeypress="return disableEnterKey(event)" />
                                  <apex:outputText rendered="{!(isReadOnly || isQTRestricted)}" styleClass="field-value quotation-detail-SalesPrice quotation-detailE-SalesPrice number" value="{0,number, ###,###,###,###,###,##0.00}" >
                                    <apex:param value="{!item.rec.SalesPrice__c}" />
                                  </apex:outputText>
                                </div> 

                                <!-- REMARKS__c -->
                                <div class="field clearfix">
                                  <apex:inputField rendered="{!!(isReadOnly || isQTRestricted)}" value="{!item.rec.Remarks__c}" styleClass="field-value quotation-detail-Remarks quotation-detailE-Remarks" html-placeholder="Remarks" html-data-compare-value="{!item.rec.Remarks__c}" onblur="safetyLockCheck(this);" onkeypress="return disableEnterKey(event)" />
                                  <apex:outputText rendered="{!(isReadOnly || isQTRestricted)}" value="{!item.rec.Remarks__c}" styleClass="field-value quotation-detail-Remarks quotation-detailE-Remarks" /> 
                                </div>




                                <div class="field">
                                  <div class="panel-area clearfix" >
                                    <div class="option-view-panel showAmount" data-target-class="isShowDetailAmountTarget" onclick="optionSettingFromPanelClick(this);lockSafety();">1</div>
<!--
                                    <div class="option-view-panel tax" data-target-class="isTaxationTarget" onclick="{!IF((isReadOnly || isQTRestricted),'','optionSettingFromPanelClick(this);calcurate();lockSafety();')}">{!$Label.JEOL_QuotEdit_Label_TaxableShort}</div>
                                    <div class="option-view-panel overhead" data-target-class="isOverheadTarget" onclick="{!IF((isReadOnly || isQTRestricted),'','optionSettingFromPanelClick(this);calcurate();lockSafety();')}">{!$Label.JEOL_QuotEdit_Label_SundryRelatedShort}</div>
                                    <div class="option-view-panel accompanyingPaperOutput" data-target-class="isAccompanyingPaperOutput" onclick="optionSettingFromPanelClick(this);lockSafety();">{!$Label.JEOL_QuotEdit_Label_SeparateSheetShort}</div>
-->
                                  </div>
                                </div>
                                <div class="field" data-type="dropdown">
                                  <button type="button" onclick="dorpdownAction(this);" data-type="button" class="optionalButton">▼</button>
                                  <ul class="detail-options" data-type="list"  style="{!IF(language <> 'ja', 'width: 225px;', '')}">
                                    <li style="height: 30px;width: 225px;" class="{!IF((isReadOnly || isQTRestricted),'hidden','field detail-options-item')}" data-type="item">
                                      <apex:commandLink action="{!item.copyAction}" title="{!$Label.JEOL_QuotEdit_Label_CloneRow}" onclick="lockSafety();clearAction(this);" rerender="detailAreaE,modalListView,modalListViewDel,SubtotalA,SubtotalB,SubtotalC,SubtotalD,SubtotalE,SubtotalF,SubtotalG,totalResult,apexMessage" styleClass="quotation-detail-action" status="ajaxStatusE"  style="{!IF(language <> 'ja', 'width: 225px;', '')}" >{!$Label.JEOL_QuotEdit_Label_CloneRow}</apex:commandLink>
                                    </li>

                                    <li class="{!IF((isReadOnly || isQTRestricted),'hidden','')}"><hr/></li>

                                    <li style="height: 30px;{!IF(language <> 'ja', 'width: 225px;', '')}" class="field detail-options-item" data-type="item" >
                                      <div class="showAmount"></div>
                                      <apex:outputLabel for="isShowDetailAmountTargetE" value="1. Show detail amount" styleClass="field-label" style="{!IF(language <> 'ja', 'width: 175px;', '')}" />
                                      <apex:inputField id="isShowDetailAmountTargetE" value="{!item.rec.IsShowDetailAmount__c}" html-data-target="data-show-target" styleClass="isShowDetailAmountTarget" onchange="optionSetting(this);" html-data-compare-value="{!item.rec.IsShowDetailAmount__c}" onblur="safetyLockCheck(this);" onkeypress="return disableEnterKey(event)" />
                                    </li>

<!--
                                    <li style="height: 30px;{!IF(language <> 'ja', 'width: 225px;', '')}" class="field detail-options-item" data-type="item">
                                      <div class="tax"></div>
                                      <apex:outputLabel for="isTaxationTargetE" value="{!$Label.JEOL_QuotEdit_Label_Taxable}" styleClass="field-label" style="{!IF(language <> 'ja', 'width: 175px;', '')}" />
                                      <apex:inputField rendered="{!!(isReadOnly || isQTRestricted)}" id="isTaxationTargetE" value="{!item.rec.IsTaxationTarget__c}" html-data-target="data-tax-target" styleClass="isTaxationTarget"  onchange="optionSetting(this);calcurate();" html-data-compare-value="{!item.rec.IsTaxationTarget__c}" onblur="safetyLockCheck(this);" />
                                      <apex:inputcheckbox rendered="{!(isReadOnly || isQTRestricted)}" disabled="true" id="isTaxationTargetEView" value="{!item.rec.IsTaxationTarget__c}" />
                                    </li>
                                    <li style="height: 30px;{!IF(language <> 'ja', 'width: 225px;', '')}" class="field detail-options-item" data-type="item" >
                                      <div class="overhead"></div>
                                      <apex:outputLabel for="isOverheadTargetE" value="{!$Label.JEOL_QuotEdit_Label_SundryRelated}" styleClass="field-label" style="{!IF(language <> 'ja', 'width: 175px;', '')}" />
                                      <apex:inputField rendered="{!!(isReadOnly || isQTRestricted)}" id="isOverheadTargetE" value="{!item.rec.IsOverheadTarget__c}" html-data-target="data-overhead-target" styleClass="isOverheadTarget" onchange="optionSetting(this);calcurate();" html-data-compare-value="{!item.rec.IsOverheadTarget__c}" onblur="safetyLockCheck(this);" />
                                      <apex:inputcheckbox rendered="{!(isReadOnly || isQTRestricted)}" disabled="true" id="isOverheadTargetEView" value="{!item.rec.IsOverheadTarget__c}" />
                                    </li>
                                    <li style="height: 30px;{!IF(language <> 'ja', 'width: 225px;', '')}" class="field detail-options-item" data-type="item" >
                                      <div class="accompanyingPaperOutput"></div>
                                      <apex:outputLabel for="isAccompanyingPaperOutputE" value="{!$Label.JEOL_QuotEdit_Label_SeparateSheet}" styleClass="field-label" style="{!IF(language <> 'ja', 'width: 175px;', '')}" />
                                      <apex:inputField id="isAccompanyingPaperOutputE" value="{!item.rec.AccompanyingPaperOutput__c}" html-data-target="data-forbidden-target" styleClass="isAccompanyingPaperOutput" onchange="optionSetting(this);" html-data-compare-value="{!item.rec.AccompanyingPaperOutput__c}" onblur="safetyLockCheck(this);" />
                                    </li>
-->
                                    <li><hr/></li>

                                    <li style="height: 30px;{!IF(language <> 'ja', 'width: 225px;', '')}" class="field detail-options-item close-option" data-type="item" >
                                      <apex:outputLink value="javascript: void(0);" styleClass="closeButton" onclick="clearAction(this);$j(this).closest('[data-type=\'dropdown\']').find('[data-type=\'button\']').trigger('focus');return false;"  style="{!IF(language <> 'ja', 'width: 225px;', '')}" >{!$Label.JEOL_QuotEdit_Label_Close}</apex:outputLink>
                                    </li>
                                  </ul>
                                </div>
                                <div class="{!IF((isReadOnly || isQTRestricted),'hidden','field')}">
                                  <apex:commandLink action="{!item.deleteAction}" title="{!$Label.JEOL_QuotEdit_Label_RemoveRow}" onclick="lockSafety();" rerender="detailAreaE,modalListView,modalListViewDel,SubtotalA,SubtotalB,SubtotalC,SubtotalD,SubtotalE,SubtotalF,SubtotalG,totalResult,apexMessage" styleClass="quotation-detail-action deleteAction" status="ajaxStatusE" >×</apex:commandLink>
                                </div>
                                
                              </apex:outputPanel>
                              
                              
                              <!-- SUMMARY ROW -->
                              <apex:outputPanel id="detail_titleE" layout="block" html-data-depth="{!item.rec.Depth__c}" html-data-sortNo="{!item.rec.SortNo__c}" html-data-section-type="E" html-data-type="{!item.rec.Type__c}" html-data-forbidden-target="{!item.rec.AccompanyingPaperOutput__c}" styleClass="quotation-detail-item quotation-detail-itemE clearfix" rendered="{!item.rec.Type__c = '2'}">
                                <div class="{!IF((isReadOnly || isQTRestricted),'hidden','field')}">
                                  <div class="quotation-detail-action sortableAction sortableActionE" onmousedown="dragActionE(this);" >
                                    <div class="sortable-pointer"></div>
                                  </div>
                                </div>
                                <div class="{!IF((isReadOnly || isQTRestricted),'hidden','field')}">
                                  <div class="quotation-detail-action configAction">
                                    <apex:outputLink value="javascript: void(0);" onclick="removeDepth(this);lockSafety();return false;" styleClass="paragraph-option paragraph-up">&lsaquo;</apex:outputLink>
                                    <apex:outputLink value="javascript: void(0);" onclick="addDepth(this);lockSafety();return false;" styleClass="paragraph-option paragraph-down">&rsaquo;</apex:outputLink>
                                  </div>
                                </div>
                                <div class="hidden">
                                  <apex:inputHidden html-class="quotation-detail-sortNo" value="{!item.rec.SortNo__c}" />
                                  <apex:inputHidden html-class="quotation-detail-depth" value="{!item.rec.Depth__c}" />
                                </div>
                                <div class="field" style="overflow-x: hidden;{!IF((isReadOnly || isQTRestricted),'margin-left: 86px;width: 803px;','')}">
                                  <div class="indent-wrap">
                                    <apex:inputField rendered="{!!(isReadOnly || isQTRestricted)}" styleClass="field-value quotation-detail-headingBody" value="{!item.rec.Body__c}" onfocus="detailBodyFocus(this);" onblur="safetyLockCheck(this);detailBodyBlur(this);" html-data-compare-value="{!item.rec.Body__c}" />
                                    <apex:outputText rendered="{!(isReadOnly || isQTRestricted)}"  styleClass="field-value quotation-detail-headingBody" value="{!item.rec.Body__c}" />
                                  </div>
                                </div>
                                <div class="field">
                                  <div class="panel-area clearfix" >
<!--
                                    <div class="option-view-panel" ></div>
                                    <div class="option-view-panel" ></div>
                                    <div class="option-view-panel" ></div>
                                    <div class="option-view-panel accompanyingPaperOutput" data-target-class="isAccompanyingPaperOutput" onclick="optionSettingFromPanelClick(this);lockSafety();">{!$Label.JEOL_QuotEdit_Label_SeparateSheetShort}</div>
                                    <div class="option-view-panel" ></div>
-->
                                  </div>
                                </div>
                                <div class="{!IF((isReadOnly || isQTRestricted),'hidden','field')}" data-type="dropdown">
                                  <button type="button" onclick="dorpdownAction(this);" data-type="button" class="optionalButton">▼</button>
                                  <ul class="detail-options" data-type="list" style="{!IF(language <> 'ja', 'width: 225px;', '')}">
                                    <li style="height: 30px;{!IF(language <> 'ja', 'width: 225px;', '')}" class="{!IF((isReadOnly || isQTRestricted),'hidden','field detail-options-item')}" data-type="item">
                                      <apex:commandLink action="{!item.copyAction}" title="{!$Label.JEOL_QuotEdit_Label_CloneRow}" onclick="lockSafety();clearAction(this);" rerender="detailAreaE,modalListView,modalListViewDel,SubtotalA,SubtotalB,SubtotalC,SubtotalD,SubtotalE,SubtotalF,SubtotalG,totalResult,apexMessage" styleClass="quotation-detail-action" status="ajaxStatusE" style="{!IF(language <> 'ja', 'width: 225px;', '')}">{!$Label.JEOL_QuotEdit_Label_CloneRow}</apex:commandLink>
                                    </li>

<!--
                                    <li class="{!IF((isReadOnly || isQTRestricted),'hidden','')}" ><hr/></li>

                                    <li style="height: 30px;{!IF(language <> 'ja', 'width: 225px;', '')}" class="field detail-options-item" data-type="item">
                                      <div class="accompanyingPaperOutput"></div>
                                      <apex:outputLabel for="isAccompanyingPaperOutput-breakdownE" value="{!$Label.JEOL_QuotEdit_Label_SeparateSheet}" styleClass="field-label" style="{!IF(language <> 'ja', 'width: 175px;', '')}" />
                                      <apex:inputField id="isAccompanyingPaperOutput-breakdownE" value="{!item.rec.AccompanyingPaperOutput__c}" html-data-target="data-forbidden-target" styleClass="field-value isAccompanyingPaperOutput" onchange="optionSetting(this);" html-data-compare-value="{!item.rec.AccompanyingPaperOutput__c}" onblur="safetyLockCheck(this);" />
                                    </li>
-->

                                    <li><hr/></li>

                                    <li style="height: 30px;{!IF(language <> 'ja', 'width: 225px;', '')}" class="field detail-options-item close-option" data-type="item">
                                      <apex:outputLink value="javascript: void(0);" styleClass="closeButton" onclick="clearAction(this);$j(this).closest('[data-type=\'dropdown\']').find('[data-type=\'button\']').trigger('focus');return false;" >{!$Label.JEOL_QuotEdit_Label_Close}</apex:outputLink>
                                    </li>
                                  </ul>
                                </div>
                                <div class="{!IF((isReadOnly || isQTRestricted),'hidden','field')}" >
                                  <apex:commandLink action="{!item.deleteAction}" title="{!$Label.JEOL_QuotEdit_Label_RemoveRow}" onclick="lockSafety();" rerender="detailAreaE,modalListView,modalListViewDel,SubtotalA,SubtotalB,SubtotalC,SubtotalD,SubtotalE,SubtotalF,SubtotalG,totalResult,apexMessage" styleClass="quotation-detail-action deleteAction" status="ajaxStatusE" >×</apex:commandLink>
                                </div>
                              </apex:outputPanel>
                              
                            </apex:repeat>
                          </apex:outputPanel>
                          <apex:outputPanel layout="none" rendered="{!!hasDetailsE}">
                            <div style="padding: 10px; margin: 2px 0px;">{!$Label.JEOL_QuotEdit_Message_DetailNotCreated}</div>
                          </apex:outputPanel>
                        </apex:outputPanel>
                        <apex:actionStatus layout="block" onstop="initWithCalcurate();focusOpenModalDetail();" id="ajaxStatusE" startStyleClass="ajax-status-start">
                          <apex:facet name="start">
                            <div class="ajax-status-start-inner ajax-loading">
                              <span style="position:relative; z-index: 2;">{!$Label.JEOL_QuotEdit_Label_Searching}</span>
                            </div>
                          </apex:facet>
                        </apex:actionStatus>
                        <hr />

                      </apex:outputPanel>
                        
                      <!-- Add New Item button -->
                      <div class="quotation-item create-action-area" >
                        <div class="quotation-item-body clearfix" >
                          <div class="{!IF((isReadOnly || isQTRestricted),'hidden','field clearfix top')}" data-type="dropdown">
                            <apex:commandLink rerender="detailAreaE,modalListView,modalListViewDel,apexMessage" action="{!qdm.createQuotationDetailE}" oncomplete="lockSafety();showResult('{!$Label.JEOL_QuotEdit_Message_ProcessingCompleted}');" styleClass="add-default-detail customButton" status="ajaxStatusE" >{!$Label.JEOL_QuotEdit_Label_AddNewItem}</apex:commandLink>
                            <apex:outputLink value="javascript: void(0);" onclick="dorpdownAction(this);return false;" html-data-type="button" styleClass="add-optional-details customButton">▲</apex:outputLink>
                            <ul class="optional-list" data-type="list">
                              <li data-type="item">
                                <apex:commandLink styleClass="optional-item" oncomplete="lockSafety();showResult('{!$Label.JEOL_QuotEdit_Message_ProcessingCompleted}');" rerender="detailAreaE,modalListView,modalListViewDel,apexMessage" action="{!qdm.createQuotationDetailEx5}" status="ajaxStatusE" >{!$Label.JEOLAsia_QuotEdit_Label_AddNewItemx5}</apex:commandLink>
                              </li>
                              <li data-type="item">
                                <apex:commandLink styleClass="optional-item" oncomplete="lockSafety();showResult('{!$Label.JEOL_QuotEdit_Message_ProcessingCompleted}');" rerender="detailAreaE,modalListView,modalListViewDel,apexMessage" action="{!qdm.createQuotationDetailE}" status="ajaxStatusE" >{!$Label.JEOL_QuotEdit_Label_AddNewItem}</apex:commandLink>
                              </li>
                              <li data-type="item">
                                <apex:commandLink styleClass="optional-item" oncomplete="lockSafety();showResult('{!$Label.JEOL_QuotEdit_Message_ProcessingCompleted}');" rerender="detailAreaE,modalListView,modalListViewDel,apexMessage" action="{!qdm.createHeadingDetailE}" status="ajaxStatusE">{!$Label.JEOL_QuotEdit_Label_AddHeading}</apex:commandLink>
                              </li>
                              <li><hr/></li>
                              <li class="field close-option" data-type="item">
                                <apex:outputLink value="javascript: void(0);" styleClass="optional-item closeButton" onclick="clearAction(this);$j(this).closest('[data-type=\'dropdown\']').find('[data-type=\'button\']').trigger('focus');return false;" >{!$Label.JEOL_QuotEdit_Label_Close}</apex:outputLink>
                              </li>
                            </ul>
                          </div>
                        </div>
                      </div>

                      <!-- SUMMARY SECTION -->
                      <div class="quotation-item total-amount-area" >
                        <apex:outputPanel layout="block" styleClass="quotation-item-body clearfix" id="SubtotalE">
                          <div class="hidden" >
                            <apex:inputHidden html-class="fieldSubtotalE" value="{!qdm.parentRec.SubtotalE__c}" />
                          </div>

                          <div class="field" >
                            <div class="field-label">
                              <apex:outputLabel for="quotationSubtotalE" value="Subtotal ({!qdm.parentRec.SalesCurrency__c})" style="padding: 8px; background-color: #DDDDDD;" />
                            </div>
                            <apex:outputText id="quotationSubtotalE" styleClass="field-value quotationSubtotalEOutput number" value="{0,number, ###,###,###,###,###,##0.00}" style="font-size: 13px;" >
                              <apex:param value="{!qdm.parentRec.SubtotalE__c}" />
                            </apex:outputText>
                          </div>
                        </apex:outputPanel>
                      </div>
                    </apex:outputPanel>





                    <apex:outputPanel >

                      <apex:outputPanel layout="block" id="detailAreaF"  styleClass="quotation-item quotation-detail-informations" >
                        <apex:variable value="{!qdm.currentSizeF > 0}" var="hasDetailsF" />

                        <div class="quotation-item-header clearfix" style="height: 38px;">
                          <div class="header-title">{!$Label.JEOLAsia_ProfitCalculation_ExpensesInformations}</div>
                        </div>

                        <!-- GRID 6 -->
                        <!-- Grid of items -->
                        <div class="quotation-item-header quotation-detail-header backgroundcolorgrey clearfix">
                          <div class="quotation-detail-header-item quotation-detail-productName quotation-detailF-productName" style="margin-left: 94px;">Product Name</div>
                          <div class="quotation-detail-header-item quotation-detail-Description quotation-detailF-Description">Description</div>
                          <div class="quotation-detail-header-item quotation-detail-quantity quotation-detailF-quantity">Qty</div>
                          <div class="quotation-detail-header-item quotation-detail-UnitPrice quotation-detailF-UnitPrice">Unit Price</div>
                          <div class="quotation-detail-header-item quotation-detail-CatalogCurrency quotation-detailF-CatalogCurrency">Cur</div>
                          <div class="quotation-detail-header-item quotation-detail-CostPrice quotation-detailF-CostPrice">Cost Price<br/>({!qdm.parentRec.SalesCurrency__c})</div>
                          <div class="quotation-detail-header-item quotation-detail-SalesPrice quotation-detailF-SalesPrice">Sales Price<br/>({!qdm.parentRec.SalesCurrency__c})</div>
                          <div class="quotation-detail-header-item quotation-detail-Remarks quotation-detailF-Remarks">Remarks</div>
                        </div>
                        <apex:outputPanel layout="block" styleClass="quotation-item-body clearfix quotation-detail-list quotation-detail-listF">
                          <apex:outputPanel layout="none" rendered="{!hasDetailsF}">
                            <apex:repeat value="{!qdm.itemsF}" var="item" >
                            
                              <!-- NORMAL ROW -->
                              <apex:outputPanel id="detail_productF" layout="block" html-data-depth="{!item.rec.Depth__c}" html-data-sortNo="{!item.rec.SortNo__c}" html-data-section-type="F" html-data-type="{!item.rec.Type__c}" html-data-discount-target="{!item.rec.IsDiscountTarget__c}" html-data-tax-target="{!item.rec.IsTaxationTarget__c}" html-data-overhead-target="{!item.rec.IsOverheadTarget__c}" html-data-show-target="{!item.rec.IsShowDetailAmount__c}" html-data-forbidden-target="{!item.rec.AccompanyingPaperOutput__c}" styleClass="quotation-detail-item quotation-detail-itemF clearfix" rendered="{!item.rec.Type__c = '1'}">
                                <div class="{!IF((isReadOnly || isQTRestricted),'hidden','field')}">
                                  <div class="quotation-detail-action sortableAction sortableActionF" onmousedown="dragActionF(this);" >
                                    <div class="sortable-pointer"></div>
                                  </div>
                                </div>
                                <div class="{!IF((isReadOnly || isQTRestricted),'hidden','field')}">
                                  <div class="quotation-detail-action configAction clearfix">
                                    <apex:outputLink value="javascript: void(0);" onclick="removeDepth(this);lockSafety();return false;" styleClass="paragraph-option paragraph-up">&lsaquo;</apex:outputLink>
                                    <apex:outputLink value="javascript: void(0);" onclick="addDepth(this);lockSafety();return false;" styleClass="paragraph-option paragraph-down">&rsaquo;</apex:outputLink>
                                  </div>
                                </div>
                                <div class="hidden">
                                  <apex:inputHidden html-class="quotation-detail-Amount-input" value="{!item.rec.Amount__c}" />
                                  <apex:inputHidden html-class="quotation-detail-sortNo" value="{!item.rec.SortNo__c}" />
                                  <apex:inputHidden html-class="quotation-detail-depth" value="{!item.rec.Depth__c}" />
                                  <apex:inputHidden html-class="quotation-detail-CostPrice-input" value="{!item.rec.CostPrice__c}" />
                                  <apex:inputHidden html-class="quotation-detail-CostPriceJProdUnit" value="{!item.rec.CostPriceJProdUnit__c}" />
                                </div>





                                <!-- BODY__c -->
                                <div class="field" style="overflow-x: hidden;{!IF((isReadOnly || isQTRestricted),'margin-left: 86px;width: 200px;','')}" >
                                  <div class="indent-wrap" >
                                    <apex:inputField rendered="{!!(isReadOnly || isQTRestricted)}" id="quotation-detail-productNameF" styleClass="field-value quotation-detail-productName quotation-detailF-productName" value="{!item.rec.Body__c}" html-data-compare-value="{!item.rec.Body__c}" onfocus="detailBodyFocus(this);" onblur="detailBodyBlur(this);safetyLockCheck(this);" html-placeholder="{!$Label.JEOL_QuotEdit_Label_ProductName}" ></apex:inputField>
                                    <apex:outputText rendered="{!(isReadOnly || isQTRestricted)}" id="quotation-detail-productNameFView" styleClass="field-value quotation-detail-productName quotation-detailF-productName" value="{!item.rec.Body__c}" style="width: 200px;" />
                                  </div>
                                </div>

                                <!-- DESCRIPTION__c -->
                                <div class="field clearfix">
                                  <apex:inputField rendered="{!!(isReadOnly || isQTRestricted)}" value="{!item.rec.Description__c}" styleClass="field-value quotation-detail-Description quotation-detailF-Description" html-placeholder="Description" html-data-compare-value="{!item.rec.Description__c}" onblur="safetyLockCheck(this);" onkeypress="return disableEnterKey(event)" />
                                  <apex:outputText rendered="{!(isReadOnly || isQTRestricted)}" value="{!item.rec.Description__c}" styleClass="field-value quotation-detail-Description quotation-detailF-Description" /> 
                                </div>

                                <!-- QUANTITY -->
                                <div class="field">
                                  <apex:inputField rendered="{!!(isReadOnly || isQTRestricted)}" styleClass="field-value quotation-detail-quantity quotation-detailF-quantity number " value="{!item.rec.Quantity__c}" onchange="calcurate();" html-data-compare-value="{!item.rec.Quantity__c}" onblur="safetyLockCheck(this);" onkeypress="return disableEnterKey(event)" />
                                  <apex:outputText rendered="{!(isReadOnly || isQTRestricted)}" styleClass="field-value quotation-detail-quantity quotation-detailF-quantity number " value="{0,number, ###,###,###,###,###,##0.0}">
                                    <apex:param value="{!item.rec.Quantity__c}" />
                                  </apex:outputText>

                                </div>

                                <!-- UNIT PRICE -->
                                <div class="field">
                                  <apex:inputField rendered="{!!(isReadOnly || isQTRestricted)}" styleClass="field-value quotation-detail-UnitPrice quotation-detailF-UnitPrice number " value="{!item.rec.UnitPrice__c}" onchange="calcurate();" html-data-compare-value="{!item.rec.UnitPrice__c}" onblur="safetyLockCheck(this);" onkeypress="return disableEnterKey(event)" />

                                  <apex:inputHidden rendered="{!(isReadOnly || isQTRestricted)}" Html-Class="field-value quotation-detail-UnitPrice quotation-detailF-UnitPrice number " value="{!item.rec.UnitPrice__c}" />

                                  <apex:outputText rendered="{!(isReadOnly || isQTRestricted)}" styleClass="field-value quotation-detail-UnitPrice quotation-detailF-UnitPrice number " value="{0,number, ###,###,###,###,###,##0.00}" >
                                    <apex:param value="{!item.rec.UnitPrice__c}" />
                                  </apex:outputText>
                                </div>

                                <!-- CATALOG CURRENCY -->
                                <div class="field">
                                  <apex:selectList rendered="{!!(isReadOnly || isQTRestricted)}" styleClass="field-value quotation-detail-CatalogCurrency quotation-detailF-CatalogCurrency" value="{!item.rec.CatalogCurrency__c}" size="1" html-data-compare-value="{!item.rec.CatalogCurrency__c}" onblur="safetyLockCheck(this);" required="true" onchange="calcurate();" onkeypress="return disableEnterKey(event)" >
                                      <apex:selectOptions value="{!listOtherCurrencyOption}"/> 
                                  </apex:selectList>

                                  <apex:inputHidden rendered="{!(isReadOnly || isQTRestricted)}" Html-Class="field-value quotation-detail-CatalogCurrency quotation-detailF-CatalogCurrency number " value="{!item.rec.CatalogCurrency__c}" />

                                  <apex:outputText rendered="{!(isReadOnly || isQTRestricted)}" styleClass="field-value quotation-detail-CatalogCurrency quotation-detailF-CatalogCurrency number " value="{!item.rec.CatalogCurrency__c}" />
                                </div>

                                <!-- COST PRICE -->
                                <div class="field">
                                  <apex:outputText styleClass="field-value quotation-detail-CostPrice quotation-detailF-CostPrice number" value="{0,number, ###,###,###,###,###,##0.00}" >
                                    <apex:param value="{!item.rec.CostPrice__c}" />
                                  </apex:outputText>
                                </div> 

                                <!-- SALES PRICE -->
                                <div class="field">
                                  <apex:inputField rendered="{!!(isReadOnly || isQTRestricted)}" styleClass="field-value quotation-detail-SalesPrice quotation-detailF-SalesPrice number " value="{!item.rec.SalesPrice__c}" onchange="calcurate();" html-data-compare-value="{!item.rec.SalesPrice__c}" onblur="safetyLockCheck(this);" onkeypress="return disableEnterKey(event)" />
                                  <apex:outputText rendered="{!(isReadOnly || isQTRestricted)}" styleClass="field-value quotation-detail-SalesPrice quotation-detailF-SalesPrice number" value="{0,number, ###,###,###,###,###,##0.00}" >
                                    <apex:param value="{!item.rec.SalesPrice__c}" />
                                  </apex:outputText>
                                </div> 

                                <!-- REMARKS__c -->
                                <div class="field clearfix">
                                  <apex:inputField rendered="{!!(isReadOnly || isQTRestricted)}" value="{!item.rec.Remarks__c}" styleClass="field-value quotation-detail-Remarks quotation-detailF-Remarks" html-placeholder="Remarks" html-data-compare-value="{!item.rec.Remarks__c}" onblur="safetyLockCheck(this);" onkeypress="return disableEnterKey(event)" />
                                  <apex:outputText rendered="{!(isReadOnly || isQTRestricted)}" value="{!item.rec.Remarks__c}" styleClass="field-value quotation-detail-Remarks quotation-detailF-Remarks" /> 
                                </div>





                                <div class="field">
                                  <div class="panel-area clearfix" >
                                    <div class="option-view-panel showAmount" data-target-class="isShowDetailAmountTarget" onclick="optionSettingFromPanelClick(this);lockSafety();">1</div>
<!--
                                    <div class="option-view-panel tax" data-target-class="isTaxationTarget" onclick="{!IF((isReadOnly || isQTRestricted),'','optionSettingFromPanelClick(this);calcurate();lockSafety();')}">{!$Label.JEOL_QuotEdit_Label_TaxableShort}</div>
                                    <div class="option-view-panel overhead" data-target-class="isOverheadTarget" onclick="{!IF((isReadOnly || isQTRestricted),'','optionSettingFromPanelClick(this);calcurate();lockSafety();')}">{!$Label.JEOL_QuotEdit_Label_SundryRelatedShort}</div>
                                    <div class="option-view-panel accompanyingPaperOutput" data-target-class="isAccompanyingPaperOutput" onclick="optionSettingFromPanelClick(this);lockSafety();">{!$Label.JEOL_QuotEdit_Label_SeparateSheetShort}</div>
-->
                                  </div>
                                </div>
                                <div class="field" data-type="dropdown">
                                  <button type="button" onclick="dorpdownAction(this);" data-type="button" class="optionalButton">▼</button>
                                  <ul class="detail-options" data-type="list"  style="{!IF(language <> 'ja', 'width: 225px;', '')}">
                                    <li style="height: 30px;width: 225px;" class="{!IF((isReadOnly || isQTRestricted),'hidden','field detail-options-item')}" data-type="item">
                                      <apex:commandLink action="{!item.copyAction}" title="{!$Label.JEOL_QuotEdit_Label_CloneRow}" onclick="lockSafety();clearAction(this);" rerender="detailAreaF,modalListView,modalListViewDel,SubtotalA,SubtotalB,SubtotalC,SubtotalD,SubtotalE,SubtotalF,SubtotalG,totalResult,apexMessage" styleClass="quotation-detail-action" status="ajaxStatusF"  style="{!IF(language <> 'ja', 'width: 225px;', '')}" >{!$Label.JEOL_QuotEdit_Label_CloneRow}</apex:commandLink>
                                    </li>

                                    <li class="{!IF((isReadOnly || isQTRestricted),'hidden','')}"><hr/></li>

                                    <li style="height: 30px;{!IF(language <> 'ja', 'width: 225px;', '')}" class="field detail-options-item" data-type="item" >
                                      <div class="showAmount"></div>
                                      <apex:outputLabel for="isShowDetailAmountTargetF" value="1. Show detail amount" styleClass="field-label" style="{!IF(language <> 'ja', 'width: 175px;', '')}" />
                                      <apex:inputField id="isShowDetailAmountTargetF" value="{!item.rec.IsShowDetailAmount__c}" html-data-target="data-show-target" styleClass="isShowDetailAmountTarget" onchange="optionSetting(this);" html-data-compare-value="{!item.rec.IsShowDetailAmount__c}" onblur="safetyLockCheck(this);" onkeypress="return disableEnterKey(event)" />
                                    </li>

<!--
                                    <li style="height: 30px;{!IF(language <> 'ja', 'width: 225px;', '')}" class="field detail-options-item" data-type="item">
                                      <div class="tax"></div>
                                      <apex:outputLabel for="isTaxationTargetF" value="{!$Label.JEOL_QuotEdit_Label_Taxable}" styleClass="field-label" style="{!IF(language <> 'ja', 'width: 175px;', '')}" />
                                      <apex:inputField rendered="{!!(isReadOnly || isQTRestricted)}" id="isTaxationTargetF" value="{!item.rec.IsTaxationTarget__c}" html-data-target="data-tax-target" styleClass="isTaxationTarget"  onchange="optionSetting(this);calcurate();" html-data-compare-value="{!item.rec.IsTaxationTarget__c}" onblur="safetyLockCheck(this);" />
                                      <apex:inputcheckbox rendered="{!(isReadOnly || isQTRestricted)}" disabled="true" id="isTaxationTargetFView" value="{!item.rec.IsTaxationTarget__c}" />
                                    </li>
                                    <li style="height: 30px;{!IF(language <> 'ja', 'width: 225px;', '')}" class="field detail-options-item" data-type="item" >
                                      <div class="overhead"></div>
                                      <apex:outputLabel for="isOverheadTargetF" value="{!$Label.JEOL_QuotEdit_Label_SundryRelated}" styleClass="field-label" style="{!IF(language <> 'ja', 'width: 175px;', '')}" />
                                      <apex:inputField rendered="{!!(isReadOnly || isQTRestricted)}" id="isOverheadTargetF" value="{!item.rec.IsOverheadTarget__c}" html-data-target="data-overhead-target" styleClass="isOverheadTarget" onchange="optionSetting(this);calcurate();" html-data-compare-value="{!item.rec.IsOverheadTarget__c}" onblur="safetyLockCheck(this);" />
                                      <apex:inputcheckbox rendered="{!(isReadOnly || isQTRestricted)}" disabled="true" id="isOverheadTargetFView" value="{!item.rec.IsOverheadTarget__c}" />
                                    </li>
                                    <li style="height: 30px;{!IF(language <> 'ja', 'width: 225px;', '')}" class="field detail-options-item" data-type="item" >
                                      <div class="accompanyingPaperOutput"></div>
                                      <apex:outputLabel for="isAccompanyingPaperOutputF" value="{!$Label.JEOL_QuotEdit_Label_SeparateSheet}" styleClass="field-label" style="{!IF(language <> 'ja', 'width: 175px;', '')}" />
                                      <apex:inputField id="isAccompanyingPaperOutputF" value="{!item.rec.AccompanyingPaperOutput__c}" html-data-target="data-forbidden-target" styleClass="isAccompanyingPaperOutput" onchange="optionSetting(this);" html-data-compare-value="{!item.rec.AccompanyingPaperOutput__c}" onblur="safetyLockCheck(this);" />
                                    </li>
-->
                                    <li><hr/></li>

                                    <li style="height: 30px;{!IF(language <> 'ja', 'width: 225px;', '')}" class="field detail-options-item close-option" data-type="item" >
                                      <apex:outputLink value="javascript: void(0);" styleClass="closeButton" onclick="clearAction(this);$j(this).closest('[data-type=\'dropdown\']').find('[data-type=\'button\']').trigger('focus');return false;"  style="{!IF(language <> 'ja', 'width: 225px;', '')}" >{!$Label.JEOL_QuotEdit_Label_Close}</apex:outputLink>
                                    </li>
                                  </ul>
                                </div>
                                <div class="{!IF((isReadOnly || isQTRestricted),'hidden','field')}">
                                  <apex:commandLink action="{!item.deleteAction}" title="{!$Label.JEOL_QuotEdit_Label_RemoveRow}" onclick="lockSafety();" rerender="detailAreaF,modalListView,modalListViewDel,SubtotalA,SubtotalB,SubtotalC,SubtotalD,SubtotalE,SubtotalF,SubtotalG,totalResult,apexMessage" styleClass="quotation-detail-action deleteAction" status="ajaxStatusF" >×</apex:commandLink>
                                </div>
                                
                              </apex:outputPanel>
                              
                              
                              <!-- SUMMARY ROW -->
                              <apex:outputPanel id="detail_titleF" layout="block" html-data-depth="{!item.rec.Depth__c}" html-data-sortNo="{!item.rec.SortNo__c}" html-data-section-type="F" html-data-type="{!item.rec.Type__c}" html-data-forbidden-target="{!item.rec.AccompanyingPaperOutput__c}" styleClass="quotation-detail-item quotation-detail-itemF clearfix" rendered="{!item.rec.Type__c = '2'}">
                                <div class="{!IF((isReadOnly || isQTRestricted),'hidden','field')}">
                                  <div class="quotation-detail-action sortableAction sortableActionF" onmousedown="dragActionF(this);" >
                                    <div class="sortable-pointer"></div>
                                  </div>
                                </div>
                                <div class="{!IF((isReadOnly || isQTRestricted),'hidden','field')}">
                                  <div class="quotation-detail-action configAction">
                                    <apex:outputLink value="javascript: void(0);" onclick="removeDepth(this);lockSafety();return false;" styleClass="paragraph-option paragraph-up">&lsaquo;</apex:outputLink>
                                    <apex:outputLink value="javascript: void(0);" onclick="addDepth(this);lockSafety();return false;" styleClass="paragraph-option paragraph-down">&rsaquo;</apex:outputLink>
                                  </div>
                                </div>
                                <div class="hidden">
                                  <apex:inputHidden html-class="quotation-detail-sortNo" value="{!item.rec.SortNo__c}" />
                                  <apex:inputHidden html-class="quotation-detail-depth" value="{!item.rec.Depth__c}" />
                                </div>
                                <div class="field" style="overflow-x: hidden;{!IF((isReadOnly || isQTRestricted),'margin-left: 86px;width: 803px;','')}">
                                  <div class="indent-wrap">
                                    <apex:inputField rendered="{!!(isReadOnly || isQTRestricted)}" styleClass="field-value quotation-detail-headingBody" value="{!item.rec.Body__c}" onfocus="detailBodyFocus(this);" onblur="safetyLockCheck(this);detailBodyBlur(this);" html-data-compare-value="{!item.rec.Body__c}" />
                                    <apex:outputText rendered="{!(isReadOnly || isQTRestricted)}"  styleClass="field-value quotation-detail-headingBody" value="{!item.rec.Body__c}" />
                                  </div>
                                </div>
                                <div class="field">
                                  <div class="panel-area clearfix" >
<!--
                                    <div class="option-view-panel" ></div>
                                    <div class="option-view-panel" ></div>
                                    <div class="option-view-panel" ></div>
                                    <div class="option-view-panel accompanyingPaperOutput" data-target-class="isAccompanyingPaperOutput" onclick="optionSettingFromPanelClick(this);lockSafety();">{!$Label.JEOL_QuotEdit_Label_SeparateSheetShort}</div>
                                    <div class="option-view-panel" ></div>
-->
                                  </div>
                                </div>
                                <div class="{!IF((isReadOnly || isQTRestricted),'hidden','field')}" data-type="dropdown">
                                  <button type="button" onclick="dorpdownAction(this);" data-type="button" class="optionalButton">▼</button>
                                  <ul class="detail-options" data-type="list" style="{!IF(language <> 'ja', 'width: 225px;', '')}">
                                    <li style="height: 30px;{!IF(language <> 'ja', 'width: 225px;', '')}" class="{!IF((isReadOnly || isQTRestricted),'hidden','field detail-options-item')}" data-type="item">
                                      <apex:commandLink action="{!item.copyAction}" title="{!$Label.JEOL_QuotEdit_Label_CloneRow}" onclick="lockSafety();clearAction(this);" rerender="detailAreaF,modalListView,modalListViewDel,SubtotalA,SubtotalB,SubtotalC,SubtotalD,SubtotalE,SubtotalF,SubtotalG,totalResult,apexMessage" styleClass="quotation-detail-action" status="ajaxStatusF" style="{!IF(language <> 'ja', 'width: 225px;', '')}">{!$Label.JEOL_QuotEdit_Label_CloneRow}</apex:commandLink>
                                    </li>


<!--
                                    <li class="{!IF((isReadOnly || isQTRestricted),'hidden','')}" ><hr/></li>

                                    <li style="height: 30px;{!IF(language <> 'ja', 'width: 225px;', '')}" class="field detail-options-item" data-type="item">
                                      <div class="accompanyingPaperOutput"></div>
                                      <apex:outputLabel for="isAccompanyingPaperOutput-breakdownF" value="{!$Label.JEOL_QuotEdit_Label_SeparateSheet}" styleClass="field-label" style="{!IF(language <> 'ja', 'width: 175px;', '')}" />
                                      <apex:inputField id="isAccompanyingPaperOutput-breakdownF" value="{!item.rec.AccompanyingPaperOutput__c}" html-data-target="data-forbidden-target" styleClass="field-value isAccompanyingPaperOutput" onchange="optionSetting(this);" html-data-compare-value="{!item.rec.AccompanyingPaperOutput__c}" onblur="safetyLockCheck(this);" />
                                    </li>
-->

                                    <li><hr/></li>

                                    <li style="height: 30px;{!IF(language <> 'ja', 'width: 225px;', '')}" class="field detail-options-item close-option" data-type="item">
                                      <apex:outputLink value="javascript: void(0);" styleClass="closeButton" onclick="clearAction(this);$j(this).closest('[data-type=\'dropdown\']').find('[data-type=\'button\']').trigger('focus');return false;" >{!$Label.JEOL_QuotEdit_Label_Close}</apex:outputLink>
                                    </li>
                                  </ul>
                                </div>
                                <div class="{!IF((isReadOnly || isQTRestricted),'hidden','field')}" >
                                  <apex:commandLink action="{!item.deleteAction}" title="{!$Label.JEOL_QuotEdit_Label_RemoveRow}" onclick="lockSafety();" rerender="detailAreaF,modalListView,modalListViewDel,SubtotalA,SubtotalB,SubtotalC,SubtotalD,SubtotalE,SubtotalF,SubtotalG,totalResult,apexMessage" styleClass="quotation-detail-action deleteAction" status="ajaxStatusF" >×</apex:commandLink>
                                </div>
                              </apex:outputPanel>
                              
                            </apex:repeat>
                          </apex:outputPanel>
                          <apex:outputPanel layout="none" rendered="{!!hasDetailsF}">
                            <div style="padding: 10px; margin: 2px 0px;">{!$Label.JEOL_QuotEdit_Message_DetailNotCreated}</div>
                          </apex:outputPanel>
                        </apex:outputPanel>
                        <apex:actionStatus layout="block" onstop="initWithCalcurate();focusOpenModalDetail();" id="ajaxStatusF" startStyleClass="ajax-status-start">
                          <apex:facet name="start">
                            <div class="ajax-status-start-inner ajax-loading">
                              <span style="position:relative; z-index: 2;">{!$Label.JEOL_QuotEdit_Label_Searching}</span>
                            </div>
                          </apex:facet>
                        </apex:actionStatus>
                        <hr />

                      </apex:outputPanel>
                        
                      <!-- Add New Item button -->
                      <div class="quotation-item create-action-area" >
                        <div class="quotation-item-body clearfix" >
                          <div class="{!IF((isReadOnly || isQTRestricted),'hidden','field clearfix top')}" data-type="dropdown">
                            <apex:commandLink rerender="detailAreaF,modalListView,modalListViewDel,apexMessage" action="{!qdm.createQuotationDetailF}" oncomplete="lockSafety();showResult('{!$Label.JEOL_QuotEdit_Message_ProcessingCompleted}');" styleClass="add-default-detail customButton" status="ajaxStatusF" >{!$Label.JEOL_QuotEdit_Label_AddNewItem}</apex:commandLink>
                            <apex:outputLink value="javascript: void(0);" onclick="dorpdownAction(this);return false;" html-data-type="button" styleClass="add-optional-details customButton">▲</apex:outputLink>
                            <ul class="optional-list" data-type="list">
                              <li data-type="item">
                                <apex:commandLink styleClass="optional-item" oncomplete="lockSafety();showResult('{!$Label.JEOL_QuotEdit_Message_ProcessingCompleted}');" rerender="detailAreaF,modalListView,modalListViewDel,apexMessage" action="{!qdm.createQuotationDetailFx5}" status="ajaxStatusF" >{!$Label.JEOLAsia_QuotEdit_Label_AddNewItemx5}</apex:commandLink>
                              </li>
                              <li data-type="item">
                                <apex:commandLink styleClass="optional-item" oncomplete="lockSafety();showResult('{!$Label.JEOL_QuotEdit_Message_ProcessingCompleted}');" rerender="detailAreaF,modalListView,modalListViewDel,apexMessage" action="{!qdm.createQuotationDetailF}" status="ajaxStatusF" >{!$Label.JEOL_QuotEdit_Label_AddNewItem}</apex:commandLink>
                              </li>
                              <li data-type="item">
                                <apex:commandLink styleClass="optional-item" oncomplete="lockSafety();showResult('{!$Label.JEOL_QuotEdit_Message_ProcessingCompleted}');" rerender="detailAreaF,modalListView,modalListViewDel,apexMessage" action="{!qdm.createHeadingDetailF}" status="ajaxStatusF">{!$Label.JEOL_QuotEdit_Label_AddHeading}</apex:commandLink>
                              </li>
                              <li><hr/></li>
                              <li class="field close-option" data-type="item">
                                <apex:outputLink value="javascript: void(0);" styleClass="optional-item closeButton" onclick="clearAction(this);$j(this).closest('[data-type=\'dropdown\']').find('[data-type=\'button\']').trigger('focus');return false;" >{!$Label.JEOL_QuotEdit_Label_Close}</apex:outputLink>
                              </li>
                            </ul>
                          </div>
                        </div>
                      </div>

                      <!-- SUMMARY SECTION -->
                      <div class="quotation-item total-amount-area" >
                        <apex:outputPanel layout="block" styleClass="quotation-item-body clearfix" id="SubtotalF">
                          <div class="hidden" >
                            <apex:inputHidden html-class="fieldSubtotalF" value="{!qdm.parentRec.SubtotalF__c}" />
                          </div>

                          <div class="field" >
                            <div class="field-label">
                              <apex:outputLabel for="quotationSubtotalF" value="Subtotal ({!qdm.parentRec.SalesCurrency__c})" style="padding: 8px; background-color: #DDDDDD;" />
                            </div>
                            <apex:outputText id="quotationSubtotalF" styleClass="field-value quotationSubtotalFOutput number" value="{0,number, ###,###,###,###,###,##0.00}" style="font-size: 13px;" >
                              <apex:param value="{!qdm.parentRec.SubtotalF__c}" />
                            </apex:outputText>
                          </div>
                        </apex:outputPanel>
                      </div>

                    </apex:outputPanel>




                    <hr class="hrdoubleline" />




                    <!-- GRAND SUMMARY SECTION -->
                    <div class="quotation-item total-amount-area">

                      <apex:outputPanel layout="block" styleClass="quotation-item-body clearfix" id="SectionGrandTotalPC">

                        <div class="hidden" >
                          <apex:inputHidden html-class="fieldGrandTotal" value="{!qdm.parentRec.GrandTotal__c}" />
                          <apex:inputHidden html-class="fieldStandardOfferAmount" value="{!qdm.parentRec.StandardOfferAmount__c}" />
                          <apex:inputHidden html-class="fieldProfitTotalRate" value="{!qdm.parentRec.TotalProfitRate__c}" />
                          <apex:inputHidden html-class="fieldProfitTotalValue" value="{!qdm.parentRec.TotalProfitValue__c}" />
                        </div>

                       <!-- Grand Total (Cost) -->
                        <div class="field" >
                          <div class="field-label">
                            <apex:outputLabel value="Grand Total (Cost) ({!qdm.parentRec.SalesCurrency__c})" style="padding: 8px; background-color: #DDDDDD;" />
                          </div>
                          <apex:outputText styleClass="field-value profitCalcGrandTotal number" value="{0,number, ###,###,###,###,###,##0.00}" style="font-size: 13px;" >
                            <apex:param value="{!qdm.parentRec.GrandTotal__c}" />
                          </apex:outputText>
                        </div>

                       <!-- Standard Offer Amount -->
                        <div class="field" >
                          <div class="field-label">
                            <apex:outputLabel value="Standard Offer Amount ({!qdm.parentRec.SalesCurrency__c})" style="padding-right: 8px;" />
                          </div>
                          <apex:outputText styleClass="field-value profitCalcStandardOfferAmount number" value="{0,number, ###,###,###,###,###,##0.00}" style="font-size: 13px;" >
                            <apex:param value="{!qdm.parentRec.StandardOfferAmount__c}" />
                          </apex:outputText>
                        </div>

                       <!-- Offer Amount -->
                        <div class="field" >
                          <div class="field-label">
                            <apex:outputLabel for="profitCalcOfferAmount" value="Offer Amount ({!qdm.parentRec.SalesCurrency__c})" style="padding-right: 8px;" />
                          </div>
                          <apex:inputField rendered="{!!(isFixedPC == '1')}" id="profitCalcOfferAmount" styleClass="field-value profitCalcOfferAmount number" value="{!qdm.parentRec.OfferAmount__c}" onchange="calcurate();" html-data-compare-value="{!qdm.baseParentRec.OfferAmount__c}" onblur="safetyLockCheck(this);" onkeypress="return disableEnterKey(event)" />
                          <apex:outputText rendered="{!(isFixedPC == '1')}" styleClass="field-value profitCalcOfferAmount number" value="{0,number, ###,###,###,###,###,##0.00}" style="font-size: 13px;" >
                            <apex:param value="{!qdm.parentRec.OfferAmount__c}" />
                          </apex:outputText>
                        </div>

                       <!-- Total Profit  -->
                        <div class="field" >
                          <div class="field-label">
                            <apex:outputLabel value="Total Profit ({!qdm.parentRec.SalesCurrency__c})" style="padding: 8px; background-color: #0C4186; color: #FFF;" />
                          </div>
                          <apex:outputText styleClass="profitCalcTotalProfitRate number" value="{0,number, ###,###,###,###,###,##0.0%}" style="font-size: 13px;width: 122px;" >
                            <apex:param value="{!qdm.parentRec.TotalProfitRate__c}" />
                          </apex:outputText>
                          <apex:outputText styleClass="field-value profitCalcTotalProfitValue number" value="{0,number, ###,###,###,###,###,##0.00}" style="font-size: 13px;width: 122px;" >
                            <apex:param value="{!qdm.parentRec.TotalProfitValue__c}" />
                          </apex:outputText>
                        </div>


                      </apex:outputPanel>
                    </div>










                      <!-- GRAND SUMMARY SECTION -->
                      <div class="quotation-item total-amount-area" style="float: right;">
                        <apex:outputPanel layout="block" styleClass="quotation-item-body clearfix" id="SectionGrandTotal">
                          <div class="hidden" >
                            <apex:inputHidden html-class="fieldQuotationSubtitleOutput" value="{!qdm.parentRec.Subtitle__c}" />
                            <apex:inputHidden html-class="quotationSubtotalReductionAmount1" value="{!qdm.parentRec.SubtotalReductionAmount1__c}" />
                            <apex:inputHidden html-class="quotationSubtotalReductionAmount2" value="{!qdm.parentRec.SubtotalReductionAmount2__c}" />
                            <apex:inputHidden html-class="quotationTotalAmount" value="{!qdm.parentRec.TotalAmount__c}" />
                            <apex:inputHidden html-class="quotationConsumptionTaxAmount" value="{!qdm.parentRec.ConsumptionTaxAmount__c}" />
                            <apex:inputHidden html-class="quotationTotalTaxAmount" value="{!qdm.parentRec.TotalTaxAmount__c}" />
                          </div>

                          <!-- SUBTOTAL -->
                          <div class="{!IF(isReadOnly && (qdm.parentRec.CustomReductionAmount1__c == null || qdm.parentRec.CustomReductionAmount1__c == 0 ) && (qdm.parentRec.CustomReductionAmount2__c == null || qdm.parentRec.CustomReductionAmount2__c == 0 ) && (qdm.parentRec.CustomReductionAmount3__c == null || qdm.parentRec.CustomReductionAmount3__c == 0 ),'hidden','field')}" >
                            <apex:inputField rendered="{!!isReadOnly}" value="{!qdm.parentRec.SubtitleLabel__c}" styleClass="field-value subtitleLabel" html-placeholder="{!$Label.JEOL_QuotEdit_Label_SubtotalName}" html-data-compare-value="{!qdm.baseParentRec.SubtitleLabel__c}" onblur="safetyLockCheck(this);" onkeypress="return disableEnterKey(event)" />
                            <apex:outputLabel rendered="{!isReadOnly}" value="{!qdm.parentRec.SubtitleLabel__c}" styleClass="field-value subtitleLabel" html-placeholder="{!$Label.JEOL_QuotEdit_Label_SubtotalName}" />
                            <apex:outputText styleClass="field-value quotationSubtitleOutput number" value="{0,number, ###,###,###,###,###,##0.00}" style="font-size: 13px;">
                              <apex:param value="{!qdm.parentRec.Subtitle__c}" />
                            </apex:outputText>
                            <div class="field-value" style="width: auto;">
                              <apex:inputCheckbox value="{!qdm.parentRec.OutputSubtitle__c}" html-data-compare-value="{!qdm.baseParentRec.OutputSubtitle__c}" onblur="safetyLockCheck(this);" onkeypress="return disableEnterKey(event)"/>  <!--Modification-VAIB(2015/05/27 UAT_QA_List No.72) -->
                            </div>
                          </div>


                          <!-- REDUCTION 1 -->
                          <div class="{!IF(isReadOnly && (qdm.parentRec.CustomReductionAmount1__c == null || qdm.parentRec.CustomReductionAmount1__c == 0 ),'hidden','field')}" >

                            <div class="field-value" style="width: auto;">
                              <apex:selectRadio value="{!qdm.parentRec.SubtotalReduction1PlusMinus__c}" styleClass="customReductionPlusMinus" onchange="setTotalAmount()" onkeypress="return disableEnterKey(event)">
                                <apex:selectoptions value="{!reductionOptions}"></apex:selectoptions>
                              </apex:selectRadio>
                            </div>

                            <apex:inputField rendered="{!!isReadOnly}" value="{!qdm.parentRec.CustomReductionName1__c}" styleClass="field-value customReductionTitle" html-placeholder="{!$Label.JEOL_QuotEdit_Label_DiscountName}" html-data-compare-value="{!qdm.baseParentRec.CustomReductionName1__c}" onblur="safetyLockCheck(this);" style="margin-left: 0px;" onkeypress="return disableEnterKey(event)" />
                            <apex:outputLabel rendered="{!isReadOnly}" value="{!qdm.parentRec.CustomReductionName1__c}" styleClass="field-value customReductionTitle" html-placeholder="{!$Label.JEOL_QuotEdit_Label_DiscountName}" />
                            <apex:inputField rendered="{!!isReadOnly}" id="customReductionAcmount1" styleClass="field-value customReductionAmount number" value="{!qdm.parentRec.CustomReductionAmount1__c}" onchange="setTotalAmount();" html-data-compare-value="{!qdm.baseParentRec.CustomReductionAmount1__c}" onblur="safetyLockCheck(this);" onkeypress="return disableEnterKey(event)" />
                            <apex:outputText rendered="{!isReadOnly}" id="customReductionAcmount1Value" styleClass="field-value customReductionAmount number" value="{!qdm.parentRec.CustomReductionAmount1__c}" />
                          </div>

                          <!-- SUBTOTAL AFTER REDUCTION 1 -->
                          <div class="{!IF(isReadOnly && ((qdm.parentRec.CustomReductionAmount1__c == null || qdm.parentRec.CustomReductionAmount1__c == 0) || ((qdm.parentRec.CustomReductionAmount2__c == null || qdm.parentRec.CustomReductionAmount2__c == 0) && (qdm.parentRec.CustomReductionAmount3__c == null || qdm.parentRec.CustomReductionAmount3__c == 0))),'hidden','field')}" >
                            <apex:inputField rendered="{!!isReadOnly}" value="{!qdm.parentRec.SubtotalReductionName1__c}" styleClass="field-value subtitleLabel" html-placeholder="{!$Label.JEOL_QuotEdit_Label_Subtotal}" html-data-compare-value="{!qdm.baseParentRec.SubtotalReductionName1__c}" onblur="safetyLockCheck(this);" onkeypress="return disableEnterKey(event)" />
                            <apex:outputLabel rendered="{!isReadOnly}" value="{!qdm.parentRec.SubtotalReductionName1__c}" styleClass="field-value subtitleLabel" html-placeholder="{!$Label.JEOL_QuotEdit_Label_Subtotal}" />
                            <apex:outputText styleClass="field-value quotationSubtotalReductionAmount1Output number" value="{0,number, ###,###,###,###,###,##0.00}" style="font-size: 13px;">
                              <apex:param value="{!qdm.parentRec.SubtotalReductionAmount1__c}" />
                            </apex:outputText>
                            <div class="field-value" style="width: auto;">
                              <apex:inputCheckbox value="{!qdm.parentRec.OutputSubtotalReduction1__c}" html-data-compare-value="{!qdm.baseParentRec.OutputSubtotalReduction1__c}" onblur="safetyLockCheck(this);" onkeypress="return disableEnterKey(event)"/>
                            </div>
                          </div>

                          <!-- REDUCTION 2 -->
                          <div class="{!IF(isReadOnly && (qdm.parentRec.CustomReductionAmount2__c == null || qdm.parentRec.CustomReductionAmount2__c == 0 ),'hidden','field')}" >

                            <div class="field-value" style="width: auto;">
                              <apex:selectRadio value="{!qdm.parentRec.SubtotalReduction2PlusMinus__c}" styleClass="customReductionPlusMinus" onchange="setTotalAmount()" onkeypress="return disableEnterKey(event)">
                                <apex:selectoptions value="{!reductionOptions}"></apex:selectoptions>
                              </apex:selectRadio>
                            </div>

                            <apex:inputField rendered="{!!isReadOnly}" value="{!qdm.parentRec.CustomReductionName2__c}" styleClass="field-value customReductionTitle" html-placeholder="{!$Label.JEOL_QuotEdit_Label_DiscountName}" html-data-compare-value="{!qdm.baseParentRec.CustomReductionName2__c}" onblur="safetyLockCheck(this);" style="margin-left: 0px;" onkeypress="return disableEnterKey(event)" />
                            <apex:outputLabel rendered="{!isReadOnly}" value="{!qdm.parentRec.CustomReductionName2__c}" styleClass="field-value customReductionTitle" html-placeholder="{!$Label.JEOL_QuotEdit_Label_DiscountName}" />
                            <apex:inputField rendered="{!!isReadOnly}" id="customReductionAcmount2" styleClass="field-value customReductionAmount number" value="{!qdm.parentRec.CustomReductionAmount2__c}" onchange="setTotalAmount()" html-data-compare-value="{!qdm.baseParentRec.CustomReductionAmount2__c}" onblur="safetyLockCheck(this);" onkeypress="return disableEnterKey(event)" />
                            <apex:outputText rendered="{!isReadOnly}" id="customReductionAcmount2Value" styleClass="field-value customReductionAmount number" value="{!qdm.parentRec.CustomReductionAmount2__c}" />
                          </div>

                          <!-- SUBTOTAL AFTER REDUCTION 2 -->
                          <div class="{!IF(isReadOnly && ((qdm.parentRec.CustomReductionAmount2__c == null || qdm.parentRec.CustomReductionAmount2__c == 0 ) || (qdm.parentRec.CustomReductionAmount3__c == null || qdm.parentRec.CustomReductionAmount3__c == 0 )),'hidden','field')}" >
                            <apex:inputField rendered="{!!isReadOnly}" value="{!qdm.parentRec.SubtotalReductionName2__c}" styleClass="field-value subtitleLabel" html-placeholder="{!$Label.JEOL_QuotEdit_Label_Subtotal}" html-data-compare-value="{!qdm.baseParentRec.SubtotalReductionName2__c}" onblur="safetyLockCheck(this);" onkeypress="return disableEnterKey(event)" />
                            <apex:outputLabel rendered="{!isReadOnly}" value="{!qdm.parentRec.SubtotalReductionName2__c}" styleClass="field-value subtitleLabel" html-placeholder="{!$Label.JEOL_QuotEdit_Label_Subtotal}" />
                            <apex:outputText styleClass="field-value quotationSubtotalReductionAmount2Output number" value="{0,number, ###,###,###,###,###,##0.00}" style="font-size: 13px;">
                              <apex:param value="{!qdm.parentRec.SubtotalReductionAmount2__c}" />
                            </apex:outputText>
                            <div class="field-value" style="width: auto;">
                              <apex:inputCheckbox value="{!qdm.parentRec.OutputSubtotalReduction2__c}" html-data-compare-value="{!qdm.baseParentRec.OutputSubtotalReduction2__c}" onblur="safetyLockCheck(this);" onkeypress="return disableEnterKey(event)"/>
                            </div>
                          </div>

                          <!-- REDUCTION 3 -->
                          <div class="{!IF(isReadOnly && (qdm.parentRec.CustomReductionAmount3__c == null || qdm.parentRec.CustomReductionAmount3__c == 0 ),'hidden','field')}" >

                            <div class="field-value" style="width: auto;">
                              <apex:selectRadio value="{!qdm.parentRec.SubtotalReduction3PlusMinus__c}" styleClass="customReductionPlusMinus" onchange="setTotalAmount()" onkeypress="return disableEnterKey(event)">
                                <apex:selectoptions value="{!reductionOptions}"></apex:selectoptions>
                              </apex:selectRadio>
                            </div>

                            <apex:inputField rendered="{!!isReadOnly}" value="{!qdm.parentRec.CustomReductionName3__c}" styleClass="field-value customReductionTitle" html-placeholder="{!$Label.JEOL_QuotEdit_Label_DiscountName}" html-data-compare-value="{!qdm.baseParentRec.CustomReductionName3__c}" onblur="safetyLockCheck(this);" style="margin-left: 0px;" onkeypress="return disableEnterKey(event)"/>
                            <apex:outputLabel rendered="{!isReadOnly}" value="{!qdm.parentRec.CustomReductionName3__c}" styleClass="field-value customReductionTitle" html-placeholder="{!$Label.JEOL_QuotEdit_Label_DiscountName}" />
                            <apex:inputField rendered="{!!isReadOnly}" id="customReductionAcmount3" styleClass="field-value customReductionAmount number" value="{!qdm.parentRec.CustomReductionAmount3__c}" onchange="setTotalAmount();" html-data-compare-value="{!qdm.baseParentRec.CustomReductionAmount3__c}" onblur="safetyLockCheck(this);" onkeypress="return disableEnterKey(event)" />
                            <apex:outputText rendered="{!isReadOnly}" id="customReductionAcmount3Value" styleClass="field-value customReductionAmount number" value="{!qdm.parentRec.CustomReductionAmount3__c}" />
                          </div>

                          <!-- SUBTOTAL AFTER REDUCTION 3 -->
                          <div class="field" >
                            <apex:inputField rendered="{!!isReadOnly}" value="{!qdm.parentRec.TotalAmountName__c}" styleClass="field-value subtitleLabel" html-placeholder="{!$Label.JEOL_QuotEdit_Label_Subtotal}" html-data-compare-value="{!qdm.baseParentRec.TotalAmountName__c}" onblur="safetyLockCheck(this);" onkeypress="return disableEnterKey(event)" />
                            <apex:outputLabel rendered="{!isReadOnly}" value="{!qdm.parentRec.TotalAmountName__c}" styleClass="field-value subtitleLabel" html-placeholder="{!$Label.JEOL_QuotEdit_Label_Subtotal}" />
                            <apex:outputText styleClass="field-value quotationTotalAmountOutput number" value="{0,number, ###,###,###,###,###,##0.00}" style="font-size: 13px;" >
                              <apex:param value="{!qdm.parentRec.TotalAmount__c}" />
                            </apex:outputText>
                            <div class="field-value" style="width: auto;">
                              <apex:inputCheckbox value="{!qdm.parentRec.OutputTotalAmount__c}" html-data-compare-value="{!qdm.baseParentRec.OutputTotalAmount__c}" onblur="safetyLockCheck(this);" onkeypress="return disableEnterKey(event)" /> <!--Modification-VAIB(2015/05/27 UAT_QA_List No.72) -->
                            </div>
                          </div>
                          <div class="field" >
                            <div class="field-label">
                              <apex:outputLabel for="quotationConsumptionTaxAmountOutput" value="Tax (" style="padding-right: 8px;" />
                              <apex:inputField rendered="{!!isReadOnly}" styleClass="field-value taxRate number" value="{!qdm.parentRec.TaxRate__c}" html-tabIndex="-1" onchange="setTotalAmount();" html-data-compare-value="{!qdm.baseParentRec.TaxRate__c}" onblur="safetyLockCheck(this);" onkeypress="return disableEnterKey(event)" />
                              <apex:outputField rendered="{!isReadOnly}" styleClass="field-value taxRate number" value="{!qdm.parentRec.TaxRate__c}" />
                              <apex:outputText rendered="{!!isReadOnly}" value=" %)" style="padding-left: 8px;" />
                              <apex:outputText rendered="{!isReadOnly}" value=" )" style="padding-left: 8px;" />
                            </div>
                            <apex:outputText id="quotationConsumptionTaxAmountOutput" styleClass="field-value quotationConsumptionTaxAmountOutput number" value="{0,number, ###,###,###,###,###,##0.00}" style="font-size: 13px;" >
                              <apex:param value="{!qdm.parentRec.ConsumptionTaxAmount__c}" />
                            </apex:outputText>
                            <div class="field-value" style="width: auto;">
                              <apex:inputCheckbox value="{!qdm.parentRec.OutputConsumptionTaxAmount__c}" styleClass="includeTaxOutput" html-data-compare-value="{!qdm.baseParentRec.OutputConsumptionTaxAmount__c}" onblur="safetyLockCheck(this);" onkeypress="return disableEnterKey(event)" /> <!--Modification-VAIB(2015/05/27 UAT_QA_List No.72) -->
                            </div>
                          </div>
                          <div class="field" >
                            <apex:inputField rendered="{!!isReadOnly}" value="{!qdm.parentRec.TotalTaxAmountName__c}" styleClass="field-value subtitleLabel" html-placeholder="{!$Label.JEOL_QuotEdit_Label_Total}" html-data-compare-value="{!qdm.baseParentRec.TotalTaxAmountName__c}" onblur="safetyLockCheck(this);" onkeypress="return disableEnterKey(event)" />
                            <apex:outputLabel rendered="{!isReadOnly}" value="{!qdm.parentRec.TotalTaxAmountName__c}" styleClass="field-value subtitleLabel" html-placeholder="{!$Label.JEOL_QuotEdit_Label_Total}" />
                            <apex:outputText styleClass="field-value quotationTotalTaxAmountOutput number" value="{0,number, ###,###,###,###,###,##0.00}" style="font-size: 13px;" >
                              <apex:param value="{!qdm.parentRec.TotalTaxAmount__c}" />
                            </apex:outputText>
                            <div class="field-value" style="width: auto;">
                              <apex:inputCheckbox value="{!qdm.parentRec.OutputTotalTaxAmount__c}" styleClass="includeTaxOutput" html-data-compare-value="{!qdm.baseParentRec.OutputTotalTaxAmount__c}" onblur="safetyLockCheck(this);" onkeypress="return disableEnterKey(event)" /> <!--Modification-VAIB(2015/05/27 UAT_QA_List No.72) -->
                            </div>
                          </div>

                        </apex:outputPanel>
                      </div>






                    <apex:outputPanel >

                      <apex:outputPanel layout="block" id="detailAreaG"  styleClass="quotation-item quotation-detail-informations" >
                        <apex:variable value="{!qdm.currentSizeG > 0}" var="hasDetailsG" />

                        <div class="quotation-item-header clearfix" style="height: 38px;">
                          <div class="header-title">{!$Label.JEOLAsia_ProfitCalculation_RecommendedInformations}</div>
                        </div>

                        <!-- GRID 7 -->
                        <!-- Grid of items -->
                        <div class="quotation-item-header quotation-detail-header backgroundcolorgrey clearfix">
                          <div class="quotation-detail-header-item quotation-detail-productName quotation-detailG-productName" style="margin-left: 94px;">Product Name</div>
                          <div class="quotation-detail-header-item quotation-detail-Description quotation-detailG-Description">Model Type</div>
                          <div class="quotation-detail-header-item quotation-detail-quantity quotation-detailG-quantity">Qty</div>
                          <div class="quotation-detail-header-item quotation-detail-QuantityUnit quotation-detailG-QuantityUnit">Unit</div>
                          <div class="quotation-detail-header-item quotation-detail-UnitPrice quotation-detailG-UnitPrice">Unit Price</div>
                          <div class="quotation-detail-header-item quotation-detail-CatalogCurrency quotation-detailG-CatalogCurrency">Cur</div>
                          <div class="quotation-detail-header-item quotation-detail-CostPrice quotation-detailG-CostPrice">Cost Price<br/>({!qdm.parentRec.SalesCurrency__c})</div>
                          <div class="quotation-detail-header-item quotation-detail-SalesPrice quotation-detailG-SalesPrice">Sales Price<br/>({!qdm.parentRec.SalesCurrency__c})</div>
                          <div class="quotation-detail-header-item quotation-detail-Remarks quotation-detailG-Remarks">Remarks</div>
                        </div>
                        <apex:outputPanel layout="block" styleClass="quotation-item-body clearfix quotation-detail-list quotation-detail-listG">
                          <apex:outputPanel layout="none" rendered="{!hasDetailsG}">
                            <apex:repeat value="{!qdm.itemsG}" var="item" >
                            
                              <!-- NORMAL ROW -->
                              <apex:outputPanel id="detail_productG" layout="block" html-data-depth="{!item.rec.Depth__c}" html-data-sortNo="{!item.rec.SortNo__c}" html-data-section-type="G" html-data-type="{!item.rec.Type__c}" html-data-discount-target="{!item.rec.IsDiscountTarget__c}" html-data-tax-target="{!item.rec.IsTaxationTarget__c}" html-data-overhead-target="{!item.rec.IsOverheadTarget__c}" html-data-jprod-target="{!item.rec.IsJProdTarget__c}" html-data-show-target="{!item.rec.IsShowDetailAmount__c}" html-data-forbidden-target="{!item.rec.AccompanyingPaperOutput__c}" styleClass="quotation-detail-item quotation-detail-itemG clearfix" rendered="{!item.rec.Type__c = '1'}">
                                <div class="{!IF((isReadOnly || isQTRestricted),'hidden','field')}">
                                  <div class="quotation-detail-action sortableAction sortableActionG" onmousedown="dragActionG(this);" >
                                    <div class="sortable-pointer"></div>
                                  </div>
                                </div>
                                <div class="{!IF((isReadOnly || isQTRestricted),'hidden','field')}">
                                  <div class="quotation-detail-action configAction clearfix">
                                    <apex:outputLink value="javascript: void(0);" onclick="removeDepth(this);lockSafety();return false;" styleClass="paragraph-option paragraph-up">&lsaquo;</apex:outputLink>
                                    <apex:outputLink value="javascript: void(0);" onclick="addDepth(this);lockSafety();return false;" styleClass="paragraph-option paragraph-down">&rsaquo;</apex:outputLink>
                                  </div>
                                </div>
                                <div class="hidden">
                                  <apex:inputHidden html-class="quotation-detail-Amount-input" value="{!item.rec.Amount__c}" />
                                  <apex:inputHidden html-class="quotation-detail-sortNo" value="{!item.rec.SortNo__c}" />
                                  <apex:inputHidden html-class="quotation-detail-depth" value="{!item.rec.Depth__c}" />
                                  <apex:inputHidden html-class="quotation-detail-CostPrice-input" value="{!item.rec.CostPrice__c}" />
                                  <apex:inputHidden html-class="quotation-detail-CostPriceJProdUnit" value="{!item.rec.CostPriceJProdUnit__c}" />
                                  <apex:inputHidden html-class="quotation-detail-SalesPriceCoefficient" value="{!item.rec.SalesPriceCoefficient__c}" />
                                </div>

                                <!-- BODY__c -->
                                <div class="field" style="overflow-x: hidden;{!IF((isReadOnly || isQTRestricted),'margin-left: 86px;width: 157px;','')}" >
                                  <div class="indent-wrap" >
                                    <button class="{!IF((isReadOnly || isQTRestricted),'hidden','productSelectButton')}" type="button" data-toggle="modal" onclick="initDetailProductGItemManage($j(this).closest('.quotation-detail-item'));setOpenModalDetailId(this);" data-target="#detailProductItemView"></button>
                                    <apex:inputField rendered="{!!(isReadOnly || isQTRestricted)}" id="quotation-detail-productNameG" styleClass="field-value quotation-detail-productName quotation-detailG-productName" value="{!item.rec.Body__c}" html-data-compare-value="{!item.rec.Body__c}" onfocus="detailBodyFocus(this);" onblur="detailBodyBlur(this);safetyLockCheck(this);" html-placeholder="{!$Label.JEOL_QuotEdit_Label_ProductName}" ></apex:inputField>
                                    <apex:outputText rendered="{!(isReadOnly || isQTRestricted)}" id="quotation-detail-productNameGView" styleClass="field-value quotation-detail-productName quotation-detailG-productName" value="{!item.rec.Body__c}" style="padding-left: 8px;width: 157px;"/>
                                  </div>
                                </div>

                                <!-- MODELTYPE__c -->
                                <div class="field clearfix">
                                  <apex:inputField rendered="{!!(isReadOnly || isQTRestricted)}" value="{!item.rec.ModelType__c}" styleClass="field-value quotation-detail-Description quotation-detailG-Description" html-placeholder="Model Type" html-data-compare-value="{!item.rec.ModelType__c}" onblur="safetyLockCheck(this);" onkeypress="return disableEnterKey(event)" />
                                  <apex:outputText rendered="{!(isReadOnly || isQTRestricted)}" value="{!item.rec.ModelType__c}" styleClass="field-value quotation-detail-Description quotation-detailG-Description" /> 
                                </div>

                                <!-- QUANTITY -->
                                <div class="field">
                                  <apex:inputField rendered="{!!(isReadOnly || isQTRestricted)}" styleClass="field-value quotation-detail-quantity quotation-detailG-quantity number " value="{!item.rec.Quantity__c}" onchange="calcurate();" html-data-compare-value="{!item.rec.Quantity__c}" onblur="safetyLockCheck(this);" onkeypress="return disableEnterKey(event)" />
                                  <apex:outputText rendered="{!(isReadOnly || isQTRestricted)}" styleClass="field-value quotation-detail-quantity quotation-detailG-quantity number " value="{0,number, ###,###,###,###,###,##0.0}">
                                    <apex:param value="{!item.rec.Quantity__c}" />
                                  </apex:outputText>

                                </div>

                                <!-- QUANTITY UNIT -->
                                <div class="field">
                                  <apex:inputField rendered="{!!(isReadOnly || isQTRestricted)}" styleClass="field-value quotation-detail-QuantityUnit quotation-detailG-QuantityUnit" value="{!item.rec.QuantityUnit__c}" onchange="calcurate();" html-data-compare-value="{!item.rec.QuantityUnit__c}" onblur="safetyLockCheck(this);" onkeypress="return disableEnterKey(event)" />
                                  <apex:outputText rendered="{!(isReadOnly || isQTRestricted)}" styleClass="field-value quotation-detail-QuantityUnit quotation-detailG-QuantityUnit" value="{!item.rec.QuantityUnit__c}" />
                                </div>

                                <!-- UNIT PRICE -->
                                <div class="field">
                                  <apex:inputField rendered="{!!(isReadOnly || isQTRestricted)}" styleClass="field-value quotation-detail-UnitPrice quotation-detailG-UnitPrice number " value="{!item.rec.UnitPrice__c}" onchange="calcurate();" html-data-compare-value="{!item.rec.UnitPrice__c}" onblur="safetyLockCheck(this);" onkeypress="return disableEnterKey(event)" />

                                  <apex:inputHidden rendered="{!(isReadOnly || isQTRestricted)}" Html-Class="field-value quotation-detail-UnitPrice quotation-detailG-UnitPrice number " value="{!item.rec.UnitPrice__c}" />

                                  <apex:outputText rendered="{!(isReadOnly || isQTRestricted)}" styleClass="field-value quotation-detail-UnitPrice quotation-detailG-UnitPrice number " value="{0,number, ###,###,###,###,###,##0.00}" >
                                    <apex:param value="{!item.rec.UnitPrice__c}" />
                                  </apex:outputText>
                                </div>

                                <!-- CATALOG CURRENCY -->
                                <div class="field">
                                  <apex:selectList rendered="{!!(isReadOnly || isQTRestricted)}" styleClass="field-value quotation-detail-CatalogCurrency quotation-detailG-CatalogCurrency" value="{!item.rec.CatalogCurrency__c}" size="1" html-data-compare-value="{!item.rec.CatalogCurrency__c}" onblur="safetyLockCheck(this);" required="true" onchange="calcurate();" onkeypress="return disableEnterKey(event)" >
                                      <apex:selectOptions value="{!listOtherCurrencyOption}"/> 
                                  </apex:selectList>

                                  <apex:inputHidden rendered="{!(isReadOnly || isQTRestricted)}" Html-Class="field-value quotation-detail-CatalogCurrency quotation-detailG-CatalogCurrency number " value="{!item.rec.CatalogCurrency__c}" />

                                  <apex:outputText rendered="{!(isReadOnly || isQTRestricted)}" styleClass="field-value quotation-detail-CatalogCurrency quotation-detailG-CatalogCurrency number " value="{!item.rec.CatalogCurrency__c}" />
                                </div>

                                <!-- COST PRICE -->
                                <div class="field">
                                  <apex:outputText styleClass="field-value quotation-detail-CostPrice quotation-detailG-CostPrice number" value="{0,number, ###,###,###,###,###,##0.00}" >
                                    <apex:param value="{!item.rec.CostPrice__c}" />
                                  </apex:outputText>
                                </div> 

                                <!-- SALES PRICE -->
                                <div class="field">
                                  <apex:inputField rendered="{!!(isReadOnly || isQTRestricted)}" styleClass="field-value quotation-detail-SalesPrice quotation-detailG-SalesPrice number " value="{!item.rec.SalesPrice__c}" onchange="calcurate();" html-data-compare-value="{!item.rec.SalesPrice__c}" onblur="safetyLockCheck(this);" onkeypress="return disableEnterKey(event)" />
                                  <apex:outputText rendered="{!(isReadOnly || isQTRestricted)}" styleClass="field-value quotation-detail-SalesPrice quotation-detailG-SalesPrice number" value="{0,number, ###,###,###,###,###,##0.00}" >
                                    <apex:param value="{!item.rec.SalesPrice__c}" />
                                  </apex:outputText>
                                </div> 

                                <!-- REMARKS__c -->
                                <div class="field clearfix">
                                  <apex:inputField rendered="{!!(isReadOnly || isQTRestricted)}" value="{!item.rec.Remarks__c}" styleClass="field-value quotation-detail-Remarks quotation-detailG-Remarks" html-placeholder="Remarks" html-data-compare-value="{!item.rec.Remarks__c}" onblur="safetyLockCheck(this);" onkeypress="return disableEnterKey(event)" />
                                  <apex:outputText rendered="{!(isReadOnly || isQTRestricted)}" value="{!item.rec.Remarks__c}" styleClass="field-value quotation-detail-Remarks quotation-detailG-Remarks" /> 
                                </div>





                                <div class="field">
                                  <div class="panel-area clearfix" >
                                    <div class="option-view-panel showAmount" data-target-class="isShowDetailAmountTarget" onclick="optionSettingFromPanelClick(this);lockSafety();">1</div>
                                    <div class="option-view-panel">2</div>
                                    <div class="option-view-panel jProdTarget" data-target-class="isJProdTarget" onclick="{!IF((isReadOnly || isQTRestricted),'','optionSettingFromPanelClick(this);calcurate();lockSafety();')}">3</div>

<!--
                                    <div class="option-view-panel tax" data-target-class="isTaxationTarget" onclick="{!IF((isReadOnly || isQTRestricted),'','optionSettingFromPanelClick(this);calcurate();lockSafety();')}">{!$Label.JEOL_QuotEdit_Label_TaxableShort}</div>
                                    <div class="option-view-panel overhead" data-target-class="isOverheadTarget" onclick="{!IF((isReadOnly || isQTRestricted),'','optionSettingFromPanelClick(this);calcurate();lockSafety();')}">{!$Label.JEOL_QuotEdit_Label_SundryRelatedShort}</div>
                                    <div class="option-view-panel accompanyingPaperOutput" data-target-class="isAccompanyingPaperOutput" onclick="optionSettingFromPanelClick(this);lockSafety();">{!$Label.JEOL_QuotEdit_Label_SeparateSheetShort}</div>
-->
                                  </div>
                                </div>
                                <div class="field" data-type="dropdown">
                                  <button type="button" onclick="dorpdownAction(this);" data-type="button" class="optionalButton">▼</button>
                                  <ul class="detail-options" data-type="list"  style="{!IF(language <> 'ja', 'width: 225px;', '')}">
                                    <li style="height: 30px;width: 225px;" class="{!IF((isReadOnly || isQTRestricted),'hidden','field detail-options-item')}" data-type="item">
                                      <apex:commandLink action="{!item.copyAction}" title="{!$Label.JEOL_QuotEdit_Label_CloneRow}" onclick="lockSafety();clearAction(this);" rerender="detailAreaG,modalListView,modalListViewDel,SubtotalA,SubtotalB,SubtotalC,SubtotalD,SubtotalE,SubtotalF,SubtotalG,totalResult,apexMessage" styleClass="quotation-detail-action" status="ajaxStatusG"  style="{!IF(language <> 'ja', 'width: 225px;', '')}" >{!$Label.JEOL_QuotEdit_Label_CloneRow}</apex:commandLink>
                                    </li>

                                    <li class="{!IF((isReadOnly || isQTRestricted),'hidden','')}"><hr/></li>

                                    <li style="height: 30px;{!IF(language <> 'ja', 'width: 225px;', '')}" class="field detail-options-item" data-type="item" >
                                      <div class="showAmount"></div>
                                      <apex:outputLabel for="isShowDetailAmountTargetG" value="1. Show detail amount" styleClass="field-label" style="{!IF(language <> 'ja', 'width: 175px;', '')}" />
                                      <apex:inputField id="isShowDetailAmountTargetG" value="{!item.rec.IsShowDetailAmount__c}" html-data-target="data-show-target" styleClass="isShowDetailAmountTarget" onchange="optionSetting(this);" html-data-compare-value="{!item.rec.IsShowDetailAmount__c}" onblur="safetyLockCheck(this);" onkeypress="return disableEnterKey(event)" />
                                    </li>


                                    <li style="height: 30px;{!IF(language <> 'ja', 'width: 225px;', '')}" class="field detail-options-item" data-type="item">
                                      <div class="jProdTarget"></div>
                                      <apex:outputLabel for="isJProdTargetG" value="3. JEOL Product" styleClass="field-label" style="{!IF(language <> 'ja', 'width: 175px;', '')}" />
                                      <apex:inputField rendered="{!!(isReadOnly || isQTRestricted)}" id="isJProdTargetG" value="{!item.rec.IsJProdTarget__c}" html-data-target="data-jprod-target" styleClass="isJProdTarget" onchange="optionSetting(this);calcurate();" html-data-compare-value="{!item.rec.IsJProdTarget__c}" onblur="safetyLockCheck(this);" onkeypress="return disableEnterKey(event)" />
                                      <apex:inputcheckbox rendered="{!(isReadOnly || isQTRestricted)}" disabled="true" id="isJProdTargetGView" value="{!item.rec.IsJProdTarget__c}" onkeypress="return disableEnterKey(event)" />
                                    </li>

<!--
                                    <li style="height: 30px;{!IF(language <> 'ja', 'width: 225px;', '')}" class="field detail-options-item" data-type="item">
                                      <div class="tax"></div>
                                      <apex:outputLabel for="isTaxationTargetG" value="{!$Label.JEOL_QuotEdit_Label_Taxable}" styleClass="field-label" style="{!IF(language <> 'ja', 'width: 175px;', '')}" />
                                      <apex:inputField rendered="{!!(isReadOnly || isQTRestricted)}" id="isTaxationTargetG" value="{!item.rec.IsTaxationTarget__c}" html-data-target="data-tax-target" styleClass="isTaxationTarget"  onchange="optionSetting(this);calcurate();" html-data-compare-value="{!item.rec.IsTaxationTarget__c}" onblur="safetyLockCheck(this);" />
                                      <apex:inputcheckbox rendered="{!(isReadOnly || isQTRestricted)}" disabled="true" id="isTaxationTargetGView" value="{!item.rec.IsTaxationTarget__c}" />
                                    </li>
                                    <li style="height: 30px;{!IF(language <> 'ja', 'width: 225px;', '')}" class="field detail-options-item" data-type="item" >
                                      <div class="overhead"></div>
                                      <apex:outputLabel for="isOverheadTargetG" value="{!$Label.JEOL_QuotEdit_Label_SundryRelated}" styleClass="field-label" style="{!IF(language <> 'ja', 'width: 175px;', '')}" />
                                      <apex:inputField rendered="{!!(isReadOnly || isQTRestricted)}" id="isOverheadTargetG" value="{!item.rec.IsOverheadTarget__c}" html-data-target="data-overhead-target" styleClass="isOverheadTarget" onchange="optionSetting(this);calcurate();" html-data-compare-value="{!item.rec.IsOverheadTarget__c}" onblur="safetyLockCheck(this);" />
                                      <apex:inputcheckbox rendered="{!(isReadOnly || isQTRestricted)}" disabled="true" id="isOverheadTargetGView" value="{!item.rec.IsOverheadTarget__c}" />
                                    </li>
                                    <li style="height: 30px;{!IF(language <> 'ja', 'width: 225px;', '')}" class="field detail-options-item" data-type="item" >
                                      <div class="accompanyingPaperOutput"></div>
                                      <apex:outputLabel for="isAccompanyingPaperOutputG" value="{!$Label.JEOL_QuotEdit_Label_SeparateSheet}" styleClass="field-label" style="{!IF(language <> 'ja', 'width: 175px;', '')}" />
                                      <apex:inputField id="isAccompanyingPaperOutputG" value="{!item.rec.AccompanyingPaperOutput__c}" html-data-target="data-forbidden-target" styleClass="isAccompanyingPaperOutput" onchange="optionSetting(this);" html-data-compare-value="{!item.rec.AccompanyingPaperOutput__c}" onblur="safetyLockCheck(this);" />
                                    </li>
-->

                                    <li><hr/></li>

                                    <li style="height: 30px;{!IF(language <> 'ja', 'width: 225px;', '')}" class="field detail-options-item close-option" data-type="item" >
                                      <apex:outputLink value="javascript: void(0);" styleClass="closeButton" onclick="clearAction(this);$j(this).closest('[data-type=\'dropdown\']').find('[data-type=\'button\']').trigger('focus');return false;"  style="{!IF(language <> 'ja', 'width: 225px;', '')}" >{!$Label.JEOL_QuotEdit_Label_Close}</apex:outputLink>
                                    </li>
                                  </ul>
                                </div>
                                <div class="{!IF((isReadOnly || isQTRestricted),'hidden','field')}">
                                  <apex:commandLink action="{!item.deleteAction}" title="{!$Label.JEOL_QuotEdit_Label_RemoveRow}" onclick="lockSafety();" rerender="detailAreaG,modalListView,modalListViewDel,SubtotalA,SubtotalB,SubtotalC,SubtotalD,SubtotalE,SubtotalF,SubtotalG,totalResult,apexMessage" styleClass="quotation-detail-action deleteAction" status="ajaxStatusG" >×</apex:commandLink>
                                </div>
                                
                              </apex:outputPanel>
                              
                              
                              <!-- SUMMARY ROW -->
                              <apex:outputPanel id="detail_titleG" layout="block" html-data-depth="{!item.rec.Depth__c}" html-data-sortNo="{!item.rec.SortNo__c}" html-data-section-type="G" html-data-type="{!item.rec.Type__c}" html-data-forbidden-target="{!item.rec.AccompanyingPaperOutput__c}" styleClass="quotation-detail-item quotation-detail-itemG clearfix" rendered="{!item.rec.Type__c = '2'}">
                                <div class="{!IF((isReadOnly || isQTRestricted),'hidden','field')}">
                                  <div class="quotation-detail-action sortableAction sortableActionG" onmousedown="dragActionG(this);" >
                                    <div class="sortable-pointer"></div>
                                  </div>
                                </div>
                                <div class="{!IF((isReadOnly || isQTRestricted),'hidden','field')}">
                                  <div class="quotation-detail-action configAction">
                                    <apex:outputLink value="javascript: void(0);" onclick="removeDepth(this);lockSafety();return false;" styleClass="paragraph-option paragraph-up">&lsaquo;</apex:outputLink>
                                    <apex:outputLink value="javascript: void(0);" onclick="addDepth(this);lockSafety();return false;" styleClass="paragraph-option paragraph-down">&rsaquo;</apex:outputLink>
                                  </div>
                                </div>
                                <div class="hidden">
                                  <apex:inputHidden html-class="quotation-detail-sortNo" value="{!item.rec.SortNo__c}" />
                                  <apex:inputHidden html-class="quotation-detail-depth" value="{!item.rec.Depth__c}" />
                                </div>
                                <div class="field" style="overflow-x: hidden;{!IF((isReadOnly || isQTRestricted),'margin-left: 86px;width: 803px;','')}">
                                  <div class="indent-wrap">
                                    <apex:inputField rendered="{!!(isReadOnly || isQTRestricted)}" styleClass="field-value quotation-detail-headingBody" value="{!item.rec.Body__c}" onfocus="detailBodyFocus(this);" onblur="safetyLockCheck(this);detailBodyBlur(this);" html-data-compare-value="{!item.rec.Body__c}" />
                                    <apex:outputText rendered="{!(isReadOnly || isQTRestricted)}"  styleClass="field-value quotation-detail-headingBody" value="{!item.rec.Body__c}" />
                                  </div>
                                </div>
                                <div class="field">
                                  <div class="panel-area clearfix" >
<!--
                                    <div class="option-view-panel" ></div>
                                    <div class="option-view-panel" ></div>
                                    <div class="option-view-panel" ></div>
                                    <div class="option-view-panel accompanyingPaperOutput" data-target-class="isAccompanyingPaperOutput" onclick="optionSettingFromPanelClick(this);lockSafety();">{!$Label.JEOL_QuotEdit_Label_SeparateSheetShort}</div>
                                    <div class="option-view-panel" ></div>
-->
                                  </div>
                                </div>
                                <div class="{!IF((isReadOnly || isQTRestricted),'hidden','field')}" data-type="dropdown">
                                  <button type="button" onclick="dorpdownAction(this);" data-type="button" class="optionalButton">▼</button>
                                  <ul class="detail-options" data-type="list" style="{!IF(language <> 'ja', 'width: 225px;', '')}">
                                    <li style="height: 30px;{!IF(language <> 'ja', 'width: 225px;', '')}" class="{!IF((isReadOnly || isQTRestricted),'hidden','field detail-options-item')}" data-type="item">
                                      <apex:commandLink action="{!item.copyAction}" title="{!$Label.JEOL_QuotEdit_Label_CloneRow}" onclick="lockSafety();clearAction(this);" rerender="detailAreaG,modalListView,modalListViewDel,SubtotalA,SubtotalB,SubtotalC,SubtotalD,SubtotalE,SubtotalF,SubtotalG,totalResult,apexMessage" styleClass="quotation-detail-action" status="ajaxStatusG" style="{!IF(language <> 'ja', 'width: 225px;', '')}">{!$Label.JEOL_QuotEdit_Label_CloneRow}</apex:commandLink>
                                    </li>

<!--
                                    <li class="{!IF((isReadOnly || isQTRestricted),'hidden','')}" ><hr/></li>

                                    <li style="height: 30px;{!IF(language <> 'ja', 'width: 225px;', '')}" class="field detail-options-item" data-type="item">
                                      <div class="accompanyingPaperOutput"></div>
                                      <apex:outputLabel for="isAccompanyingPaperOutput-breakdownG" value="{!$Label.JEOL_QuotEdit_Label_SeparateSheet}" styleClass="field-label" style="{!IF(language <> 'ja', 'width: 175px;', '')}" />
                                      <apex:inputField id="isAccompanyingPaperOutput-breakdownG" value="{!item.rec.AccompanyingPaperOutput__c}" html-data-target="data-forbidden-target" styleClass="field-value isAccompanyingPaperOutput" onchange="optionSetting(this);" html-data-compare-value="{!item.rec.AccompanyingPaperOutput__c}" onblur="safetyLockCheck(this);" />
                                    </li>
-->

                                    <li><hr/></li>

                                    <li style="height: 30px;{!IF(language <> 'ja', 'width: 225px;', '')}" class="field detail-options-item close-option" data-type="item">
                                      <apex:outputLink value="javascript: void(0);" styleClass="closeButton" onclick="clearAction(this);$j(this).closest('[data-type=\'dropdown\']').find('[data-type=\'button\']').trigger('focus');return false;" >{!$Label.JEOL_QuotEdit_Label_Close}</apex:outputLink>
                                    </li>
                                  </ul>
                                </div>
                                <div class="{!IF((isReadOnly || isQTRestricted),'hidden','field')}" >
                                  <apex:commandLink action="{!item.deleteAction}" title="{!$Label.JEOL_QuotEdit_Label_RemoveRow}" onclick="lockSafety();" rerender="detailAreaG,modalListView,modalListViewDel,SubtotalA,SubtotalB,SubtotalC,SubtotalD,SubtotalE,SubtotalF,SubtotalG,totalResult,apexMessage" styleClass="quotation-detail-action deleteAction" status="ajaxStatusG" >×</apex:commandLink>
                                </div>
                              </apex:outputPanel>
                              
                            </apex:repeat>
                          </apex:outputPanel>
                          <apex:outputPanel layout="none" rendered="{!!hasDetailsG}">
                            <div style="padding: 10px; margin: 2px 0px;">{!$Label.JEOL_QuotEdit_Message_DetailNotCreated}</div>
                          </apex:outputPanel>
                        </apex:outputPanel>
                        <apex:actionStatus layout="block" onstop="initWithCalcurate();focusOpenModalDetail();" id="ajaxStatusG" startStyleClass="ajax-status-start">
                          <apex:facet name="start">
                            <div class="ajax-status-start-inner ajax-loading">
                              <span style="position:relative; z-index: 2;">{!$Label.JEOL_QuotEdit_Label_Searching}</span>
                            </div>
                          </apex:facet>
                        </apex:actionStatus>
                        <hr />

                      </apex:outputPanel>
                        
                      <!-- Add New Item button -->
                      <div class="quotation-item create-action-area" >
                        <div class="quotation-item-body clearfix" >
                          <div class="{!IF((isReadOnly || isQTRestricted),'hidden','field clearfix top')}" data-type="dropdown">
                            <apex:commandLink rerender="detailAreaG,modalListView,modalListViewDel,apexMessage" action="{!qdm.createQuotationDetailG}" oncomplete="lockSafety();showResult('{!$Label.JEOL_QuotEdit_Message_ProcessingCompleted}');" styleClass="add-default-detail customButton" status="ajaxStatusG" >{!$Label.JEOL_QuotEdit_Label_AddNewItem}</apex:commandLink>
                            <apex:outputLink value="javascript: void(0);" onclick="dorpdownAction(this);return false;" html-data-type="button" styleClass="add-optional-details customButton">▲</apex:outputLink>
                            <ul class="optional-list" data-type="list">
                              <li data-type="item">
                                <apex:commandLink styleClass="optional-item" oncomplete="lockSafety();showResult('{!$Label.JEOL_QuotEdit_Message_ProcessingCompleted}');" rerender="detailAreaG,modalListView,modalListViewDel,apexMessage" action="{!qdm.createQuotationDetailGx5}" status="ajaxStatusG" >{!$Label.JEOLAsia_QuotEdit_Label_AddNewItemx5}</apex:commandLink>
                              </li>
                              <li data-type="item">
                                <apex:commandLink styleClass="optional-item" oncomplete="lockSafety();showResult('{!$Label.JEOL_QuotEdit_Message_ProcessingCompleted}');" rerender="detailAreaG,modalListView,modalListViewDel,apexMessage" action="{!qdm.createQuotationDetailG}" status="ajaxStatusG" >{!$Label.JEOL_QuotEdit_Label_AddNewItem}</apex:commandLink>
                              </li>
                              <li data-type="item">
                                <apex:commandLink styleClass="optional-item" oncomplete="lockSafety();showResult('{!$Label.JEOL_QuotEdit_Message_ProcessingCompleted}');" rerender="detailAreaG,modalListView,modalListViewDel,apexMessage" action="{!qdm.createHeadingDetailG}" status="ajaxStatusG">{!$Label.JEOL_QuotEdit_Label_AddHeading}</apex:commandLink>
                              </li>
                              <li><hr/></li>
                              <li class="field close-option" data-type="item">
                                <apex:outputLink value="javascript: void(0);" styleClass="optional-item closeButton" onclick="clearAction(this);$j(this).closest('[data-type=\'dropdown\']').find('[data-type=\'button\']').trigger('focus');return false;" >{!$Label.JEOL_QuotEdit_Label_Close}</apex:outputLink>
                              </li>
                            </ul>
                          </div>
                        </div>
                      </div>
                    </apex:outputPanel>






                  </div>
                </div>
              </div>


            </apex:outputPanel>

            <div class="footer">
              <apex:include pageName="{!$Page.JEOL_VisualforceFooter}" />
            </div>

            <style>
              .modal-dialog .modal-content {
                border: 2px solid #5e82b2;
                //overflow: hidden;
              }
              .modal-dialog.modal-alert .modal-content {
                border: 2px solid #e34b4b; 
              }
              #OutputPrintView .modal-dialog {width: 600px;}
              #detailProductItemView .modal-dialog {width: 882px;}
              #certificatePrintView .modal-dialog {width: 822px;}
              #multiDeleteView .modal-dialog {width: 822px;}
              .modal-dialog .modal-content .modal-header {
                background: #5e82b2;
                background: -moz-linear-gradient(top,  #5e82b2 0%, #5575a1 100%);
                background: -webkit-gradient(linear, left top, left bottom, color-stop(0%,#5e82b2), color-stop(100%,#5575a1));
                background: -webkit-linear-gradient(top,  #5e82b2 0%,#5575a1 100%);
                background: -o-linear-gradient(top,  #5e82b2 0%,#5575a1 100%);
                background: -ms-linear-gradient(top,  #5e82b2 0%,#5575a1 100%);
                background: linear-gradient(to bottom,  #5e82b2 0%,#5575a1 100%);
                filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#5e82b2', endColorstr='#5575a1',GradientType=0 );
                text-shadow: -1px -1px #415b7c, 1px 1px #415b7c;
                font-size: 16px;
                font-weight: bold;
                color: #fff;
                border-bottom: none;
              }
              .modal-dialog.modal-alert .modal-content .modal-header {
                background: #e34b4b; /* Old browsers */
                background: -moz-linear-gradient(top,  #e34b4b 0%, #993737 100%); /* FF3.6+ */
                background: -webkit-gradient(linear, left top, left bottom, color-stop(0%,#e34b4b), color-stop(100%,#993737)); /* Chrome,Safari4+ */
                background: -webkit-linear-gradient(top,  #e34b4b 0%,#993737 100%); /* Chrome10+,Safari5.1+ */
                background: -o-linear-gradient(top,  #e34b4b 0%,#993737 100%); /* Opera 11.10+ */
                background: -ms-linear-gradient(top,  #e34b4b 0%,#993737 100%); /* IE10+ */
                background: linear-gradient(to bottom,  #e34b4b 0%,#993737 100%); /* W3C */
                filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#e34b4b', endColorstr='#993737',GradientType=0 ); /* IE6-9 */
              }
              .modal-dialog .modal-body {
              }
              .modal-body .search-area {
                padding-top: 0px;
                background-color: #becde0;
                border: none;
                padding: 8px;
                margin-bottom: 16px;
                position: relative;
              }
              .modal-dialog .modal-content .modal-body .search-area .toggle-button {
                width: 80px;
                height: 20px;
                border-radius: 0 0 6px 6px;
                border: 1px solid #7e9bc1;
                background-color: #ffffff;
                text-align: center;
                cursor: pointer;
                line-height: 20px;
                position: absolute;
                top: 100%;
                padding: 0px;
              }
              .modal-body .search-area .toggle-button:before {
                content: '▼';
              }
              .modal-body .search-area .collapse.in + .toggle-button:before {
                content: '▲';
              }
              .modal-body .search-area .section-body .field,
              .modal-body .search-area .section-body .field .field-value[type="text"] {
                width: 100%;
              }
              .modal-body .search-area .section-body .search-field {
                display: table;
                float: left;
              }
              .modal-body .search-area .section-body .search-field .field {
                display: table-row;
                float: none;
              }
              .modal-body .search-area .section-body .search-field .field .field-label,
              .modal-body .search-area .section-body .search-field .field .field-value[type="text"] {
                display: table-cell;
              } 
              .modal-body .search-area .section-body .search-field .field .field-label {
                width: 1%;
                min-width: 80px;
                white-space: nowrap;
              }
              .modal-body .search-area .section-body .search-field .field .field-value[type="text"] {
                width: 100%;
              }
              .modal-body .search-area .section-body .field.field-fitness,
              .modal-body .search-area .section-body .field.field-fitness .field-value {
                width: auto;
              }
              .modal-dialog .modal-body .errors {
                display: none;
              }
              .modal-dialog .modal-body .select-area {
                width: 100%;
              }
              .modal-dialog .modal-body .select-area>* {
                float: left;
              }
              .modal-dialog .modal-body .select-area:after {
                content: ".";
                display: block;
                height: 0px;
                overflow: hidden;
                clear: both;
              }
              .modal-dialog .modal-content .modal-body .select-area .item-list {
                width: 100%;
                height: 342px;
                overflow: auto;
              }
              .setting-row {
                width: 100%;
              }
              fieldset.setting-row {
                margin-top: 20px;
              }
              fieldset.setting-row legend {
                color: inherit;
                font-weight: normal;
                padding: 4px 8px;
              }
              .contents .modal-body .options-area .output-controls fieldset.setting-row .field .field-label {
                line-height: 30px;
                padding: 0px 8px;
              }
              
              .contents .modal-body .options-area .output-controls fieldset.setting-row .field .field-label,
              .contents .modal-body .options-area .output-controls fieldset.setting-row .field .field-value {
                height: 30px;
                vertical-align: middle;
              }
              .setting-row .word-text .field-value,
              .setting-row .word-text .field-label {
                font-size: 13px;
                text-align: left;
                width: 452px;
                margin-left: 8px; 
              }
              .setting-row .word-select-list .field-value,
              .setting-row .word-select-list .field-label {
                font-size: 13px;
                width: 116px;
                text-align: left;
              }
              .modal-dialog .modal-content .modal-body .select-area .table {
                display: table;
                width: 100%;
              }
              .modal-dialog .modal-content .modal-body #productACatalogTabPanel .select-area .table,
              .modal-dialog .modal-content .modal-body #productGCatalogTabPanel .select-area .table,
              .modal-dialog .modal-content .modal-body #productCatalogTabPanel .select-area .table {
                width: 396px;
              }
              .modal-dialog .modal-content .modal-body .select-area .table .item {
                display: table-row;
                padding: 4px;
                border-radius: 2px;
                border: 1px solid #cccccc;
                //height: 58px;
                margin-top: -1px;
                user-select: none;
                -moz-user-select: none;
                -webkit-user-select: none;
                -ms-user-select: none;  
                cursor: pointer;
                overflow: hidden;
                background-color: #fff;
              }
              
              .modal-dialog .modal-content .modal-body .select-area .table .item:first-child {
                margin-top: 0px;
              }
              .modal-dialog .modal-content .modal-body .select-area .table .item:hover .field {
                border-top: 1px solid #00ABFF;
                border-color: #00ABFF;
                box-shadow: 0 1px 5px rgba(0,171,255,0.25);
                background-color: #fff;
                position: relative;
              }
              .modal-dialog .modal-content .modal-body .select-area .table .item:first-child:hover .field:first-child {
                border-left-color: #666;
              }
              .modal-dialog .modal-content .modal-body .select-area .table .item:hover .field:first-child {
                border-left-color: #00ABFF;
              }
              .modal-dialog .modal-content .modal-body .select-area .table .item:hover .field:last-child {
                border-right-color: #00ABFF;
              }
              .modal-dialog .modal-content .modal-body .select-area .table .item:last-child:hover .field {
                border-bottom-color: #00ABFF;
              }
              .modal-dialog .modal-content .modal-body .select-area .table .item .field.head {
                border-color: #666;
                box-shadow: none;
                background-color: #becde0;
                position: static;
                cursor: default;
              }
              .modal-dialog .modal-content .modal-body .select-area .item-list .table .item.selected .field {
                background-color: #00ABFF;
                color: #fff;
              }
              .modal-dialog .modal-content .modal-body .select-area .item-list .table .item.selected .field:first-child {
                border-left-color: #00ABFF;
              }
              .modal-dialog .modal-content .modal-body .select-area .table .item.selected:hover .field {
                background-color: #00ABFF;
                color: #fff;
              }
              .modal-dialog .modal-content .modal-body .select-area .table .item .field {
                display: table-cell;
                margin: 0;
                float:none;
                border: 1px solid #eee;
                border-left: none;
                border-top: none;
              }
              .modal-dialog .modal-content .modal-body .select-area .table .item:first-child .field {border-top: 1px solid #666;}
              .modal-dialog .modal-content .modal-body .select-area .table .item:last-child .field {border-bottom: 1px solid #666;}
              .modal-dialog .modal-content .modal-body .select-area .table .item .field:first-child {border-left: 1px solid #666;}
              .modal-dialog .modal-content .modal-body .select-area .table .item .field:last-child {border-right-color: #666;}

              .modal-dialog .modal-content .modal-body .select-area .table .item .field .field-label {
                font-size: 12px;
                padding: 0 8px;
                width: 80px;
                margin: 3px 0px;
                color: #999999;
              }
              .modal-dialog .modal-content .modal-body .select-area .table .item .field .field-value {
                font-size: 12px;
                margin-left: 4px;
                overflow: hidden;
                padding: 2px 8px;
                vertical-align: middle;
                white-space: nowrap;
                text-overflow: ellipsis;
                height: auto;
                line-height: normal;
                width: 100%;
              }
              .modal-dialog .modal-content .modal-body .select-area .table .item .field .field-value.number {
                text-align: right;
              }
              .modal-dialog .modal-content .modal-body #productACatalogTabPanel .select-area .tree,
              .modal-dialog .modal-content .modal-body #productGCatalogTabPanel .select-area .tree,
              .modal-dialog .modal-content .modal-body #productCatalogTabPanel .select-area .tree {
                padding: 8px;
              }
              .modal-dialog .modal-content .modal-body #productACatalogTabPanel .select-area .selected-area .tree>.item,
              .modal-dialog .modal-content .modal-body #productGCatalogTabPanel .select-area .selected-area .tree>.item,
              .modal-dialog .modal-content .modal-body #productCatalogTabPanel .select-area .selected-area .tree>.item {
                border: 1px solid #999;
                margin-top: -1px;
              }
              .modal-dialog .modal-content .modal-body #productACatalogTabPanel .select-area .selected-area .tree>.item:first-child,
              .modal-dialog .modal-content .modal-body #productGCatalogTabPanel .select-area .selected-area .tree>.item:first-child,
              .modal-dialog .modal-content .modal-body #productCatalogTabPanel .select-area .selected-area .tree>.item:first-child {
                margin-top: 0px;
              }
              .modal-dialog .modal-content .modal-body #productACatalogTabPanel .select-area .tree .item,
              .modal-dialog .modal-content .modal-body #productGCatalogTabPanel .select-area .tree .item,
              .modal-dialog .modal-content .modal-body #productCatalogTabPanel .select-area .tree .item {
                display: block;
                border-radius: 2px;
                user-select: none;
                -moz-user-select: none;
                -webkit-user-select: none;
                -ms-user-select: none;  
                cursor: pointer;
                background-color: #fff;
                padding-bottom: 4px;
              }
              .modal-dialog .modal-content .modal-body #productACatalogTabPanel .select-area .tree .item:after,
              .modal-dialog .modal-content .modal-body #productGCatalogTabPanel .select-area .tree .item:after,
              .modal-dialog .modal-content .modal-body #productCatalogTabPanel .select-area .tree .item:after {
                content: "";
                display:block;
                width: 100%;
                height: 0px;
                clear: both;
              }
              .modal-dialog .modal-content .modal-body #productACatalogTabPanel .select-area .tree .item .tree-view,
              .modal-dialog .modal-content .modal-body #productGCatalogTabPanel .select-area .tree .item .tree-view,
              .modal-dialog .modal-content .modal-body #productCatalogTabPanel .select-area .tree .item .tree-view {
                //float: left;
                width: 100%;
              }
              .modal-dialog .modal-content .modal-body #productACatalogTabPanel .select-area .tree .item .tree-view:hover,
              .modal-dialog .modal-content .modal-body #productGCatalogTabPanel .select-area .tree .item .tree-view:hover,
              .modal-dialog .modal-content .modal-body #productCatalogTabPanel .select-area .tree .item .tree-view:hover {
                background-color: #ddd;
              }
              .modal-dialog .modal-content .modal-body #productACatalogTabPanel .select-area .tree .item[data-target]>.tree-view:before,
              .modal-dialog .modal-content .modal-body #productGCatalogTabPanel .select-area .tree .item[data-target]>.tree-view:before,
              .modal-dialog .modal-content .modal-body #productCatalogTabPanel .select-area .tree .item[data-target]>.tree-view:before {
                display: inline-block;
                margin-right: 8px;
                background-image: url("{!URLFOR($Resource.JEOL_CustomizedMaterials, 'JEOL_CustomizedMaterials/images/folder.png')}");
                background-position: center center;
                background-size: contain;
                background-repeat: no-repeat;
                vertical-align: text-bottom;
                width: 20px;
                height: 20px;
                content: "";
              }
              .modal-dialog .modal-content .modal-body #productACatalogTabPanel .select-area .tree .item.open[data-target]>.tree-view:before,
              .modal-dialog .modal-content .modal-body #productGCatalogTabPanel .select-area .tree .item.open[data-target]>.tree-view:before,
              .modal-dialog .modal-content .modal-body #productCatalogTabPanel .select-area .tree .item.open[data-target]>.tree-view:before {
                background-image: url("{!URLFOR($Resource.JEOL_CustomizedMaterials, 'JEOL_CustomizedMaterials/images/folder_open.png')}");
              }
              .modal-dialog .modal-content .modal-body #productACatalogTabPanel .select-area .tree .item .tree-fieldset,
              .modal-dialog .modal-content .modal-body #productGCatalogTabPanel .select-area .tree .item .tree-fieldset,
              .modal-dialog .modal-content .modal-body #productCatalogTabPanel .select-area .tree .item .tree-fieldset {
                width: 100%;
                float: left;
                display: none;
              }
              .modal-dialog .modal-content .modal-body #productACatalogTabPanel .select-area .tree .item>.children,
              .modal-dialog .modal-content .modal-body #productGCatalogTabPanel .select-area .tree .item>.children,
              .modal-dialog .modal-content .modal-body #productCatalogTabPanel .select-area .tree .item>.children {
                display: none;
                width: 100%;
                float: left;
                padding-left: 8px;
              }
              .modal-dialog .modal-content .modal-body #productACatalogTabPanel .select-area .tree .item>.children>.tree>.item:before,
              .modal-dialog .modal-content .modal-body #productGCatalogTabPanel .select-area .tree .item>.children>.tree>.item:before,
              .modal-dialog .modal-content .modal-body #productCatalogTabPanel .select-area .tree .item>.children>.tree>.item:before {
                display: block;
                float: left;
                content: "┗";
                height: 20px;
                line-height: 20px;
                margin-right: 8px;
              }
              .modal-dialog .modal-content .modal-body #productACatalogTabPanel .select-area .tree .item.open>.children,
              .modal-dialog .modal-content .modal-body #productGCatalogTabPanel .select-area .tree .item.open>.children,
              .modal-dialog .modal-content .modal-body #productCatalogTabPanel .select-area .tree .item.open>.children {
                display: block;
              }
              .modal-dialog .modal-content .modal-body #productACatalogTabPanel .select-area .tree .item.item-drag>.children,
              .modal-dialog .modal-content .modal-body #productGCatalogTabPanel .select-area .tree .item.item-drag>.children,
              .modal-dialog .modal-content .modal-body #productCatalogTabPanel .select-area .tree .item.item-drag>.children {
                display: none;
              }
              #detailProductItemView[data-tab-target] [data-tab-panel] {
                display: none;
              }
              #detailProductItemView[data-tab-target="productAItemSearch"] [data-tab-panel="productAItemSearch"],
              #detailProductItemView[data-tab-target="productBItemSearch"] [data-tab-panel="productBItemSearch"],
              #detailProductItemView[data-tab-target="productG1ItemSearch"] [data-tab-panel="productG1ItemSearch"],
              #detailProductItemView[data-tab-target="productG2ItemSearch"] [data-tab-panel="productG2ItemSearch"],
              #detailProductItemView[data-tab-target="catalogAItemSearch"] [data-tab-panel="catalogAItemSearch"],
              #detailProductItemView[data-tab-target="catalogGItemSearch"] [data-tab-panel="catalogGItemSearch"] {
                display: block;
              }
              [data-tab-target] .tab-buttons {
                margin-top: 8px;
              }
              [data-tab-target] .tab-buttons .tab {
                position: relative;
                bottom: -2px;
                padding: 2px 16px;
                border: 1px solid #7e9bc1;
                border-bottom: none;
                background: none;
                color: #999;
                margin: 0px 4px;
                font-weight: normal;
                border-radius: 4px 4px 0px 0px;
                transition: color 0.3s ease 0s;
              }
              [data-tab-target] .tab-buttons .tab:hover,
              [data-tab-target] .tab-buttons .tab.active {
                padding: 4px 16px;
                bottom: 0px;
                background-color: #fff;
                color: #333;
              }
              [data-tab-target] .tab-panel {
                border: 1px solid #7e9bc1;
              }
              #detailProductItemView .section .detail-product-action-area {
                padding: 4px;
                float: right;
              }
              #detailProductItemView .section .detail-product-action-area:first-child {
                float: left;
              }
              #detailProductItemView .section .detail-product-action-area .title {
                width: auto;
                line-height: 40px;
              }
              #detailProductItemView .section .detail-product-action-area hr {
                float: left
              }
              #detailProductItemView .select-area .item-list,
              #detailProductItemView .select-area .selected-list {
                height: 348px;
              }
              #detailProductItemView .select-area .selected-list {
                float: right;
              }
              #detailProductItemView .section .detail-product-action-area,
              #detailProductItemView .select-area .item-list,
              #detailProductItemView .select-area .selected-list {
                width: 406px;
                overflow: auto;
              }
              

              #detailProductItemView .select-area .selected-list {
                border: 3px dashed #eee;
                border-radius: 4px;
                margin-left: 0px;
                float: right;
                overflow-y: auto;
                overflow-x: overlay;
              }
              #detailProductItemView .select-area .selected-list .drop-target:empty {
                display: block;
                line-height: 326px;
                margin: 0px;
                width: 400px;
                text-align: center;
                color: #aaa;
                //background-color: #fff;
                font-size: 120%;
              }
              #detailProductItemView .select-area .selected-list.drop-hover .drop-target:empty {
                color: #fff;
              }
              #detailProductItemView .select-area .selected-list .drop-target:empty:after {
                content: "You can select items by using Drag &amp; Drop.";
                display: inline-block;
                *display: inline;
                *zoom: 1;
                width: 100%;
              }
              #detailProductItemView .select-area .selected-list.drop-active {
                background-color: #eee;
                border-color: #fff;
              }
              #detailProductItemView .select-area .selected-list.drop-hover {
                background-color: #becde0;
                border-color: #fff;
              }
              #detailProductItemView #productItemTabPanel .select-area .selected-list .item,
              #detailProductItemView #productAItemTabPanel .select-area .selected-list .item,
              #detailProductItemView #productBItemTabPanel .select-area .selected-list .item,
              #detailProductItemView #productG1ItemTabPanel .select-area .selected-list .item,
              #detailProductItemView #productG2ItemTabPanel .select-area .selected-list .item {
                position: relative;
                top: 0px;
                box-shadow: 0px -1px 3px -1px rgba(0,0,0,0.4);
                transition: height 0.2s linear 0s;
              }
              #detailProductItemView .item-drag {
                width: 402px;
              }
              .modal-dialog .modal-content .modal-footer {
                overflow: hidden;
              }
              .modal-body .customButton {
                width: 100%;
              }
              .modal-dialog .modal-content .modal-footer .button-area {
                overflow: hidden;
                float: left;
              }
              .modal-dialog .modal-content .modal-footer .button-area.right {
                float: right;
              }
              .modal-dialog .modal-content .modal-footer .button-area .customButton {
                float: left;
                width: 120px;
                margin-left: 8px;
              }
              .modal-dialog .modal-content .modal-footer .button-area .customButton:first-child {
                margin-left: 0px;
              }
              .modal-dialog .modal-content .modal-body .section .title,
              .modal-dialog .modal-content .modal-body .section .header {
                width: 100%;
                float: left;
              }
              
              .modal-dialog .modal-content .modal-body .title {
                font-size: 15px;
                margin: 12px 0px;
              }
              #OutputPrintView .modal-dialog .modal-content .modal-body .options-area .output-controls .field{
                width: 154px;
              }
              .modal-dialog .modal-content .modal-body .options-area .output-settings .field .field-label,
              .modal-dialog .modal-content .modal-body .options-area .output-settings .field .field-value,
              .modal-dialog .modal-content .modal-body .options-area .output-controls .field .field-label,
              .modal-dialog .modal-content .modal-body .options-area .output-controls .field .field-value {
                font-size: 13px;
                padding: 4px 8px 4px 8px;
              }
              .modal-dialog .modal-content .modal-body .options-area .output-settings .field .field-value {
                width: 80px;
              }
              .modal-dialog .modal-content .modal-body .options-area .output-controls .field .field-label {
                width: 112px;
              }
              .modal-dialog .modal-content .item-loading {
                background-color: #ffffff;
                position: absolute;
                opacity: 0.7;
                filter: alpha(opacity=70);
                left: 0;
                top: 0;
                height: 100%;
                width: 100%;
                z-index: 100;
              }
              .customButton.doCancel {
                width: 100px;
                float: left;
              }
              .customButton.doDelete {
                float: left;
                width: 120px;
                color: #7F2D2D;
                border-color: #FF6B6B;
                margin-left: 12px;
                margin-right: 12px;
                text-shadow: none;
              }
              .customButton.doDelete:focus,
              .customButton.doDelete:hover {
                background-color: #E34B4B;
                color: #fff;
                border-color: #E21F1F;
              }
              .customButton.doDelete:active {
                box-shadow: 0px 1px 3px rgba(0,0,0,0.70) inset;
              }
              .customButton.doSave {
                width: 120px;
                float: right;
              }
              .customButton.doOutput {
                width: 120px;
                color: #3D6951;
                border-color: #16874A;
                text-shadow: none;
                margin-left: 8px;
                float: right;
              }
              .customButton.doOutput:hover {
                background-color: #4CB47C;
                color: #fff;
                border-color: #16874A;
              }
              .customButton.doOutput:active {
                background-color: #309F64;
              }
              .customButton.doPreview {
                float: right;
                width: 120px;
                margin-left: 8px;
              }
              .alert {
                top: 10px;
                display: none;
                position: fixed;
                text-align: center;
                width: 100%;
                opacity: 0;
                transition: top 0.4s ease-out 0s, opacity 0.4s ease-out 0s;
                z-index: 2000;
              }
              .alert p {
                display: inline-block;
                *display: inline;
                *zoom: 1;
                white-space: nowrap;
                border: 1px solid #FFF100;
                background-color: #FFFBC6;
                border-radius: 2px;
                box-shadow: 0px 2px 3px 1px rgba(0,0,0,0.4);
                padding: 2px 30px;
              }
              .field .radio-item {
                float: left;
              }
              .field-value.master-accountCode {
                width: 72px;
              }
              .field-value.master-contactName,
              .field-value.master-contactPhone,
              .field-value.master-contactBelong,
              .field-value.master-contactPost {
                width: 108px;
              }
              .field-value.master-accountName {
                width: 158px;
              }
              .field-value.master-accountAddress {
                width: 320px;
              }
              .field-value.master-quoteId {
                display: none;
              }
                            
              .modalDetailList col.checkbox {width: 46px;}
              .modalDetailList col.Qty {width: 46px;}
              .modalDetailList col.isSel {width: 20px;}
              .modalDetailList col.qty2sp {width: 56px;}
              .modalDetailList col.ModelType {width: 122px;}
              .modalDetailList col.PartNumber {width: 112px;}
              .modalDetailList col.Description {width: 300px;}
              .modalDetailList col.body {width: 400px;}
              .modalDetailList col.body2sp {width: 230px;}
              .modalDetailList col.amount {width: 200px;}
              .modalDetailList col.MultDelAmount {width: 150px;}
              .modalDetailList col.MultDelQuantity {width: 80px;}
              .modalDetailList col.Price {width: 120px;}
              .modalDetailList {
                width: 100%;
                table-layout: fixed;
                border-collapse: collapse;
              }

              .price2spcol {
                vertical-align: middle;
                text-align: center;                            
              }

              .modalDetailList tr th,
              .modalDetailList tr td {
                vertical-align: middle;
                border: 1px solid #ccc;
                overflow: hidden;
              }
              .modalDetailList tr th div.field,
              .modalDetailList tr td div.field {
                float: none;
                width: 100%;
              }
              .modalDetailList tr td div.field .field-value.center,
              .modalDetailList tr th div.field .field-label.center {
                text-align: center;
              }
              .modalDetailList tr td div.field .field-value.right,
              .modalDetailList tr th div.field .field-label.right {
                text-align: right;
              }
              .modalDetailList tr th div.field .field-label,
              .modalDetailList tr td div.field .field-value {
                text-align: left;
                padding: 2px 8px;
                white-space: nowrap;
                text-overflow: ellipsis;
                overflow: hidden;
                border: none;
                height: auto;
                width: 100%;
              }
              .modalDetailList tr[data-type="3"] {background-color:#d9edeb;}
              .modalDetailList tr[data-type="4"] {background-color:#F9E4EC;}
              .modalDetailList tr[data-type="5"] {background-color:#abcdef;}
              .modalDetailList tr[data-depth] td div.field .field-value.body:before {content:"&#9493;";padding-right: 4px;color:#ccc;}
              .modalDetailList tr[data-depth="0"] td div.field .field-value.body:before {content:""}
              
              .modalDetailList tr[data-depth="1"] td div.field .field-value {padding-left: 16px;}
              .modalDetailList tr[data-depth="2"] td div.field .field-value {padding-left: 24px;}
              .modalDetailList tr[data-depth="3"] td div.field .field-value {padding-left: 32px;}
              .modalDetailList tr[data-depth="4"] td div.field .field-value {padding-left: 40px;}
              .modalDetailList tr[data-depth="5"] td div.field .field-value {padding-left: 48px;}

              .search-field-quotation-createdDate {
                  margin-left: 4px;
              }

                table.delete_table td {
                  width:100px;
                  text-align:center;
                  vertical-align:middle;
                }
                table.delete_table tr {
                }
                table.delete_table tr.todelete {
                  background-color:#999;
                }


            </style>
            <script>


$j(function () {
 
  
  $j(document)
    .mouseup(function () {
      isMouseDown = false;
    });
});

            </script>            
            <div id="alert" class="alert">
              <p class="description" ></p>
            </div>


            <!-- MODAL FORM - PRINT OUT -->
            <div class="modal fade" id="OutputPrintView" data-backdrop="static" tabindex="-1" role="dialog" aria-labelledby="OutputPrint" aria-hidden="true">
              <div class="modal-dialog">
                <div class="modal-content">
                  <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                      <span aria-hidden="true">&times;</span>
                    </button>
                    <div id="OutputPrint" class="screen-name">{!IF(qdm.parentRec.Status__c == '3', $Label.JEOL_QuotEdit_Label_OutputQuotation, 'Preview Quotation')}</div>
                  </div>
                  <apex:outputPanel layout="block" styleClass="modal-body" id="outputSetting">
                    <div class="section standard-info-area clearfix">
                      <div class="title">
                        <span>{!IF(qdm.parentRec.Status__c == '3', $Label.JEOL_QuotEdit_Label_OutputSettings, 'Preview Settings')}</span>
                      </div>
                      <div class="field">
                        <apex:OutputLabel value="{!$Label.JEOL_QuotEdit_Label_QuotationNo}" styleclass="field-label" style="width: 135px" />
                        <apex:Outputfield value="{!qdm.parentRec.ProfitCalculationNo__c}" styleclass="field-value"/>
                      </div>
                      <div class="field" >
                        <apex:OutputLabel value="{!$Label.JEOL_QuotEdit_Label_BranchNo}" styleclass="field-label" style="{!IF(language <> 'ja', 'width: 130px;', '')}" />
                        <apex:Outputfield value="{!qdm.parentRec.BranchNo__c}" styleclass="field-value"/>
                      </div>
                          <apex:actionStatus layout="inline"  id="overrideDepartmentTextProcessing" >
                            <apex:facet name="start">
                              <div style="display: inline-block; *display: inline; *zoom: 1; line-height: 30px; margin-left: 108px; color: #22816b;">{!$Label.JEOL_QuotEdit_Label_Searching}</div>
                            </apex:facet>
                          </apex:actionStatus>
                    
                      <div class="field" style="width: 500px; height: 17px;">
                        <apex:OutputLabel value="Quotation Title" styleclass="field-label" style="width: 135px" for="QTTitleRow1"/>
                        <apex:Inputfield style="width: 250px" id="QTTitleRow1" value="{!qdm.parentRec.TitleRow1__c}" html-data-compare-value="{!qdm.baseParentRec.TitleRow1__c}" onblur="safetyLockCheck(this);" onkeypress="return disableEnterKey(event)" />
                      </div>

                      <div class="field" style="width: 500px; height: 16px;">
                        <apex:OutputLabel styleclass="field-label" style="width: 135px"/>
                        <apex:Inputfield style="width: 250px" id="QTTitleRow2" value="{!qdm.parentRec.TitleRow2__c}" html-data-compare-value="{!qdm.baseParentRec.TitleRow2__c}" onblur="safetyLockCheck(this);" onkeypress="return disableEnterKey(event)" />
                      </div>

                      <div class="field" style="width: 500px; height: 16px;">
                        <apex:OutputLabel styleclass="field-label" style="width: 135px"/>
                        <apex:Inputfield style="width: 250px" id="QTTitleRow3" value="{!qdm.parentRec.TitleRow3__c}" html-data-compare-value="{!qdm.baseParentRec.TitleRow3__c}" onblur="safetyLockCheck(this);" onkeypress="return disableEnterKey(event)" />
                      </div>

                      <div class="field" style="width: 500px; height: 16px;">
                        <apex:OutputLabel styleclass="field-label" style="width: 135px"/>
                        <apex:Inputfield style="width: 250px" id="QTTitleRow4" value="{!qdm.parentRec.TitleRow4__c}" html-data-compare-value="{!qdm.baseParentRec.TitleRow4__c}" onblur="safetyLockCheck(this);" onkeypress="return disableEnterKey(event)" />
                      </div>

                      <div class="field" style="width: 500px;">
                        <apex:OutputLabel styleclass="field-label" style="width: 135px"/>
                        <apex:Inputfield style="width: 250px" id="QTTitleRow5" value="{!qdm.parentRec.TitleRow5__c}" html-data-compare-value="{!qdm.baseParentRec.TitleRow5__c}" onblur="safetyLockCheck(this);" onkeypress="return disableEnterKey(event)" />
                      </div>

                      <apex:outputPanel rendered="{!hasMultipleModelTypeScreenOptions}">
                        <div class="field" style="width: 500px;">
                          <apex:OutputLabel styleclass="field-label" style="width: 135px" value="Header Picture"/>
                          <apex:SelectList value="{!qdm.parentRec.ModelTypeScreen__c}"
                                           styleClass="field-value" size="1"
                                           html-data-compare-value="{!qdm.baseParentRec.ModelTypeScreen__c}"
                                           onblur="safetyLockCheck(this);"
                                           required="true"
                                           onkeypress="return disableEnterKey(event)">
                            <apex:selectOptions value="{!ModelTypeScreenOptions}" />
                          </apex:SelectList>
                        </div>
                      </apex:outputPanel>

                    </div>

                    <div class="section options-area clearfix">
                      <div class="title">
                        <apex:OutputLabel value="{!IF(qdm.parentRec.Status__c == '3', $Label.JEOL_QuotEdit_Label_OutputOptions, 'Preview Options')}" styleclass="field-label" style="width:130px"/>
                      </div>

                      <div class="output-controls clearfix">
                        <div  class="field header">
                          <span>・{!$Label.JEOL_QuotEdit_Label_ViewControls}</span>
                        </div>
                          
                        <div class="field" style="width: 255px; height: 26px;" />
                        <div class="field" style="width: 290px; height: 26px;">
                          <apex:OutputLabel value="Print first page" styleclass="field-label" style="width: 275px;" for="printQuotFirstPage"/>
                          <apex:Inputfield id="printQuotFirstPage" value="{!qdm.parentRec.PrintQuotationFirstPage__c}" html-data-compare-value="{!qdm.baseParentRec.PrintQuotationFirstPage__c}" onblur="safetyLockCheck(this);" onkeypress="return disableEnterKey(event)" />
                        </div>
<!--                        <div class="field" style="width: 255px; height: 26px;" /> -->
                        <div class="field" style="width: 258px; height: 26px;" >
                          <apex:OutputLabel value="Print specifications page" styleclass="field-label" style="width: 245px;" for="printQuotSpecsPage"/>
                          <apex:Inputfield id="printQuotSpecsPage" value="{!qdm.parentRec.PrintQuotationSpecificationsPage__c}" html-data-compare-value="{!qdm.baseParentRec.PrintQuotationSpecificationsPage__c}" onblur="safetyLockCheck(this);" onkeypress="return disableEnterKey(event)" />
                        </div>
<!--                        <div class="field" style="width: 255px; height: 26px;" /> -->
                        <div class="field" style="width: 290px; height: 26px;">
                          <apex:OutputLabel value="Print Spare Parts Detail" styleclass="field-label" style="width: 275px;" for="printSparePartsDetail"/>
                          <apex:Inputfield id="printSparePartsDetail" value="{!qdm.parentRec.Print2SPDetail__c}" html-data-compare-value="{!qdm.baseParentRec.Print2SPDetail__c}" onblur="safetyLockCheck(this);" onkeypress="return disableEnterKey(event)" />
                        </div>
<!--                        <div class="field" style="width: 255px; height: 26px;" /> -->
                        <div class="field" style="width: 258px; height: 26px;" >
                          <apex:OutputLabel value="Do not print detail amounts" styleclass="field-label" style="width: 245px;" for="printNotDetailPrices"/>
                          <apex:Inputfield id="printNotDetailPrices" value="{!qdm.parentRec.PrintNotDetailAmounts__c}" html-data-compare-value="{!qdm.baseParentRec.PrintNotDetailAmounts__c}" onblur="safetyLockCheck(this);" onkeypress="return disableEnterKey(event)" />
                        </div>
<!--                        <div class="field" style="width: 255px; height: 26px;" /> -->
                        <div class="field" style="width: 290px; height: 26px;" >
                          <apex:OutputLabel value="Print Quantity Unit" styleclass="field-label" style="width: 275px;" for="printQuantityUnit"/>
                          <apex:Inputfield id="printQuantityUnit" value="{!qdm.parentRec.PrintQuantityUnit__c}" html-data-compare-value="{!qdm.baseParentRec.PrintQuantityUnit__c}" onblur="safetyLockCheck(this);" onkeypress="return disableEnterKey(event)" />
                        </div>
<!--                        <div class="field" style="width: 255px; height: 26px;" /> -->
                        <div class="field" style="width: 258px; height: 26px;" >
                          <apex:OutputLabel value="Print Unit Price" styleclass="field-label" style="width: 245px;" for="printUnitPrice"/>
                          <apex:Inputfield id="printUnitPrice" value="{!qdm.parentRec.PrintUnitPrice__c}" html-data-compare-value="{!qdm.baseParentRec.PrintUnitPrice__c}" onblur="safetyLockCheck(this);" onkeypress="return disableEnterKey(event)" />
                        </div>
<!--                        <div class="field" style="width: 255px; height: 26px;" /> -->
                        <div class="field" style="width: 290px; height: 26px;" >
                          <apex:OutputLabel value="Do not print salespeople phone numbers"  styleclass="field-label" style="width: 275px;" for="printNotEmailSalesprople"/>
                          <apex:Inputfield id="printNotEmailSalesprople" value="{!qdm.parentRec.PrintNotPhoneSalespeople__c}" html-data-compare-value="{!qdm.baseParentRec.PrintNotPhoneSalespeople__c}" onblur="safetyLockCheck(this);" onkeypress="return disableEnterKey(event)" />
                        </div>
<!--                        <div class="field" style="width: 255px; height: 26px;" /> -->
                        <div class="field" style="width: 258px; height: 26px;" >
                          <apex:OutputLabel value="Quotation for budgetary purposes" styleclass="field-label" style="width: 245px;" for="quotationBudgetPurpose"/>
                          <apex:Inputfield id="quotationBudgetPurpose" value="{!qdm.parentRec.PrintQuotationBudgetPurpose__c}" html-data-compare-value="{!qdm.baseParentRec.PrintQuotationBudgetPurpose__c}" onblur="safetyLockCheck(this);" onkeypress="return disableEnterKey(event)" />
                        </div>

                        <div class="field" style="width: 290px; height: 26px;" >
                          <apex:OutputLabel value="Print JEOL Terms & Conditions" styleclass="field-label" style="width: 275px;" for="printJeolTerms"/>
                          <apex:Inputfield id="printJeolTerms" value="{!qdm.parentRec.PrintJeolTerms__c}" html-data-compare-value="{!qdm.baseParentRec.PrintJeolTerms__c}" onblur="safetyLockCheck(this);" onkeypress="return disableEnterKey(event)" />
                        </div>

                        <div class="field" style="width: 258px; height: 26px;" >
                          <apex:OutputLabel value="Print Proforma Invoice" styleclass="field-label" style="width: 245px;" for="printProformaInvoice"/>
                          <apex:Inputfield id="printProformaInvoice" value="{!qdm.parentRec.PrintProformaInvoice__c}" html-data-compare-value="{!qdm.baseParentRec.PrintProformaInvoice__c}" onblur="safetyLockCheck(this);" onkeypress="return disableEnterKey(event)" />
                        </div>

                      </div>
                    </div>
                  </apex:outputPanel>
                  <div class="modal-footer">
                    <div class="button-area">
                      <button type="button" class="customButton" onclick="$j('#OutputPrintView').modal('hide');" >{!$Label.JEOL_QuotEdit_Label_Cancel}</button>
                    </div>
                    <div class="button-area right">
                      <apex:commandLink value="{!$Label.JEOL_QuotEdit_Label_Save}" onclick="$j('#OutputPrintView .modal-content').addClass('ajax-loading');" styleclass="customButton doSave" action="{!ajaxSaveAction}" oncomplete="$j('#OutputPrintView .modal-content').removeClass('ajax-loading');showResult('{!$Label.JEOL_QuotEdit_Message_SettingsSaved}');unlockSafety();" rerender="listview, modalListView, modalListViewDel, outputSetting" status="ajaxStatusA"/>

<!--
                      <apex:commandLink value="{!$Label.JEOL_QuotEdit_Label_Output}" onclick="$j('#OutputPrintView .modal-content').addClass('ajax-loading');" styleClass="customButton doPreview" action="{!ajaxSaveAction}" oncomplete="$j('#OutputPrintView .modal-content').removeClass('ajax-loading');openPreview();unlockSafety();" rerender="listview, modalListView, modalListViewDel, outputSetting" status="ajaxStatusA" />
-->
                      <apex:commandLink value="{!$Label.JEOL_QuotEdit_Label_Output}"
                                        rendered="{!qdm.parentRec.Status__c == '3'}"
                                        onclick="$j('#OutputPrintView .modal-content').addClass('ajax-loading');"
                                        styleClass="customButton doOutput"
                                        action="{!doSaveWithPrintDatePart1}"
                                        oncomplete="doSaveWithPrintDatePart2_JS();"
                                        rerender="listview, modalListView, modalListViewDel, outputSetting, attachmentList"
                                        status="ajaxStatusA" />

                      <apex:commandLink value="Preview"
                                        rendered="{!qdm.parentRec.Status__c != '3'}"
                                        onclick="$j('#OutputPrintView .modal-content').addClass('ajax-loading');"
                                        styleClass="customButton doOutput"
                                        action="{!doSaveWithPrintDatePart1}" oncomplete="$j('#OutputPrintView .modal-content').removeClass('ajax-loading');$j('#OutputPrintView').modal('hide');showResult('{!$Label.JEOL_QuotEdit_Message_PdfPrinted}');openPrintWindow();unlockSafery();"
                                        rerender="listview, modalListView, modalListViewDel, outputSetting, attachmentList"
                                        status="ajaxStatusA" />

                      <apex:actionFunction action="{!doSaveWithPrintDatePart2}"
                                           name="doSaveWithPrintDatePart2_JS"
                                           oncomplete="$j('#OutputPrintView .modal-content').removeClass('ajax-loading');$j('#OutputPrintView').modal('hide');showResult('{!$Label.JEOL_QuotEdit_Message_PdfPrinted}');openPrintWindow();unlockSafery();"
                                           rerender="listview, modalListView, modalListViewDel, outputSetting, attachmentList"
                                           status="ajaxStatusA" />

                    </div>
                  </div>
                </div>
              </div>
            </div>



            <!-- MODAL FORM - REJECT COMMENT -->
            <div class="modal fade" id="OutputRejectComment" data-backdrop="static" tabindex="-1" role="dialog" aria-labelledby="OutputPrint" aria-hidden="true">
              <div class="modal-dialog">
                <div class="modal-content">
                  <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                      <span aria-hidden="true">&times;</span>
                    </button>
                    <div id="OutputPrint2" class="screen-name">Reject Comment</div>
                  </div>
                  <apex:outputPanel layout="block" styleClass="modal-body" id="outputSetting2">
                    <div class="section standard-info-area clearfix">
                      <div class="title">
                        <span>Please enter the reject comment.</span>
                      </div>
                      <div class="field">
                        <apex:outputLabel value="Reject comment" styleclass="field-label" style="width: 150px;" />
                        <apex:inputTextarea value="{!RejectCommentInput}" rows="4" styleclass="field-value" style="width: 370px;height: 82px;"/>
                      </div>
                    </div>
                  </apex:outputPanel>

                  <div class="modal-footer">
                    <div class="button-area">
                      <button type="button" class="customButton" onclick="$j('#OutputRejectComment').modal('hide');" >{!$Label.JEOL_QuotEdit_Label_Cancel}</button>
                    </div>
                    <div class="button-area right">

                      <apex:commandLink value="Reject"
                                        onclick="$j('#OutputRejectComment .modal-content').addClass('ajax-loading');"
                                        styleClass="customButton doPreview" 
                                        action="{!rejectRequest}" 
                                        oncomplete="$j('#OutputRejectComment .modal-content').removeClass('ajax-loading');unlockSafety();$j('#OutputRejectComment').modal('hide');actFinallyReject();" 
                                        status="ajaxStatusA" />

                      <apex:actionFunction name="actFinallyReject" immediate="true"  rerender="contentPage" />

                    </div>
                  </div>
                </div>
              </div>
            </div>




            <!-- MODAL FORM - ESCALATE COMMENT DIRECTOR -->
            <div class="modal fade" id="OutputEscalateCommentDirector" data-backdrop="static" tabindex="-1" role="dialog" aria-labelledby="OutputPrint" aria-hidden="true">
              <div class="modal-dialog">
                <div class="modal-content">
                  <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                      <span aria-hidden="true">&times;</span>
                    </button>
                    <div id="OutputPrint2" class="screen-name">Escalation Comment</div>
                  </div>
                  <apex:outputPanel layout="block" styleClass="modal-body" id="outputSetting3">
                    <div class="section standard-info-area clearfix">
                      <div class="title">
                        <span>Please enter the comment for the escalation.</span>
                      </div>
                      <div class="field">
                        <apex:outputLabel value="Escalation comment" styleclass="field-label" style="width: 170px;" />
                        <apex:inputTextarea value="{!EscalateCommentInputDirector}" rows="4" styleclass="field-value" style="width: 350px;height: 82px;"/>
                      </div>
                    </div>
                  </apex:outputPanel>

                  <div class="modal-footer">
                    <div class="button-area">
                      <button type="button" class="customButton" onclick="$j('#OutputEscalateCommentDirector').modal('hide');" >{!$Label.JEOL_QuotEdit_Label_Cancel}</button>
                    </div>
                    <div class="button-area right">

                      <apex:commandLink value="Escalate"
                                        onclick="$j('#OutputEscalateCommentDirector .modal-content').addClass('ajax-loading');" 
                                        styleClass="customButton doPreview" 
                                        action="{!escalateRequestDirector}" 
                                        oncomplete="$j('#OutputEscalateCommentDirector .modal-content').removeClass('ajax-loading');unlockSafety();$j('#OutputEscalateCommentDirector').modal('hide');actFinallyEscalate();" 
                                        status="ajaxStatusA" />

                      <apex:actionFunction name="actFinallyEscalate" immediate="true"  rerender="contentPage" />

                    </div>
                  </div>
                </div>
              </div>
            </div>



            <!-- MODAL FORM - ESCALATE COMMENT MD -->
            <div class="modal fade" id="OutputEscalateCommentMD" data-backdrop="static" tabindex="-1" role="dialog" aria-labelledby="OutputPrint" aria-hidden="true">
              <div class="modal-dialog">
                <div class="modal-content">
                  <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                      <span aria-hidden="true">&times;</span>
                    </button>
                    <div id="OutputPrint2" class="screen-name">Escalation Comment</div>
                  </div>
                  <apex:outputPanel layout="block" styleClass="modal-body" id="outputSetting4">
                    <div class="section standard-info-area clearfix">
                      <div class="title">
                        <span>Please enter the comment for the escalation.</span>
                      </div>
                      <div class="field">
                        <apex:outputLabel value="Escalation comment" styleclass="field-label" style="width: 170px;" />
                        <apex:inputTextarea value="{!EscalateCommentInputMD}" rows="4" styleclass="field-value" style="width: 350px;height: 82px;"/>
                      </div>
                    </div>
                  </apex:outputPanel>

                  <div class="modal-footer">
                    <div class="button-area">
                      <button type="button" class="customButton" onclick="$j('#OutputEscalateCommentMD').modal('hide');" >{!$Label.JEOL_QuotEdit_Label_Cancel}</button>
                    </div>
                    <div class="button-area right">

                      <apex:commandLink value="Escalate"
                                        onclick="$j('#OutputEscalateCommentMD .modal-content').addClass('ajax-loading');" 
                                        styleClass="customButton doPreview" 
                                        action="{!escalateRequestMD}" 
                                        oncomplete="$j('#OutputEscalateCommentMD .modal-content').removeClass('ajax-loading');unlockSafety();$j('#OutputEscalateCommentMD').modal('hide');actFinallyEscalate();" 
                                        status="ajaxStatusA" />

                      <apex:actionFunction name="actFinallyEscalate" immediate="true"  rerender="contentPage" />

                    </div>
                  </div>
                </div>
              </div>
            </div>



            <div class="modal fade" id="deleteConfirm" tabindex="-1" role="dialog" aria-labelledby="QuotationDelete" aria-hidden="true">
              <div class="modal-dialog modal-alert">
                <div class="modal-content">
                  <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                      <span aria-hidden="true">&times;</span>
                    </button>
                    <div id="QuotationDelete" class="screen-name">Deletion of Quotation</div>
                  </div>
                  <div class="modal-body">
                    <div class="confirm-area">
                      <p>You will delete this quotation.</p>
                      <p>Do you want to continue?</p>
                    </div>
                  </div>
                  <div class="modal-footer">
                    <div class="button-area right">
                      <button type="button" class="customButton doDelete" onclick="deleteConfirm();" >Delete</button>
                      <button type="button" class="customButton doCancel" onclick="$j('#deleteConfirm').modal('hide');" >Cancel</button>
                    </div>
                  </div>
                </div>
              </div>
            </div>


            <!-- MODAL FORM - SEARCH ITEM / CATALOG -->
            <div class="modal fade" id="detailProductItemView" data-tab-target="productAItemSearch" data-backdrop="static" tabindex="-1" role="dialog" aria-labelledby="detailProductItem" aria-hidden="true">
              <div class="modal-dialog">
                <div class="modal-content">
                  <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                      <span aria-hidden="true">&times;</span>
                    </button>
                    <div id="detailProductItem" class="screen-name">Items Selection</div>
                  </div>
                  <div class="modal-body section">
                    <div class="tab-buttons">
                      <button type="button" class="tab" onclick="tabSelection(this);" data-target="productAItemSearch" id="productAItemSearch">J-Products Items Search</button>
                      <button type="button" class="tab" onclick="tabSelection(this);" data-target="productBItemSearch" id="productBItemSearch">Local Supply Items Search</button>
                      <button type="button" class="tab" onclick="tabSelection(this);" data-target="productG1ItemSearch" id="productG1ItemSearch">J-Products Recommended Items Search</button>
                      <button type="button" class="tab" onclick="tabSelection(this);" data-target="productG2ItemSearch" id="productG2ItemSearch">Local Supply Recommended Items Search</button>
                      <button type="button" class="tab active" onclick="tabSelection(this);" data-target="catalogAItemSearch" id="catalogAItemSearch">Catalog Search</button>
                      <button type="button" class="tab active" onclick="tabSelection(this);" data-target="catalogGItemSearch" id="catalogGItemSearch">Catalog Search</button>
                    </div>

                    <!-- TAB - ITEM SECTION A -->
                    <div id="productAItemTabPanel" class="tab-panel" data-tab-panel="productAItemSearch">
                      <div class="section search-area">
                        <div class="section-header" >
                          <span>Search Filters:</span>
                        </div>
                        <div id="detailProductAItemSearchArea" class="section-body collapse in clearfix">
                          <div class="field" style="width: 100%;">
                            <input type="checkbox" class="field-value auto-close-check" style="width: auto;" checked="checked" id="chkCollapsingA" onkeypress="return disableEnterKey(event)"/>
                            <label class="field-label" style="width: auto;" for="chkCollapsingA" >Automatically collapse this section after searching</label>
                          </div>

                          <!-- CURRENCY Radio Buttons -->
<!--
                          <div class="field clearfix" style="border-bottom: 1px solid #ABB8C9; box-shadow: 0px 1px 0px #eee">
                            <div class="radio-item">
                              <apex:outputLabel value="Currency: " styleClass="field-label" />
                              <input id="currencySearchA" type="text" class="field-value productDivision radio-product-type" style="display: none;" data-field="CurrencySearch__c"/>
                            </div>

                            <apex:repeat value="{!listJProdCurrencyOption}" var="cur">
                              <div class="radio-item">
                                <input id="radio-currencyA-{!cur.Value}" type="radio" name="currencySearchA" onchange="$j('#currencySearchA').val(this.value);" class="field-value" value="{!cur.Value}" />
                                <label for="radio-currencyA-{!cur.Value}" class="field-label">{!cur.Label}</label>
                              </div>
                            </apex:repeat>
                          </div>
-->

                          <div class="search-field">
                            <div class="field ">
                              <label class="field-label" >Item Name</label>
                              <input type="text" class="field-value search-field-product-name" data-field="EnglishName__c" placeholder="Item Name" onkeypress="return disableEnterKey(event)" />
                            </div>
<!--
                            <div class="field">
                              <label class="field-label" >Item No.</label>
                              <input type="text" class="field-value search-field-product-code" data-field="Name" placeholder="Item No." />
                            </div>
-->
                            <div class="field">
                              <label class="field-label" >Model Type</label>
                              <input type="text" class="field-value search-field-model-type" data-field="ModelType__c" placeholder="Model Type" onkeypress="return disableEnterKey(event)" />
                            </div>
                          </div>
                          <div class="field">
                            <button type="button" onclick="productAItemSearchJS();" class="customButton">Search</button>
                          </div>
                        </div>
                        <button type="button" class="toggle-button customButton" data-toggle="collapse" data-target="#detailProductAItemSearchArea" aria-expanded="false" aria-controls="detailProductAItemSearchArea" ></button>
                      </div>
                      <div class="section">
                        <div class="select-header clearfix">
                          <div class="detail-product-action-area clearfix">
                            <div class="title">
                              <span>List of Items</span>
                            </div>
                            <div class="pager-area clearfix">
                              <a href="javascript: void(0);" class="prev customButton" onclick="prevRecordsAddDraggableA();return false;" style="display: none;">&laquo;</a>
                              <div class="prev disabled-button" >&laquo;</div>
                              <div class="current-page-number"></div>
                              <div class="separator">/</div>
                              <div class="max-page-number"></div>
                              <a href="javascript: void(0);" class="next customButton" onclick="nextRecordsAddDraggableA();return false;" style="display: none;">&raquo;</a>
                              <div class="next disabled-button">&raquo;</div>
                            </div>
                            <hr />
                          </div>
                          <div class="detail-product-action-area clearfix">
                            <div class="title">
                              <span>Items selected</span>
                            </div>
                            <hr />
                          </div>
                        </div>
                        <div class="select-area clearfix">
                          <div class="item-list"></div>
                          <div  id="selected-list-A" class="selected-list" >
                            <div class="drop-target table" ></div>
                          </div>
                        </div>
                      </div>
                    </div>

                    <!-- TAB - ITEM SECTION B -->
                    <div id="productBItemTabPanel" class="tab-panel" data-tab-panel="productBItemSearch">
                      <div class="section search-area">
                        <div class="section-header" >
                          <span>Search Filters:</span>
                        </div>
                        <div id="detailProductBItemSearchArea" class="section-body collapse in clearfix">
                          <div class="field" style="width: 100%;">
                            <input type="checkbox" class="field-value auto-close-check" style="width: auto;" checked="checked" id="chkCollapsingB" onkeypress="return disableEnterKey(event)" />
                            <label class="field-label" style="width: auto;" for="chkCollapsingB" >Automatically collapse this section after searching</label>
                          </div>

                          <!-- CURRENCY Radio Buttons -->
<!--
                          <div class="field clearfix" style="border-bottom: 1px solid #ABB8C9; box-shadow: 0px 1px 0px #eee">
                            <div class="radio-item">
                              <apex:outputLabel value="Currency: " styleClass="field-label" />
                              <input id="currencySearchB" type="text" class="field-value productDivision radio-product-type" style="display: none;" data-field="CurrencySearch__c"/>
                            </div>

                            <apex:repeat value="{!listOtherCurrencyOption}" var="cur">
                              <div class="radio-item">
                                <input id="radio-currencyB-{!cur.Value}" type="radio" name="currencySearchB" onchange="$j('#currencySearchB').val(this.value);" class="field-value" value="{!cur.Value}" />
                                <label for="radio-currencyB-{!cur.Value}" class="field-label">{!cur.Label}</label>
                              </div>
                            </apex:repeat>
                          </div>
-->

                          <div class="search-field">
                            <div class="field ">
                              <label class="field-label" >Item Name</label>
                              <input type="text" class="field-value search-field-product-name" data-field="EnglishName__c" placeholder="Item Name" onkeypress="return disableEnterKey(event)" />
                            </div>
                            <div class="field">
                              <label class="field-label" >Supplier</label>
                              <input type="text" class="field-value search-field-model-type" data-field="Supplier__c" placeholder="Supplier" onkeypress="return disableEnterKey(event)" />
                            </div>
<!--                            
                            <div class="field">
                              <label class="field-label" >{!$Label.JEOL_QuotEdit_Label_ItemNo}</label>
                              <input type="text" class="field-value search-field-product-code" data-field="Name" placeholder="{!$Label.JEOL_QuotEdit_Label_ItemNo}" />
                            </div>
                            <div class="field">
                              <label class="field-label" >Model Type</label>
                              <input type="text" class="field-value search-field-model-type" data-field="ModelType__c" placeholder="Model Type" />
                            </div>
-->
                          </div>
                          <div class="field">
                            <button type="button" onclick="productBItemSearchJS();" class="customButton">Search</button>
                          </div>
                        </div>
                        <button type="button" class="toggle-button customButton" data-toggle="collapse" data-target="#detailProductBItemSearchArea" aria-expanded="false" aria-controls="detailProductBItemSearchArea" ></button>
                      </div>
                      <div class="section">
                        <div class="select-header clearfix">
                          <div class="detail-product-action-area clearfix">
                            <div class="title">
                              <span>List of Items</span>
                            </div>
                            <div class="pager-area clearfix">
                              <a href="javascript: void(0);" class="prev customButton" onclick="prevRecordsAddDraggableB();return false;" style="display: none;">&laquo;</a>
                              <div class="prev disabled-button" >&laquo;</div>
                              <div class="current-page-number"></div>
                              <div class="separator">/</div>
                              <div class="max-page-number"></div>
                              <a href="javascript: void(0);" class="next customButton" onclick="nextRecordsAddDraggableB();return false;" style="display: none;">&raquo;</a>
                              <div class="next disabled-button">&raquo;</div>
                            </div>
                            <hr />
                          </div>
                          <div class="detail-product-action-area clearfix">
                            <div class="title">
                              <span>Items selected</span>
                            </div>
                            <hr />
                          </div>
                        </div>
                        <div class="select-area clearfix">
                          <div class="item-list"></div>
                          <div  id="selected-list-B" class="selected-list" >
                            <div class="drop-target table" ></div>
                          </div>
                        </div>
                      </div>
                    </div>


                    <!-- TAB - ITEM SECTION G1 -->
                    <div id="productG1ItemTabPanel" class="tab-panel" data-tab-panel="productG1ItemSearch">
                      <div class="section search-area">
                        <div class="section-header" >
                          <span>Search Filters:</span>
                        </div>
                        <div id="detailProductG1ItemSearchArea" class="section-body collapse in clearfix">
                          <div class="field" style="width: 100%;">
                            <input type="checkbox" class="field-value auto-close-check" style="width: auto;" checked="checked" id="chkCollapsingG1" onkeypress="return disableEnterKey(event)" />
                            <label class="field-label" style="width: auto;" for="chkCollapsingG1" >Automatically collapse this section after searching</label>
                          </div>

                          <!-- CURRENCY Radio Buttons -->
<!--
                          <div class="field clearfix" style="border-bottom: 1px solid #ABB8C9; box-shadow: 0px 1px 0px #eee">
                            <div class="radio-item">
                              <apex:outputLabel value="Currency: " styleClass="field-label" />
                              <input id="currencySearchG1" type="text" class="field-value productDivision radio-product-type" style="display: none;" data-field="CurrencySearch__c"/>
                            </div>

                            <apex:repeat value="{!listOtherCurrencyOption}" var="cur">
                              <div class="radio-item">
                                <input id="radio-currencyG1-{!cur.Value}" type="radio" name="currencySearchG1" onchange="$j('#currencySearchG1').val(this.value);" class="field-value" value="{!cur.Value}" />
                                <label for="radio-currencyG1-{!cur.Value}" class="field-label">{!cur.Label}</label>
                              </div>
                            </apex:repeat>
                          </div>
-->

                          <div class="search-field">
                            <div class="field ">
                              <label class="field-label" >Item Name</label>
                              <input type="text" class="field-value search-field-product-name" data-field="EnglishName__c" placeholder="Item Name" onkeypress="return disableEnterKey(event)" />
                            </div>
<!--                            
                            <div class="field">
                              <label class="field-label" >{!$Label.JEOL_QuotEdit_Label_ItemNo}</label>
                              <input type="text" class="field-value search-field-product-code" data-field="Name" placeholder="{!$Label.JEOL_QuotEdit_Label_ItemNo}" />
                            </div>
-->
                            <div class="field">
                              <label class="field-label" >Model Type</label>
                              <input type="text" class="field-value search-field-model-type" data-field="ModelType__c" placeholder="Model Type" onkeypress="return disableEnterKey(event)" />
                            </div>
                          </div>
                          <div class="field">
                            <button type="button" onclick="productG1ItemSearchJS();" class="customButton">Search</button>
                          </div>
                        </div>
                        <button type="button" class="toggle-button customButton" data-toggle="collapse" data-target="#detailProductG1ItemSearchArea" aria-expanded="false" aria-controls="detailProductBItemSearchArea" ></button>
                      </div>
                      <div class="section">
                        <div class="select-header clearfix">
                          <div class="detail-product-action-area clearfix">
                            <div class="title">
                              <span>List of Items</span>
                            </div>
                            <div class="pager-area clearfix">
                              <a href="javascript: void(0);" class="prev customButton" onclick="prevRecordsAddDraggableG1();return false;" style="display: none;">&laquo;</a>
                              <div class="prev disabled-button" >&laquo;</div>
                              <div class="current-page-number"></div>
                              <div class="separator">/</div>
                              <div class="max-page-number"></div>
                              <a href="javascript: void(0);" class="next customButton" onclick="nextRecordsAddDraggableG1();return false;" style="display: none;">&raquo;</a>
                              <div class="next disabled-button">&raquo;</div>
                            </div>
                            <hr />
                          </div>
                          <div class="detail-product-action-area clearfix">
                            <div class="title">
                              <span>Items selected</span>
                            </div>
                            <hr />
                          </div>
                        </div>
                        <div class="select-area clearfix">
                          <div class="item-list"></div>
                          <div  id="selected-list-G1" class="selected-list" >
                            <div class="drop-target table" ></div>
                          </div>
                        </div>
                      </div>
                    </div>


                    <!-- TAB - ITEM SECTION G2 -->
                    <div id="productG2ItemTabPanel" class="tab-panel" data-tab-panel="productG2ItemSearch">
                      <div class="section search-area">
                        <div class="section-header" >
                          <span>Search Filters:</span>
                        </div>
                        <div id="detailProductG2ItemSearchArea" class="section-body collapse in clearfix">
                          <div class="field" style="width: 100%;">
                            <input type="checkbox" class="field-value auto-close-check" style="width: auto;" checked="checked" id="chkCollapsingG2" onkeypress="return disableEnterKey(event)" />
                            <label class="field-label" style="width: auto;" for="chkCollapsingG2" >Automatically collapse this section after searching</label>
                          </div>

                          <!-- CURRENCY Radio Buttons -->
<!--
                          <div class="field clearfix" style="border-bottom: 1px solid #ABB8C9; box-shadow: 0px 1px 0px #eee">
                            <div class="radio-item">
                              <apex:outputLabel value="Currency: " styleClass="field-label" />
                              <input id="currencySearchG2" type="text" class="field-value productDivision radio-product-type" style="display: none;" data-field="CurrencySearch__c"/>
                            </div>

                            <apex:repeat value="{!listOtherCurrencyOption}" var="cur">
                              <div class="radio-item">
                                <input id="radio-currencyG2-{!cur.Value}" type="radio" name="currencySearchG2" onchange="$j('#currencySearchG2').val(this.value);" class="field-value" value="{!cur.Value}" />
                                <label for="radio-currencyG2-{!cur.Value}" class="field-label">{!cur.Label}</label>
                              </div>
                            </apex:repeat>
                          </div>
-->

                          <div class="search-field">
                            <div class="field ">
                              <label class="field-label" >Item Name</label>
                              <input type="text" class="field-value search-field-product-name" data-field="EnglishName__c" placeholder="Item Name" onkeypress="return disableEnterKey(event)" />
                            </div>
                            <div class="field">
                              <label class="field-label" >Supplier</label>
                              <input type="text" class="field-value search-field-model-type" data-field="Supplier__c" placeholder="Supplier" onkeypress="return disableEnterKey(event)" />
                            </div>
<!--
                            <div class="field">
                              <label class="field-label" >{!$Label.JEOL_QuotEdit_Label_ItemNo}</label>
                              <input type="text" class="field-value search-field-product-code" data-field="Name" placeholder="{!$Label.JEOL_QuotEdit_Label_ItemNo}" />
                            </div>
                            <div class="field">
                              <label class="field-label" >Model Type</label>
                              <input type="text" class="field-value search-field-model-type" data-field="ModelType__c" placeholder="Model Type" />
                            </div>
-->
                          </div>
                          <div class="field">
                            <button type="button" onclick="productG2ItemSearchJS();" class="customButton">Search</button>
                          </div>
                        </div>
                        <button type="button" class="toggle-button customButton" data-toggle="collapse" data-target="#detailProductG2ItemSearchArea" aria-expanded="false" aria-controls="detailProductG2ItemSearchArea" ></button>
                      </div>
                      <div class="section">
                        <div class="select-header clearfix">
                          <div class="detail-product-action-area clearfix">
                            <div class="title">
                              <span>List of Items</span>
                            </div>
                            <div class="pager-area clearfix">
                              <a href="javascript: void(0);" class="prev customButton" onclick="prevRecordsAddDraggableG2();return false;" style="display: none;">&laquo;</a>
                              <div class="prev disabled-button" >&laquo;</div>
                              <div class="current-page-number"></div>
                              <div class="separator">/</div>
                              <div class="max-page-number"></div>
                              <a href="javascript: void(0);" class="next customButton" onclick="nextRecordsAddDraggableG2();return false;" style="display: none;">&raquo;</a>
                              <div class="next disabled-button">&raquo;</div>
                            </div>
                            <hr />
                          </div>
                          <div class="detail-product-action-area clearfix">
                            <div class="title">
                              <span>Items selected</span>
                            </div>
                            <hr />
                          </div>
                        </div>
                        <div class="select-area clearfix">
                          <div class="item-list"></div>
                          <div  id="selected-list-G2" class="selected-list" >
                            <div class="drop-target table" ></div>
                          </div>
                        </div>
                      </div>
                    </div>


                    <!-- TAB - CATALOG SECTION A -->                    
                    <div id="productACatalogTabPanel" class="tab-panel" data-tab-panel="catalogAItemSearch">
                      <div class="section search-area">
                        <div class="section-header" >
                          <span>Search Filters:</span>
                        </div>

                        <div id="detailProductACatalogSearchArea" class="section-body collapse in clearfix">
                          <div class="field" style="width: 100%;">
                            <input type="checkbox" id="chkCollapsingCatA" class="field-value auto-close-check" style="width: auto;" checked="checked" onkeypress="return disableEnterKey(event)"/>
                            <label class="field-label" style="width: auto;" for="chkCollapsingCatA" >Automatically collapse this section after searching</label>
                          </div>

                          <!-- CURRENCY Radio Buttons -->
<!--
                          <div class="field clearfix" style="border-bottom: 1px solid #ABB8C9; box-shadow: 0px 1px 0px #eee">
                            <div class="radio-item">
                              <apex:outputLabel value="Currency: " styleClass="field-label" />
                              <input id="currencySearchACat" type="text" class="field-value productDivision radio-product-type" style="display: none;" data-field="CurrencySearch__c"/>
                            </div>

                            <apex:repeat value="{!listJProdCurrencyOption}" var="cur">
                              <div class="radio-item">
                                <input id="radio-currencyACat-{!cur.Value}" type="radio" name="currencySearchACat" onchange="$j('#currencySearchACat').val(this.value);" class="field-value" value="{!cur.Value}" />
                                <label for="radio-currencyACat-{!cur.Value}" class="field-label">{!cur.Label}</label>
                              </div>
                            </apex:repeat>
                          </div>
-->

                          <div class="search-field">
<!--
                            <div class="field">
                              <label class="field-label" >Catalog No</label>
                              <input type="text" class="field-value search-field-product-name" data-field="ProductCatalog__c" placeholder="Catalog No" />
                            </div>
-->
                            <div class="field">
                              <label class="field-label" >Search Key</label>
                              <input type="text" class="field-value search-field-product-code" data-field="SearchKeyWord__c" placeholder="Search Key" onkeypress="return disableEnterKey(event)"/>
                            </div>
                          </div>
                          <div class="field">
                            <button type="button" onclick="productACatalogSearch();" class="customButton">Search</button>
                          </div>
                        </div>
                        <button type="button" class="toggle-button customButton" data-toggle="collapse" data-target="#detailProductACatalogSearchArea" aria-expanded="false" aria-controls="detailProductACatalogSearchArea" ></button>
                      </div>
                      <div class="section">
                        <div class="select-header clearfix">
                          <div class="detail-product-action-area clearfix">
                            <div class="title">
                              <span>List of Items</span>
                            </div>
                            <hr />
                          </div>
                          <div class="detail-product-action-area clearfix">
                            <div class="title">
                              <span>Items selected</span>
                            </div>
                            <hr />
                          </div>
                        </div>
                        <div class="select-area catalog clearfix">
                          <div class="item-list"></div>
                          <div  id="selected-list-catalog-A" class="selected-list" >
                            <div class="drop-target tree" ></div>
                          </div>
                        </div>
                        <apex:inputTextarea readonly="True" styleClass="EibunText" style="width:100%;margin-top: 1rem;margin-bottom: -1.5rem;"/>
                      </div>
                    </div>


                    <!-- TAB - CATALOG SECTION G -->                    
                    <div id="productGCatalogTabPanel" class="tab-panel" data-tab-panel="catalogGItemSearch">
                      <div class="section search-area">
                        <div class="section-header" >
                          <span>Search Filters:</span>
                        </div>

                        <div id="detailProductGCatalogSearchArea" class="section-body collapse in clearfix">
                          <div class="field" style="width: 100%;">
                            <input type="checkbox" id="chkCollapsingCatG" class="field-value auto-close-check" style="width: auto;" checked="checked" onkeypress="return disableEnterKey(event)"/>
                            <label class="field-label" style="width: auto;" for="chkCollapsingCatG" >Automatically collapse this section after searching</label>
                          </div>

                          <!-- CURRENCY Radio Buttons -->
<!--
                          <div class="field clearfix" style="border-bottom: 1px solid #ABB8C9; box-shadow: 0px 1px 0px #eee">
                            <div class="radio-item">
                              <apex:outputLabel value="Currency: " styleClass="field-label" />
                              <input id="currencySearchGCat" type="text" class="field-value productDivision radio-product-type" style="display: none;" data-field="CurrencySearch__c"/>
                            </div>

                            <apex:repeat value="{!listJProdCurrencyOption}" var="cur">
                              <div class="radio-item">
                                <input id="radio-currencyGCat-{!cur.Value}" type="radio" name="currencySearchGCat" onchange="$j('#currencySearchGCat').val(this.value);" class="field-value" value="{!cur.Value}" />
                                <label for="radio-currencyGCat-{!cur.Value}" class="field-label">{!cur.Label}</label>
                              </div>
                            </apex:repeat>
                          </div>
-->

                          <div class="search-field">
<!--
                            <div class="field">
                              <label class="field-label" >Catalog No</label>
                              <input type="text" class="field-value search-field-product-name" data-field="ProductCatalog__c" placeholder="Catalog No" />
                            </div>
-->
                            <div class="field">
                              <label class="field-label" >Search Key</label>
                              <input type="text" class="field-value search-field-product-code" data-field="SearchKeyWord__c" placeholder="Search Key" onkeypress="return disableEnterKey(event)"/>
                            </div>
                          </div>
                          <div class="field">
                            <button type="button" onclick="productGCatalogSearch();" class="customButton">Search</button>
                          </div>
                        </div>
                        <button type="button" class="toggle-button customButton" data-toggle="collapse" data-target="#detailProductGCatalogSearchArea" aria-expanded="false" aria-controls="detailProductGCatalogSearchArea" ></button>
                      </div>
                      <div class="section">
                        <div class="select-header clearfix">
                          <div class="detail-product-action-area clearfix">
                            <div class="title">
                              <span>List of Items</span>
                            </div>
                            <hr />
                          </div>
                          <div class="detail-product-action-area clearfix">
                            <div class="title">
                              <span>Items selected</span>
                            </div>
                            <hr />
                          </div>
                        </div>
                        <div class="select-area catalog clearfix">
                          <div class="item-list"></div>
                          <div  id="selected-list-catalog-G" class="selected-list" >
                            <div class="drop-target tree" ></div>
                          </div>
                        </div>
                        <apex:inputTextarea readonly="True" styleClass="EibunText" style="width:100%;margin-top: 1rem;margin-bottom: -1.5rem;"/>
                      </div>
                    </div>

                  </div>
                  <div class="modal-footer">
                    <div data-tab-panel="productAItemSearch">
                      <button type="button" class="customButton" onclick="lockSafety();chooseItemDetailProductA();">OK</button>
                    </div>
                    <div data-tab-panel="productBItemSearch">
                      <button type="button" class="customButton" onclick="lockSafety();chooseItemDetailProductB();">OK</button>
                    </div>
                    <div data-tab-panel="productG1ItemSearch">
                      <button type="button" class="customButton" onclick="lockSafety();chooseItemDetailProductG1();">OK</button>
                    </div>
                    <div data-tab-panel="productG2ItemSearch">
                      <button type="button" class="customButton" onclick="lockSafety();chooseItemDetailProductG2();">OK</button>
                    </div>
                    <div data-tab-panel="catalogAItemSearch">
                      <button type="button" class="customButton" onclick="lockSafety();chooseCatalogDetailProductA();">OK</button>
                    </div>
                    <div data-tab-panel="catalogGItemSearch">
                      <button type="button" class="customButton" onclick="lockSafety();chooseCatalogDetailProductG();">OK</button>
                    </div>
                  </div>
                </div>
              </div>
            </div>












            <div class="modal fade" id="certificatePrintView" data-backdrop="static" tabindex="-1" role="dialog" aria-labelledby="certificatePrint" aria-hidden="true">
              <div class="modal-dialog">
                <div class="modal-content">
                  <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                      <span aria-hidden="true">&times;</span>
                    </button>
                    <div id="certificatePrint" class="screen-name">{!IF((isReadOnly || isQTRestricted),'Show','Edit')} Spare Parts</div>
                  </div>
                  <apex:outputPanel layout="block" styleClass="modal-body" >
                    <div class="section options-area">
                      <div class="select-header clearfix" >
                        <div class="title clearfix" >
                          <div >Informations</div>
                        </div>
                      </div>
                      <div class="section-body output-controls clearfix">
                        <div class="setting-row clearfix">
                          <div class="field">
                            <apex:outputLabel value="PC No." styleClass="field-label" />
                            <apex:outputField value="{!qdm.parentRec.ProfitCalculationNo__c}" styleClass="field-value" />
                          </div>
                          <div class="field">
                            <apex:outputLabel value="Branch" styleClass="field-label" />
                            <apex:outputField value="{!qdm.parentRec.BranchNo__c}" styleClass="field-value" />
                            <apex:inputHidden value="{!defaultCoef}" id="standardCoef" html-class="standardCoef" />
                          </div>
                        </div>
                      </div>
                    </div>

                    <div class="section options-area" >
                      <apex:outputPanel layout="block" id="modalListView">

                        <table class="modalDetailList" >
                          <col class="isSel" />
                          <col class="qty2sp" />
                          <col class="PartNumber" />
                          <col class="body2sp" />
                          <col class="Price" />
                          <col class="Price" />
                          <col class="Price" />
                          <tr >
                            <th >
                            </th>
                            <th >
                              <div class="field">
                                <apex:outputText value="Qty" styleClass="field-label center" />
                              </div>
                            </th>
                            <th >
                              <div class="field">
                                <apex:outputText value="Part Number" styleClass="field-label" />
                              </div>
                            </th>
                            <th >
                              <div class="field">
                                <apex:outputText value="Description" styleClass="field-label" /><br/>
                                <apex:outputText value="Specification" styleClass="field-label" />
                              </div>
                            </th>
                            <th >
                              <div class="field price2spcol">Unit Price<br/>(JPY)</div>
                            </th>
                            <th >
                              <div class="field price2spcol">Cost Price<br/>({!qdm.parentRec.SalesCurrency__c})</div>
                            </th>
                            <th >
                              <div class="field price2spcol">Sales Price<br/>({!qdm.parentRec.SalesCurrency__c})</div>
                            </th>
                          </tr>

                          <apex:repeat value="{!current2SPItems}" var="item" >
                            <tr class="row2SPdetail">
                              <td >
                                <div class="field">
                                  <apex:inputCheckbox styleClass="field-value" value="{!item.isSel}" onkeypress="return disableEnterKey(event)"/>
                                </div>
                              </td>
                              <td >
                                <div class="field" style="margin: 0;">
                                  <apex:inputHidden html-class="qty2spinput" value="{!item.qty}" />
                                  <apex:inputText rendered="{!!(isReadOnly || isQTRestricted)}" 
                                                  value="{!item.qtyFormatted}"
                                                  styleClass="field-value right qty2sp"
                                                  style="height: 52px;"
                                                  html-data-compare-value="{!item.qtyFormatted}" 
                                                  onblur="safetyLockCheck(this);" 
                                                  onchange="calculate2sp(this);"
                                                  onkeypress="return disableEnterKey(event)"/>
                                  <apex:inputHidden rendered="{!(isReadOnly || isQTRestricted)}" html-class="qty2sp" value="{!item.qtyFormatted}" />
                                  <apex:outputText rendered="{!(isReadOnly || isQTRestricted)}" value="{!item.qtyFormatted}" styleClass="field-value right qty2sp"/>
                                </div>
                              </td>
                              <td >
                                <div class="field">
                                  <apex:outputText value="{!item.partNumber}" styleClass="field-value" />
                                </div>
                              </td>
                              <td >
                                <div class="field">
                                  <apex:outputText value="{!item.description}" styleClass="field-value body2sp mightOverflow" />
                                  <apex:outputText value="{!item.specification}" styleClass="field-value body2sp mightOverflow" />
                                </div>
                              </td>
                              <td >
                                <div class="field">
                                  <apex:outputText value="{0, number, ###,###,###,###,###,##0.00}" styleClass="field-value right unitPrice2sp" >
                                    <apex:param value="{!item.unitPrice}" />
                                  </apex:outputText>
                                </div>
                              </td>
                              <td >
                                <div class="field">
                                  <apex:inputHidden html-class="costPriceJPY2spinput" value="{!item.costPriceJPY}" />
                                  <apex:outputText value="{0, number, ###,###,###,###,###,##0.00}" styleClass="field-value right costPrice2sp" >
                                    <apex:param value="{!item.costPrice}" />
                                  </apex:outputText>
                                </div>
                              </td>
                              <td >
                                <div class="field" style="margin: 0;">
                                  <apex:inputHidden html-class="salesPrice2spinput" value="{!item.salesPrice}" />
                                  <apex:inputHidden html-class="salesPrice2spCalcul" value="{!item.salesPriceCalcul}" />
                                  <apex:inputText rendered="{!!(isReadOnly || isQTRestricted)}" 
                                                  value="{!item.salesPriceFormatted}" 
                                                  styleClass="field-value right salesPrice2sp right" 
                                                  style="height: 52px;"
                                                  html-data-compare-value="{!item.salesPriceFormatted}" 
                                                  onblur="safetyLockCheck(this);" 
                                                  onchange="calculate2sp(this);" 
                                                  html-placeholder="{!item.salesPriceCalculFormatted}"
                                                  onkeypress="return disableEnterKey(event)"/>
                                  <apex:outputText rendered="{!(isReadOnly || isQTRestricted) && item.salesPriceFormatted != NULL}" value="{!item.salesPriceFormatted}" styleClass="field-value right salesPrice2sp right"/>
                                  <apex:outputText rendered="{!(isReadOnly || isQTRestricted) && item.salesPriceFormatted == NULL}" value="{!item.salesPriceCalculFormatted}" styleClass="field-value right salesPrice2spgrey right" style="color: #b3b3b3;"/>
                                </div>
                              </td>
                            </tr>
                          </apex:repeat>
                        </table>
                      </apex:outputPanel>
                    </div>
                  </apex:outputPanel>
                  <div class="modal-footer">
                    <div class="button-area">
                      <button style="{!IF((isReadOnly || isQTRestricted), 'display: none;', '')}" type="button" class="customButton" onclick="$j('#certificatePrintView').modal('hide');" >Cancel</button>

                      <apex:commandLink rendered="{!!(isReadOnly || isQTRestricted)}" value="Delete" action="{!deleteCurrent2SPInFullSP}" onclick="$j('#certificatePrintView .modal-content').addClass('ajax-loading');" styleclass="customButton doSave" oncomplete="$j('#certificatePrintView .modal-content').removeClass('ajax-loading');showResult('The Spare Parts have been saved.');$j('#certificatePrintView').modal('hide');unlockSafety();" rerender="listview, modalListView, modalListViewDel" status="ajaxStatusA"/>                
                    </div>
                    <div class="button-area right">
                      <apex:commandLink rendered="{!!(isReadOnly || isQTRestricted)}" value="Save" action="{!saveCurrent2SPInFullSP}" onclick="$j('#certificatePrintView .modal-content').addClass('ajax-loading');" styleclass="customButton doSave" oncomplete="$j('#certificatePrintView .modal-content').removeClass('ajax-loading');showResult('The Spare Parts have been saved.');$j('#certificatePrintView').modal('hide');unlockSafety();" rerender="listview, modalListView, modalListViewDel" status="ajaxStatusA"/>

                      <button style="{!IF(!(isReadOnly || isQTRestricted), 'display: none;', '')}" type="button" class="customButton" onclick="$j('#certificatePrintView').modal('hide');" >Close</button>
                    </div>
                  </div>
                </div>
              </div>
            </div>




            
            <!-- MULTI DELETE MODAL FORM -->
            <div class="modal fade" id="multiDeleteView" data-backdrop="static" tabindex="-1" role="dialog" aria-labelledby="multiDelete" aria-hidden="true">
              <div class="modal-dialog">
                <div class="modal-content">
                  <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                      <span aria-hidden="true">&times;</span>
                    </button>
                    <div id="multiDelete" class="screen-name">Delete Multiple Lines</div>

                  </div>
                  <apex:outputPanel layout="block" styleClass="modal-body" id="multiDeleteViewPanel">
                    <div class="section options-area" >
                      <div class="select-header clearfix" >
                        <div class="title clearfix" >
                          <div style="float: left;">Select the lines to delete</div>
                        </div>
                      </div>
                      <apex:outputPanel layout="block" id="modalListViewDel">
                        <table class="modalDetailList delete_table" id="delete_table" >
                          <col class="body" />
                          <col class="ModelType" />
                          <col class="MultDelQuantity" />
                          <col class="MultDelAmount" />
                          <tr >
                            <th >
                              <div class="field">
                                <apex:outputText value="{!$Label.JEOL_QuotEdit_Label_ProductName}" styleClass="field-label  body" />
                              </div>
                            </th>
                            <th >
                              <div class="field">
                                <apex:outputText value="Model Type" styleClass="field-label" />
                              </div>
                            </th>
                            <th >
                              <div class="field">
                                <apex:outputText value="Quantity" styleClass="field-label" />
                              </div>
                            </th>
                            <th >
                              <div class="field">
                                <apex:outputText value="Sales Price" styleClass="field-label" />
                              </div>
                            </th>
                          </tr>
                          <apex:repeat value="{!qdm.ItemsAllNotDeleted}" var="item" >
                            <tr data-depth="{!item.rec.Depth__c}" data-type="{!item.rec.Type__c}" data-rowguid="{!item.IdxRow}"
                                onmousedown="isMouseDown = true; window.getSelection().removeAllRanges(); if ($j(this).hasClass('todelete')) {isRemoveMode = true; $j(this).removeClass('todelete');} else {isRemoveMode = false; $j(this).addClass('todelete');} return false;"
                                onmouseover="if (isMouseDown) {if (isRemoveMode) {$j(this).removeClass('todelete');} else {$j(this).addClass('todelete');}}" >
                              <td >
                                <div class="field">
                                  <apex:outputText value="{!item.rec.Body__c}" styleClass="field-value body" />
                                </div>
                              </td>
                              <td >
                                <div class="field">
                                  <apex:outputText value="{!item.rec.ModelType__c}" styleClass="field-value" />
                                </div>
                              </td>
                              <td >
                                <div class="field">
                                  <apex:outputText value="{0, number, ###,##0.0}" styleClass="field-value  right" >
                                    <apex:param value="{!item.rec.Quantity__c}" />
                                  </apex:outputText>
                                </div>
                              </td>
                              <td >
                                <div class="field">
                                  <apex:outputText value="{0, number, ###,###,###,###,###,##0.00}" styleClass="field-value  right" rendered="{!item.rec.SalesPrice__c != NULL}" >
                                    <apex:param value="{!item.rec.SalesPrice__c}" />
                                  </apex:outputText>
                                  <apex:outputText value="{0, number, ###,###,###,###,###,##0.00}" styleClass="field-value  right" rendered="{!item.rec.SalesPrice__c == NULL}">
                                    <apex:param value="{!item.rec.SalesPriceCalculated__c}" />
                                  </apex:outputText>
                                </div>
                              </td>
                            </tr>
                          </apex:repeat>
                        </table>
                      </apex:outputPanel>
                    </div>
                  </apex:outputPanel>
                  <div class="modal-footer">
                    <div class="button-area">
                      <button type="button" class="customButton" onclick="$j('#multiDeleteView').modal('hide');" >Cancel</button>
                    </div>
                    <div class="button-area right">
                      <apex:commandLink value="Delete" onclick="$j('#multiDeleteView .modal-content').addClass('ajax-loading');deleteMultipleRows();" action="{!deleteMultiRows}" styleclass="customButton doSave" oncomplete="$j('#multiDeleteView .modal-content').removeClass('ajax-loading');$j('#multiDeleteView').modal('hide');showResult('Multiple lines have been deleted.');unlockSafety();" rerender="listview, modalListView, modalListViewDel" status="ajaxStatusA"/>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            
          </apex:form>

          <hr style="margin-bottom: 40px; width: 96%; border-color: #ddd;"/>
          <apex:outputPanel id="attachmentList" layout="block" styleClass="section base-width" rendered="{!(qdm.parentRec.id != null)}">
            <apex:relatedList list="CombinedAttachments" subject="{!qdm.parentRec.id}" />
          </apex:outputPanel>


          <apex:outputPanel id="historyList" layout="block" styleClass="section base-width" rendered="{!(qdm.parentRec.id != null)}">
          <div id="c_History" >
              <c:JEOL_GenericHistoryComponent object="{!qdm.parentRec}" recordsLimit="50"/>
          </div>
          </apex:outputPanel>

        </div>
      </apex:outputPanel>
    </body>
  </html>
</apex:outputPanel>

    <script>
        $j('html').scrollTop({!scrollTopValue});
        $j('body').scrollTop({!scrollTopValue});
        if ({!scrollTopValue > 48}) {
            $j('.navi-area').addClass('fixed-top');
        }
    </script>
    <script type="text/javascript">
      window.onscroll = function() {
          var iTop1 = $j('html').scrollTop();
          var iTop2 = $j('body').scrollTop();
          
          $j('input[id$=fieldScrollValue]').val((iTop1 > iTop2) ? iTop1 : iTop2);     
      };
    </script>
    
</apex:page>