<!--
 * Updated : 2015/06/02 by Polus (Voxer) - Add of the 明細項目初期設定 section of the User Settings
 * Updated : 2015/06/11 by Polus (Voxer) - Delete "rerender="contentPage"" from the preview button (Caused the disappearence of the top menu)
 -->
<apex:page showHeader="false" standardStylesheets="true" applyHtmlTag="false" applyBodyTag="false" doctype="html-5.0" controller="JEOL_QuotationEditorPageCtrl">
 <apex:outputPanel layout="none" id="contentPage">
  <html>
    <head>
      <meta name="viewport" content="width=device-width, initial-scale=1" />
      <title>Salesforce -{!qdm.parentRec.name}-</title>
      <apex:stylesheet value="{!URLFOR($Resource.JQueryUI, 'JQueryUI/jquery-ui.min.css')}" />
      <apex:stylesheet value="{!URLFOR($Resource.JEOL_CustomizedMaterials, 'JEOL_CustomizedMaterials/bootstrap/css/bootstrap.css')}" />
      <apex:stylesheet value="{!URLFOR($Resource.JEOL_CustomizedMaterials, 'JEOL_CustomizedMaterials/JEOL_CustomBaseStyle.css')}" />
      <!--[if IE 8.0]>
      <style>
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-item .quotation-detail-item[data-depth="0"] .indent-wrap:after {
          display: none;
        }
      </style>
      <script>
        document.createElement('button');
      </script>
      <![endif]-->
      <style>
        .contents .page-header {
          z-index: 2;
          position :relative;
          margin-bottom: 42px;
        }
        .contents .contents-body .section .section-body hr {
          float: left;
        }
        .contents .contents-body .button-area .section-body .customButton {
          float: left;
        }
        .contents .contents-body .navi-area {
          background-color: #7e9bc1;
          box-shadow: 0 1px 3px rgba(0,0,0,0.15);
          width: 100%;
          position: absolute;
          top: 0px;
          left: 0px;
          margin-top: 49px;
        }
        .contents .contents-body .navi-area.fixed-top {
          z-index: 2;
          position: fixed;
          margin-top: 0px;
        }
        .contents .contents-body .navi-area .section-body {
          padding: 4px 8px;
          margin: 0px auto;
          position: relative;
          z-index: 1;
        }
        .contents .contents-body .navi-area .section-body .navi-buttons {
          float: left;
          margin-right: 16px;
        }
        .contents .contents-body .navi-area .section-body .navi-buttons.right {
          float: right;
          margin-right: 0px;
          margin-left: 16px;
        }
        .contents .contents-body .navi-area .section-body .navi-item {
          margin-right: -1px;
          float: left;
        }
        .contents .contents-body .navi-area .section-body .navi-item>* {
          border-radius: 0;
        }
        .contents .contents-body .navi-area .section-body .navi-item:first-child>* {
          border-top-left-radius: 4px;
          border-bottom-left-radius: 4px;
        }
        .contents .contents-body .navi-area .section-body .navi-item:last-child {
          margin-right: 0px;
        }
        .contents .contents-body .navi-area .section-body .navi-item:last-child>* {
          border-top-right-radius: 4px;
          border-bottom-right-radius: 4px;
        }
        .contents .contents-body .navi-area .section-body .navi-item div[data-type="dropdown"] button[data-type="button"] {
          width: auto;
          padding: 0px 16px;
          border-radius: 0px;
          margin: 0px auto;
          border: 1px solid #7e9bc1;
          color: #2f4159;
        }
        
        .contents .contents-body .quotation-area .section-body .quotation-information {
          box-shadow: 0 1px 3px rgba(0,0,0,0.15);
          border: 1px solid #ddd;
          background-color: #ffffff;
        }
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-item {
          float: left;
          padding: 8px;
        }
        .contents .contents-body .quotation-area .section-body .quotation-information .field-label {
          font-size: 12px;
        }
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-item .quotation-item-header {
          width: 100%;
          border-radius: 2px;
          background-color: #becde0;
          margin: 0 0 4px 0;
          border: 1px solid transparent;
        }
        
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-item .quotation-item-header .header-title {
          float: left;
          display: block;
          padding: 8px;
        }
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-item.shipment-account-area .quotation-item-header .customButton {
          float: right;
          display: block;
          margin: 3px;
        }
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-item .quotation-item-body>* {
          float: left;
        }
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-item .quotation-item-body {
          width: 100%;
          border: 1px solid transparent;
          position: relative;
        }
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations .quotation-detail-header .quotation-detail-header-item {
          float: left;
        }
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations .quotation-detail-header .quotation-detail-header-item.customButton,
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations .quotation-detail-header .quotation-detail-header-item.disabled-button {
          padding: 6px;
          margin: 3px 0px 3px 3px;
        }
        .refreshButton-disabled.disabled-button {
          cursor: wait;
        }
        .disabled-button .refresh-icon {
          border-top-color: #ddd;
          border-left-color: #ddd;
          border-bottom-color: #ddd;
          background-color: #f9f9f9;
        }
        .disabled-button .refresh-icon:before {
          border-left-color: #ddd;
        }
        .contents .quotation-detail-action {
          display: block;
          border: 1px solid transparent;
          width: 30px;
          padding: 0px;
          text-align: center;
          text-decoration: none;
          cursor: pointer;
        }
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations .quotation-detail-list .quotation-detail-item {
          border: 1px solid transparent;
          margin: 2px 0px;
        }
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations .quotation-detail-list .quotation-detail-item[data-type="3"] {
          background-color: #d9edeb;
          border-radius: 8px;
        }
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations .quotation-detail-list .quotation-detail-item[data-type="4"] {
          background-color: #F9E4EC;
          border-radius: 8px;
        }
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations .quotation-detail-list .quotation-detail-item[data-type="5"] {
          background-color: #abcdef;
          border-radius: 8px;
        }
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations .quotation-detail-list .quotation-detail-item .quotation-detail-productName {
          padding-left: 30px;
        }
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations .quotation-detail-header .quotation-detail-header-item,
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations .quotation-detail-list .quotation-detail-item .field {
          margin-left: 8px;
        }
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations .quotation-detail-list .quotation-detail-item .field .indent-wrap {
          //height: 30px;
          position: relative;
        }
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations .quotation-detail-list .quotation-detail-item .field .indent-wrap .field-value {
          height: 30px;
          resize: none;
        }
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations .quotation-detail-list .quotation-detail-item .field .indent-wrap .field-value:noborder{
          height: 30px;
          resize: none;
        }
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations .quotation-detail-list .quotation-detail-item .field .indent-wrap .field-value:focus {
          resize: vertical;
        }
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations .quotation-detail-list .quotation-detail-item .field:first-child {
          margin-left: 0px;
        }
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations .quotation-detail-list .quotation-detail-item .field .sortableAction {
          height: 30px;
          box-shadow: none;
          transition: box-shadow 0.1s linear 0s;
          background-color: #FFFFFF;
          border-radius: 4px;
        }
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations .quotation-detail-list .quotation-detail-item .field .sortableAction:hover {
          box-shadow: 0 1px 3px rgba(0,0,0,0.40);
        }
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations .quotation-detail-list .quotation-detail-childWrap-item .quotation-detail-item .field .sortableAction:hover {
          box-shadow: 0 1px 3px rgba(0,0,0,0.40) inset;
        }
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations .quotation-detail-list .quotation-detail-item .field .sortableAction:active {
          cursor: row-resize;
          box-shadow: none;
          transition: none;
        }
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations .quotation-detail-list .quotation-detail-item .field .optionalButton {
          width: 30px;
          padding: 4px 8px;
          border: 1px solid transparent;
          background-color: #FFF;
          color: #7e9bc1;
          text-decoration: none;
          display: inline-block;
          *display: inline;
          *zoom: 1;
          border-radius: 4px;
          transition: box-shadow 0.2s linear 0s, background-color 0.2s linear 0s, color 0.2s linear 0s; 
        }
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations .quotation-detail-list .quotation-detail-item .field .desabled-optionalButton {
          width: 30px;
          padding: 4px 8px;
          border: 1px solid transparent;
          background-color: #FFF;
          color: #7e9bc1;
        }
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations .quotation-detail-list .quotation-detail-item .field.open .optionalButton {
          background-color: #F2D350;
          border: 1px solid #fff;
          color: #fff;
          box-shadow: 0px 1px 3px rgba(0,0,0,0.2) inset;
        }
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations .quotation-detail-list .quotation-detail-item .field .optionalButton:hover {
          background-color: #F2D350;
          box-shadow: 0px 1px 3px rgba(0,0,0,0.2);
          color: #fff;
        }
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations .quotation-detail-list .quotation-detail-item .field.open .optionalButton:hover {
          background-color: #F2D350;
          box-shadow: 0px 1px 3px rgba(0,0,0,0.2) inset;
          color: #fff;
        }
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations .quotation-detail-list .quotation-detail-item .field .optionalButton:focus {
          position: relative;
          border-color: #00ABFF;
          box-shadow: 0 1px 5px rgba(0,171,255,0.25);
          outline: none;
        }
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations .quotation-detail-list .quotation-detail-item .field .optionalButton:active {
          box-shadow: 0px 1px 3px rgba(0,0,0,0.2) inset;
          border: 1px solid #fff;
          
        }
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations .quotation-detail-list .quotation-detail-item .field .detail-options {
          top: 2.4em;
        }
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations .quotation-detail-list .quotation-detail-item .field .detail-options .detail-options-item {
          width: 158px;
          cursor: default;
          margin: 0;
        }
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations .quotation-detail-list .quotation-detail-item .field .detail-options .detail-options-item .field-value {
          margin: 0;
          vertical-align: middle;
        }
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations .quotation-detail-list .quotation-detail-item .field .detail-options .detail-options-item a {
          width: 100%;
          margin: 0px;
          vertical-align: middle;
          display: block;
          padding: 4px 16px;
        }
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations .quotation-detail-header .configAction {
          width: 36px;
          border: 1px solid transparent;
        }
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations .quotation-detail-list .quotation-detail-item .field .configAction {
          width: 40px;
          top: 3px;
          height: 30px;
          cursor: default;
        }
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations .quotation-detail-list .quotation-detail-item .field .configAction .paragraph-option {
          float: left;
          display: block;
          width: 50%;
          text-decoration: none;
          height: 100%;
          vertical-align: middle;
          box-shadow: none;
          transition: box-shadow 0.1s linear 0s, background-color 0.1s linear 0s;
          font-size: 30px;
          line-height: 30px;
          color: #becde0;
          background-color: transparent;
          cursor: pointer;
        }
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations .quotation-detail-list .quotation-detail-item .field .configAction .paragraph-option.paragraph-up {
          border-radius: 8px 0px 0px 8px;
        }
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations .quotation-detail-list .quotation-detail-item .field .configAction .paragraph-option.paragraph-down {
          border-radius: 0px 8px 8px 0px;
        }
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations .quotation-detail-list .quotation-detail-item .field .configAction .paragraph-option:hover {
          transition: none;
          box-shadow: 0 1px 3px rgba(0,0,0,0.20);
          color: #fff;
          background-color: #7FCC9E;
        }
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations .quotation-detail-list .quotation-detail-item .field .configAction .paragraph-option:active {
          box-shadow: 0 1px 3px rgba(0,0,0,0.20) inset;
        }

        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations .quotation-detail-list .quotation-detail-item .field .deleteAction {
          height: 30px;
          box-shadow: none;
          background-color: transparent;
          transition: box-shadow 0.1s linear 0s, background-color 0.1s linear 0s, color 0.1s linear 0s;
          font-weight: bold;
          border-radius: 30px;
          line-height: 30px;
          color: #becde0;
        }
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations .quotation-detail-list .quotation-detail-item .field .deleteAction:hover {
          box-shadow: 0 1px 3px rgba(0,0,0,0.20);
          background-color: #E34B4B;
          color: #FFFFFF;
        }
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations .quotation-detail-list .quotation-detail-item .field .deleteAction:focus {
          box-shadow: 0 1px 3px rgba(0,0,0,0.20);
          background-color: #E34B4B;
          color: #FFFFFF;
        }
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations .quotation-detail-list .quotation-detail-item .field .deleteAction:active {
          transition: none;
          box-shadow: 0 1px 3px rgba(0,0,0,0.40) inset;
        }

        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations .quotation-detail-list .quotation-detail-item .field .sortableAction .sortable-pointer {
          width: 18px;
          height: 18px;
          background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAABkCAYAAABw4pVUAAAAoUlEQVR42u3bUQ0AIQxEwSpHCGYqjRpAwDaZl6yBzid3dW4/y1k5AhADAsSAADEgQAwIEIcAYkCAGBAgBgSIAQFiQOwPIkmSJEmSJEmSJEmKyTu2jxwMCBADAsSAADEgQBwCiAEBYkCAGBAgBgSIATEg/lOXJEmSJEmSJEmSFJ5nU2/qBgSIAQFiQIAYECAOAcSAADEgQAwIEAMCxIAYkA0br9/OdIXF4wsAAAAASUVORK5CYII=');
          background-repeat: no-repeat;
          background-position: center, center;
          background-size: 18px 14px;
          margin-top: 50%;
          top: -9px;
          position: relative;
          display: inline-block;
          *display: inline;
          *zoom: 1;
          vertical-align: middle;
        }
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations .quotation-detail-list .quotation-detail-item .field .panel-area {
          border: none;
          width: 45px;
        }
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations .quotation-detail-list .quotation-detail-item .field .panel-area .option-view-panel {
          float: left;
          width: 15px;
          height: 15px;
          border: none;
          border-radius: 2px;
          background-color: #eee;
          transition: background-color 0.2s linear 0s, box-shadow 0.2s linear 0s, color 0.2s linear 0s, box-shadow 0.2s linear 0s;
          font-size: 11px;
          text-align: center;
          line-height: 15px;
          cursor: pointer;
          color: #fff;
          font-weight: bold;
          text-shadow: 1px 1px 0px #999, -1px -1px 0px #999, -1px 1px 0px #999, 1px -1px 0px #999;
        }
        /*
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations .quotation-detail-list .quotation-detail-item .field .panel-area:hover .option-view-panel:hover {
          width: 30px;
          height: 30px;
          line-height: 30px;
          font-size: 14px;
        }
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations .quotation-detail-list .quotation-detail-item .field .panel-area:hover .option-view-panel {
          width: 0px;
          height: 0px;
          overflow: hidden;
        }
        */
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations .quotation-detail-list .quotation-detail-item .field .detail-options .detail-options-item .tax,
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations .quotation-detail-list .quotation-detail-item .field .detail-options .detail-options-item .overhead,
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations .quotation-detail-list .quotation-detail-item .field .detail-options .detail-options-item .showAmount,
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations .quotation-detail-list .quotation-detail-item .field .detail-options .detail-options-item .accompanyingPaperOutput,
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations .quotation-detail-list .quotation-detail-item .field .detail-options .detail-options-item .commissionTarget,
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations .quotation-detail-list .quotation-detail-item .field .detail-options .detail-options-item .pagebreakTarget {
          width: 14px;
          height: 14px;
          display: inline-block;
          *display: inline;
          *zoom: 1;
          vertical-align: middle;
          margin-left: 8px;
        }
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations .quotation-detail-list .quotation-detail-item[data-tax-target="true"] .field .panel-area .option-view-panel.tax,
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations .quotation-detail-list .quotation-detail-item[data-overhead-target="true"] .field .panel-area .option-view-panel.overhead,
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations .quotation-detail-list .quotation-detail-item[data-show-target="true"] .field .panel-area .option-view-panel.showAmount,
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations .quotation-detail-list .quotation-detail-item[data-accompanying-paper-output="true"] .field .panel-area .option-view-panel.accompanyingPaperOutput,
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations .quotation-detail-list .quotation-detail-item[data-commission-target="true"] .field .panel-area .option-view-panel.commissionTarget,
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations .quotation-detail-list .quotation-detail-item[data-pagebreak-target="true"] .field .panel-area .option-view-panel.pagebreakTarget {
          box-shadow: 0px 1px 3px rgba(0,0,0,0.4) inset;
          color: #666;
          text-shadow: 1px 1px 0px #fff, -1px -1px 0px #fff, -1px 1px 0px #fff, 1px -1px 0px #fff;
        }
        
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations .quotation-detail-list .quotation-detail-item .field .detail-options .detail-options-item .tax,
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations .quotation-detail-list .quotation-detail-item[data-tax-target="true"] .field .panel-area .option-view-panel.tax {
          background-color: #7E8DC6;
          color: #2E385D;
        }
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations .quotation-detail-list .quotation-detail-item .field .detail-options .detail-options-item .overhead,
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations .quotation-detail-list .quotation-detail-item[data-overhead-target="true"] .field .panel-area .option-view-panel.overhead {
          background-color: #6EBBB3;
          color: #346E68;
        }
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations .quotation-detail-list .quotation-detail-item .field .detail-options .detail-options-item .showAmount,
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations .quotation-detail-list .quotation-detail-item[data-show-target="true"] .field .panel-area .option-view-panel.showAmount {
          background-color: #FFC396;
          color: #60412A;
        }
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations .quotation-detail-list .quotation-detail-item .field .detail-options .detail-options-item .accompanyingPaperOutput,
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations .quotation-detail-list .quotation-detail-item[data-accompanying-paper-output="true"] .field .panel-area .option-view-panel.accompanyingPaperOutput {
          background-color: #FFDF96;
          color: #665736;
        }
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations .quotation-detail-list .quotation-detail-item .field .detail-options .detail-options-item .commissionTarget,
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations .quotation-detail-list .quotation-detail-item[data-commission-target="true"] .field .panel-area .option-view-panel.commissionTarget {
          background-color: #DB81A5;
          color: #9A2D59;
        }
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations .quotation-detail-list .quotation-detail-item .field .detail-options .detail-options-item .pagebreakTarget,
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations .quotation-detail-list .quotation-detail-item[data-pagebreak-target="true"] .field .panel-area .option-view-panel.pagebreakTarget {
          background-color: #555555;
          color: #000000;
        }

        .commissionTargetMulti {
          width: 18px;
          height: 18px;
          display: inline-block;
          *display: inline;
          *zoom: 1;
          text-align: center;
          cursor: pointer;
          background-color: #DB81A5;
          color: #9A2D59;
          transition: background-color 0.2s linear 0s, box-shadow 0.2s linear 0s, color 0.2s linear 0s, box-shadow 0.2s linear 0s;
          font-weight: bold;
          text-shadow: 1px 1px 0px #fff, -1px -1px 0px #fff, -1px 1px 0px #fff, 1px -1px 0px #fff;
        }

        .commissionTargetMulti.commissionTargetMultiNotActive{
          box-shadow: 0px 1px 3px rgba(0,0,0,0.4) inset;
          color: #fff;
          text-shadow: 1px 1px 0px #999, -1px -1px 0px #999, -1px 1px 0px #999, 1px -1px 0px #999;
          background-color: #DDE5F0;
        }

        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations .quotation-detail-list .quotation-detail-item .discount-row {
          float: right;
          background-color: #DDE5F0;
          padding: 0px 8px;
          overflow: hidden;
          height: 0px;
          transition: height 250ms linear 0s;
          width: 100%;
          box-shadow: 0px 1px 3px rgba(0,0,0,0.4) inset;
        }
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations .quotation-detail-list .quotation-detail-item .discount-row .field input {
          visibility: collapse;
        }
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations .quotation-detail-list .quotation-detail-item[data-discount-target="true"] .discount-row .field input {
          visibility: visible;
        }
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations .quotation-detail-list .quotation-detail-item[data-discount-target="true"] .discount-row {
          height: 38px;
        }
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations .quotation-detail-list .quotation-detail-item .discount-row .field:first-child {
          margin-left: {!IF(language <> 'ja', '221px;', '323px')};
        }
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations .quotation-detail-list .quotation-detail-item .discount-row .field>* {
          vertical-align: middle;
        }
        .contents .contents-body .quotation-area .section-body .quotation-information .create-action-area .quotation-item-body {
          padding-left: 38px;
          position: relative;
        }
        .contents .contents-body .quotation-area .section-body .quotation-information .create-action-area .quotation-item-body .add-default-detail {
          float: left;
          border-radius: 4px 0 0 4px;
          margin-right: -1px;
        }
        .contents .contents-body .quotation-area .section-body .quotation-information .create-action-area .quotation-item-body .add-optional-details {
          float: left;
          border-radius: 0 4px 4px 0;
        }
        .contents .drag-placeholder {
          margin: 2px;
        }
        .contents .drag-placeholder>* {
          border-right: 1px dashed #ccc; 
          display: block;
          border: 1px solid transparent;
          overflow: hidden;
          border-radius: 4px;
        }
        .contents .drag-placeholder>*:after {
          padding: 5px 4px;
          text-align: center;
          margin: 4px 12px 4px 4px;
          border-radius: 4px;
          border: 1px dashed #CCC;
          background-color: #f6f6f6;
          color: #f6f6f6;
          position: relative;
          content: ".";
          display: block;
          left: 0px;
        }
        .contents .quotation-detail-childWrap-item {
          border: 1px dashed #7e9bc1;
          margin: -1px;
          overflow: hidden;
        }
        .contents .quotation-detail-childWrap-item>* {
          float: left;
        }
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-note-area {
          margin-top: 48px; 
        }
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-note-area .quotation-item-body .field .field-label {
          text-align: left;
          padding: 0 8px;
        }
        .contents .contents-body .action-area .section-body .save {
          float: left;
        }
        
        .contents .contents-body .quotation-detail-item .field .indent-wrap {
          position: relative;
          left: 0px;
          transition: left 0.2s linear 0s;
        }
        .contents .contents-body .quotation-detail-item[data-depth="0"] .indent-wrap {
          left: 0px;
        }
        .contents .drag-placeholder [data-depth="0"]:after {
          left: 82px;
        }
        .contents .contents-body  .quotation-detail-item[data-discount-target="true"] .quotation-detail-Amount {
          color: #999;
          text-decoration: line-through;
        }
        .contents .contents-body  .quotation-detail-item[data-depth="0"][data-discount-target="false"] .quotation-detail-Amount,
        .contents .contents-body  .quotation-detail-item[data-depth="0"] .discount-row .field .quotation-detail-totalDiscountAmount {
          font-weight: bold;
        }
        .contents .contents-body .quotation-detail-item[data-depth="1"] .indent-wrap {
          left: 24px;
        }
        .contents .contents-body .quotation-detail-item[data-depth="1"] .indent-wrap:after {
          color: #444;
        }
        .contents .drag-placeholder [data-depth="1"]:after {
          left: 106px
        }
        .contents .contents-body .quotation-detail-item[data-depth="2"] .indent-wrap {
          left: 48px;
        }
        .contents .contents-body .quotation-detail-item[data-depth="2"] .indent-wrap:after {
          color: #666;
        }
        .contents .drag-placeholder [data-depth="2"]:after {
          left: 130px
        }
        .contents .contents-body .quotation-detail-item[data-depth="3"] .indent-wrap {
          left: 72px;
        }
        .contents .contents-body .quotation-detail-item[data-depth="3"] .indent-wrap:after {
          color: #888;
        }
        .contents .drag-placeholder [data-depth="3"]:after {
          left: 154px;
        }
        .contents .contents-body .quotation-detail-item[data-depth="4"] .indent-wrap {
          left: 96px;
        }
        .contents .contents-body .quotation-detail-item[data-depth="4"] .indent-wrap:after {
          color: #aaa;
        }
        .contents .drag-placeholder [data-depth="4"]:after {
          left: 178px;
        }
        .contents .contents-body .quotation-detail-item[data-depth="5"] .indent-wrap {
          left: 120px;
        }
        .contents .contents-body .quotation-detail-item[data-depth="5"] .indent-wrap:after {
          color: #ccc;
        }
        .contents .drag-placeholder [data-depth="5"]:after {
          left: 202px;
        }
        .contents .contents-body .quotation-detail-item .indent-wrap:after {
          content: "┗";
          position: absolute;
          top: 8px;
          left: 0px;
          opacity: 0;
          z-index: -1;
          transition: opacity 0.1s linear 0.1s, left 0.2s linear 0s;
        }
        .contents .contents-body .quotation-detail-item[data-depth="1"] .indent-wrap:after,
        .contents .contents-body .quotation-detail-item[data-depth="2"] .indent-wrap:after,
        .contents .contents-body .quotation-detail-item[data-depth="3"] .indent-wrap:after,
        .contents .contents-body .quotation-detail-item[data-depth="4"] .indent-wrap:after,
        .contents .contents-body .quotation-detail-item[data-depth="5"] .indent-wrap:after {
          z-index: 1;
          opacity: 1.0;
          left: -24px;
        }
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations .quotation-detail-list>.quotation-detail-item:first-child .field .configAction .paragraph-option,
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations .quotation-detail-list>.quotation-detail-childWrap-item:first-child>.quotation-detail-item:first-child .field .configAction .paragraph-option{
          display: none;
        }
        .contents .contents-body .quotation-area .section-body .quotation-information .contract-account-area,
        .contents .contents-body .quotation-area .section-body .quotation-information .shipment-account-area,
        .contents .contents-body .quotation-area .section-body .quotation-information .basic-information-area,
        .contents .contents-body .quotation-area .section-body .quotation-information .option-field-area,
        .contents .contents-body .quotation-area .section-body .quotation-information .organization-information-area,
        .contents .contents-body .quotation-area .section-body .quotation-information .create-action-area,
        .contents .contents-body .quotation-area .section-body .quotation-information .total-amount-area {
          width: 50%;
        }
        .contents .contents-body .quotation-area .section-body .quotation-information .contract-account-area,
        .contents .contents-body .quotation-area .section-body .quotation-information .shipment-account-area {
          min-height: 320px;
        }
        .contents .contents-body .quotation-area .section-body .quotation-information .organization-information-area {
          min-height: {!IF(language <> 'ja', '566px;', '560px')};
        }
        .basic-information-area {
          min-height: {!IF(language <> 'ja', '566px;', '0px')};          
        }


        .contents .contents-body .quotation-area .section-body .quotation-information .total-amount-area .quotation-item-body .field .subtitleLabel,
        .contents .contents-body .quotation-area .section-body .quotation-information .total-amount-area .quotation-item-body .field .customReductionTitle {
          margin: 0px 10px 0px 88px;
          text-align: right;
        }
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations {
          position: relative;
        }
        .contents .contents-body .quotation-area .section-body .quotation-information .main-information-area,
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-detail-informations,
        .contents .contents-body .quotation-area .section-body .quotation-information .quotation-note-area {
          width: 100%;
        }
        .contents .contents-body .memo-area .section-body {
          box-shadow: 0 1px 3px rgba(0,0,0,0.15);
          border: 1px solid #ddd;
          background-color: #ffffff;
          padding: 8px;
          border-radius: 8px;
        }
        .contents .contents-body .memo-area .section-body .panel,
        .contents .contents-body .memo-area .section-body .panel .panel-header,
        .contents .contents-body .memo-area .section-body .panel .panel-body,
        .contents .contents-body .memo-area .section-body .panel .panel-body textarea {
          width: 100%;
          margin: 0;
        }
        .add-space {
          margin-top: 20px
        }

        .total-amount-area .quotation-item-body .field .field-value.commissionRate,
        .total-amount-area .quotation-item-body .field .field-value.taxRate {
          width: 36px;
        }
        .quotation-item .quotation-item-header .quotation-detail-action,
        .deliveryPeriod,
        .quoteValidityPeriod {
          width: 32px;
        }
        .month:after {
          content: "{!$Label.JEOL_QuotEdit_Label_Month}";
          
        }
        .quotation-detail-quantityUnit {
          width: 45px;
        }
        .groupLeaderApproval,
        .branchManagerApproval,
        .quotation-detail-quantity,
        .quotation-detail-overheadRate,
        .quotation-detail-commissionRate,
        .quotation-detail-discountRate,
        .contents .field .field-label[for="discountRate"] {
          width: 60px;
        }
        .field.toggle .deliveryCondition1 {
          width: 61px;
        }
        
        .contents .field .field-label[for="discountAmount"] {
          width: {!IF(language <> 'ja', '126px;', '72px')};
        }
        .series,
        .master-quantityUnit,
        .master-productPrice,
        .quotation-detail-quantityUnit-rate {
          width: 80px;
        }
        .contents .field .field-label[data-target="deliveryDeadline"] {
          width: 82px;
        }
        .deliveryCondition1 {
          width: 90px;
        }
        .contents .field.toggle .field-value.contractCode,
        .contents .field.toggle .field-value.shipmentCode {
          width: 67px;
          border-radius: 4px 0px 0px 4px;
          transition: border-color 0.2s linear 0s, box-shadow 0.2s linear 0s;
        }
        .field.toggle .field-value.guide-destinationAccountCode {
          width: 97px;
          border-radius: 4px 0px 0px 4px;
          transition: border-color 0.2s linear 0s, box-shadow 0.2s linear 0s;
        }
        .contractCodeView {
          width: 97px;
          border-radius: 4px 0px 0px 4px;
          border-bottom: 0px;
          display: inline-block;
          padding: 4px 8px;
          height: 30px;
          vertical-align: middle;
          overflow: hidden;
          white-space: nowrap;
          }
          
        .contractNameView {
          width: 300px;
          border-radius: 4px 0px 0px 4px;
          border-bottom: 0px;
          display: inline-block;
          padding: 4px 8px;
          height: 30px;
          vertical-align: middle;
          overflow: hidden;
          white-space: nowrap;
          }

        .contractNameView2 {
          width: 270px;
          border-radius: 4px 0px 0px 4px;
          border-bottom: 0px;
          display: inline-block;
          padding: 4px 8px;
          height: 30px;
          vertical-align: middle;
          overflow: hidden;
          white-space: nowrap;
          }

        .contractBelongView {
          width: 150px;
          border-radius: 4px 0px 0px 4px;
          border-bottom: 0px;
          display: inline-block;
          padding: 4px 8px;
          height: 30px;
          vertical-align: middle;
          overflow: hidden;
          white-space: nowrap;
          }        

        .deliveryLocationSectionView {
          width: 110px;
          border-radius: 4px 0px 0px 4px;
          border-bottom: 0px;
          display: inline-block;
          padding: 4px 8px;
          height: 30px;
          vertical-align: middle;
          overflow: hidden;
          white-space: nowrap;
          }
          
        .deliveryLocationTextView {
          width: 287px;
          border-radius: 4px 0px 0px 4px;
          border-bottom: 0px;
          display: inline-block;
          padding: 4px 8px;
          height: 30px;
          vertical-align: middle;
          overflow: hidden;
          white-space: nowrap;
          }
        .unitBodyView {
          border-radius: 4px 0px 0px 4px;
          border-bottom: 0px;
          display: inline-block;
          padding: 4px 8px;
          height: 30px;
          vertical-align: middle;
          overflow: hidden;
          white-space: nowrap;
          }
        .otherTextView {
          width: 910px;
          border-radius: 4px 0px 0px 4px;
          border-bottom: 0px;
          display: inline-block;
          padding: 4px 8px;
          height: 30px;
          vertical-align: middle;
          overflow: hidden;
          white-space: nowrap;
          }
        .shipmentCode + .productSearchButton,
        .contractCode + .productSearchButton {
          float: none;
          vertical-align: middle;
        }
        .quotationDivision,
        .contractCode,
        .shipmentCode,
        .shipmentDistanceZone {
          width: 96px;
        }
        .contents .field .field-value.deliveryDeadline,
        .contents .field .field-value.quoteExpirationDate {
          width: 98px;
        }
        .contents .field .field-value.postalCode {
          padding: 4px 8px 4px 24px;
          width: 100px;
        }
        .quotation-detail-UnitPrice {
          width: 94px;
        }
        .contents .field .field-label.quotationLimitDateLabel {
          width: {!IF(language <> 'ja', '111px', '108px')};
        }
        
        .contents .field .field-label[for="quoteNo"],
        .contents .field .field-label[for="quotationType"],
        .contents .field .field-label[for="createdByName"],
        .contents .field .field-label[for="issueDate"],
        .contents .field .field-label[for="printedDate"],
        .contents .field .field-label[for="quotationRequestedDate"],
        .contents .field .field-label[for="customerQuotationRequestedNo"],
        .contents .field .field-label[for="groupLeaderApproval"],
        .contents .field .field-label[for="branchManagerApproval"] {
          width: 112px;
        }
        
        .quotationRequestedDate,
        .issueDate {
          margin-left: -4px;
        }
        
        .quotation-detail-Amount,
        .quotation-detail-totalDiscountAmount  {
          margin-left: 4px;
          width: 112px;
        }
        .contents .field .field-value.quotation-detail-ProductCode {
          width: 109px;
        }
        .contents .field.toggle .field-value.quotation-detail-ProductCode {
          width: 80px;
          position: relative;
          border-radius: 4px 0px 0px 4px;
          float: left;
          transition: border-color 0.2s linear 0s, box-shadow 0.2s linear 0s;
        }

        .contents .field .field-value.salesAreaBis {
          /* width: 149px; modified for mitsumori shutsuyoku popup by mkubomura 20150821 */
          width: 108px;
        }
        .contents .field.toggle .field-value.salesAreaBis {
          /* width: 120px; modified for mitsumori shutsuyoku popup by mkubomura 20150821 */
          width: 79px;
          position: relative;
          border-radius: 4px 0px 0px 4px;
          float: left;
          transition: border-color 0.2s linear 0s, box-shadow 0.2s linear 0s;
        }

        .contents .field .field-value.quotation-detail-ProductCode.not-found-alert{
          border-color: #e34b4b;
          box-shadow: 0px 1px 3px rgba(227, 75, 75, 0.4), 0px 1px 3px rgba(0,0,0,0.15) inset;
        }
        .contents .field .field-value.quotation-detail-ProductCode.not-found-alert:focus {
          box-shadow: 0 1px 5px rgba(0,0,0,0.30) inset, 0px 1px 3px rgba(227, 75, 75, 0.4);
        }
        .contents .field.toggle .field-value + .productSearchButton {
          display:inline-block;
          *display: inline;
          *zoom: 1;
        }
        
        .contractPersonInCharge,
        .shipmentPersonInCharge,
        .quotation-detail-header-item.quotation-detail-ProductCode,
        .deliveryLocationSection,
        .durationYear,
        .paymentConditionSection {
          width: 112px;
        }
        .contents .field.toggle .field-value.unitBody {
          width: 122px;
          position: relative;
          border-radius: 4px 0px 0px 4px;
        }
        .contents .field .field-label[data-target="deliveryDate_Arbitrarily"] {
          width: {!IF(language <> 'ja', '127px;', '144px')};
        }
        
        .createdByName,
        .createdDate {
          width: 148px;
        }
        .contractBelong,
        .contractPost,
        .contractPhone,
        .contractFax,
        .shipmentBelong,
        .shipmentPost,
        .shipmentPhone,
        .shipmentFax,
        .quoteNo,
        .branchNo,
        input.registerDate,
        input.issueDate,
        input.quotationRequestedDate,
        .printedDate,
        .SalesArea,
        .quotation-detail-discountAmount,
        .unitBody,
        .acceptanceDate {
          width: 152px;
        }
        
        .quotationTypeView {
          width: 78px;
          border-bottom: 0px;
          display: inline-block;
          padding: 4px 8px;
          height: 30px;
          vertical-align: middle;
          }
        
        .field.toggle .salesAreaCode,
        .field.toggle .department,
        .field.toggle .quotationType {
          width: 79px;
        }
        .department,
        .salesAreaCode,
        .quotationType {
          width: 108px;
        }
        .departmentView {
          width: 108px;
          border-bottom: 0px;
          display: inline-block;
          padding: 4px 8px;
          height: 30px;
          vertical-align: middle;
          }
        
        .contents .field .field-label[data-target="deliveryPeriod"] {
          width: {!IF(language <> 'ja', '127px;', '156px')};
        }
        
        .total-amount-area .quotation-item-body .field .field-value,
        .salesPerson,
        .orgPhone,
        .salesAssistant {
          width: 172px;
        }
        .master-productName,
        .master-productCode {
          width: 180px;
        }
        .quotationSubtitleOutput,
        .quotationTotalAmountOutput {
          width: 192px;
        }
        .master-acountName {
          width: 200px;
        }
        .total-amount-area .quotation-item-body .field .field-label {
          width: 269px;
        }
        .deliveryLocationText,
        .deliveryCondition2,
        .paymentConditionText {
          width: 282px;
          margin: 0 0 0 8px;
        }
        .contractName,
        .shipmentName {
          width: 250px;
          margin: 0 0 0 8px;
        }
        .lastModifiedDate,
        .orgName,
        .shipmentDistanceSection {
          width: 256px;
        }
        .customerQuotationRequestedNo {
          width: 384px;
        }
        .master-acountAddress {
          width: 308px;
        }
        .quotation-detail-productName {
          width: 320px;
        }
        .deliveryDate_Arbitrarily {
          width: 352px;
        }
        .contractAddress,
        .shipmentAddress,
        .contractUndergraduate,
        .shipmentUndergraduate,
        .orgAddress {
          width: 400px;
        }
        
        .quotation-detail-overheadBody,
        .quotation-detail-commissionBody {
          width: 437px;
        }
        .name,
        .otherText {
          width: 918px;
        }
        .contents .field.toggle .name {
          width: 888px;
          position: relative;
          border-radius: 4px 0px 0px 4px;
        }
        .quotation-detail-subtotalBody {
          width: 679px;
        }
        .quotation-detail-headingBody {
          width: 803px;
        }
        .quotation-note-area .quotation-item-body .field,
        .quotation-note-area .quotation-item-body .field .field-value {
          width: 100%
        }
        .number {
          text-align: right;
        }
        .section-separator {
          border-top: 1px solid #7e9bc1;
          padding: 0px;
          margin: 0 auto;
          width: 100%;
        }
        .productSearchButton {
          width: 30px;
          height: 30px;
          display: none;
          border: 1px solid silver;
          background-color: #fff;
          border-radius: 0px 4px 4px 0px;
          text-align: center;
          line-height: 40px;
          margin-left: -1px;
          float: right;
        }
        .productSearchButton:hover {
          background-color: #f2f5f8;
          border-color: #00ABFF;
          text-decoration: none;
          box-shadow: 0px 1px 5px rgba(0,171,255,0.25);
          position: relative;
        }
        .productSearchButton
        Button:before {
          background-color: #becde0;
          display: block;
          content: " ";
          position: absolute;
          border-radius: 2px;
          width: 4px;
          height: 12px;
          top: 0px;
          left: 0px;
          right: 0px;
          bottom: 0px;
          margin: auto;
        }
        .productSearchButton:hover {
          background-color: #f2f5f8;
          border-color: #00ABFF;
          text-decoration: none;
          box-shadow: 0px 1px 5px rgba(0,171,255,0.25);
          position: relative;
        }
        .productSearchButton:focus {
          position: relative;
          border-color: #00ABFF;
          box-shadow: 0 1px 5px rgba(0,171,255,0.25);
          outline: none;
        }
        .productSearchButton:active {
          background-color: #f2f5f8;
          border-color: #00ABFF;
          text-decoration: none;
          position: relative;
          box-shadow: 0px 1px 5px rgba(0,171,255,0.25) inset;
        }
        .productSelectButton {
          position: absolute;
          top: 5px;
          left: 5px;
          width: 20px;
          height: 20px;
          border: 2px solid #becde0;
          display: block;
          background: none;
          background-color: #fff;
          border-radius: 20px;
          transform: none;
          transition: box-shadow 0.1s linear 0s, transform 0.1s linear 0s;
          cursor: pointer;
        }
        .productSelectButton:before {
          background-color: #becde0;
          display: block;
          content: " ";
          position: absolute;
          border-radius: 2px;
          width: 4px;
          height: 12px;
          top: 0px;
          left: 0px;
          right: 0px;
          bottom: 0px;
          margin: auto;
        }        
        .productSelectButton:after {
          background-color: #becde0;
          display: block;
          content: " ";
          position: absolute;
          border-radius: 2px;
          width: 12px;
          height: 4px;
          top: 0px;
          left: 0px;
          right: 0px;
          bottom: 0px;
          margin: auto;
        }
        .productSelectButton:hover {
          border-color: #7e9bc1;
          box-shadow: 1px 0px 3px rgba(0,0,0,0.20);
          transform: rotate(90deg);
        }
        .productSelectButton:hover:before {
          background-color: #7e9bc1;
        }
        .productSelectButton:hover:after {
          background-color: #7e9bc1;
        }
        .productSelectButton:active {
          cursor: pointer;
          box-shadow: 1px 0 3px rgba(0,0,0,0.40) inset;
        }
        .contents div[data-type="dropdown"] {
          display: block;
          position: relative;
        }
        .contents div[data-type="dropdown"]:after {
          content: "";
          display: block;
          height: 0px;
          clear: both;
        }
        .contents div[data-type="dropdown"] *[data-type="label"] {
          display: block;
          float: left;
        }
        .contents div[data-type="dropdown"] input[type="text"][data-type="input-field"] {
          display: block;
          float: left;
          border-radius: 4px 0px 0px 4px;
          border: 1px solid silver;
          box-shadow: 0 1px 3px rgba(0,0,0,0.15) inset;
          transition: box-shadow 0.1s linear 0s;
          height: 30px;
        }
        .contents div[data-type="dropdown"] input[type="text"][data-type="input-field"] + .productSearchButton {
          float: left;
          border-radius: 0px;
        }
        .contents div[data-type="dropdown"] input[type="text"][data-type="input-field"]:focus {
          position: relative;
        }
        .contents div[data-type="dropdown"] button[data-type="button"] {
          display: block;
          float: left;
          margin: 0px 0px 0px -1px;
          border-radius: 0px 4px 4px 0px;
          border: 1px solid silver;
          height: 30px;
          background-image: none;
          font-weight: normal;
          background-color: #fff;
          padding: 0px;
          text-aling: center;
          color: #7FCC9E;
          width: 20px;
          transition: box-shadow 0.2s linear 0s, background-color 0.2s linear 0s, border 0.2s linear 0s;
        }
        .contents div[data-type="dropdown"] button[data-type="button"]:hover {
          box-shadow: 0px 1px 3px rgba(0,0,0,0.2);
          background-color: #f2f5f8;
        }
        .contents div[data-type="dropdown"] button[data-type="button"]:active {
          box-shadow: 0px 1px 3px rgba(0,0,0,0.2) inset;
          background-color: #f2f5f8;
        }
        .contents div[data-type="dropdown"] button[data-type="button"]:focus {
          background-color: #f2f5f8;
          border-color: #00ABFF;
          box-shadow: 0px 1px 3px rgba(0,0,0,0.2) inset, 0 1px 5px rgba(0,171,255,0.25);
          outline: none;
        }
        .contents div[data-type="dropdown"].open ul[data-type="list"] {
          display: block;
          user-select: none;
          -moz-user-select: none;
          -webkit-user-select: none;
          -ms-user-select: none;  
        }
        .contents div[data-type="dropdown"] ul[data-type="list"] {
          display: none;
          position: absolute;
          height: auto;
          background-color: #fff;
          border: 1px solid silver;
          border-radius: 0px 0px 4px 4px;
          z-index: 2; <!-- Changed from 1 by Polus (2015/06/09) because the buttons "+" were appearing inside the dropdown -->
          top: 32px;
          right: 0px;
          box-shadow: 0px 2px 4px rgba(0,0,0,0.3);
          overflow: hidden;
        }
        .contents div.top[data-type="dropdown"] ul[data-type="list"] {
          bottom: 100%;
          top: auto;
          border-radius: 4px 4px 0px 0px;
        }
        .contents div[data-type="dropdown"] ul.scroll[data-type="list"] {
          max-height: 158px;
          overflow-y: auto;
        }
        .contents div[data-type="dropdown"] ul[data-type="list"] li hr {
          margin: 0px;
        }
        .contents div[data-type="dropdown"] ul[data-type="list"] li[data-type="item"] {
          padding: 0px;
          min-width: 76px;
          text-align: left;
          cursor: pointer;
          white-space: nowrap;
        }
        .contents div[data-type="dropdown"] ul[data-type="list"] li[data-type="item"]:hover {
          background-color: #f2f5f8;
        }

        .contents div[data-type="dropdown"] ul[data-type="list"] li[data-type="item"]:hover hr {
          margin: 4px;
        }
        
        .contents div[data-type="dropdown"] ul[data-type="list"] li[data-type="item"].close-option {
          text-align: center;
          width: 100%;
          margin: 0px;
        }
        .contents div[data-type="dropdown"] ul[data-type="list"] li[data-type="item"] a {
          padding: 4px 16px;
          display: block;
          width: 100%;
          text-decoration: none;
        }
        .contents div[data-type="dropdown"] ul[data-type="list"] li[data-type="item"] a:empty {
          height: 24px;
        }
        .contents div[data-type="dropdown"] ul[data-type="list"] li[data-type="item"] a:focus {
          background-color: #f2f5f8;
          outline: none;
        }
        
        .contents div[data-type="dropdown"] ul[data-type="list"] li[data-type="item"].close-option .closeButton {
          text-decoration: none;
          display: block;
          height: 30px;
          line-height: 30px;
          width: 100%;
        }
        .ajax-status-start {
          width: 100%;
          height: 100%;
          background-color: transparent;
          position: absolute;
          top: 0px;
          left: 0px;
          z-index: 1;
          text-align: center;
          font-size: 20px;
          color: #666;
        }
        .ajax-status-start-page {
          width: 100%;
          height: 100%;
          background-color: transparent;
          position: fixed;
          top: 0px;
          left: 0px;
          z-index: 10000;
          text-align: center;
          font-size: 20px;
          color: #666;
        }
        .ajax-status-start .ajax-status-start-inner {
          position: absolute;
          top: 0px;
          left: 0px;
          right: 0px;
          height: 100%;
          margin: auto;
        }
        .ajax-loading:before {
          content: "";
          background-repeat: no-repeat;
          background-image: url("{!URLFOR($Resource.JEOL_CustomizedMaterials, 'JEOL_CustomizedMaterials/images/ajax-2.gif')}");
          background-position: center center;
          display: block;
          position: absolute;
          top: 0px;
          left: 0px;
          right: 0px;
          bottom: 0px;
          height: 100%;
          width: 100%;
          z-index: 2;
        }
        .ajax-loading:after {
          content: "";
          width: 100%;
          height: 100%;
          position: absolute;
          top: 0px;
          left: 0px;
          z-index: 1;
          background-image: url("{!URLFOR($Resource.JEOL_CustomizedMaterials, 'JEOL_CustomizedMaterials/images/alpha-bg.png')}");
        }
        .contents .contents-body .section.error-area {
          padding: 0px;
          margin-bottom: 0px;
        }
        .field.ajaxRequestStatus {
          width: 100%;
          padding-left: 100px;
          margin: 0px;
        }
        .field.ajaxRequestStatus .ajaxStatusView {
          line-height: 30px;
          margin-left: 8px;
          color: #22816b;
        }
        .contents .field input.field-value.reference-field-hidden {
          height: 0px;
          width: 0px;
          padding: 0px !important;
          border: none;
          visibility: collapse;
        }
        .requireField:before {
          content: "※";
          display: inline;
          color: #e34b4b;
        }
        input::-webkit-calendar-picker-indicator {
          display: none;
        }
        .branchNoInput {
          width: 3rem;
        }
      </style>
      <apex:includeScript value="{!URLFOR($Resource.JQuery)}" />
      <apex:includeScript value="{!URLFOR($Resource.JQueryUI, 'JQueryUI/jquery-ui.min.js')}" />
      <apex:includeScript value="{!URLFOR($Resource.JEOL_CustomizedMaterials, 'JEOL_CustomizedMaterials/bootstrap/js/bootstrap.min.js')}" />
      <apex:includeScript value="{!URLFOR($Resource.JEOL_CustomizedMaterials, 'JEOL_CustomizedMaterials/PagerHelper.js')}" />
<!--
      
      <apex:outputPanel id="enhanceContractAccount">
      <script>
          var $j = jQuery.noConflict();
           function enhanceContractAccountLookup(){        
            $j('input[id$= contractAccountId_lkid]').val('{!qdm.parentRec.ContractAccount__c}');
            $j('input[id$= contractAccountId_lkold]').val('{!qdm.parentRec.ContractAccount__r.Name}');
            }
      </script>
      </apex:outputPanel>

      <apex:outputPanel id="enhanceShipmentAccount">
      <script>
          var $j = jQuery.noConflict();
           function enhanceShipmentAccountLookupxxx(){        
            $j('input[id$= shipmentAccountId_lkid]').val('{!qdm.parentRec.ShipmentAccount__c}');
            $j('input[id$= shipmentAccountId_lkold]').val('{!qdm.parentRec.ShipmentAccount__r.Name}');
            }
      </script>
      </apex:outputPanel>
-->
      <script>
        var $j = jQuery.noConflict();
        var safety = {!ISBLANK(qdm.parentRec.id)};
        var makeSafetyCheck = true;
        var makeSafetyCheck2 = true;
        var lastSuggest = 0;
        var lastsuggestval = '';
        var isMouseDown = false;
        var isRemoveMode = true;

        $j(function(){

            $j(".branchNoInput").attr("maxlength", 2);

            var windwTransitions = (function(e){
                if (makeSafetyCheck2 && (makeSafetyCheck || document.activeElement.type === 'text')) {
                    var currentFocus = document.querySelector(':focus');
                    if (currentFocus && typeof currentFocus !== 'undefined') {
                        currentFocus.blur();
                    }
                    if (safety) {
                        e.returnValue = '内容に変更がありました。保存せずにページから離れますか？';
                    } else {
                        safety = true;
                    }
                }
            });
            if (window.addEventListener) {
                window.addEventListener('beforeunload', windwTransitions);
            } else if (window.attachEvent) {
                window.attachEvent('onbeforeunload', windwTransitions);
            } else {
                alert("画面遷移時に警告を出せません。ご注意ください。");
            }
            var $window = $j(window);
            $window.on('click',clearAction);
            $window.on('scroll',function(e){
                var beforeTop = window.beforeTop;
                var currentTop = $window.scrollTop();
                if (!beforeTop) {
                    beforeTop = 0;
                }
                if (beforeTop < currentTop && currentTop > 48) {
                    $j('.navi-area').addClass('fixed-top');
                } else if ((beforeTop > currentTop && currentTop <= 48) || currentTop == 0) {
                    $j('.navi-area').removeClass('fixed-top');
                }
                window.beforeTop = currentTop; 
            });
            $window.on('keydown',function(e){
                var $dropdown = $j('.open[data-type="dropdown"]');
                if (/(38|40|27)/.test(e.which) && $dropdown.length) {
                    e.preventDefault();
                    e.stopPropagation();
                    
                    if (e.which == 27) {
                        $dropdown.removeClass('open');
                        $dropdown.find('[data-type="button"]').trigger('focus');
                    }
                    
                    var $items = $dropdown.find('[data-type="list"] [data-type="item"]');
                    var $target = $j(e.target);
                    if ($target.attr('data-type') !== 'item') {
                        $target = $target.closest('[data-type="item"]');
                    }

                    var target = null;
                    if ($target.length) {
                      target = $target[0];
                    }
                    var index = 0;
                    if (target) {
                        index = $items.index(target);
                        if (e.which == 38 && index > 0) {
                            index--;
                        }
                        if (e.which == 40 && index < $items.length - 1) {
                            index++;
                        }
                    }
                    $items.eq(index).find('a,input').trigger('focus');
                }
            });
            contentInit();
        });
       
        function unlockSafety() {
            safety = false;
        }
        function lockSafety() {
            safety = true;
        }
        function contentInit() {
            initWithCalcurate();
            $j('#selected-list').droppable(droppableOption);
            $j('#selected-list-catalog').droppable(droppableOption_catalog);
            var division = '{!productDivision}';
            var radioItems = $j('.search-area .field .radio-item input[type="radio"][value="' + division + '"]');
            radioItems.prop('checked', true);
            $j('.search-area .field .radio-item input.productDivision[type="text"]').val(division);
            //$j('.content-panel').draggable({handle: ".content-header"});
            //$j('.subwindow').draggable({handle: '.content-header'});
            $j('#detailProductItemView').on('hidden.bs.modal', function () {
                $j('#detailProductItemView .selected-list .drop-target').empty();
                detailProductItemManage.setTargetNode(null);
                detailProductCatalogManage.setTargetNode(null);
            });
        }
        function dorpdownAction(target) {
            var $target = $j(target).closest('[data-type="dropdown"]');
            if ($target.hasClass('open')) {
                $target.removeClass('open');
            } else {
                $j('.open').removeClass('open');
                $target.addClass('open');
            }
        }
        function clearAction(e) {
            var $target = $j(e.target).closest('[data-type="dropdown"]');
            if (!$target.hasClass('open')) {
                var $dropdown = $j('.open[data-type="dropdown"]');
                $dropdown.removeClass('open');
                //$dropdown.find('[data-type="button"]').trigger('focus');
            }
        }
        
        function setInputField(target) {
            var $target = $j(target);
            var $dropdown = $target.closest('[data-type="dropdown"]');
            var $inputField = $dropdown.find('[data-type="input-field"]');
            if ($target.attr('data-type') !== 'item') {
                $target = $target.closest('[data-type="item"]');
            }
            $inputField.val($target[0].getAttribute('data-value'));
            $inputField.trigger('focus');
            dorpdownAction(target);
        }
        function setSortable() {
            var sortableArea = $j('.quotation-detail-list');
            sortableArea.sortable(sortableOption);
        }
        
        function addDepth(target){
            var targetRow = $j(target).closest('.quotation-detail-item');
            var targetBefore = targetRow.prev('.quotation-detail-item');
            var depth = parseInt(targetRow[0].getAttribute('data-depth'), 10);
            if (targetBefore[0]) {
                var beforeDepth = parseInt(targetBefore[0].getAttribute('data-depth'), 10);
                var resultVal =  1 + depth;
                if (resultVal - beforeDepth > 1) {
                    resultVal--;
                }
                if (resultVal > 5) {
                    resultVal = 5;
                }
                targetRow[0].setAttribute('data-depth', resultVal);
                targetRow.find('.quotation-detail-depth').val(resultVal);
                initWithCalcurate();
                //subtotalAmountCalc();
            }
        }

        function removeDepth(target, isChain){
            var targetRow = $j(target).closest('.quotation-detail-item');
            var targetBefore = targetRow.prev('.quotation-detail-item');
            var depth = parseInt(targetRow[0].getAttribute('data-depth'), 10);
            var resultVal = 0;
            if (targetBefore[0]) {
                var beforeDepth = parseInt(targetBefore[0].getAttribute('data-depth'), 10);
                var resultVal =  0 + depth - 1;
                if (resultVal < 0) {
                    resultVal = 0;
                }
                targetRow[0].setAttribute('data-depth', resultVal);
                targetRow.find('.quotation-detail-depth').val(resultVal);
            }
            var targetAfter = targetRow.next('.quotation-detail-item');
            if (targetAfter[0]) {
                var nextNodeDepth = parseInt(targetAfter[0].getAttribute('data-depth'), 10);
                var conpareNum = (isChain ? 0 : 1);
                if (nextNodeDepth - resultVal > conpareNum) {
                    removeDepth(targetAfter[0], true);
                }
            }
            initWithCalcurate();
            if (targetRow[0].getAttribute('data-depth') === '0') {
                //subtotalAmountCalc();
            }
            
        }
        function eraseDepth(target) {
            var targetRow = $j(target).closest('.quotation-detail-item');
            var depth = parseInt(targetRow[0].getAttribute('data-depth'), 10);
            for (var i = depth; i >= 0; i--) {
                removeDepth(target);
            }
        }
        
        function initWithCalcurate() {
            RowManage.create();
            calcurate();
        }

        function calcurate() {
            myDivObj = document.getElementById("isReadOnly");
            if ( !myDivObj || myDivObj.innerHTML != "1") {
                RowManage.calcurate();
                setHeaderSubtotal();
                setTotalAmount();
            }
        }
        
        function setCommissionAmount() {
            var amount = transformCurrencyToInteger(RowManage.commissionAmount);
            var $commissionRate = $j('.commissionRate');
            var rate = transformCurrencyToInteger($commissionRate.val());
            $commissionRate.val(rate);
            var value = Math.floor((amount*rate) / 100);
            
            $j('.quotationCommissionAmountOutput').text(currencyFormat(value));
            $j('.quotationCommissionAmount').val(value);
        }
        function setHeaderSubtotal() {
            setCommissionAmount();
            var commissionAmount = transformCurrencyToInteger($j('.quotationCommissionAmount').val());
            var amount = transformCurrencyToInteger(RowManage.totalAmount);
            amount -= commissionAmount;
            $j('.quotationSubtitleOutput').text(currencyFormat(amount));
            $j('.quotationSubtitle').val(amount);
        }
        
        function setTaxAmount() {
            var amount = transformCurrencyToInteger(RowManage.totalTaxAmount);
            var discountAmount = getDiscountTotalAmount();
            var fixedAmount = amount - discountAmount;
            if (fixedAmount < 0) {
                fixedAmount = 0;
            }
            var $taxRate = $j('.taxRate');
            var rate = transformCurrencyToInteger($taxRate.val());
            $taxRate.val(rate);
            var value = Math.floor((fixedAmount*rate) / 100);
            
            $j('.quotationConsumptionTaxAmountOutput').text(currencyFormat(value));
            $j('.quotationConsumptionTaxAmount').val(value);
        }
        function getDiscountTotalAmount() {
            var $reductionForms = $j('.customReductionAmount');
            var totalReduction = 0;
            for (var i = 0; i < $reductionForms.length; i++) {
                var $reduction =  $j($reductionForms[i]);
                
                var reductionValue = transformCurrencyToInteger($reduction.val());
                if (reductionValue || reductionValue === 0) {
                    if (totalReduction + reductionValue > RowManage.totalAmount) {
                        reductionValue = RowManage.totalAmount - totalReduction;
                    }
                    $reduction.val(currencyFormat(reductionValue));
                    totalReduction += reductionValue;
                }
            }
            return totalReduction;
        }
        function getDiscountTotalAmount1() {
            var $reductionForms = $j('.customReductionAmount');
            var totalReduction = 0;
            for (var i = 0; i < 1; i++) {
                var $reduction =  $j($reductionForms[i]);
                
                var reductionValue = transformCurrencyToInteger($reduction.val());
                if (reductionValue || reductionValue === 0) {
                    if (totalReduction + reductionValue > RowManage.totalAmount) {
                        reductionValue = RowManage.totalAmount - totalReduction;
                    }
                    $reduction.val(currencyFormat(reductionValue));
                    totalReduction += reductionValue;
                }
            }
            return totalReduction;
        }
        function getDiscountTotalAmount12() {
            var $reductionForms = $j('.customReductionAmount');
            var totalReduction = 0;
            for (var i = 0; i < 2; i++) {
                var $reduction =  $j($reductionForms[i]);
                
                var reductionValue = transformCurrencyToInteger($reduction.val());
                if (reductionValue || reductionValue === 0) {
                    if (totalReduction + reductionValue > RowManage.totalAmount) {
                        reductionValue = RowManage.totalAmount - totalReduction;
                    }
                    $reduction.val(currencyFormat(reductionValue));
                    totalReduction += reductionValue;
                }
            }
            return totalReduction;
        }
        function setTotalAmount() {
            var headerSubtitleAmount = transformCurrencyToInteger($j('.quotationSubtitle').val());
            var totalReduction = getDiscountTotalAmount();
            var totalReduction1 = getDiscountTotalAmount1();
            var totalReduction12 = getDiscountTotalAmount12();
            
            var toalAmount = headerSubtitleAmount - totalReduction;
            var toalAmount1 = headerSubtitleAmount - totalReduction1;
            var toalAmount12 = headerSubtitleAmount - totalReduction12;
            
            var totalReductionPercent = 0;
            if (headerSubtitleAmount > 0 || totalReduction > 0) {
                totalReductionPercent = Math.round(totalReduction / headerSubtitleAmount * 10000) / 100;
            }
                    
            $j('.quotationTotalAmount').val(toalAmount);
            $j('.quotationTotalAmountOutput').text(currencyFormat(toalAmount));
            $j('.quotationSubtotalReductionAmount1').val(toalAmount1);
            $j('.quotationSubtotalReductionAmount1Output').text(currencyFormat(toalAmount1));
            $j('.quotationSubtotalReductionAmount2').val(toalAmount12);
            $j('.quotationSubtotalReductionAmount2Output').text(currencyFormat(toalAmount12));
            
            setTaxAmount();
            var taxAmount = transformCurrencyToInteger($j('.quotationConsumptionTaxAmount').val());
            
            var fixedTotalAmount = toalAmount + taxAmount;
            $j('.quotationTotalTaxAmountOutput').text(currencyFormat(fixedTotalAmount));
            $j('.quotationTotalTaxAmount').val(fixedTotalAmount);
            
            $j('#totalReductionPercent').text('' + totalReductionPercent + '%');
           
        }
        var ItemWrap = function(target, parent) {
            this.target = target;
            this.$target = $j(target);
            if (target) {
                this.type = target.getAttribute('data-type');
            }
            this.parent = parent;
            var layerNum = 0;
            if (parent) {
                layerNum = parent.layer + 1;
            }
            this.layer = layerNum;
            this.children = new Array();
        };
        ItemWrap.prototype = {
            calc: function() {
                this.amountCalc();
                var resultAmount = this.discountCalc();
                return resultAmount;
            },
            getFixedAmount: function(){
                var $row = this.$target;
                var amount = $row.find('.quotation-detail-totalDiscountAmount-input').val();
                return transformCurrencyToInteger(amount);
            },
            setAmount: function(amount){
                var $row = this.$target;

                var $quantity = $row.find('.quotation-detail-quantity');
                var $unitPrice = $row.find('.quotation-detail-UnitPrice');
                var quantityValue = transformCurrencyToInteger($quantity.val(), true);
                var unitPriceValue = transformCurrencyToInteger($unitPrice.val());
                $quantity.val(quantityValue.toFixed(1));
                $unitPrice.val(currencyFormat(unitPriceValue));
                
                amount = transformCurrencyToInteger(amount);
                $row.find('.quotation-detail-Amount-input').val(amount);
                $row.find('.quotation-detail-Amount').text(currencyFormat(amount));
                this.discountCalc();
            },
            setDiscountAmount: function(amount){
                var $row = this.$target;
                amount = transformCurrencyToInteger(amount);
                $row.find('.quotation-detail-totalDiscountAmount').text(currencyFormat(amount));
                $row.find('.quotation-detail-totalDiscountAmount-input').val(amount);
            },
            setUnitprice: function(amount) {
                var $row = this.$target;
                $row.find('.quotation-detail-UnitPrice').val(currencyFormat(0));
            },
            amountCalc: function() {
                var $row = this.$target;
                var $quantity = $row.find('.quotation-detail-quantity');
                var $unitPrice = $row.find('.quotation-detail-UnitPrice');
                var quantityValue = transformCurrencyToInteger($quantity.val(), true);
                var unitPriceValue = transformCurrencyToInteger($unitPrice.val());
                $quantity.val(quantityValue.toFixed(1));
                $unitPrice.val(currencyFormat(unitPriceValue))

        //Modification-VAIB-Begins(2015/05/27 UAT_QA_List No.87)
        var amount;
        if(unitPriceValue<0 && quantityValue ==0)
          amount = Math.floor(unitPriceValue);
        else
                  amount = Math.floor(quantityValue*unitPriceValue);
        //Modification-VAIB-Begins(2015/05/27 UAT_QA_List No.87)
                this.setAmount(amount);
                return this.discountCalc();
            },
            discountCalc: function() {
                var $row = this.$target;
                var amount = transformCurrencyToInteger($row.find('.quotation-detail-Amount-input').val());

                var $discountRate = $row.find('.quotation-detail-discountRate');
                var $discountAmount = $row.find('.quotation-detail-discountAmount');
    
                var discountValue = 0;
                var row = this.target;
                if (row.getAttribute('data-discount-target') === 'true') {
                    var discountRateValue = transformCurrencyToInteger($discountRate.val());
                    var discountAmountValue = transformCurrencyToInteger($discountAmount.val());
                    if (discountRateValue && discountRateValue != 0) {
                        if (discountRateValue > 100) {
                            discountRateValue = 100;
                        }
                        discountValue += Math.ceil((amount * discountRateValue) / 100);
                    } else {
                        discountRateValue = 0;
                    }
                    $discountRate.val(currencyFormat(discountRateValue));
                    if (discountAmountValue && discountAmountValue != 0) {
                        if (discountAmountValue > amount) {
                            discountAmountValue = amount;
                        }
                        discountValue = discountAmountValue;
                        $discountRate.val(0);
                    } else {
                        discountAmountValue = 0;
                    }
                    $discountAmount.val(currencyFormat(discountAmountValue));
                } else {
                    $discountRate.val(0);
                    $discountAmount.val(0);
                }

                var resultAmount = amount - discountValue;
                this.setDiscountAmount(resultAmount);
                return resultAmount;
            }
        }
        var RowManage = function(){};
        RowManage.prototype = {
            init : function (){
                this.root = new ItemWrap();
                this.list = new Array();
                this.totalAmount = 0;
                this.totalTaxAmount = 0;
                this.commissionAmount = 0;
            },
            push: function(row) {
                var rootItem = this.root;
                var lastChildItem = rootItem;

                while (lastChildItem.children.length > 0) {
                    var length = lastChildItem.children.length;
                    lastChildItem = lastChildItem.children[length - 1];
                }
                var currentTarget = lastChildItem;
                if (currentTarget.target) {
                    var targetDepth = parseInt(row.getAttribute('data-depth'), 10);
                    var currentTargetDepth = parseInt(currentTarget.target.getAttribute('data-depth'), 10);
    
                    if (targetDepth == currentTargetDepth) {
                        currentTarget = currentTarget.parent;
                    } else if (targetDepth < currentTargetDepth) {
                        while (currentTarget.target) {
                            currentTargetDepth = parseInt(currentTarget.target.getAttribute('data-depth'), 10);
                            if (targetDepth == currentTargetDepth) {
                                currentTarget = currentTarget.parent;
                                break;
                            }
                            currentTarget = currentTarget.parent;
                        }
                    }
                }
                var item = new ItemWrap(row, currentTarget);
                currentTarget.children.push(item);
                this.list.push(item);
            },
            create: function() {
                var details = $j('.quotation-detail-item');
                this.init();
                for (var i = 0; i < details.length; i++) {
                    this.push(details[i]);
                }
            },
            calcurate: function() {
                var topArray = this.root;
                if (topArray == null || topArray == undefined) {
                    throw 'root なし';
                }
                amount = this.fixCalc(this.root);
                this.totalAmount = amount.total;
                this.totalTaxAmount = amount.tax;
                this.commissionAmount = amount.commission;
            },
            fixCalc: function(targetItem) {
                var children = targetItem.children;
                var amount = {
                    total: 0,
                    tax: 0,
                    commission: 0
                };
                var subtotal = 0;
                var overhead = 0;
                var commission = 0;
                for (var i = 0; i < children.length; i++) {
                    var childItem = children[i];
                    var childNode = childItem.target;
                    var $childNode = $j(childNode);
                    var childRowType = childNode.getAttribute('data-type');
                    var isTaxTarget = (childNode.getAttribute('data-tax-target') === 'true' && (childRowType === '1' || childRowType === '3' || childRowType === '5'));
                    var isCommissionTarget = (childNode.getAttribute('data-commission-target') === 'true' && (childRowType === '1' || childRowType === '3'));
                    var isOverheadTarget = (childNode.getAttribute('data-overhead-target') === 'true' && (childRowType === '1'));
                    var isTotalCalcTarget = (childRowType === '1' || childRowType === '3' || childRowType === '5');
                    var childrenAmount = null;
                    if (childItem.children.length > 0) {
                        childrenAmount = this.fixCalc(childItem);
                    }
                    if (childRowType === '1') {
                        if (childrenAmount) {
                            childItem.setAmount(childrenAmount.total);
                            childItem.setUnitprice(0);
                            if (childrenAmount.tax && childrenAmount.tax > 0) {
                                $taxationTarget = $j(childNode).find('.isTaxationTarget').prop('checked',false);
                                isTaxTarget = false;
                                optionSetting($taxationTarget[0]);
                            }
                            amount.tax += childrenAmount.tax;
                            if (childrenAmount.commission && childrenAmount.commission > 0) {
                                $commissionTarget = $j(childNode).find('.isCommissionTarget').prop('checked',false);
                                isCommissionTarget = false;
                                optionSetting($commissionTarget[0]);
                            }
                            amount.commission += childrenAmount.commission;
                        } else {
                            childItem.calc();
                        }
                        var fixedAmount = childItem.getFixedAmount();
                        amount.total += fixedAmount;
                        
                        if (isTaxTarget) {
                            amount.tax += fixedAmount;
                        }
                        if (isCommissionTarget) {
                            <!-- amount.commission += fixedAmount; -->
                            commission += fixedAmount;
                        }
                        subtotal += fixedAmount;
                        if (isOverheadTarget) {
                            overhead += fixedAmount;
                        }
                    } else if (childRowType === '2') {

                        if (childrenAmount && childrenAmount.tax && childrenAmount.tax > 0) {
                            amount.tax += childrenAmount.tax;
                        }
                                                    
                    } else if (childRowType === '3') {

                        <!-- ************************** -->
                        <!-- *** SUNDRY EXPENSE ROW *** -->
                        <!-- ************************** -->

                        if (childrenAmount && childrenAmount.tax && childrenAmount.tax > 0) {
                            amount.tax += childrenAmount.tax;
                        }
                        var overheadRate = transformCurrencyToInteger($childNode.find('.quotation-detail-overheadRate').val(), true);
                        var resultAmount = Math.ceil((overhead * overheadRate) / 100);

                        childItem.setAmount(resultAmount);
                        var fixedAmount = childItem.getFixedAmount();
                        amount.total += fixedAmount;
                        if (isTaxTarget) {
                            amount.tax += fixedAmount;
                        }
                        if (isCommissionTarget) {
                            <!-- amount.commission += fixedAmount; -->
                            commission += fixedAmount;
                        }
                        subtotal += fixedAmount;
                        overhead = 0;
                    } else if (childRowType === '4') {

                        if (childrenAmount && childrenAmount.tax && childrenAmount.tax > 0) {
                            amount.tax += childrenAmount.tax;
                        }

                        childItem.setAmount(subtotal);
                        subtotal = 0;
                    } else if (childRowType === '5') {

                        <!-- ****************** -->
                        <!-- *** COMMISSION *** -->
                        <!-- ****************** -->

                        if (childrenAmount && childrenAmount.tax && childrenAmount.tax > 0) {
                            amount.tax += childrenAmount.tax;
                        }

                        var commissionRate = transformCurrencyToInteger($childNode.find('.quotation-detail-commissionRate').val(), true);
                        var resultAmount = -Math.ceil((commission * commissionRate) / 100);

                        childItem.setAmount(resultAmount);
                        var fixedAmount = childItem.getFixedAmount();
                        amount.total += fixedAmount;
                        if (isTaxTarget) {
                            amount.tax += fixedAmount;
                        }
                        subtotal += fixedAmount;
                        commission = 0;
                    }
                    if (childRowType !== '1' && childrenAmount) {
                        amount.total += childrenAmount.total;
                        subtotal += childrenAmount.total;
                        overhead += childrenAmount.total;
                        commission += childrenAmount.total;
                    }
                    
                }
                return amount;
            }
        }
        RowManage = new RowManage();

        function currencyFormat(value) {
            if (!value && value !== 0) {
                value = 0;
            }
            var valueParts = String(value).split(".");
            valueParts[0] = valueParts[0].replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,");
            return valueParts.join('.');
        }
        var transform2ByteNumericBase = '０１２３４５６７８９';
        function transformCurrencyToInteger(value, isfloatingPoint) {
  
            value = String(value);
            if ((!value && value !== 0) || !value.match(/^-?(?!,)[0-9０-９,]*(\.?(?=[0-9０-９]+)[0-9０-９]+)$/g)) {
                value = '0';
            } else {
                value = value.replace(/[０-９]/g,function(s){return transform2ByteNumericBase.indexOf(s);});
            }
            value = parseFloat(value.replace(/,/g,''));
            if (isfloatingPoint) {
                value = Math.floor(value*10)/10;
            } else {
                value = Math.floor(value);
            }
            return value;
        }

        function optionSetting(target) {
            var $targetRow = $j(target).closest('.quotation-detail-item');
            var value = $j(target).prop('checked');
            $targetRow[0].setAttribute(target.getAttribute('data-target'),value);
        }
        
        function optionSettingFromPanelClick(target) {
            var $targetRow = $j(target).closest('.quotation-detail-item');
            var targetClass = target.getAttribute('data-target-class');
            var $targetChackbox = $targetRow.find('.' + targetClass);
            var value = $targetChackbox.prop('checked');
            $targetChackbox.prop('checked', !value);
            optionSetting($targetChackbox[0]);
        }

        function execComissionTargetMulti(target) {

            if ($j(target).hasClass('commissionTargetMultiNotActive')) {

                $j(target).removeClass('commissionTargetMultiNotActive');

                $j('.option-view-panel.commissionTarget').each(function() {
                    if ($j(this).closest('.quotation-detail-item').attr('data-commission-target') != 'true') {
                        optionSettingFromPanelClick(this);                      
                    }
                });


            } else {

                $j(target).addClass('commissionTargetMultiNotActive');

                $j('.option-view-panel.commissionTarget').each(function() {
                    if ($j(this).closest('.quotation-detail-item').attr('data-commission-target') == 'true') {
                        optionSettingFromPanelClick(this);                      
                    }
                });

            }

            calcurate();
        }

        var sortableOption = {
                axis:'y',
                opacity: 0.7,
                placeholder: 'drag-placeholder',
                cursor: 'row-resize',
                handle: '.sortableAction',
                start: function(e,ui){isExecuteSortable = true;},
                activate: createPlaceholderBody,
                stop: changeSortNo
        };
        var isExecuteSortable = false;
        function createPlaceholderBody(e, ui) {
            var body = ui.item.find('.quotation-detail-item');
            var placeHolder = $j('.drag-placeholder');
            var bodyItem = document.createElement('div');
            for (var i = 0; i < body.length; i++) {
                var item = bodyItem.cloneNode();
                item.setAttribute('data-depth', body[i].getAttribute('data-depth'));
                placeHolder.append(item);
            }
        }
        function dragAction(targetRow) {
            detailBodyBlur(lasttarget);
        
            setSortable();
            var $sortableArea = $j('.quotation-detail-list');
            var target = $j(targetRow).closest('.quotation-detail-item')[0];
            var $details = $j('.quotation-detail-item');
            var wrapdiv = document.createElement('div');
            $j(wrapdiv).addClass('quotation-detail-childWrap-item');
            $sortableArea.empty();
            var block = wrapdiv.cloneNode();
            var isChildNode = false;
            var targetDepth = parseInt(target.getAttribute('data-depth'), 10);
            var lastDepth = 0;
            
            var targetDetailType = target.getAttribute('data-type');
            for (var i = 0; i < $details.length; i++) {
                var detail = $details[i];
                var currentDetailDepth = parseInt(detail.getAttribute('data-depth'), 10);
                lastDepth = currentDetailDepth;
                if (targetDepth === currentDetailDepth || (isChildNode && targetDepth - currentDetailDepth >= 0)) {
                    if (block.childNodes.length > 0) {
                        $sortableArea.append(block);
                    }
                    block = wrapdiv.cloneNode();
                    isChildNode = (targetDepth === currentDetailDepth)
                }
                block.appendChild(detail);
                if (!isChildNode && targetDepth !== 0 && targetDepth - currentDetailDepth < 2) {
                    if (block.childNodes.length > 0) {
                        $sortableArea.append(block);
                    }
                    block = wrapdiv.cloneNode();
                }
            }
            if (block.childNodes.length > 0) {
                $sortableArea.append(block);
            }
            var sortableTarget = ' .quotation-detail-childWrap-item';
            var excludeSelectors = [];
            if (targetDepth - lastDepth > 1 && targetDepth !== 0 && !(targetDetailType === '4' || targetDetailType === '3' || targetDetailType === '5')) {
                excludeSelectors.push(':last');
            }
            if (targetDepth !== 0) {
                excludeSelectors.push(':first');
            }
            if (excludeSelectors.length > 0) {
                sortableTarget += ':not(' + excludeSelectors.join(',') +')'
            }
            $sortableArea.sortable('option', 'items', sortableTarget);
            $sortableArea.sortable('refresh');
            $j(document).on("mouseup",childWrapEraser);
            
        }
        function childWrapEraser() {
            if (!isExecuteSortable) {
                var details = $j('.quotation-detail-item');
                $j('.quotation-detail-childWrap-item').remove();
                $j('.quotation-detail-list').append(details);
            }
            isExecuteSortable = false;
            $j(document).off("mouseup",childWrapEraser);                       
        }
        function changeSortNo(e, ui) {
            var details = $j('.quotation-detail-item');
            var sortableArea = $j('.quotation-detail-list');
            sortableArea.empty();
            
            RowManage.init();
            for (var i = 0; i < details.length; i++) {
                var detail = details[i];
                setSortNo(detail, i);
                sortableArea.append(detail);
                RowManage.push(detail);
            }
            RowManage.calcurate();
            calcurate();
        }
        function setSortNo(target, sortNo) {
            var $target = $j(target)
            target.setAttribute('data-sortNo', sortNo);
            $target.find('.quotation-detail-sortNo').val(sortNo);
        }
        
        /*-----------------------------------------------*/
        var mainProductConfig = {
            fields: [
                {sobjectField:['Name'], label: 'コード', className: 'master-productCode'},
                {sobjectField:['JapaneseName__c'], label: '名称', className: 'master-productName', targetFormClassName: 'name'},
                {sobjectField:['ModelType__c'], label: '形式', className: 'master-modelType'},
                {sobjectField:['UnitPrice__c'], label: '価格', className: 'master-productPrice'},
                {sobjectField:['Tani__c'], label: '単位', className: 'master-quantityUnit'},
                {sobjectField:['Division__c'], label: '区分', className: 'master-productDivision'},
                {sobjectField:['ModelType__c'], label: '形式', className: 'master-productModelType', targetFormClassName: 'name', hidden: true}
            ]
        };
        var productConfig = {
            fields: [
                {sobjectField:['Name'], label: 'コード', className: 'master-productCode', targetFormClassName: "quotation-detail-ProductCode"},
                {sobjectField:['JapaneseName__c'], label: '名称', className: 'master-productName', targetFormClassName: 'quotation-detail-productName'},
                {sobjectField:['ModelType__c'], label: '形式', className: 'master-modelType'},
                {sobjectField:['UnitPrice__c'], label: '価格', className: 'master-productPrice', targetFormClassName: 'quotation-detail-UnitPrice'},
                {sobjectField:['Tani__c'], label: '単位', className: 'master-quantityUnit', targetFormClassName: 'quotation-detail-quantityUnit'},
                {sobjectField:['Division__c'], label: '区分', className: 'master-productDivision'},
                {sobjectField:['ModelType__c'], label: '形式', className: 'master-productModelType', targetFormClassName: 'quotation-detail-productName', hidden: true}
            ]
        };
        var catalogConfig = {
            fields: [
                {sobjectField:['SearchKeyWord__c'], className: 'master-catalogSearchKeyWord'},
                {sobjectField:['ProductCatalog__c'], className: 'master-catalogProductCatalog', hidden: true},
                {sobjectField:['ProductNo__c'], className: 'master-catalogProductNo', hidden: true},
                {sobjectField:['ClassificationType__c'], className: 'master-catalogClassificationType', hidden: true},
                {sobjectField:['Position__c'], className: 'master-catalogPosition', hidden: true},
                {sobjectField:['ProductItem__r','Name'], appendTargetField:['Name'], className: 'master-catalogProductCode', targetFormClassName: 'catalogProductCode', hidden: true},
                {sobjectField:['ProductItem__r','JapaneseName__c'], appendTargetField:['JapaneseName__c'], className: 'master-catalogProductName', targetFormClassName: 'catalogProductName'},
                {sobjectField:['ProductItem__r','Tani__c'], appendTargetField:['Tani__c'], className: 'master-catalogProductQuantityUnit', targetFormClassName: 'catalogProductQuantityUnit', hidden: true},
                {sobjectField:['ProductItem__r','UnitPrice__c'], appendTargetField:['UnitPrice__c'], className: 'master-catalogProductUnitPrice', targetFormClassName: 'catalogProductUnitPrice', hidden: true},
                {sobjectField:['ProductItem__r','ModelType__c'], appendTargetField:['ModelType__c'], className: 'master-catalogProductModelType', targetFormClassName: 'catalogProductModelType'}
            ]
        };
        var quotationConfig = {
            fields: [
                {sobjectField:['QuoteNo__c'], label: '見積No.', className: 'master-quoteNo'},
                {sobjectField:['BranchNo__c'], label: '枝番', className: 'master-branchNo'},
                {sobjectField:['Id'], label: '見積No.', className: 'master-quoteId', hidden: true},
                {sobjectField:['QuotationType__c'], label: '見積種別', className: 'master-quotationType'},
                {sobjectField:['Name'], label: '見積名称', className: 'master-name'},
                {sobjectField:['ContractName__c'], label: '契約先名称', className: 'master-contractName'},
                {sobjectField:['ShipmentName__c'], label: '納入先名称', className: 'master-shipmentName'},
                {sobjectField:['CreatedBy','Name'], label: '作成者名', className: 'master-createdByName'},
                {sobjectField:['IssueDate__c'], label: '発行日', className: 'master-issueDate',
                    resultFunc: function(value){
                        var ret = '';
                        if (value) {
                            ret = (new Date(value)).toLocaleDateString();
                        }
                        return ret;
                    }
                }
            ]
        };

        var detailTypes = ['明細','見出し','諸経費','小計','口銭'];
        var detailFieldConfigures = {
                fields: [
                    {sobjectField: ['Type__c'], label: '明細タイプ', resultFunc: function(resultValue){
                            var ret = '';
                            if (resultValue) {
                                ret = detailTypes[parseInt(resultValue, 10) - 1];
                            }
                            return ret;
                        }
                    },
                    {sobjectField: ['Body__c'], label: '内容'},
                    {sobjectField: ['ProductCode__c'], label: '{!$Label.JEOL_QuotEdit_Label_ItemNo}'},
                    {sobjectField: ['Quantity__c'], label: '数量', className: 'number'},
                    {sobjectField: ['QuantityUnit__c'], label: '単位'},
                    {sobjectField: ['UnitPrice__c'], label: '単価',className: 'number'},
                    {sobjectField: ['TotalDiscountAmount__c'], label: '金額',className: 'number'}
                ]
        };

        var divNode = document.createElement('div');
        function render(records, renderTarget, renderConfigure, eventFunction) {
            var records = records;
            var body = renderTarget;
            body.empty();
            var $table = $j(divNode.cloneNode());
            $table.addClass('table');
            var $headerRow = $j(divNode.cloneNode());
            $headerRow.addClass('item');
            $table.append($headerRow);
            var config = renderConfigure;
            var fieldSettings = config.fields;
            for (var i = 0; i < records.length; i++) {
                var currentTarget = records[i];
                var $item = $j(divNode.cloneNode());
                $item.addClass('item');
                for (key in eventFunction) {
                    $item.on(key, eventFunction[key]);
                }
                if (fieldSettings) {
                    for (var j = 0; j < fieldSettings.length; j++) {
                        var fieldConfigure = fieldSettings[j];
                        if (fieldConfigure.sobjectField) {
                            var fieldValue = getFieldValue(currentTarget,fieldConfigure.sobjectField);
                            if (i === 0) {
                                var $headItem = createField(fieldConfigure.label);
                                $headItem.addClass('head');
                                if (fieldConfigure.hidden) {
                                    $headItem.css({display: 'none'});
                                }
                                $headerRow.append($headItem);
                            }
                            $headerRow.append($headItem);
                            if (fieldConfigure.resultFunc && typeof fieldConfigure.resultFunc === "function") {
                                fieldValue = fieldConfigure.resultFunc(fieldValue);
                            }
                            $field = createField(fieldValue, fieldConfigure.className);
                            $item.append($field)
                            if (fieldConfigure.hidden) {
                                $field.css({display: 'none'});
                            }
                        }
                    }
                    $table.append($item);
                }
            }
            body.append($table);
            return body.find('.item');
        }
        function getFieldValue(targetSobject, fieldNameArray) {
            var target = targetSobject;
            for (var i = 0; i < fieldNameArray.length; i++) {
                var fieldName = fieldNameArray[i];
                if (fieldName && typeof target[fieldName] !== "undefined") {
                    target = target[fieldName];
                    if (typeof target == "string") {
                      target = convert(target);
                    }
                } else {
                    target = '';
                    break;
                }
            }
            return target;
        }

        var convert = function(convert){
            return $j("<span />", { html: convert }).text();
        };

        function createField(value, fieldClass) {
            var field = $j(divNode.cloneNode());
            field.addClass('field');
            var fieldValue = $j(divNode.cloneNode());
            fieldClass = ' ' + (fieldClass ? fieldClass : '');
            fieldValue.addClass('field-value' + fieldClass);

            fieldValue.text(value);
            field.append(fieldValue);
            return field;
        }
        function pagerInfo(manage, targetNode) {
            var manager = manage;
            var $pagerArea = $j(targetNode).find('.pager-area');
            var currentPageNum = manager.getPageNumber();
            $pagerArea.find('.current-page-number').text(currentPageNum);
            if (currentPageNum > 1) {
                $pagerArea.find('.prev.customButton').show();
                $pagerArea.find('.prev.disabled-button').hide();
            } else {
                $pagerArea.find('.prev.customButton').hide();
                $pagerArea.find('.prev.disabled-button').show();
            }
            var maxPageNum = manager.maxPageNumber();
            $pagerArea.find('.max-page-number').text(maxPageNum);
            if (maxPageNum > currentPageNum) {
                $pagerArea.find('.next.customButton').show();
                $pagerArea.find('.next.disabled-button').hide();
            } else {
                $pagerArea.find('.next.customButton').hide();
                $pagerArea.find('.next.disabled-button').show();
            }
        }
        
/*------------------------------------------------------------*/
//
//  メイン品目選択画面
//
/*------------------------------------------------------------*/
        var mainProductItemManage = new PagerHelper();
        mainProductItemManage.setPageSize(13);
        mainProductItemManage.setConfig(mainProductConfig);
        function mainProductItemSearch() {
            var conditions = queryCondition($j('#mainProductItemSearchArea'));
            mianProductItemsQuery(conditions);
        }
        function mianProductItemsQuery(conditions) {
            $j('#mainProductItemView .modal-content').addClass('ajax-loading');
            JEOL_QuotationEditorPageCtrl.getProductMaster(conditions, function(result){
                if (result) {
                    var manage = mainProductItemManage;
                    manage.setRecords(result);
                    var $modal = $j('#mainProductItemView');
                    var $items = render(manage.getRecords(), $modal.find('.item-list'), manage.getConfig(), {'click': selectRecord});
                    var errorText = '';
                    if (manage.size() >= 10000) {
                        errorText = '検索結果が多いため10000件まで表示します。';
                        showAlert(errorText, false);
                    }
                    pagerInfo(manage, $modal);
                    if($modal.find('.auto-close-check').prop('checked')) {
                        $j('#mainProductItemSearchArea').collapse('hide');
                    }
                } else {
                    showAlert('情報を取得できませんでした。再度検索してみてください。', false);
                }
                $j('#mainProductItemView .modal-content').removeClass('ajax-loading');
            });
        }
        function deleteMultipleRows() {

            var $rowToDelete = $j('.todelete');
            var conditions = [];
            for (var i = 0; i < $rowToDelete.length; i++) {
                var field = $rowToDelete[i];
                var fieldName = field.getAttribute('data-rowguid');
                conditions.push(fieldName);
            }
            $j('input[id$=fieldListRowToDel]').val(conditions);
        }
        
        function selectRecord(e) {
            var $target = $j(e.target).closest('.item');
            var isSelected = $target.hasClass('selected');
            var $modal = $j('#mainProductItemView');
            var $items = $modal.find('.item.selected');
            $items.removeClass('selected');
            
            if (isSelected) {
                $target.removeClass('selected');
            } else {
                $target.addClass('selected');
            }
        }

        function nextRecords() {
            var $modal = $j('#mainProductItemView');
            var $items = render(mainProductItemManage.next(), $modal.find('.item-list'), mainProductItemManage.getConfig(), {'click': selectRecord});
            pagerInfo(mainProductItemManage, $modal);
        }
        function prevRecords() {
            var $modal = $j('#mainProductItemView');
            var $items = render(mainProductItemManage.prev(), $modal.find('.item-list'), mainProductItemManage.getConfig(), {'click': selectRecord});
            pagerInfo(mainProductItemManage, $modal);
        }
        
        function chooseMainProductItem() {
            var $modal = $j('#mainProductItemView');
            var $selectedItem = $modal.find('.item.selected');
            if ($selectedItem.length) {
                var values = [];

                //Modification-VAIB-Begin-(2015/05/26 UAT_QA_List No.65)
                var quotType = $j('.quotationType').val();
                if(quotType && quotType.length>0 && (quotType[0] == 'a' || quotType[0] == 'A')) 
                {
                    var modelType = $selectedItem.find('.master-productModelType').text();
                    if (modelType && modelType.length > 0) {
                        values.push(modelType);
                    }
                }
                //Modification-VAIB-End-(2015/05/26 UAT_QA_List No.65)

                var name = $selectedItem.find('.master-productName').text();
                if (name && name.length > 0) {
                    values.push(name);
                }
                $j('.name').val(values.join(' '));
                $modal.modal('hide');
            } else {
                showAlert('品目を選択してください。', false);
            }
        }

/*------------------------------------------------------------*/
//
//  品目複数選択画面    品目検索　カタログ検索
//
/*------------------------------------------------------------*/

        function initDetailProductItemManage($targetNode) {
            detailProductItemManage.setTargetNode($targetNode);
            detailProductCatalogManage.setTargetNode($targetNode);
        }

        var detailProductItemManage = new PagerHelper();
        detailProductItemManage.setPageSize(13);
        detailProductItemManage.setConfig(productConfig);
        
        function productItemSearch() {
            var conditions = queryCondition($j('#detailProductItemSearchArea'));
            detailProductItemsQuery(conditions);
        }
        function detailProductItemsQuery(conditions) {
            $j('#detailProductItemView .modal-content').addClass('ajax-loading');
            JEOL_QuotationEditorPageCtrl.getProductMaster(conditions, function(result){
                if (result) {
                    var manage = detailProductItemManage;
                    manage.setRecords(result);
                    var $modal = $j('#detailProductItemView');
                    var $items = render(manage.getRecords(), $modal.find('#productItemTabPanel .item-list'), manage.getConfig());
                    $items.draggable(draggableOption);
                    var errorText = '';
                    if (manage.size() >= 10000) {
                        errorText = '検索結果が多いため10000件まで表示します。';
                        showAlert(errorText, false);
                    }
                    pagerInfo(detailProductItemManage, $j('#productItemTabPanel'));
                    if($modal.find('#productItemTabPanel .auto-close-check').prop('checked')) {
                        $j('#detailProductItemSearchArea').collapse('hide');
                    }
                } else {
                    showAlert('情報を取得できませんでした。再度検索してみてください。', false);
                }
                $j('#detailProductItemView .modal-content').removeClass('ajax-loading');
            });
        }
        function nextRecordsAddDraggable() {
            var $modal = $j('#detailProductItemView');
            var $items = render(detailProductItemManage.next(), $modal.find('#productItemTabPanel .item-list'), detailProductItemManage.getConfig());
            $items.draggable(draggableOption);
            pagerInfo(detailProductItemManage, $j('#productItemTabPanel'));
        } 
        function prevRecordsAddDraggable() {
            var $modal = $j('#detailProductItemView');
            var $items = render(detailProductItemManage.prev(), $modal.find('#productItemTabPanel .item-list'), detailProductItemManage.getConfig());
            $items.draggable(draggableOption);
            pagerInfo(detailProductItemManage, $j('#productItemTabPanel'));
        }
        
        function chooseItemDetailProduct() {
            var items = [];
            var config = detailProductItemManage.getConfig();
            var fields = config.fields;
            var $modal = $j('#detailProductItemView');
            var $selectedItems = $modal.find('#productItemTabPanel .item.selected');
            if ($selectedItems.length) {
                for (var i = 0; i < $selectedItems.length; i++) {
                    var $selectedItem = $j($selectedItems[i]);
                    var values = [];
                    for (var j = 0; j < fields.length; j++) {
                        var field = fields[j];
                        if (field.targetFormClassName) {
                            var value = $selectedItem.find('.' + field.className).text();
                            values.push('"' + field.sobjectField.join('.') + '":"' + value + '"');
                        }
                    }
                    items.push('{' + values.join(',') + '}');
                }
                var $targetNode = detailProductItemManage.getTargetNode();
                var targetSortNo = $targetNode[0].getAttribute('data-sortNo');
                var jsonText = '{' + 
                                    '"sortNo":"' + targetSortNo + '",' +
                                    '"items":[' + items.join(',') +']' +
                                '}';
                createSelectedProductItemDetails(jsonText);
                $modal.modal('hide');
            } else {
                showAlert('追加する品目を選択してください。', false);
            }
        }

        var detailProductCatalogManage = new PagerHelper();
        detailProductCatalogManage.setPageSize(10000);
        detailProductCatalogManage.setConfig(catalogConfig);

        function productCatalogSearch() {
            var conditions = queryCondition($j('#detailProductCatalogSearchArea'));
            detailProductCatalogQuery(conditions);
        }

        function detailProductCatalogQuery(conditions) {
            $j('#detailProductItemView .modal-content').addClass('ajax-loading');
            JEOL_QuotationEditorPageCtrl.getCatalogHead(conditions, function(result){
                if (result) {
                    var manage = detailProductCatalogManage;
                    manage.setRecords(result);
                    var $modal = $j('#detailProductItemView');
                    var $items = catalogRender(manage.getRecords(), $modal.find('#productCatalogTabPanel .item-list'), manage.getConfig(),{"click":getChildCatalogStructure}, true);
                    $items.draggable(draggableOption);
                    var errorText = '';
                    if (manage.size() >= 10000) {
                        errorText = '検索結果が多いため10000件まで表示します。';
                        showAlert(errorText, false);
                    }
                    //pagerInfo(detailProductCatalogManage, $j('#productCatalogTabPanel'));
                    if($modal.find('#productCatalogTabPanel .auto-close-check').prop('checked')) {
                        $j('#detailProductCatalogSearchArea').collapse('hide');
                    }
                } else {
                    showAlert('情報を取得できませんでした。再度検索してみてください。', false);
                }
                $j('#detailProductItemView .modal-content').removeClass('ajax-loading');
            });
        }
        
        function getChildCatalogStructure(e) {
            var $target = $j(e.target);
            var $parentItem = $target.closest('.item');
            if (!$parentItem.hasClass('got-items')) {
                $j('#detailProductItemView .modal-content').addClass('ajax-loading');
                JEOL_QuotationEditorPageCtrl.getChildCatalogStructure($parentItem[0].getAttribute('data-catalog'), $parentItem[0].getAttribute('data-target'), $parentItem[0].getAttribute('data-position'), function(result, event){
                    childCatalogStructureCallBack(result, event, $parentItem);
                    $j('#detailProductItemView .modal-content').removeClass('ajax-loading');
                });
            }
            $parentItem.toggleClass('open');
            e.preventDefault();
            return false;
        }
        function childCatalogStructureCallBack(result, event, $parentItem) {
            var ret = null;
            if (event.status) {
                var $childWrapper = $j(divNode.cloneNode());
                $childWrapper.addClass('children');
                $parentItem.append($childWrapper);
                var manage = detailProductCatalogManage;
                manage.setRecords(result);
                var $modal = $j('#detailProductItemView');
                var $items = catalogRender(manage.getRecords(), $childWrapper, manage.getConfig(),{"click":getChildCatalogStructure});
                if (!$parentItem.hasClass('non-select-drag')) {
                    $items.draggable(draggableOption);
                } else {
                    $items.addClass('selected non-select-drag');
                    $items.draggable(selectedDraggableOption);
                }
                var errorText = '';
                if (manage.size() >= 10000) {
                    errorText = '検索結果が多いため10000件まで表示します。';
                    showAlert(errorText, false);
                }
                ret = $items;
            } else {
                showAlert('情報を取得できませんでした。再度検索してみてください。', false);
            }
            $parentItem.addClass('got-items');
            return ret;
        }
        function catalogRender(records, renderTarget, renderConfigure, eventFunction, isRoot) {    
            var records = records;
            var body = renderTarget;
            body.empty();
            var $tree = $j(divNode.cloneNode());
            $tree.addClass('tree');
            var config = renderConfigure;
            var fieldSettings = config.fields;
            for (var i = 0; i < records.length; i++) {
                var currentTarget = records[i];
                var $item = $j(divNode.cloneNode());
                $item.addClass('item');
                
                var $view = $j(divNode.cloneNode());
                $view.addClass('tree-view');
                $item.append($view);
                var $fieldSet = $j(divNode.cloneNode());
                $fieldSet.addClass('tree-fieldset');
                $item.append($fieldSet);
                if (fieldSettings) {
                    createCatalogItemDetail(currentTarget, $view, $fieldSet, fieldSettings);
                    if ((currentTarget.Position__c === 1 && isRoot) || currentTarget.ClassificationType__c == 1) {
                        for (key in eventFunction) {
                            $view.on(key, eventFunction[key]);
                        }
                        var structure = null;
                        if (currentTarget.Position__c === 1) {
                            structure = currentTarget.CatalogStructure__c;
                        } else {
                            structure = currentTarget.ClassificationNo__c;
                        }
                        $item[0].setAttribute('data-target', structure);
                        $item[0].setAttribute('data-catalog', currentTarget.ProductCatalog__c);
                        
                    }
                    if (currentTarget.Position__c === 1 && !isRoot) {
<!--                        $item[0].setAttribute('data-exclude-json-data', true); -->
                    }
                    var targetPosition = currentTarget.Position__c;
                    $item[0].setAttribute('data-position', targetPosition);
                    $tree.append($item);
                }
            }
            body.append($tree);
            return body.find('.item');
        }
        function createCatalogItemDetail(target, $view, $fieldSet, fieldSettings) {
            var viewTexts = [];
            for (var i = 0; i < fieldSettings.length; i++) {
                var fieldConfigure = fieldSettings[i];
                if (fieldConfigure.sobjectField) {
                    var fieldValue = getFieldValue(target,fieldConfigure.sobjectField);
                    if (fieldConfigure.resultFunc && typeof fieldConfigure.resultFunc === "function") {
                        fieldValue = fieldConfigure.resultFunc(fieldValue);
                    }
                    if (!fieldConfigure.hidden && fieldValue.length > 0) {
                        viewTexts.push(fieldValue);
                    }
                    var $field = createField(fieldValue, fieldConfigure.className);
                    $fieldSet.append($field);
                    /*if (fieldConfigure.hidden) {
                        $field.css({display: 'none'});
                    }*/
                }
            }
            $view.text(viewTexts.join(' '));
        }
        
        var asyncGetStructrueQueue = null;
        var fAlreadySent = true; <!-- Used to send it only once. If not, when the main folder has been opened, but not the child folders, the content of the child folder is added twice (reason unknown) (By Polus on 2015/06/16) -->
        
        function chooseCatalogDetailProduct() {
            var items = [];
            asyncGetStructrueQueue = {};
            fAlreadySent = false;
            var config = detailProductCatalogManage.getConfig();
            var fields = config.fields;
            var $modal = $j('#detailProductItemView');
            var $selectedItems = $modal.find('#productCatalogTabPanel .item.selected');
            if ($selectedItems.length) {
                $j('#detailProductItemView .modal-content').addClass('ajax-loading');
                getAllStructure($selectedItems);
            } else {
                showAlert('追加する品目を選択してください。', false);
            }                
        }
        function getAllStructure($targets) {
            if ($targets.length) {
                for (var i = 0; i < $targets.length; i++) {
                    var item = $targets[i];
                    var $item = $j(item);
                    var targetCatalog = item.getAttribute('data-catalog');
                    var targetStructure = item.getAttribute('data-target');
                    var targetPosition = item.getAttribute('data-position');
                    if ($item.hasClass('got-items') && targetStructure && targetStructure.length) {
                        <!-- The folder has been opened -->
                        asyncGetStructrueQueue[targetStructure] = item;
                        getAllStructure($item.find('.children>.tree>.item'));
                        delete asyncGetStructrueQueue[targetStructure];
                    } else if (targetStructure && targetStructure.length) {
                        <!-- The folder has not been opened, all childs should be added -->
                        asyncGetStructrueQueue[targetStructure] = item;
                        getCatalogStructureCall($item, targetCatalog, targetStructure, targetPosition);
                    }
                }
            }
            var queueLen = 0;
            for (key in asyncGetStructrueQueue) {
                queueLen++;
            }
            if (queueLen <= 0 && !fAlreadySent) {
                fAlreadySent = true;
                createImportCatalogJson();
            }
        }
        function getCatalogStructureCall($item, targetCatalog, targetStructure, targetPosition) {
            JEOL_QuotationEditorPageCtrl.getChildCatalogStructure(targetCatalog, targetStructure, targetPosition, function(result, event){
                var $items = childCatalogStructureCallBack(result, event, $item);
                delete asyncGetStructrueQueue[targetStructure];
                if ($items) {
                    getAllStructure($items);
                }
            });
        }
        function createImportCatalogJson() {
            var $items = $j('#detailProductItemView #productCatalogTabPanel #selected-list-catalog>.tree>.item');
            var jsonItems = [];
            getCatalogJson($items, jsonItems, 0);
            var $targetNode = detailProductCatalogManage.getTargetNode();
            var targetSortNo = $targetNode[0].getAttribute('data-sortNo');
            var jsonText = '{' + 
                                '"sortNo":"' + targetSortNo + '",' +
                                '"items":[' + jsonItems.join(',') +']' +
                            '}';
            var parsedJson = JSON.parse(jsonText);

            createSelectedProductItemDetails(jsonText);
            $j('#detailProductItemView .modal-content').removeClass('ajax-loading');
            $j('#detailProductItemView').modal('hide');
        }
        
        function getCatalogJson($items, jsonItems, depth) {
        
            var config = detailProductCatalogManage.getConfig();
            var fields = config.fields;
            for (var i = 0; i < $items.length; i++) {
                var item = $items[i];
                var $item = $j(item);

                
                var isExcludeTarget = (depth != 0 && item.getAttribute('data-exclude-json-data') === 'true');
                if (!isExcludeTarget) {
                    var values = [];
                    for (var j = 0; j < fields.length; j++) {
                        var field = fields[j];
                        if (field.targetFormClassName) {
                            var $fieldset = $item.children('.tree-fieldset');
                            var value = $fieldset.find('.' + field.className).text();
                            values.push('"' + field.appendTargetField.join('.') + '":"' + value + '"');
                        }
                    }
                    values.push('"depth":' + depth);
                    jsonItems.push('{' + values.join(',') + '}');
                    var structure = item.getAttribute('data-target');
                    if (structure && structure.length > 0) {
                        var children = $item.children('.children').children('.tree').children('.item');
                        getCatalogJson(children, jsonItems, depth + 1);
                    }
                }
            }
        }
/*------------------------------------------------------------*/
//
//  見積明細IMPORT処理群
//
/*------------------------------------------------------------*/
 
        var detailImportItemManage = new PagerHelper();
        detailImportItemManage.setPageSize(13);
        detailImportItemManage.setConfig(quotationConfig);
        function detailImportItemSearch() {
            var conditions = queryCondition($j('#detailImportSearchArea'));
            detailImportQuotationQuery(conditions);
        }
        function detailImportQuotationQuery(conditions) {
            $j('#detailImportView .modal-content').addClass('ajax-loading');
            JEOL_QuotationEditorPageCtrl.getQuotationInfo(conditions, function(result){
                if (result) {
                    var manage = detailImportItemManage;
                    manage.setRecords(result);
                    var $modal = $j('#detailImportView');
                    var $items = render(manage.getRecords(), $modal.find('.item-list'), manage.getConfig(), {'click': selectQuotationRecord});
                    var errorText = '';
                    if (manage.size() >= 10000) {
                        errorText = '検索結果が多いため10000件まで表示します。';
                        showAlert(errorText, false);
                    }
                    pagerInfo(detailImportItemManage, $modal);
                    if($modal.find('.auto-close-check').prop('checked')) {
                        $j('#detailImportSearchArea').collapse('hide');
                    }
                } else {
                    showAlert('情報を取得できませんでした。再度検索してみてください。', false);
                }
                $j('#detailImportView .modal-content').removeClass('ajax-loading')
            });
        }
        function nextQuotationRecords() {
            var $modal = $j('#detailImportView');
            var $items = render(detailImportItemManage.next(), $modal.find('.item-list'), detailImportItemManage.getConfig(), {'click': selectQuotationRecord});
            pagerInfo(detailImportItemManage, $modal);
        } 
        function prevQuotationRecords() {
            var $modal = $j('#detailImportView');
            var $items = render(detailImportItemManage.prev(), $modal.find('.item-list'), detailImportItemManage.getConfig(), {'click': selectQuotationRecord});
            pagerInfo(detailImportItemManage, $modal);
        }
        function selectQuotationRecord(e) {
            var $target = $j(e.target).closest('.item');
            var isSelected = $target.hasClass('selected');
            var $modal = $j('#detailImportView');
            var $items = $modal.find('.item.selected');
            $items.removeClass('selected');
            if (isSelected) {
                $target.removeClass('selected');
            } else {
                $target.addClass('selected');
                var targetId = $target.find('.master-quoteId').text();
                $modal.find('.detail-list').addClass('ajax-loading');
                JEOL_QuotationEditorPageCtrl.getQuotationDetails({'Parent__c': targetId}, function(result) {
                    if (result) {
                        var $m = $j('#detailImportView');
                        var $items = render(result,$m.find('.detail-list'), detailFieldConfigures);
                        $modal.find('.detail-list').removeClass('ajax-loading')
                    }
                });
            }
        }
        function importDetailFromSelectedQuotation() {
            $j('#detailImportView .modal-content').addClass('ajax-loading');
            var $loading = $j('#importDetailLoading');
            var $modal = $j('#detailImportView');
            var $targetQuotation = $modal.find('.item.selected');
            var targetId = $targetQuotation.find('.master-quoteId').text();
            if (targetId && targetId.length == 18) {
                importDetailFromQuotation(targetId);
                $modal.modal('hide');
            } else {
                showAlert('見積が選択されていません。', false);
            }
            $j('#detailImportView .modal-content').removeClass('ajax-loading')
        }
/*------------------------------------------------------------*/
        
        function queryCondition($targetNode) {
            var $searchFields = $targetNode.find('input.field-value[data-field]');
            var conditions = {};
            for (var i = 0; i < $searchFields.length; i++) {
                var field = $searchFields[i];
                var fieldName = field.getAttribute('data-field');
                var fieldValue = field.value;
                if (fieldName && fieldName.length != 0) {
                    conditions[fieldName] = fieldValue;
                }
            }
            return conditions;
        }
        
        function deleteConfirm() {
            if (confirm('見積を削除します。よろしいですか？')) {
                unlockSafety();
                qotationDelete();
            }
        }
        var draggableOption = {
            helper: 'clone',
            opacity: 0.7,
            zIndex: 102,
            scroll: false,
            start: function(e, ui) {
                ui.helper.addClass('item-drag');
            }
        };
        var selectedDraggableOption = {
            helper: 'clone',
            opacity: 0.7,
            zIndex: 102,
            cursorAt: {left: 5, top: 5},
            start: function(e, ui) {
                ui.helper.addClass('item-drag');
                $j(ui.helper.context).css({'background-color':'#eee'});
            },
            stop: function(e, ui) {
                var $draggable = $j(ui.helper.context);
                if($draggable.hasClass('remove-target') && $draggable.hasClass('selected')) {
                    $draggable.remove();
                } else {
                    $draggable.css({'background-color':''});
                }
            }
        }
        var droppableOption = {
            greedy: true,
            accept: '.item',
            tolerance: 'intersect',
            activeClass: 'drop-active', 
            hoverClass: 'drop-hover', 
            drop: function(e, ui){
                if (!ui.draggable.hasClass('selected')) {
                    $selectedItem = ui.draggable.removeAttr('style').clone();
                    $selectedItem.addClass('selected');
                    $selectedItem.draggable(selectedDraggableOption);
                    $j(e.target).find('.drop-target').append($selectedItem); 
                }
            },
            out: function(e, ui){
                if (ui.draggable.hasClass('selected')) {
                    ui.draggable.addClass('remove-target');
                }
            },
            over: function(e, ui) {
                if (ui.draggable.hasClass('selected')) {
                    ui.draggable.removeClass('remove-target');
                }
            }
        };
        var droppableOption_catalog = {
            greedy: true,
            accept: '.item',
            tolerance: 'intersect',
            activeClass: 'drop-active', 
            hoverClass: 'drop-hover', 
            drop: function(e, ui){
                if (!ui.draggable.hasClass('selected')) {
                    var $selectedItem = ui.draggable.removeAttr('style').clone();
                    $selectedItem.find('.item').addClass('selected non-select-drag');
                    $selectedItem.addClass('selected non-select-drag');
                    $selectedItem.draggable(selectedDraggableOption);
                    $selectedItem.find('.item').draggable(selectedDraggableOption);
                    var items = $selectedItem.find('.item[data-target] > .tree-view');
                    items.on('click',getChildCatalogStructure);
                    var structrue = $selectedItem[0].getAttribute('data-target');
                    if (structrue && structrue.length > 0 ) {
                        $selectedItem.children('.tree-view').on('click',getChildCatalogStructure);
                    }
                    $j(e.target).find('.drop-target').append($selectedItem); 
                }
            },
            out: function(e, ui){
                if (ui.draggable.hasClass('selected')) {
                    ui.draggable.addClass('remove-target');
                }
            },
            over: function(e, ui) {
                if (ui.draggable.hasClass('selected')) {
                    ui.draggable.removeClass('remove-target');
                }
            }
        };      
        function searchRepresentativeProductItem(target) {
            $field = $j(target).closest('.field');
            var productCode = $field.find('.name').val();
            JEOL_QuotationEditorPageCtrl.searchProductItem(productCode, function(result) {
                if (result) {
                    var values = [];

                  var quotType = $j('.quotationType').val(); 
                  if(quotType && quotType.length>0 && (quotType[0] == 'a' || quotType[0] == 'A'))  //Modification-VAIB-(2015/05/26 UAT_QA_List No.65)
                  {
                    var modelType = result['ModelType__c'];
                    if (modelType && modelType.length > 0) {
                      values.push(modelType);
                    }
                  }

                    var name = result['JapaneseName__c'];
                    if (name && name.length > 0) {
                        values.push(name);
                    }
                    $field.find('.name').val(values.join(' '));
                    showResult('品目の検索が完了しました。');
                } else {
                    $field.find('.name').addClass('not-found-alert');
                    showAlert('一致する品目がありませんでした。', false);
                }
            });
        }
        function searchProductItem(target) {
            var $row = $j(target).closest('.quotation-detail-item');
            var productCode = $row.find('.quotation-detail-ProductCode').val();
            JEOL_QuotationEditorPageCtrl.searchProductItem(productCode, function(result) {
                if (result) {
                    $row.find('.quotation-detail-UnitPrice').val(result['UnitPrice__c']);
                    var nameValues = [];
                    
                    var quotType = $j('.quotationType').val(); 
                    if(quotType && quotType.length>0 && (quotType[0] == 'a' || quotType[0] == 'A'))  //Modification-VAIB-(2015/05/26 UAT_QA_List No.65)
                    {
                        var modelType = result['ModelType__c'];
                        if (modelType && modelType.length > 0) 
                        {
                            nameValues.push(modelType);
                        }
                    }

                    var name = convert(result['JapaneseName__c']);
                    if (name && name.length > 0) {
                        nameValues.push(name);
                    }
                    $row.find('.quotation-detail-productName').val(nameValues.join(' '));
                    $row.find('.quotation-detail-quantityUnit').val(result['Tani__c']);
                    calcurate();

                    if (result['IsDisplayed__c']) {
                      showResult('品目の検索が完了しました。');
                    } else {
                      showAlert('この品目を使えなくなくなりました。', true);                      
                    }

                } else {
                    $row.find('.quotation-detail-ProductCode').addClass('not-found-alert');
                    showAlert('一致する品目がありませんでした。', false);
                }
            });
        }
        
        var alertAnime = null;
        function showAlert(target, isredcolor) {
            var alert = document.getElementById('alert');
            if (isredcolor) {
              alert.style.color = "red";
            } else {
              alert.style.color = "black";
            }
            if (alertAnime) {
                clearTimeout(alertAnime);
                alert.style.top = '0px';
                alert.style.opacity = '0';
                alert.style.transition = 'none';
            }
            if (target instanceof $j) {
                $j(alert).find('.description').append(target);
            } else if (target instanceof $j || typeof target === 'string') {
                $j(alert).find('.description').text(target);
            }
            alert.style.display = 'block';
            alertAnime = setTimeout(function(){
                alert.style.top = '20px';
                alert.style.opacity = '1';
                alert.style.transition = '';
            }, 100);
            alertAnime = setTimeout(hideAleart, 3200);
        }
        function hideAleart() {
            var alert = document.getElementById('alert');
            alert.style.top = '';
            alert.style.opacity = '';
            alertAnime = setTimeout(function(){
                alert.style.display = '';
                alertAnime = null;
                $j(alert).find('.description').empty();
            }, 500);
        }
        function openPreview() {
            window.open("{!PreviewUrl}","_blank","width=960,height=600,resizable=no,toolbar=no,location=no,menubar=no,status=no,scrollbars=yes");
        }
        function openPrintWindow() {
            window.open('{!PrintUrl}',"_blank","width=960,height=600,resizable=no,toolbar=no,location=no,menubar=no,status=no,scrollbars=yes");
        }
        function openDestinationPrintPreview() {
            window.open("{!DestinationPreviewUrl}","_blank","width=960,height=600,resizable=no,toolbar=no,location=no,menubar=no,status=no,scrollbars=yes");
        }
        function openDestinationPrintWindow() {
            window.open('{!DestinationPrintUrl}',"_blank","width=960,height=600,resizable=no,toolbar=no,location=no,menubar=no,status=no,scrollbars=yes");
        }
        function openCertificationPrintPreview() {
            window.open("{!CertificationPreviewUrl}","_blank","width=960,height=600,resizable=no,toolbar=no,location=no,menubar=no,status=no,scrollbars=yes");
        }
        function openCertificationPrintWindow() {
            window.open('{!CertificationPrintUrl}',"_blank","width=960,height=600,resizable=no,toolbar=no,location=no,menubar=no,status=no,scrollbars=yes");
        }
        function changeTaxAmountOutput(node) {
            var $target = $j(node);
            var value = $target.prop('checked');
            if (value) {
                $j('.includeTaxOutput').prop('checked', false);
            } else {
                $j('.includeTaxOutput').prop('checked', true);
            }
        }
        var errorAreaId = '#{!$Component.form.apexMessage}';
        function getErrorArea() {
            return $j(errorAreaId.replace(/(:)/ig,'\\\$1'));
        }
        function showResult(text) {
            var $error = getErrorArea();
            var $children = $error.children();
            if ($children.length > 0) {
                $children = $children.clone();
                $children.css({'text-align': 'left'});
                showAlert($children, false);
            } else {
                showAlert(text, false);
            }
        }

        function showAlertRefreshAll(text) {
          var pbRefreshAll = $j('[id$=existProblemRefreshAll]').val();
          if (pbRefreshAll == 'true') {
            showAlert('ある品目が使えなくなくなりました。', true);
          } else {
            showAlert(text, false);
          }
        }

        function showDependantFields() {
            var sQuotType = $j('[id$=quotationType]').val();
            if (sQuotType == 'B09' || sQuotType == 'B18') {
                $j('#divHideQuotType1').show();
                $j('#divHideQuotType2').show();
                $j('#divHideQuotType3').show();
            } else {
                $j('#divHideQuotType1').hide();
                $j('#divHideQuotType2').hide();
                $j('#divHideQuotType3').hide();
            }
        }
        function transformInputTextBranchNo(text) {
            var ret = '';
            if (text || text === 0) {
                ret = text.replace(/[０-９]/ig,function(s){
                    return String.fromCharCode(s.charCodeAt(0) - 65248);
                })
                ret = ret.match(/^[0-9]*/ig)[0];
            }
            if (ret.length < 2) {
                for (var i = ret.length; i < 2; i++) {
                    ret = '0' + ret;
                }
            }
            return ret;
        }
        function transformSafeInputText(text) {
            var ret = '';
            if (text) {
                ret = text.replace(/[０-９ａ-ｚＡ-Ｚ]/g,function(s){
                    return String.fromCharCode(s.charCodeAt(0) - 65248);
                })
                ret = ret.toUpperCase().match(/^[0-9A-Z]*/g)[0];
            }
            return ret;
        }
        function transformInputText(text) {
            var ret = '';
            if (text) {
                ret = text.replace(/[０-９ａ-ｚＡ-Ｚ]/g,function(s){
                    return String.fromCharCode(s.charCodeAt(0) - 65248);
                })
                ret = ret.toUpperCase();
            }
            return ret;
        }
        function tabSelection(self) {
            var $self = $j(self);
            if (!$self.hasClass('active')) {
                var $modal = $j('#detailProductItemView');
                var tabs = $modal.find('.tab');
                tabs.removeClass('active');
                var targetTabName = self.getAttribute('data-target');
                $modal[0].setAttribute('data-tab-target', targetTabName);
                $self.addClass('active');
            }
            $j('#detailProductItemView').css({'display':'block'});
        }
        
        var openModalDetailId = null;
        function setOpenModalDetailId(target) {
            var $detail = $j(target).closest('.quotation-detail-item');
            openModalDetailId = $detail.attr('id');
        }
        function focusOpenModalDetail() {
            var $detail = $j(document.getElementById(openModalDetailId));
            var $targetButton = $detail.find('.productSelectButton');
            openModalDetailId = null;
            $targetButton.trigger('focus');
        }
    
        function safetyLockCheck(targetNode) {
            var value = targetNode.getAttribute('data-compare-value');
            var type = targetNode.getAttribute('type');
            var currentValue = null;
            if (type === 'checkbox' || type === 'radio') {
                currentValue = targetNode.checked;
            } else {
                currentValue = targetNode.value;
            }
            if (value !== currentValue) {
                lockSafety();
            }
        }
        function unlockSafety() {
            safety = false;
        }
        function lockSafety() {
            safety = true;
        }
        var lasttarget;
        function detailBodyFocus(target) {
            lasttarget = target;
            $j(target).parent().css('left','0px');
        }
        function detailBodyBlur(target) {
            $j(target).parent().css('left','');
            $j(target).css({height:'30px'});
        }
        function openSearchToggleButton(target) {
            $j('.field.toggle').removeClass('toggle');
            $j(target).closest('.field').addClass('toggle');
        }
        /**
         * detect IE
         * returns version of IE or false, if browser is not Internet Explorer
         */
        function detectIE() {
            var ua = window.navigator.userAgent;
        
            var msie = ua.indexOf('MSIE ');
            if (msie > 0) {
                // IE 10 or older => return version number
                return parseInt(ua.substring(msie + 5, ua.indexOf('.', msie)), 10);
            }
        
            var trident = ua.indexOf('Trident/');
            if (trident > 0) {
                // IE 11 => return version number
                var rv = ua.indexOf('rv:');
                return parseInt(ua.substring(rv + 3, ua.indexOf('.', rv)), 10);
            }
        
            var edge = ua.indexOf('Edge/');
            if (edge > 0) {
               // IE 12 => return version number
               return parseInt(ua.substring(edge + 5, ua.indexOf('.', edge)), 10);
            }
        
            // other browser
            return false;
        }
        function makeSuggestions(target) {
        
            var val = target.value;
            if (val == lastsuggestval) return;
            lastsuggestval = val;
            
            lastSuggest += 1;
            var localLastSuggest = lastSuggest;
            
            target.removeAttribute("list");

            var dataList = $j("#suggest_list");
            dataList.empty();

            var isIE = detectIE();
            var isFirefox = navigator.userAgent.toLowerCase().indexOf('firefox') > -1;
            
            if (isIE || isFirefox) {
                if(val.length < 2) return;
            } else {
                if(val.length < 3) return;
            }

            JEOL_QuotationEditorPageCtrl.getSuggestions(val, function(result) {
                if (result) {
                    if(result.length) {
                        for(var i = 0, len = result.length; i < len; i++) {
                            if (localLastSuggest === lastSuggest)
                            {
                                var idxseparator = result[i].indexOf(",");
                                var opt = $j("<option></option>").attr("value", convert(result[i].substring(0,idxseparator)));
                                if (isIE || isFirefox) {
                                    opt.attr("label", convert(result[i].substring(0,idxseparator)) + " " + convert(result[i].substring(idxseparator + 1)));
                                } else {
                                    opt.attr("label", convert(result[i].substring(idxseparator + 1)));
                                }
                                dataList.append(opt);
                            }
                        }
        
                    }
                                     
                }
            });
                    
            if (localLastSuggest === lastSuggest)
            {
                target.setAttribute("list", "suggest_list");
            }                        
        }

    </script>
    </head>
    <body >
      <apex:actionStatus layout="block" onstop="contentInit();" id="ajaxPageStatus" startStyleClass="ajax-status-start-page">
        <apex:facet name="start">
          <div class="ajax-status-start-inner ajax-loading"></div>
        </apex:facet>
      </apex:actionStatus>
      <apex:outputPanel layout="block" styleClass="contents" id="contents" >
        <div class="page-header">
          <apex:include pageName="{!$Page.JEOL_VisualforceHeader}" />
        </div>
        <div class="contents-body">
          <apex:form id="form">
            <apex:inputText id="fieldScrollValue" styleclass="hidden" value="{!currentScrollValue}" />          
            <apex:inputText id="fieldListRowToDel" styleclass="hidden" value="{!ListRowToDel}" />          
            <apex:inputText id="existProblemRefreshAll" styleclass="hidden" value="{!qdm.existProblemRefreshAll}" />
            <div class="section navi-area" >
              <div class="section-body base-width clearfix">
                <ul class="navi-buttons clearfix">
                  <li class="navi-item">
                    <apex:commandLink action="{!saveAction}" styleClass="customButton save" onclick="unlockSafety();" status="ajaxPageStatus" >{!$Label.JEOL_QuotEdit_Label_Save}</apex:commandLink>
                  </li>
                </ul>
                <ul class="navi-buttons clearfix">
                  <li class="navi-item">
                    <button type="button" class="customButton" data-toggle="modal" data-target="#wordSettingView">{!$Label.JEOL_QuotEdit_Label_UserSettings}</button>
                  </li>
                  <apex:outputPanel layout="none" rendered="{!!isNew}" >
                  <li class=" navi-item">
                    <apex:commandLink styleClass="customButton" value="{!$Label.JEOL_QuotEdit_Label_Preview}" action="{!ajaxSaveAction}" oncomplete="openPreview();" status="ajaxPageStatus" />
                  </li>
                  <li class="{!IF(isCopyForbidden,'hidden','navi-item')}">
                    <div data-type="dropdown">
                      <button class="customButton" type="button" data-type="button" onclick="dorpdownAction(this);">
                        <span >{!$Label.JEOL_QuotEdit_Label_CopyQuotation}</span>
                        <span class="caret"></span>
                      </button>
                      <ul data-type="list">
                        <li data-type="item">
                          <apex:commandLink value="{!$Label.JEOL_QuotEdit_Label_NewQuotNo}" action="{!quotationCopy}"/>
                        </li>
                        <li data-type="item">
                          <apex:commandLink value="{!$Label.JEOL_QuotEdit_Label_NewBranchNo}" action="{!quotationCopyAndBranch}" />
                        </li>
                      </ul>
                    </div>
                  </li>
                  <li class=" navi-item">
                    <button type="button" class="customButton" data-toggle="modal" data-target="#OutputPrintView">{!$Label.JEOL_QuotEdit_Label_PrintQuotation}</button>
                  </li>
                  <li class=" navi-item">
                    <button type="button" class="customButton" data-toggle="modal" data-target="#destinationPrintView">{!$Label.JEOL_QuotEdit_Label_PrintDestination}</button>
                  </li>
                  <li class=" navi-item">
                    <button type="button" class="customButton" data-toggle="modal" data-target="#certificatePrintView">{!$Label.JEOL_QuotEdit_Label_PrintCertification}</button>
                  </li>
                  </apex:outputPanel>
                </ul>
                <ul class="navi-buttons right clearfix">
                  <li class=" navi-item">
                    <apex:outputPanel layout="none" rendered="{!!isNew}" >
                      <button class="{!IF(isReadOnly,'hidden','customButton')}" type="button" data-toggle="modal" data-target="#deleteConfirm">{!$Label.JEOL_QuotEdit_Label_Delete}</button>
                    </apex:outputPanel>
                  </li>
                </ul>
              </div>
            </div>
            <div class="section base-width">
              <div class="hidden" id="isReadOnly" >{!IF(isReadOnly, 1, 0)}</div>
              <div class="screenname">
                <h1 class="small">{!$Label.JEOL_QuotEdit_Label_Quotation}</h1>
                <div class="big" >
                  <apex:outputText rendered="{!isNew}" >
                    <span>{!$Label.JEOL_QuotEdit_Label_NewQuotation}</span>
                  </apex:outputText>


                  <apex:outputText rendered="{!!isNew}" value="{!$Label.JEOL_QuotEdit_Label_ReferringKeyword}">
                    <apex:param value="{!qdm.parentRec.Name}"/>

<!--                    <span> 
                    「{!qdm.parentRec.Name}」の参照
<!--                    </span> -->
                  </apex:outputText>

                </div>
              </div>
            </div>
            <apex:outputPanel layout="none" rendered="{!!isValid}">
              <div class="section base-width" >
                <apex:messages layout="table" />
                <apex:outputText >
                  <apex:outputLink value="{!$Page.JEOL_QuotationListPage}">コチラ</apex:outputLink>
                  <apex:outputText value="から再度操作を行ってください。" />
                </apex:outputText>
              </div>
            </apex:outputPanel>
            <apex:outputPanel layout="none" id="listview" rendered="{!isValid}">
              <apex:actionFunction name="createSelectedProductItemDetails"  action="{!qdm.createSelectedProductItemDetails}" rerender="detailArea, modalListView, modalListViewDel, apexMessage" status="ajaxStatus" >
                <apex:param value="" name="jsonText" assignTo="{!qdm.createdItemInfos}" />
              </apex:actionFunction>
              <apex:actionFunction name="importDetailFromQuotation" action="{!qdm.importDetailFromQuotation}" rerender="detailArea, modalListView, modalListViewDel" status="ajaxStatus" >
                <apex:param value="" name="targetId" assignTo="{!qdm.selectedQuotationId}" />
              </apex:actionFunction>
              <apex:actionFunction name="qotationDelete" action="{!deleteAction}" />
              <div class="section button-area base-width" >
                <div class="section-body clearfix">
                  <apex:outputLink value="{!$Page.JEOL_QuotationListPage}" >&laquo;&nbsp;{!$Label.JEOL_QuotEdit_Label_BackMenu}</apex:outputLink>
                </div>
              </div>
              <div class="section base-width error-area" >
                <apex:pageMessages id="apexMessage" />
              </div>
              <div class="section quotation-area base-width">
                <div class="section-header">
                </div>

                <div class="section-body">                
                  <!-- QUOTATION INFORMATION -->
                  <div class="quotation-information clearfix">

                    <div class="quotation-item basic-information-area">
                      <div class="quotation-item-header clearfix">
                        <div class="header-title">{!$Label.JEOL_QuotEdit_Label_BasicInfo}</div>
                      </div>
                      <div class="quotation-item-body clearfix">
    <div style="min-height: 273px;">                
                        <div class="field">
                          <label for="quoteNo" class="field-label" >{!$Label.JEOL_QuotEdit_Label_QuotationNo}</label>
                          <apex:variable value="{!ISBLANK(qdm.parentRec.id) && (!isCopy || (isCopy && !isBranch))}" var="isEditQuoteNo" />
                          <span class="{!IF(((isEditQuoteNo && !isReadOnly) || isBranch),'','hidden')}" style="margin-left: -4px;" >
                              <apex:inputField id="quoteNo-input" 
                                               styleClass="field-value quoteNo"
                                               value="{!qdm.parentRec.QuoteNo__c}"
                                               rendered="{!((isEditQuoteNo && !isReadOnly) || isBranch)}" onchange="this.value=transformSafeInputText(this.value);"/>
                          </span>
                          <span class="{!IF(((isEditQuoteNo && !isReadOnly) || isBranch),'hidden','')}" style="{!IF(isReadOnly,'margin-left: -4px;','margin-left: 5px;')}" >
                              <apex:outputField id="quoteNo-output" styleClass="field-value quoteNo" value="{!qdm.parentRec.QuoteNo__c}" rendered="{!(!isEditQuoteNo || isReadOnly)}"/>
                          </span>
                        </div>
                        <div class="field">
                          <apex:outputLabel value="{!$Label.JEOL_QuotEdit_Label_BranchNo}" for="branchNo" styleClass="field-label" />
                          <apex:outputField id="branchNoView" styleClass="field-value branchNo" value="{!qdm.parentRec.BranchNo__c}" rendered="{!!isBranch}"/>
                          <apex:inputField id="branchNo" 
                                           styleClass="field-value branchNo branchNoInput"
                                           value="{!qdm.parentRec.BranchNo__c}"
                                           rendered="{!isBranch}"
                                           onchange="this.value=transformInputTextBranchNo(this.value);"/>
                        </div>
                        <div class="field ajaxRequestStatus" >
                          <apex:actionStatus layout="block" id="ajaxQuotationTypeField" onstop="$j('.quotationType').trigger('focus');">
                            <apex:facet name="start">
                              <div class="ajaxStatusView" >{!$Label.JEOL_QuotEdit_Label_Searching}</div>
                            </apex:facet>
                          </apex:actionStatus>
                        </div>
                        <apex:outputPanel layout="block" id="quotationTypeField" styleClass="field" html-data-type="dropdown" style="min-width: 200px;">
                          <Label for="quotationType" html-data-type="label" class="{!IF(isReadOnly,'','requireField ')}field-label" style="float: left;">{!$Label.JEOL_QuotEdit_Label_QuotationType}</label>
                          <apex:inputText rendered="{!!isReadOnly}" id="quotationType" html-data-type="input-field" value="{!qdm.parentRec.QuotationType__c}" styleClass="quotationType field-value" html-data-compare-value="{!qdm.baseParentRec.QuotationType__c}" onchange="this.value=transformInputText(this.value);showDependantFields();" onfocus="openSearchToggleButton(this);" onblur="safetyLockCheck(this);" />
                          <apex:commandLink action="{!quoteTypeAttachment}" title="コード検索" styleClass="productSearchButton" rerender="quotationType,quotationTypeTextField,apexMessage" status="ajaxQuotationTypeField" oncomplete="showDependantFields();" >
                            <span class="refresh-icon"></span>
                          </apex:commandLink>
                          <span class="{!IF(!isReadOnly,'hidden','')}" style="margin-left: -8px;" >
                              <apex:outputText rendered="{!isReadOnly}" id="quotationTypeView" styleClass="quotationTypeView" html-data-type="input-field" value="{!qdm.parentRec.QuotationType__c}" />
                          </span>
                          <button class="{!IF(isReadOnly,'hidden','')}" type="button" data-type="button" onclick="dorpdownAction(this);">▼</button>
                          <ul class="scroll" data-type="list">
                            <apex:repeat value="{!QuoteTypeOptions}" var="option">
                              <li data-type="item" data-value="{!option.value}" >
                                <apex:commandLink action="{!quoteTypeAttachment}" onclick="setInputField(this);showDependantFields();" rerender="quotationType,quotationTypeTextField,apexMessage" status="ajaxQuotationTypeField" >
                                  <apex:outputText value="{!option.label}" />
                                </apex:commandLink>
                              </li>
                            </apex:repeat>
                          </ul>
                        </apex:outputPanel>
                        <apex:outputPanel id="quotationTypeTextField" layout="block" styleClass="field" style="margin-left: 8px;">
                          <apex:outputText value="{!qdm.parentRec.QuotationTypeText__c}" styleClass="field-value" style=" min-width: 100px; display: block;"/>
                        </apex:outputPanel>
                        

                        <div class="field" layout="block">
                          <label for="createdByName" class="field-label" >{!$Label.JEOL_QuotEdit_Label_EnteredBy}</label>
                          <div id="createdByName" class="field-value createdByName" style="margin-left: {!IF(isReadOnly,'-12px','-3px')}" >
                            <apex:outputField value="{!qdm.parentRec.createdBy.Name}" />
                          </div>
                        </div>
                        <div class="field">
                          <apex:outputLabel value="{!$Label.JEOL_QuotEdit_Label_DateRegister}" for="lastModifiedDate" styleClass="field-label" style="width: 80px;" />
                          <div id="createdDate" class="field-value createdDate" style="vertical-align: middle;">
                            <apex:outputText value="{0,date, yyyy/MM/dd}" >
                              <apex:param value="{!qdm.parentRec.CreatedDateFormula__c}" />
                            </apex:outputText>
                          </div>
                        </div>
                        <div class="field" style="min-width: 400px;" >
                          <label for="issueDate" class="field-label" >{!$Label.JEOL_QuotEdit_Label_DateIssue}</label>
                          <span class="{!IF(isReadOnly,'hidden','')}" onclick="makeSafetyCheck=false;" onblur="makeSafetyCheck=true;" onmouseout="makeSafetyCheck=true;" >
                              <apex:inputField rendered="{!!isReadOnly}" id="issueDate" styleClass="field-value issueDate" value="{!qdm.parentRec.IssueDate__c}" html-data-compare-value="{!qdm.baseParentRec.IssueDate__c}" onblur="safetyLockCheck(this);" />
                          </span>
                          <span class="{!IF(!isReadOnly,'hidden','')}" style="margin-left: -4px" >
                              <apex:outputField rendered="{!isReadOnly}" id="issueDateView" styleClass="field-value issueDate" value="{!qdm.parentRec.IssueDate__c}" html-data-compare-value="{!qdm.baseParentRec.IssueDate__c}"/>
                          </span>
                        </div>
                        <div class="field" style="min-width: 400px;">
                          <label for="printedDate" class="field-label" >{!$Label.JEOL_QuotEdit_Label_DatePrinting}</label>
                          <div class="field-value printedDate" style="margin-left: {!IF(isReadOnly,'-12px','-3px')}" >
                            <apex:outputField id="printedDate" value="{!qdm.parentRec.PrintedDate__c}" />
                          </div>
                        </div>
                        <div class="field">
                          <label for="quotationRequestedDate" class="field-label" >{!$Label.JEOL_QuotEdit_Label_DateInquiringQuotation}</label>
                          <span class="{!IF(isReadOnly,'hidden','')}" onclick="makeSafetyCheck=false;" onblur="makeSafetyCheck=true;" onmouseout="makeSafetyCheck=true;" >
                              <apex:inputField rendered="{!!isReadOnly}" id="quotationRequestedDate" styleClass="field-value quotationRequestedDate" value="{!qdm.parentRec.QuotationRequestedDate__c}" html-data-compare-value="{!qdm.baseParentRec.QuotationRequestedDate__c}" onfocus="makeSafetyCheck2=false;" onblur="safetyLockCheck(this);"  />
                          </span>
                          <span class="{!IF(!isReadOnly,'hidden','')}" style="margin-left: -4px" >
                              <apex:outputField rendered="{!isReadOnly}" id="quotationRequestedDateView" styleClass="field-value quotationRequestedDate" value="{!qdm.parentRec.QuotationRequestedDate__c}" html-data-compare-value="{!qdm.baseParentRec.QuotationRequestedDate__c}" />
                          </span>
                        </div>
                        <div class="field" style="min-width: 400px;">
                          <label for="customerQuotationRequestedNo" class="field-label " >{!$Label.JEOL_QuotEdit_Label_InquiredQuotationNo}</label>
                          <apex:inputField rendered="{!!isReadOnly}" id="customerQuotationRequestedNo" styleClass="field-value customerQuotationRequestedNo" value="{!qdm.parentRec.CustomerQuotationRequestedNo__c}" html-data-compare-value="{!qdm.baseParentRec.CustomerQuotationRequestedNo__c}" onblur="safetyLockCheck(this);" />
                          <apex:outputField rendered="{!isReadOnly}" id="customerQuotationRequestedNoView" styleClass="field-value customerQuotationRequestedNo" value="{!qdm.parentRec.CustomerQuotationRequestedNo__c}" />
                        </div>
                    </div>
                        <hr />
                        <div class="field month">
                          <apex:outputLabel value="{!$Label.JEOL_QuotEdit_Label_InstallationDuration}" for="deliveryPeriod" html-data-target="deliveryPeriod" styleClass="{!IF(isReadOnly,'','requireField ')}field-label" />
                          <apex:inputField rendered="{!!isReadOnly}" id="deliveryPeriod" styleClass="field-value deliveryPeriod number" value="{!qdm.parentRec.DeliveryPeriod__c}" html-data-compare-value="{!qdm.baseParentRec.DeliveryPeriod__c}" onblur="safetyLockCheck(this);" />
                          <apex:outputField rendered="{!isReadOnly}" id="deliveryPeriodView" styleClass="field-value deliveryPeriod number" value="{!qdm.parentRec.DeliveryPeriod__c}" />
                        </div>
                        <div class="field">
                          <apex:outputLabel value="{!$Label.JEOL_QuotEdit_Label_InstallationBy}" for="deliveryDeadline" html-data-target="deliveryDeadline" styleClass="field-label" />
                          <apex:inputField rendered="{!!isReadOnly}" id="deliveryDeadline" styleClass="field-value deliveryDeadline" value="{!qdm.parentRec.DeliveryDeadline__c}" html-data-compare-value="{!qdm.baseParentRec.DeliveryDeadline__c}" onclick="makeSafetyCheck2=false;" onblur="safetyLockCheck(this);makeSafetyCheck2=true;" onmouseout="makeSafetyCheck2=true;" />
                          <apex:outputField rendered="{!isReadOnly}" id="deliveryDeadlineView" styleClass="field-value deliveryDeadline" value="{!qdm.parentRec.DeliveryDeadline__c}" />
                        </div>
                        <div class="field" style="min-width: 400px;">
                          <apex:outputLabel value="{!$Label.JEOL_QuotEdit_Label_TentativeInstallationDate}" for="deliveryDate_Arbitrarily" html-data-target="deliveryDate_Arbitrarily" styleClass="field-label" />
                          <apex:inputField rendered="{!!isReadOnly}" id="deliveryDate_Arbitrarily" styleClass="field-value deliveryDate_Arbitrarily" value="{!qdm.parentRec.DeliveryDate_Arbitrarily__c}" html-data-compare-value="{!qdm.baseParentRec.DeliveryDate_Arbitrarily__c}" onblur="safetyLockCheck(this);"/>
                          <apex:outputField rendered="{!isReadOnly}" id="deliveryDate_ArbitrarilyView" styleClass="field-value deliveryDate_Arbitrarily" value="{!qdm.parentRec.DeliveryDate_Arbitrarily__c}" />
                        </div>
                        <hr />
                        <div class="field month">
                          <apex:outputLabel value="{!$Label.JEOL_QuotEdit_Label_QuotValidDuration}" for="quoteValidityPeriod" styleClass="{!IF(isReadOnly,'','requireField ')}field-label quotationLimitDateLabel" />
                          <apex:inputField rendered="{!!isReadOnly}" id="quoteValidityPeriod" styleClass="field-value quoteValidityPeriod number" value="{!qdm.parentRec.QuoteValidityPeriod__c}" html-data-compare-value="{!qdm.baseParentRec.QuoteValidityPeriod__c}" onblur="safetyLockCheck(this);" />
                          <apex:outputField rendered="{!isReadOnly}" id="quoteValidityPeriodView" styleClass="field-value quoteValidityPeriod number" value="{!qdm.parentRec.QuoteValidityPeriod__c}" />
                        </div>
                        <div class="field" style="{!IF(isReadOnly,'','height: 42px;')}">
                          <apex:outputLabel value="{!$Label.JEOL_QuotEdit_Label_QuotValidUntil}" for="quoteExpirationDate" styleClass="field-label quotationLimitDateLabel" style="{!IF(language <> 'ja', 'width: 100px;', 'margin-left: 20px;')}"/>
                          <apex:inputField rendered="{!!isReadOnly}" id="quoteExpirationDate" styleClass="field-value quoteExpirationDate" value="{!qdm.parentRec.QuoteExpirationDate__c}" html-data-compare-value="{!qdm.baseParentRec.QuoteExpirationDate__c}" onclick="makeSafetyCheck2=false;" onblur="safetyLockCheck(this);makeSafetyCheck2=true;" onmouseout="makeSafetyCheck2=true;" />
                          <apex:outputField rendered="{!isReadOnly}" id="quoteExpirationDateView" styleClass="field-value quoteExpirationDate" value="{!qdm.parentRec.QuoteExpirationDate__c}" />
                        </div>
                        <div class="{!IF(!isReadOnly,'hidden','field')}" style="width: 1200px;">
                          <apex:outputLabel style="width: 108px;" value="{!$Label.JEOL_QuotEdit_Label_QuotValidUntilArbit}" for="quoteExpirationDate_Arbitrarily" html-data-target="quoteExpirationDate_Arbitrarily" styleClass="field-label" />
                          <apex:inputField rendered="{!!isReadOnly}" id="quoteExpirationDate_Arbitrarily" styleClass="field-value quoteExpirationDate_Arbitrarily" value="{!qdm.parentRec.QuoteExpirationDate_Arbitrarily__c}" html-data-compare-value="{!qdm.baseParentRec.QuoteExpirationDate_Arbitrarily__c}" onblur="safetyLockCheck(this);"/>
                          <apex:outputField rendered="{!isReadOnly}" id="quoteExpirationDate_ArbitrarilyView" styleClass="field-value quoteExpirationDate_Arbitrarily" value="{!qdm.parentRec.QuoteExpirationDate_Arbitrarily__c}" />
                        </div>
                        <div class="field">
                          <apex:outputLabel value="{!$ObjectType.QuotationInformation__c.Fields.HyomenNebikiRitsu__c.Label}" styleClass="field-label quotationLimitDateLabel" />
                          <span id="totalReductionPercent" styleClass="field-value totalReductionPercent number" ></span>
                          <apex:outputField rendered="{!isReadOnly}" styleClass="field-value" value="{!qdm.parentRec.HyomenNebikiRitsu__c}" />
                        </div>

                      </div>
                    </div>
                    
                    <!-- ORGANIZATION INFORMATION -->
                    <apex:outputPanel id="organizationInformation" layout="block" styleClass="quotation-item organization-information-area">
                      <div class="quotation-item-header clearfix">
                        <div class="header-title">{!$Label.JEOL_QuotEdit_Label_CompanyProfile}</div>
                      </div>
                      <div class="quotation-item-body clearfix">
    <div style="min-height: 272px;">                
                        <div class="field ajaxRequestStatus" >
                          <apex:actionStatus layout="block"  id="departmentAttach" onstop="$j('.department').trigger('focus');">
                            <apex:facet name="start">
                              <div class="ajaxStatusView" >{!$Label.JEOL_QuotEdit_Label_Searching}</div>
                            </apex:facet>
                          </apex:actionStatus>
                        </div>
                        <div class="field" data-type="dropdown">
                          <apex:outputLabel value="{!$Label.JEOL_QuotEdit_Label_Division}" html-data-type="label" for="department" styleClass="{!IF(isReadOnly,'','requireField ')}field-label" style="float: left;"/>
                          <apex:inputText rendered="{!!isReadOnly}" id="department" html-data-type="input-field" styleClass="field-value department" value="{!qdm.parentRec.DepartmentCode__c}" html-data-compare-value="{!qdm.baseParentRec.DepartmentCode__c}" onchange="this.value=transformInputText(this.value);" onfocus="openSearchToggleButton(this);" onblur="safetyLockCheck(this);"/>
                          <apex:outputText rendered="{!isReadOnly}" id="departmentView" html-data-type="input-field" styleClass="departmentView" value="{!qdm.parentRec.DepartmentCode__c}" />
                          <apex:commandLink action="{!departmentInfoAttachment}" title="コード検索" styleClass="productSearchButton" rerender="organizationInformation,apexMessage" status="departmentAttach" >
                            <span class="refresh-icon"></span>
                          </apex:commandLink>
                          <button class="{!IF(isReadOnly,'hidden','')}" type="button" data-type="button" onclick="dorpdownAction(this);">▼</button>
                          <ul class="scroll" data-type="list">
                            <apex:repeat value="{!DepartmentOptions}" var="option">
                              <li data-type="item" data-value="{!option.value}" >
                                <apex:commandLink action="{!departmentInfoAttachment}" onclick="setInputField(this);" rerender="organizationInformation,apexMessage" status="departmentAttach" >
                                  <apex:outputText value="{!option.label}" />
                                </apex:commandLink>
                              </li>
                            </apex:repeat>
                          </ul>
                        </div>
                        <apex:outputPanel layout="block" styleClass="field" style="margin-left: 8px;">
                          <apex:outputText value="{!qdm.parentRec.DepartmentName__c}" styleClass="field-value" style="min-width: 100px; display: block;"/>
                        </apex:outputPanel>
                        <div class="field" style="{!IF(isReadOnly,'min-width: 400px;','')}">
                          <apex:outputLabel value="{!$Label.JEOL_QuotEdit_Label_CompanyName}" for="orgName" styleClass="field-label" />
                          <apex:inputField rendered="{!!isReadOnly}" id="orgName" styleClass="field-value orgName" value="{!qdm.parentRec.OrgName__c}" html-data-compare-value="{!qdm.baseParentRec.OrgName__c}" onblur="safetyLockCheck(this);" />
                          <apex:outputField rendered="{!isReadOnly}" id="orgNameView" styleClass="field-value orgName" value="{!qdm.parentRec.OrgName__c}" />
                        </div>
                        <div class="field hidden">
                          <apex:inputHidden id="postalCode" html-class="field-value postalCode" value="{!qdm.parentRec.PostalCode__c}" />
                        </div>
                        <div class="field">
                          <apex:outputLabel value="{!$Label.JEOL_QuotEdit_Label_Address}" for="orgAddress" styleClass="field-label" />
                          <apex:outputText id="orgAddress" styleClass="field-value orgAddress" value="{!address}" />
                        </div>
                        <div class="field">
                          <apex:outputLabel value="{!$Label.JEOL_QuotEdit_Label_Tel}" for="orgPhone" styleClass="field-label" />
                          <apex:inputField rendered="{!!isReadOnly}" id="orgPhone" styleClass="field-value orgPhone" value="{!qdm.parentRec.Phone__c}" html-data-compare-value="{!qdm.baseParentRec.Phone__c}" onblur="safetyLockCheck(this);" />
                          <apex:outputField rendered="{!isReadOnly}" id="orgPhoneView" styleClass="field-value orgPhone" value="{!qdm.parentRec.Phone__c}" />
                        </div>
                        <div class="field" data-type="dropdown">
                          <apex:outputLabel value="{!$Label.JEOL_QuotEdit_Label_ProductCode}" html-data-type="label" for="series" styleClass="{!IF(isReadOnly,'','requireField ')}field-label" style="float: left;{!IF(language <> 'ja', 'width:120px;', '')}"/>
                          <apex:inputText rendered="{!!isReadOnly}" id="series" html-data-type="input-field" styleClass="field-value series" onchange="this.value=transformInputText(this.value);" value="{!qdm.parentRec.Series__c}" html-data-compare-value="{!qdm.baseParentRec.Series__c}" onblur="safetyLockCheck(this);" />
                          <apex:outputText rendered="{!isReadOnly}" id="seriesView" html-data-type="input-field" styleClass="departmentView" value="{!qdm.parentRec.Series__c}" />
                          <button class="{!IF(isReadOnly,'hidden','')}" type="button" data-type="button" onclick="dorpdownAction(this);">▼</button>
                          <ul class="scroll" data-type="list">
                            <apex:repeat value="{!SeriesOptions}" var="option">
                              <li data-type="item" data-value="{!option.value}" >
                                <a href="javascript: void(0);" onclick="setInputField(this);return false;" ><apex:outputText value="{!option.label}" rendered="{!!ISBLANK(option.label)}"/></a>
                              </li>
                            </apex:repeat>
                          </ul>
                        </div>
                        <div class="field" style="min-width: 400px;">
                          <apex:outputLabel value="{!$Label.JEOL_QuotEdit_Label_SalesPerson}" for="salesPerson" styleClass="field-label" />
                          <apex:inputField rendered="{!!isReadOnly}" id="salesPerson" styleClass="field-value salesPerson" value="{!qdm.parentRec.SalesPerson__c}" html-data-compare-value="{!qdm.baseParentRec.SalesPerson__c}" onclick="makeSafetyCheck=false;" onblur="safetyLockCheck(this);makeSafetyCheck=true;" onmouseout="makeSafetyCheck=true;" />
                          <apex:outputField rendered="{!isReadOnly}" id="salesPersonView" styleClass="field-value salesPerson" value="{!qdm.parentRec.SalesPerson__c}" />
                        </div>
                        <div class="field" style="min-width: 400px;">
                          <apex:outputLabel value="{!$Label.JEOL_QuotEdit_Label_SalesAssistant}" for="salesAssistant" styleClass="field-label" />
                          <apex:inputField rendered="{!!isReadOnly}" id="salesAssistant" styleClass="field-value salesAssistant" value="{!qdm.parentRec.SalesAssistant__c}" html-data-compare-value="{!qdm.baseParentRec.SalesAssistant__c}" onclick="makeSafetyCheck=false;" onblur="safetyLockCheck(this);makeSafetyCheck=true;" onmouseout="makeSafetyCheck=true;" />
                          <apex:outputField rendered="{!isReadOnly}" id="salesAssistantView" styleClass="field-value salesAssistant" value="{!qdm.parentRec.SalesAssistant__c}" />
                        </div>
                        <div class="field ajaxRequestStatus" >
                          <apex:actionStatus layout="block"  id="ajaxSalesAreaAttach" onstop="$j('.salesAreaCode').trigger('focus');">
                            <apex:facet name="start">
                              <div class="ajaxStatusView" >{!$Label.JEOL_QuotEdit_Label_Searching}</div>
                            </apex:facet>
                          </apex:actionStatus>
                        </div>
                        <apex:outputPanel id="SalesAreaCodeField" layout="block" styleClass="field" html-data-type="dropdown">
                          <apex:outputLabel value="{!$Label.JEOL_QuotEdit_Label_AreaCode}" html-data-type="label" for="SalesArea" styleClass="{!IF(isReadOnly,'','requireField ')}field-label" style="float: left;"/>
                          <apex:inputText rendered="{!!isReadOnly}" id="salesAreaCode" html-data-type="input-field"  styleClass="field-value salesAreaCode" value="{!qdm.parentRec.SalesAreaCode__c}" html-data-compare-value="{!qdm.baseParentRec.SalesAreaCode__c}" onchange="this.value=transformInputText(this.value);" onfocus="openSearchToggleButton(this);" onblur="safetyLockCheck(this);" />
                          <apex:outputText rendered="{!isReadOnly}" id="salesAreaCodeView" html-data-type="input-field"  styleClass="departmentView" value="{!qdm.parentRec.SalesAreaCode__c}" />
                          <apex:commandLink action="{!salesAreaAttachment}" title="コード検索" styleClass="productSearchButton" rerender="salesAreaCode,SalesAreaField,apexMessage" status="ajaxSalesAreaAttach" >
                            <span class="refresh-icon"></span>
                          </apex:commandLink>
                          <button class="{!IF(isReadOnly,'hidden','')}" type="button" data-type="button" onclick="dorpdownAction(this);">▼</button>
                          <ul class="scroll" data-type="list">
                            <apex:repeat value="{!SalesAreaOptions}" var="option">
                              <li data-type="item" data-value="{!option.value}" >
                                <apex:commandLink action="{!salesAreaAttachment}" onclick="setInputField(this);" rerender="salesAreaCode,SalesAreaField,apexMessage" status="ajaxSalesAreaAttach" >
                                  <apex:outputText value="{!option.label}" />
                                </apex:commandLink>
                              </li>
                            </apex:repeat>
                          </ul>
                        </apex:outputPanel>
                        <apex:outputPanel id="SalesAreaField" layout="block" styleClass="field" style="margin-left: 8px;">
                          <apex:outputText styleClass="field-value salesArea" value="{!qdm.parentRec.SalesArea__c}" style="min-width: 100px;"/>
                        </apex:outputPanel>
                      </div>
                      </div>
                      <hr/>
                      
                      <!-- 2 checkboxes section -->
                      <div>
                        <div class="field">
                          <label for="groupLeaderApproval" class="field-label " style="{!IF(language <> 'ja', 'width:110px;', '')}">{!$Label.JEOL_QuotEdit_Label_ManagerAuth}</label>
                          <div class="field-value groupLeaderApproval">
                            <apex:inputcheckbox disabled="{!IF(isReadOnly,'true','false')}" id="groupLeaderApproval" value="{!qdm.parentRec.GroupLeaderApproval__c}" tabIndex="-1" html-data-compare-value="{!qdm.baseParentRec.GroupLeaderApproval__c}" onblur="safetyLockCheck(this);" />
                          </div>
                        </div>
                        <div class="field">
                          <label for="branchManagerApproval" class="field-label " style="{!IF(language <> 'ja', 'width:150px;', '')}">{!$Label.JEOL_QuotEdit_Label_DirectorAuth}</label>
                          <div class="field-value branchManagerApproval">
                            <apex:inputcheckbox disabled="{!IF(isReadOnly,'true','false')}" id="branchManagerApproval" value="{!qdm.parentRec.BranchManagerApproval__c}" tabIndex="-1" html-data-compare-value="{!qdm.baseParentRec.BranchManagerApproval__c}" onblur="safetyLockCheck(this);" />
                          </div>
                        </div>
                      </div>
                    </apex:outputPanel>
                    
                    <!-- 契約先 section -->
                    <div class="quotation-item contract-account-area">
                      <div class="quotation-item-header clearfix" style="height: 38px;">
                        <div class="header-title">{!$Label.JEOL_QuotEdit_Label_ContractorBasicInfo}</div>
                      </div>
                      <div class="quotation-item-body clearfix">
                        <div class="field ajaxRequestStatus" >
                          <apex:actionStatus layout="block"  id="ajaxContractAccountAttach">
                            <apex:facet name="start">
                              <div class="ajaxStatusView" >{!$Label.JEOL_QuotEdit_Label_Searching}</div>
                            </apex:facet>
                          </apex:actionStatus>
                        </div>

                        <!-- CONTRACT ACCOUNT -->
                        <div class="field">
                          <apex:outputLabel value="{!$Label.JEOL_QuotEdit_Label_Contractor}" for="contractCode" styleClass="{!IF(isReadOnly,'','requireField ')}field-label" />
                          <apex:inputField rendered="{!!isReadOnly}" id="contractCode" styleClass="field-value contractCode" html-placeholder="{!$Label.JEOL_QuotEdit_Label_ContractorCode}" value="{!qdm.parentRec.ContractCode__c}" html-data-compare-value="{!qdm.baseParentRec.ContractCode__c}" onfocus="openSearchToggleButton(this);" onblur="safetyLockCheck(this);" />
                          <apex:commandLink rendered="{!!isReadOnly}" action="{!ContractAttachmentFromCode}" title="コード検索" rerender="enhanceContractAccount, contractCode, contractName, contractName1, contractName2, contractAddress, contractUndergraduate, contractAccountSignalPanel, shipmentAccountSignalPanel, contractPersonInCharge, contractPhone, contractFax, contractBelong, contractPost" styleClass="productSearchButton" status="ajaxContractAccountAttach" oncomplete="enhanceContractAccountLookup();">
                            <span class="refresh-icon"></span>
                          </apex:commandLink>
                          <apex:outputText rendered="{!isReadOnly}" id="contractCodeView" styleClass="contractCodeView" html-placeholder="{!$Label.JEOL_QuotEdit_Label_ContractorCode}" value="{!qdm.parentRec.ContractCode__c}" />
                          <!--
                          <apex:inputField rendered="{!!isReadOnly}" id="contractName" styleClass="field-value contractName" html-placeholder="{!$Label.JEOL_QuotEdit_Label_ContractorName}" value="{!qdm.parentRec.ContractName__c}" html-data-compare-value="{!qdm.baseParentRec.ContractName__c}" onblur="safetyLockCheck(this);"/>
                          -->
                          <apex:outputText rendered="{!!isReadOnly}" id="contractName" styleClass="contractNameView2" html-placeholder="{!$Label.JEOL_QuotEdit_Label_ContractorName}" value="{!qdm.parentRec.ContractName__c}" />
                          <apex:outputText rendered="{!isReadOnly}" id="contractNameView" styleClass="contractNameView" html-placeholder="{!$Label.JEOL_QuotEdit_Label_ContractorName}" value="{!qdm.parentRec.ContractName__c}" />
                          <apex:inputField rendered="{!!isReadOnly}" id="contractAccountId" styleClass="field-value reference-field-hidden" value="{!qdm.parentRec.ContractAccount_dummyField__c}" onclick="makeSafetyCheck=false;" onblur="makeSafetyCheck=true;" onmouseout="makeSafetyCheck=true;" >
                            <apex:actionSupport focus="contractName" event="onchange" action="{!ContractAttachment}" rerender="enhanceContractAccount, contractCode, contractName, contractName1, contractName2, contractAddress, contractUndergraduate, contractAccountSignalPanel, shipmentAccountSignalPanel, contractPersonInCharge, contractPhone, contractFax, contractBelong, contractPost" status="ajaxContractAccountAttach" oncomplete="enhanceContractAccountLookup();"/> <!-- rerender contractAccountId -->
                         </apex:inputField>
                        </div>

                        <!-- CONTRACT ACCOUNT SIGNAL -->
                        <apex:outputPanel id="contractAccountSignalPanel">
                          <apex:outputPanel rendered="{!(contractAccountSignal != NULL || shipmentAccountSignal != NULL)}">
                            <div class="field">
                              <apex:outputLabel styleClass="field-label" />
                              <apex:outputText style="color: red;" value="{!contractAccountSignal}" />
                            </div>
                          </apex:outputPanel>
                        </apex:outputPanel>

                        <div class="field">
                          <apex:outputLabel value="{!$ObjectType.QuotationInformation__c.fields.ContractName1__c.Label}" for="ContractName1" styleClass="field-label" />
                          <apex:inputText rendered="{!!isReadOnly}" id="contractName1" styleClass="field-value" value="{!qdm.parentRec.ContractName1__c}" style="width: 400px;" maxlength="100"/>
                          <apex:outputText rendered="{!isReadOnly}" id="contractName1View" styleClass="field-value" value="{!qdm.parentRec.ContractName1__c}" style="width: 400px;" />
                        </div>
                        
                        <div class="field">
                          <apex:outputLabel value="{!$ObjectType.QuotationInformation__c.fields.ContractName2__c.Label}" for="ContractName2" styleClass="field-label" />
                          <apex:inputText rendered="{!!isReadOnly}" id="contractName2" styleClass="field-value" value="{!qdm.parentRec.ContractName2__c}" style="width: 400px;" maxlength="50"/>
                          <apex:outputText rendered="{!isReadOnly}" id="contractName2View" styleClass="field-value" value="{!qdm.parentRec.ContractName2__c}" style="width: 400px;" />
                        </div>
                        
                        <div class="field">
                          <apex:outputLabel value="{!$Label.JEOL_QuotEdit_Label_BranchOffice}" for="contractUndergraduate" styleClass="field-label" />
                          <apex:outputText id="contractUndergraduate" styleClass="field-value contractUndergraduate" value="{!qdm.parentRec.ContractUndergraduate__c}" />
                        </div>
                        <div class="field">
                          <apex:outputLabel value="{!$Label.JEOL_QuotEdit_Label_Address}" for="contractAddress" styleClass="field-label" />
<!--                          <apex:inputHidden id="contractAddress_hidden" value="{!qdm.parentRec.ContractAddress__c}" /> --> 
                          <apex:outputText id="contractAddress" styleClass="field-value contractAddress" value="{!qdm.parentRec.ContractAddress__c}" />
                        </div>
                        <div class="field">
                          <apex:outputLabel value="{!$Label.JEOL_QuotEdit_Label_Department}" for="contractBelong" styleClass="field-label" />
                          <apex:inputField rendered="{!!isReadOnly}" id="contractBelong" styleClass="field-value contractBelong" value="{!qdm.parentRec.ContractBelong__c}" html-data-compare-value="{!qdm.baseParentRec.ContractBelong__c}" onblur="safetyLockCheck(this);" />
                          <apex:outputText rendered="{!isReadOnly}" id="contractBelongView" styleClass="contractBelongView" value="{!qdm.parentRec.ContractBelong__c}"  />
                        </div>
                        <div class="field">
                          <apex:outputLabel value="{!$Label.JEOL_QuotEdit_Label_Designation}" for="contactPost" styleClass="field-label" />
                          <apex:inputField rendered="{!!isReadOnly}" id="contractPost" styleClass="field-value contractPost" value="{!qdm.parentRec.ContractPost__c}" html-data-compare-value="{!qdm.baseParentRec.ContractPost__c}" onblur="safetyLockCheck(this);" />
                          <apex:outputText rendered="{!isReadOnly}" id="contractPostView" styleClass="contractBelongView" value="{!qdm.parentRec.ContractPost__c}" />
                        </div>
                        <div class="field">
                          <apex:outputLabel value="{!$Label.JEOL_QuotEdit_Label_PersonInCharge}" for="contractPersonInCharge" styleClass="field-label" />
                          <apex:inputField rendered="{!!isReadOnly}" id="contractPersonInCharge" styleClass="field-value contractPersonInCharge" value="{!qdm.parentRec.ContractPersonInCharge__c}" html-data-compare-value="{!qdm.baseParentRec.ContractPersonInCharge__c}" onblur="safetyLockCheck(this);" />
                          <apex:outputText rendered="{!isReadOnly}" id="contractPersonInChargeView" styleClass="contractBelongView" value="{!qdm.parentRec.ContractPersonInCharge__c}" />
                          <apex:inputField rendered="{!!isReadOnly}" styleClass="field-value reference-field-hidden" value="{!qdm.parentRec.ContractContact_dummyField__c}" onclick="makeSafetyCheck=false;" onblur="makeSafetyCheck=true;" onmouseout="makeSafetyCheck=true;" >
                            <apex:actionSupport focus="contractPersonInCharge" event="onchange" action="{!contractContactAttachment}" rerender="enhanceContractAccount, contractCode, contractName, contractName1, contractName2, contractAddress, contractUndergraduate, contractAccountSignalPanel, shipmentAccountSignalPanel, contractPersonInCharge, contractPhone, contractFax, contractBelong, contractPost" status="ajaxContractAccountAttach" oncomplete="enhanceContractAccountLookup();"/>
                          </apex:inputField>
                        </div>
                        <div class="field" style="height: 32px;">
                          <apex:outputLabel value="{!$Label.JEOL_QuotEdit_Label_Contact}" for="contractPhone" styleClass="field-label" />
                          <apex:inputField rendered="{!!isReadOnly}" id="contractPhone" styleClass="field-value contractPhone" value="{!qdm.parentRec.ContractPhone__c}" html-data-compare-value="{!qdm.baseParentRec.ContractPhone__c}" onblur="safetyLockCheck(this);" />
                          <apex:outputText rendered="{!isReadOnly}" id="contractPhoneView" styleClass="contractBelongView" value="{!qdm.parentRec.ContractPhone__c}" />
                        </div>
                        <div class="field">
                          <apex:outputLabel styleClass="field-label" />
                          <apex:outputText styleClass="contractBelongView" />
                        </div>
                        <div class="field">
                          <apex:outputLabel value="{!$Label.JEOL_QuotEdit_Label_FAX}" for="contractFax" styleClass="field-label" />
                          <apex:inputField rendered="{!!isReadOnly}" id="contractFax" styleClass="field-value contractPhone" value="{!qdm.parentRec.ContractFax__c}" html-data-compare-value="{!qdm.baseParentRec.ContractFax__c}" onblur="safetyLockCheck(this);" />
                          <apex:outputText rendered="{!isReadOnly}" id="contractFaxView" styleClass="contractBelongView" value="{!qdm.parentRec.ContractFax__c}" />
                        </div>
                        <div class="field" style="min-width: 400px;">
                          <apex:outputLabel for="salesPipeLine" styleClass="field-label" >
                            <span>{!$Label.JEOL_QuotEdit_Label_Sales}</span><br />
                            <span>{!$Label.JEOL_QuotEdit_Label_Pipeline}</span>
                          </apex:outputLabel>
                          <apex:inputField rendered="{!!isReadOnly}" id="salesPipeLine" styleClass="field-value salesPipeLine" value="{!qdm.parentRec.SalesPipelineLkup__c}" html-data-compare-value="{!qdm.baseParentRec.SalesPipelineLkup__c}" onclick="makeSafetyCheck=false;" onblur="safetyLockCheck(this);makeSafetyCheck=true;" onmouseout="makeSafetyCheck=true;" />
                          <apex:outputField rendered="{!isReadOnly}" id="salesPipeLineView" styleClass="field-value salesPipeLine" value="{!qdm.parentRec.SalesPipelineLkup__c}" />
                        </div>
                      </div>
                    </div>
                    
                    <!-- 納入先 section -->
                    <div class="quotation-item shipment-account-area">
                      <div class="quotation-item-header clearfix" style="height: 38px;">
                        <div class="header-title">{!$Label.JEOL_QuotEdit_Label_EndUserBasicInfo}</div>
                        <apex:commandLink rendered="{!!isReadOnly}" value="{!$Label.JEOL_QuotEdit_Label_CopyCustomer}" styleClass="customButton" oncomplete="enhanceShipmentAccountLookup();lockSafety();" action="{!contractAccountInputCopy}" status="ajaxShipmentAttach" rerender="enhanceShipmentAccount, shipmentCode, shipmentName, shipmentName1, shipmentName2, shipmentAddress, shipmentUndergraduate, contractAccountSignalPanel, shipmentAccountSignalPanel, shipmentBelong, shipmentPost, shipmentPersonInCharge, shipmentPhone, shipmentFax,  unitBodyField, durationYear, acceptanceDate, kikaku, shipmentDistanceZone, shipmentDistanceSection" />
                      </div >
                      <div class="quotation-item-body clearfix">
                        <div class="field ajaxRequestStatus">
                          <apex:actionStatus layout="block"  id="ajaxShipmentAttach">
                            <apex:facet name="start">
                              <div class="ajaxStatusView" >{!$Label.JEOL_QuotEdit_Label_Searching}</div>
                            </apex:facet>
                          </apex:actionStatus>
                        </div>
                        
                        <!-- SHIPMENT ACCOUNT -->
                        <div class="field">
                          <apex:outputLabel value="{!$Label.JEOL_QuotEdit_Label_Contractor}" for="shipmentCode" styleClass="{!IF(isReadOnly,'','requireField ')}field-label" />
                          <apex:inputField rendered="{!!isReadOnly}" id="shipmentCode" styleClass="field-value shipmentCode" html-placeholder="{!$Label.JEOL_QuotEdit_Label_ContractorCode}" value="{!qdm.parentRec.ShipmentCode__c}"  html-data-compare-value="{!qdm.baseParentRec.ShipmentCode__c}" onfocus="openSearchToggleButton(this);" onblur="safetyLockCheck(this);"/>
                          <apex:commandLink rendered="{!!isReadOnly}" action="{!ShipmentAttachmentFromCode}" title="コード検索" rerender="enhanceShipmentAccount, shipmentCode, shipmentName, shipmentName1, shipmentName2, shipmentAddress, shipmentUndergraduate, contractAccountSignalPanel, shipmentAccountSignalPanel, shipmentPersonInCharge, shipmentPhone, shipmentFax, shipmentBelong, shipmentPost, unitBodyField, durationYear, acceptanceDate, kikaku, shipmentDistanceZone, shipmentDistanceSection" styleClass="productSearchButton" status="ajaxShipmentAttach" oncomplete="enhanceShipmentAccountLookup();">
                            <span class="refresh-icon"></span>
                          </apex:commandLink>
                          <apex:outputText rendered="{!isReadOnly}" id="shipmentCodeView" styleClass="contractCodeView" html-placeholder="{!$Label.JEOL_QuotEdit_Label_ContractorCode}" value="{!qdm.parentRec.ShipmentCode__c}" />
                          <!--
                          <apex:inputField rendered="{!!isReadOnly}" id="shipmentName" styleClass="field-value shipmentName" html-placeholder="{!$Label.JEOL_QuotEdit_Label_ContractorName}" value="{!qdm.parentRec.ShipmentName__c}" html-data-compare-value="{!qdm.baseParentRec.ShipmentName__c}" onblur="safetyLockCheck(this);" />
                          -->
                          <apex:outputText rendered="{!!isReadOnly}" id="shipmentName" styleClass="contractNameView2" html-placeholder="{!$Label.JEOL_QuotEdit_Label_ContractorName}" value="{!qdm.parentRec.ShipmentName__c}" />
                          <apex:outputText rendered="{!isReadOnly}" id="shipmentNameView" styleClass="contractNameView" html-placeholder="{!$Label.JEOL_QuotEdit_Label_ContractorName}" value="{!qdm.parentRec.ShipmentName__c}" />
                          <apex:inputField rendered="{!!isReadOnly}" id="shipmentAccountId" styleClass="field-value reference-field-hidden" value="{!qdm.parentRec.ShipmentAccount_dummyField__c}" onclick="makeSafetyCheck=false;" onblur="makeSafetyCheck=true;" onmouseout="makeSafetyCheck=true;" >
                            <apex:actionSupport focus="shipmentName" event="onchange" action="{!ShipmentAttachment}" rerender="enhanceShipmentAccount, shipmentCode, shipmentName, shipmentName1, shipmentName2, shipmentAddress, shipmentUndergraduate, contractAccountSignalPanel, shipmentAccountSignalPanel, unitBodyField, durationYear, acceptanceDate, kikaku, shipmentDistanceZone, shipmentDistanceSection, shipmentPersonInCharge, shipmentPhone, shipmentFax,  shipmentBelong, shipmentPost" status="ajaxShipmentAttach" oncomplete="enhanceShipmentAccountLookup();" /> <!-- rerender="shipmentAccountId"  -->
                          </apex:inputField>
                        </div>

                        <!-- SHIPMENT ACCOUNT SIGNAL -->
                        <apex:outputPanel id="shipmentAccountSignalPanel">
                          <apex:outputPanel rendered="{!(contractAccountSignal != NULL || shipmentAccountSignal != NULL)}">
                            <div class="field">
                              <apex:outputLabel styleClass="field-label" />
                              <apex:outputText style="color: red;" value="{!shipmentAccountSignal}" />
                            </div>
                          </apex:outputPanel>
                        </apex:outputPanel>
                                                
                        <div class="field">
                          <apex:outputLabel value="{!$ObjectType.QuotationInformation__c.fields.ShipmentName1__c.Label}" for="ShipmentName1" styleClass="field-label" />
                          <apex:inputText rendered="{!!isReadOnly}" id="shipmentName1" styleClass="field-value" value="{!qdm.parentRec.ShipmentName1__c}" style="width: 400px;" maxlength="100"/>
                          <apex:outputText rendered="{!isReadOnly}" id="shipmentName1View" styleClass="field-value" value="{!qdm.parentRec.ShipmentName1__c}" style="width: 400px;" />
                        </div>
                        
                        <div class="field">
                          <apex:outputLabel value="{!$ObjectType.QuotationInformation__c.fields.ShipmentName2__c.Label}" for="ShipmentName2" styleClass="field-label" />
                          <apex:inputText rendered="{!!isReadOnly}" id="shipmentName2" styleClass="field-value" value="{!qdm.parentRec.ShipmentName2__c}" style="width: 400px;" maxlength="50"/>
                          <apex:outputText rendered="{!isReadOnly}" id="shipmentName2View" styleClass="field-value" value="{!qdm.parentRec.ShipmentName2__c}" style="width: 400px;" />
                        </div>
                        
                        <div class="field">
                          <apex:outputLabel value="{!$Label.JEOL_QuotEdit_Label_BranchOffice}" for="shipmentUndergraduate" styleClass="field-label" />
                          <apex:outputText id="shipmentUndergraduate" styleClass="field-value shipmentUndergraduate" value="{!qdm.parentRec.ShipmentUndergraduate__c}" />
                        </div>
                        <div class="field">
                          <apex:outputLabel value="{!$Label.JEOL_QuotEdit_Label_Address}" for="shipmentAddress" styleClass="field-label" />
<!--                          <apex:inputHidden id="shipmentAddress_hidden" value="{!qdm.parentRec.ShipmentAddress__c}" /> -->
                          <apex:outputText id="shipmentAddress" styleClass="field-value shipmentAddress" value="{!qdm.parentRec.ShipmentAddress__c}" />
                        </div>
                        <div class="field">
                          <apex:outputLabel value="{!$Label.JEOL_QuotEdit_Label_Department}" for="shipmentBelong" styleClass="field-label" />
                          <apex:inputField rendered="{!!isReadOnly}" id="shipmentBelong" styleClass="field-value shipmentBelong" value="{!qdm.parentRec.ShipmentBelong__c}" html-data-compare-value="{!qdm.baseParentRec.ShipmentBelong__c}" onblur="safetyLockCheck(this);" />
                          <apex:outputText rendered="{!isReadOnly}" id="shipmentBelongView" styleClass="contractBelongView" value="{!qdm.parentRec.ShipmentBelong__c}" />
                        </div>
                        <div class="field">
                          <apex:outputLabel value="{!$Label.JEOL_QuotEdit_Label_Designation}" for="shipmentPost" styleClass="field-label" />
                          <apex:inputField rendered="{!!isReadOnly}" id="shipmentPost" styleClass="field-value shipmentPost" value="{!qdm.parentRec.ShipmentPost__c}" html-data-compare-value="{!qdm.baseParentRec.ShipmentPost__c}" onblur="safetyLockCheck(this);" />
                          <apex:outputText rendered="{!isReadOnly}" id="shipmentPostView" styleClass="contractBelongView" value="{!qdm.parentRec.ShipmentPost__c}" />
                        </div>
                        <div class="field">
                          <apex:outputLabel value="{!$Label.JEOL_QuotEdit_Label_PersonInCharge}" for="shipmentPersonInCharge" styleClass="field-label" />
                          <apex:inputField rendered="{!!isReadOnly}" id="shipmentPersonInCharge" styleClass="field-value shipmentPersonInCharge" value="{!qdm.parentRec.ShipmentPersonInCharge__c}" html-data-compare-value="{!qdm.baseParentRec.ShipmentPersonInCharge__c}" onblur="safetyLockCheck(this);" />
                          <apex:outputText rendered="{!isReadOnly}" id="shipmentPersonInChargeView" styleClass="contractBelongView" value="{!qdm.parentRec.ShipmentPersonInCharge__c}" />
                          <apex:inputField rendered="{!!isReadOnly}" styleClass="field-value reference-field-hidden" value="{!qdm.parentRec.ShipmentContact_dummyField__c}" onclick="makeSafetyCheck=false;" onblur="makeSafetyCheck=true;" onmouseout="makeSafetyCheck=true;" >
                            <apex:actionSupport focus="shipmentPersonInCharge" event="onchange" action="{!shipmentContactAttachment}" rerender="enhanceShipmentAccount, shipmentCode, shipmentName, shipmentName1, shipmentName2, shipmentAddress, shipmentUndergraduate, contractAccountSignalPanel, shipmentAccountSignalPanel, shipmentPersonInCharge, shipmentPhone, shipmentFax,  shipmentBelong, shipmentPost, unitBodyField, durationYear, acceptanceDate, kikaku, shipmentDistanceZone, shipmentDistanceSection" status="ajaxShipmentAttach" oncomplete="enhanceShipmentAccountLookup();"/>
                          </apex:inputField>
                       </div>
                        <div class="field" style="height:32px">
                          <apex:outputLabel value="{!$Label.JEOL_QuotEdit_Label_Contact}" for="shipmentPhone" styleClass="field-label" />
                          <apex:inputField rendered="{!!isReadOnly}" id="shipmentPhone" styleClass="field-value shipmentPhone" value="{!qdm.parentRec.ShipmentPhone__c}" html-data-compare-value="{!qdm.baseParentRec.ShipmentPhone__c}" onblur="safetyLockCheck(this);" />
                          <apex:outputText rendered="{!isReadOnly}" id="shipmentPhoneView" styleClass="contractBelongView" value="{!qdm.parentRec.ShipmentPhone__c}" />
                        </div>
                        <div class="field">
                          <apex:outputLabel styleClass="field-label" />
                          <apex:outputText styleClass="contractBelongView" />
                        </div>
                        <div class="field">
                          <apex:outputLabel value="{!$Label.JEOL_QuotEdit_Label_FAX}" for="shipmentFax" styleClass="field-label" />
                          <apex:inputField rendered="{!!isReadOnly}" id="shipmentFax" styleClass="field-value shipmentPhone" value="{!qdm.parentRec.ShipmentFax__c}" html-data-compare-value="{!qdm.baseParentRec.ShipmentFax__c}" onblur="safetyLockCheck(this);" />
                          <apex:outputText rendered="{!isReadOnly}" id="shipmentFaxView" styleClass="contractBelongView" value="{!qdm.parentRec.ShipmentFax__c}" />
                        </div>
                        <div class="field">
                          <apex:outputLabel value="{!$Label.JEOL_QuotEdit_Label_DistanceCode}" styleClass="field-label" />
                          <apex:outputText id="shipmentDistanceZone" styleClass="field-value shipmentDistanceZone" value="{!qdm.parentRec.ShipmentDistanceZone__c}" />
                        </div>
                        <div class="field">
                          <apex:outputLabel value="{!$Label.JEOL_QuotEdit_Label_DistanceDefinition}" styleClass="field-label" />
                          <apex:outputText id="shipmentDistanceSection" styleClass="field-value shipmentDistanceSection" value="{!qdm.parentRec.ShipmentDistanceSection__c}" />
                        </div>
                      </div>
                    </div>
                    
                    <!-- Section under 契約先 -->
                    <div class="quotation-item option-field-area">
                      <div class="quotation-item-body clearfix">
                        <hr />
                        <div class="field">
                          <apex:outputLabel value="{!$Label.JEOL_QuotEdit_Label_ModeDelivery}" for="deliveryLocationSection" styleClass="field-label" />
                          <apex:inputField rendered="{!!isReadOnly}" id="deliveryLocationSection" styleClass="field-value deliveryLocationSection" value="{!qdm.parentRec.DeliveryLocationSection__c}" required="true" html-data-compare-value="{!qdm.baseParentRec.DeliveryLocationSection__c}" onblur="safetyLockCheck(this);" />
                          <apex:outputText rendered="{!isReadOnly}" id="deliveryLocationSectionView" styleClass="deliveryLocationSectionView" value="{!qdm.parentRec.DeliveryLocationSection__c}" />
                          <apex:inputField rendered="{!!isReadOnly}" id="deliveryLocationText" styleClass="field-value deliveryLocationText" value="{!qdm.parentRec.DeliveryLocationText__c}" html-data-compare-value="{!qdm.baseParentRec.DeliveryLocationText__c}" onblur="safetyLockCheck(this);" />
                          <apex:outputText rendered="{!isReadOnly}" id="deliveryLocationTextView" styleClass="deliveryLocationTextView" value="{!qdm.parentRec.DeliveryLocationText__c}" />
                        </div>
                        <div class="field ajaxRequestStatus">
                          <apex:actionStatus layout="block"  id="ajaxDelivConditionAttach" onstop="$j('.deliveryCondition1').trigger('focus');">
                            <apex:facet name="start">
                              <div class="ajaxStatusView" >{!$Label.JEOL_QuotEdit_Label_Searching}</div>
                            </apex:facet>
                          </apex:actionStatus>
                        </div>
                        <div class="field">
                          <apex:outputLabel value="{!$Label.JEOL_QuotEdit_Label_DeliveryTerm}" for="deliveryCondition1" styleClass="field-label" />
                        </div>
                        <div class="field" data-type="dropdown">
                          <apex:inputText rendered="{!!isReadOnly}" html-data-type="input-field" id="deliveryCondition1" styleClass="field-value deliveryCondition1" value="{!qdm.parentRec.DeliveryCondition1__c}" html-data-compare-value="{!qdm.baseParentRec.DeliveryCondition1__c}" onchange="this.value=transformInputText(this.value);" onfocus="openSearchToggleButton(this);" onblur="safetyLockCheck(this);" />
                          <apex:commandLink rendered="{!!isReadOnly}" action="{!delivConditionAttachment}" title="コード検索" rerender="deliveryCondition1, deliveryCondition2" styleClass="productSearchButton" status="ajaxDelivConditionAttach">
                            <span class="refresh-icon"></span>
                          </apex:commandLink>
                          <button class="{!IF(isReadOnly,'hidden','')}" type="button" data-type="button" onclick="dorpdownAction(this);">▼</button>
                          <ul class="scroll" data-type="list">
                            <apex:repeat value="{!DelivConditionOptions}" var="option">
                              <li data-type="item" data-value="{!option.value}" >
                                <apex:commandLink action="{!delivConditionAttachment}" onclick="setInputField(this);" rerender="deliveryCondition1,deliveryCondition2,apexMessage" status="ajaxDelivConditionAttach" >
                                  <apex:outputText value="{!option.label}" />
                                </apex:commandLink>
                              </li>
                            </apex:repeat>
                          </ul>
                          <apex:outputText rendered="{!isReadOnly}" html-data-type="input-field" id="deliveryCondition1View" styleClass="deliveryLocationSectionView" value="{!qdm.parentRec.DeliveryCondition1__c}" />
                        </div>
                        <div class="field">
                          <apex:inputField rendered="{!!isReadOnly}" id="deliveryCondition2" styleClass="field-value deliveryCondition2" value="{!qdm.parentRec.DeliveryCondition2__c}" html-data-compare-value="{!qdm.baseParentRec.DeliveryCondition2__c}" onblur="safetyLockCheck(this);" />
                          <apex:outputText rendered="{!isReadOnly}" id="deliveryCondition2View" styleClass="deliveryLocationTextView" value="{!qdm.parentRec.DeliveryCondition2__c}" />
                        </div>
                        <hr />
                        <div class="field">
                          <apex:outputLabel value="{!$Label.JEOL_QuotEdit_Label_PaymentTermsDef}" for="paymentConditionSection" styleClass="field-label" />
                          <apex:inputField rendered="{!!isReadOnly}" id="paymentConditionSection" styleClass="field-value paymentConditionSection" value="{!qdm.parentRec.PaymentConditionSection__c}" required="true" html-data-compare-value="{!qdm.baseParentRec.PaymentConditionSection__c}" onblur="safetyLockCheck(this);"/>
                          <apex:outputText rendered="{!isReadOnly}" id="paymentConditionSectionView" styleClass="deliveryLocationSectionView" value="{!qdm.parentRec.PaymentConditionSection__c}" />
                          <apex:inputField rendered="{!!isReadOnly}" id="paymentConditionText" styleClass="field-value paymentConditionText" value="{!qdm.parentRec.PaymentConditionText__c}" html-data-compare-value="{!qdm.baseParentRec.PaymentConditionText__c}" onblur="safetyLockCheck(this);" />
                          <apex:outputText rendered="{!isReadOnly}" id="paymentConditionTextView" styleClass="deliveryLocationTextView" value="{!qdm.parentRec.PaymentConditionText__c}"  />
                        </div>
                      </div>
                    </div>
                    
                    
                    <div class="quotation-item option-field-area">
                      <div class="quotation-item-body clearfix">
                        <hr />
                        <div class="field ajaxRequestStatus" >
                          <apex:actionStatus layout="block"  id="ajaxAcceptanceDateCalc" onstop="showResult('{!$Label.JEOL_QuotEdit_Message_ProcessCompleted}');$j('.unitBody').trigger('focus');" >
                            <apex:facet name="start">
                              <div class="ajaxStatusView" >{!$Label.JEOL_QuotEdit_Label_Searching}</div>
                            </apex:facet>
                          </apex:actionStatus>
                        </div>
                        <apex:outputPanel layout="block" id="unitBodyField" styleClass="field" html-data-type="dropdown" style="width: 267px;">
                          <apex:outputLabel value="{!$Label.JEOL_QuotEdit_Label_UnitBody}" html-data-type="label" for="unitBody" styleClass="field-label" />
                          <apex:inputText rendered="{!!isReadOnly}" id="unitBody" html-data-type="input-field" styleClass="field-value unitBody" value="{!qdm.parentRec.UnitBody__c}"  html-data-compare-value="{!qdm.baseParentRec.UnitBody__c}" onchange="this.value=transformInputText(this.value);" onfocus="openSearchToggleButton(this);" onblur="safetyLockCheck(this);" />
                          <apex:outputText rendered="{!isReadOnly}" id="unitBodyView" html-data-type="input-field" styleClass="unitBodyView" value="{!qdm.parentRec.UnitBody__c}" />
                          <apex:commandLink action="{!acceptanceDateCalc}" title="コード検索" rerender="unitBody,durationYear,acceptanceDate, kikaku,apexMessage" styleClass="productSearchButton" status="ajaxAcceptanceDateCalc">
                            <span class="refresh-icon"></span>
                          </apex:commandLink>
                          <button style="margin-right: 0px;" class="{!IF(isReadOnly,'hidden','')}" type="button" data-type="button" onclick="dorpdownAction(this);">▼</button>
                          <ul class="scroll" data-type="list" style="margin-right: 0px;">
                            <apex:repeat value="{!CandidateUnitBody}" var="option" >
                              <li data-type="item" data-value="{!option.value}" >
                                <apex:commandLink action="{!acceptanceDateCalc}" onclick="setInputField(this);" rerender="unitBody,durationYear,acceptanceDate, kikaku,apexMessage" status="ajaxAcceptanceDateCalc" >
                                  <apex:outputText value="{!option.label}" rendered="{!!ISBLANK(option.value)}"/>
                                </apex:commandLink>
                              </li>
                            </apex:repeat>
                          </ul>
                        </apex:outputPanel>
                        <div class="field" style="margin-left: 29px;{!IF(isReadOnly,'','height: 30px;')}">
                          <apex:outputLabel style="width: 50px;" value="{!$Label.JEOL_QuotEdit_Label_Standard}" styleClass="field-label" />
                          <apex:outputText id="kikaku" styleClass="field-value acceptanceDate" value="{!qdm.parentRec.UnitBodyKikaku__c}" />
                        </div>
                        
                        <div class="field">
                          <apex:outputLabel value="{!$Label.JEOL_QuotEdit_Label_DurationAfterAccept}" styleClass="field-label" />
                          <apex:outputText id="durationYear" styleClass="field-value durationYear" style="text-align: right;" value="{!qdm.parentRec.KeikaNensu__c}" />
                          <apex:outputText value="{!$Label.JEOL_QuotEdit_Label_Years}" style="padding-left: 8px"/>
                        </div>
                        <div class="field" style="height: 30px;" >
                          <apex:outputLabel value="{!$Label.JEOL_QuotEdit_Label_DateAcceptance}" styleClass="field-label" />
                          <apex:outputField id="acceptanceDate" styleClass="field-value acceptanceDate" value="{!qdm.parentRec.AcceptanceDate__c}" />
                        </div>

                        <div id="divHideQuotType1" class="{!IF(isReadOnly,'hidden','field')}" style="min-width: 400px;">
                          <apex:outputLabel value="{!$ObjectType.QuotationInformation__c.fields.KeiyakuStartDate__c.label}" for="KeiyakuStartDate" styleClass="field-label" />
                          <apex:inputField style="min-width: 100px;" id="KeiyakuStartDate" styleClass="field-value shipmentPhone" value="{!qdm.parentRec.KeiyakuStartDate__c}" html-data-compare-value="{!qdm.baseParentRec.KeiyakuStartDate__c}" onblur="safetyLockCheck(this);" />
                        </div>
                        <div id="divHideQuotType2" class="{!IF(isReadOnly,'hidden','field')}" style="min-width: 400px;">
                          <apex:outputLabel value="{!$ObjectType.QuotationInformation__c.fields.KeiyakuEndDate__c.label}" for="KeiyakuEndDate" styleClass="field-label" />
                          <apex:inputField style="min-width: 100px;" id="KeiyakuEndDate" styleClass="field-value shipmentPhone" value="{!qdm.parentRec.KeiyakuEndDate__c}" html-data-compare-value="{!qdm.baseParentRec.KeiyakuEndDate__c}" onblur="safetyLockCheck(this);" />
                        </div>
                        <div id="divHideQuotType3" class="{!IF(isReadOnly,'hidden','field')}" style="min-width: 400px;">
                          <apex:outputLabel value="{!$ObjectType.QuotationInformation__c.fields.HoshuShurui__c.label}" for="HoshuShurui" styleClass="field-label" />
                          <apex:inputField id="HoshuShurui" styleClass="field-value shipmentPhone" value="{!qdm.parentRec.HoshuShurui__c}" html-data-compare-value="{!qdm.baseParentRec.HoshuShurui__c}" onblur="safetyLockCheck(this);" />
                        </div>
                        <div class="{!IF(isReadOnly,'field','hidden')}" style="min-width: 400px;">
                          <apex:outputLabel value="{!$ObjectType.QuotationInformation__c.fields.KeiyakuStartDate__c.label}" for="KeiyakuStartDate" styleClass="field-label" />
                          <apex:outputField id="KeiyakuStartDateView" styleClass="contractBelongView" value="{!qdm.parentRec.KeiyakuStartDate__c}" />
                        </div>
                        <div class="{!IF(isReadOnly,'field','hidden')}" style="min-width: 400px;">
                          <apex:outputLabel value="{!$ObjectType.QuotationInformation__c.fields.KeiyakuEndDate__c.label}" for="KeiyakuEndDate" styleClass="field-label" />
                          <apex:outputField id="KeiyakuEndDateView" styleClass="contractBelongView" value="{!qdm.parentRec.KeiyakuEndDate__c}" />
                        </div>
                        <div class="{!IF(isReadOnly,'field','hidden')}" style="min-width: 400px;">
                          <apex:outputLabel value="{!$ObjectType.QuotationInformation__c.fields.HoshuShurui__c.label}" for="HoshuShurui" styleClass="field-label" />
                          <apex:outputField id="HoshuShuruiView" styleClass="contractBelongView" value="{!qdm.parentRec.HoshuShurui__c}" />
                        </div>

                      </div>
                    </div>
                    
                    <!-- SECTION Other / Title -->
                    <div class="quotation-item main-information-area add-space">
                      <div class="quotation-item-body clearfix">
                        <div class="field">
                          <apex:outputLabel value="{!$Label.JEOL_QuotEdit_Label_Others}" for="otherText" styleClass="field-label" />
                          <apex:inputField rendered="{!!isReadOnly}" id="otherText" styleClass="field-value otherText" value="{!qdm.parentRec.OtherText__c}" html-data-compare-value="{!qdm.baseParentRec.OtherText__c}" onblur="safetyLockCheck(this);" />
                          <apex:outputText rendered="{!isReadOnly}" id="otherTextView" styleClass="otherTextView" value="{!qdm.parentRec.OtherText__c}" />
                        </div>
                        <div class="field" >
                          <button type="button" class="{!IF(isReadOnly,'hidden','productSelectButton')}" data-toggle="modal" data-target="#mainProductItemView" style="left: 102px;z-index: 1;" ></button>
                          <apex:outputLabel value="{!$Label.JEOL_QuotEdit_Label_QuotationTitle}" for="name" styleClass="field-label" />
                          <apex:inputText maxlength="50" rendered="{!!isReadOnly}" id="name" style="padding-left: 30px;" styleClass="field-value name" value="{!qdm.parentRec.name}" html-data-compare-value="{!qdm.baseParentRec.name}" onfocus="openSearchToggleButton(this);" onblur="safetyLockCheck(this);" />
                          <a href="javascript: void(0);" title="コード検索" class="productSearchButton" onclick="searchRepresentativeProductItem(this);return false;">
                            <span class="refresh-icon"></span>
                          </a>
                          <apex:outputText rendered="{!isReadOnly}" id="nameView" styleClass="otherTextView" value="{!qdm.parentRec.name}" />
                        </div>
                      </div>
                    </div>
                    <apex:outputPanel layout="block" id="detailArea"  styleClass="quotation-item quotation-detail-informations" >
                      <apex:variable value="{!qdm.currentSize > 0}" var="hasDetails" />
                      <hr style="margin: 20px 0px 4px 0px; float: none;"/>
                      <div style="overflow: hidden;width: 100%;">
                        <div class="optionArea clearfix" style="float: right;">
                          <div class="field" style="{!IF(isReadOnly,'','margin-right: 8px;')}">
                            <apex:outputLabel value="{!$Label.JEOL_QuotEdit_Label_Currency}" for="currencyIsoCode" styleClass="field-label" />
                            <apex:inputField rendered="{!!isReadOnly}" id="currencyIsoCode" styleClass="field-value currencyIsoCode" value="{!qdm.parentRec.CurrencyIsoCode}" html-data-compare-value="{!qdm.baseParentRec.CurrencyIsoCode}" onblur="safetyLockCheck(this);" />

                            <apex:selectList rendered="{!isReadOnly}" value="{!DetailType}" multiselect="false" size="1" disabled="true" styleClass="field-value currencyIsoCode">
                                <apex:selectOption itemLabel="{!DetailType}" itemValue="Option 1"/>
                            </apex:selectList>                            
                          </div>
                          <apex:outputPanel layout="block" styleClass="field" style="margin-right: 8px;" rendered="{!(hasDetails && !isReadOnly)}">
                            <apex:commandLink action="{!qdm.refreshDetailProductItem}" oncomplete="showAlertRefreshAll('{!$Label.JEOL_QuotEdit_Message_ContentRefreshed}');lockSafety();" rerender="existProblemRefreshAll, detailArea, modalListView, modalListViewDel, apexMessage" status="ajaxStatus" title="{!$Label.JEOL_QuotEdit_Message_ContentRefreshing}" styleClass="refreshButton customButton">
                              <span class="refresh-icon" style="vertical-align: middle;"></span>
                              <span style="vertical-align: middle;">{!$Label.JEOL_QuotEdit_Label_ContentsRefresh}</span>
                            </apex:commandLink>
                          </apex:outputPanel>
                          <div class="{!IF(isReadOnly,'hidden','field')}" >
                            <button type="button" class="customButton" data-toggle="modal" data-target="#detailImportView" style="margin-right: 8px;">{!$Label.JEOL_QuotEdit_Label_ImportDetails}</button>
                          </div>
                          <div class="{!IF(isReadOnly,'hidden','field')}" >
                            <button type="button" class="customButton" data-toggle="modal" data-target="#multiDeleteView">{!$Label.JEOL_QuotEdit_Label_DeleteMultiLines}</button>
                          </div>
                        </div>
                      </div>
                      
                      <!-- Grip of items -->
                      <div class="quotation-item-header quotation-detail-header clearfix">
                        <div class="quotation-detail-header-item quotation-detail-productName" style="margin-left: 94px;">{!$Label.JEOL_QuotEdit_Label_ProductName}</div>
                        <div class="quotation-detail-header-item quotation-detail-ProductCode">{!$Label.JEOL_QuotEdit_Label_ItemNo}</div>
                        <div class="quotation-detail-header-item quotation-detail-quantity">{!$Label.JEOL_QuotEdit_Label_Qty}</div>
                        <div class="quotation-detail-header-item quotation-detail-quantityUnit" style="width: 80px;">{!$Label.JEOL_QuotEdit_Label_Unit}</div>
                        <div class="quotation-detail-header-item quotation-detail-UnitPrice">{!$Label.JEOL_QuotEdit_Label_UnitPrice}</div>
                        <div class="quotation-detail-header-item quotation-detail-Amount">{!$Label.JEOL_QuotEdit_Label_Amount}</div>

                        <div class="{!IF(isReadOnly,'hidden','panel-area clearfix')}" >
                          <div class="option-view-panel commissionTargetMulti commissionTargetMultiNotActive" onclick="{!IF(isReadOnly,'','execComissionTargetMulti(this);lockSafety();')}">{!$Label.JEOL_QuotEdit_Label_CommissionRelatedShort}</div>
                        </div>
                      </div>
                      <apex:outputPanel layout="block" styleClass="quotation-item-body clearfix quotation-detail-list">
                        <apex:outputPanel layout="none" rendered="{!hasDetails}">
                          <apex:repeat value="{!qdm.items}" var="item" >
                          
                            <!-- NORMAL ROW -->
                            <apex:outputPanel id="detail_product"
                                              layout="block"
                                              html-data-depth="{!item.rec.Depth__c}"
                                              html-data-sortNo="{!item.rec.SortNo__c}"
                                              html-data-type="{!item.rec.Type__c}"
                                              html-data-tax-target="{!item.rec.IsTaxationTarget__c}"
                                              html-data-overhead-target="{!item.rec.IsOverheadTarget__c}"
                                              html-data-discount-target="{!item.rec.IsDiscountTarget__c}"
                                              html-data-show-target="{!item.rec.IsShowDetailAmount__c}"
                                              html-data-accompanying-paper-output="{!item.rec.AccompanyingPaperOutput__c}"
                                              html-data-commission-target="{!item.rec.CommissionTarget__c}"
                                              html-data-pagebreak-target="{!item.rec.PagebreakTarget__c}"
                                              styleClass="quotation-detail-item clearfix"
                                              rendered="{!item.rec.Type__c = '1'}">
                              <div class="{!IF(isReadOnly,'hidden','field')}">
                                <div class="quotation-detail-action sortableAction" onmousedown="dragAction(this);" >
                                  <div class="sortable-pointer"></div>
                                </div>
                              </div>
                              <div class="{!IF(isReadOnly,'hidden','field')}">
                                <div class="quotation-detail-action configAction clearfix">
                                  <apex:outputLink value="javascript: void(0);" onclick="removeDepth(this);lockSafety();return false;" styleClass="paragraph-option paragraph-up">&lsaquo;</apex:outputLink>
                                  <apex:outputLink value="javascript: void(0);" onclick="addDepth(this);lockSafety();return false;" styleClass="paragraph-option paragraph-down">&rsaquo;</apex:outputLink>
                                </div>
                              </div>
                              <div class="hidden">
                                <apex:inputHidden html-class="quotation-detail-Amount-input" value="{!item.rec.Amount__c}" />
                                <apex:inputHidden html-class="quotation-detail-sortNo" value="{!item.rec.SortNo__c}" />
                                <apex:inputHidden html-class="quotation-detail-depth" value="{!item.rec.Depth__c}" />
                                <apex:inputHidden html-class="quotation-detail-totalDiscountAmount-input" value="{!item.rec.TotalDiscountAmount__c}" />
                              </div>
                              <div class="field" style="overflow-x: hidden;{!IF(isReadOnly,'margin-left: 63px;width: 320px;','')}" >
                                <div class="indent-wrap" >
                                  <button class="{!IF(isReadOnly,'hidden','productSelectButton')}" type="button" data-toggle="modal" onclick="initDetailProductItemManage($j(this).closest('.quotation-detail-item'));setOpenModalDetailId(this);" data-target="#detailProductItemView"></button>
                                  <apex:inputField rendered="{!!isReadOnly}" id="quotation-detail-productName" styleClass="field-value quotation-detail-productName" value="{!item.rec.Body__c}" html-data-compare-value="{!item.rec.Body__c}" onfocus="detailBodyFocus(this);" onblur="detailBodyBlur(this);safetyLockCheck(this);" html-placeholder="{!$Label.JEOL_QuotEdit_Label_ProductName}" ></apex:inputField>
                                  <apex:outputText rendered="{!isReadOnly}" id="quotation-detail-productNameView" styleClass="field-value quotation-detail-productName" value="{!item.rec.Body__c}" />
                                </div>
                              </div>
                              <div class="field clearfix" style="{!IF(isReadOnly,'width: 110px;','')}">
                                <apex:inputField rendered="{!!isReadOnly}" value="{!item.rec.ProductCode__c}" styleClass="field-value quotation-detail-ProductCode" html-placeholder="{!$Label.JEOL_QuotEdit_Label_ItemNo}" html-data-compare-value="{!item.rec.ProductCode__c}" onfocus="openSearchToggleButton(this);makeSuggestions(this);" onblur="safetyLockCheck(this);" onkeyup="makeSuggestions(this);" />
                                <a class="{!IF(isReadOnly,'hidden','productSearchButton')}" href="javascript: void(0);"  title="コード検索" onclick="searchProductItem(this);lockSafety();return false;">
                                  <span class="refresh-icon"></span>
                                </a>
                                <apex:outputText rendered="{!isReadOnly}" value="{!item.rec.ProductCode__c}" styleClass="field-value quotation-detail-ProductCode" /> 
                              </div>
                              <datalist id="suggest_list"></datalist>                              
                              <div class="field">
                                <apex:inputField rendered="{!!isReadOnly}" styleClass="field-value quotation-detail-quantity number " value="{!item.rec.Quantity__c}" onchange="calcurate();" html-data-compare-value="{!item.rec.Quantity__c}" onblur="safetyLockCheck(this);" />
                                <apex:outputText rendered="{!isReadOnly}" styleClass="field-value quotation-detail-quantity number " value="{!item.rec.Quantity__c}" />
                              </div>
                              <div class="field" data-type="dropdown" style="{!IF(isReadOnly,'width: 50px;','')}">
                                <apex:inputField rendered="{!!isReadOnly}" styleClass="field-value quotation-detail-quantityUnit" value="{!item.rec.QuantityUnit__c}" html-data-type="input-field" html-data-compare-value="{!item.rec.QuantityUnit__c}" onblur="safetyLockCheck(this);" />
                                <apex:outputText rendered="{!isReadOnly}" styleClass="field-value quotation-detail-quantityUnit" value="{!item.rec.QuantityUnit__c}" />
                                <button class="{!IF(isReadOnly,'hidden','')}" type="button" data-type="button" onclick="dorpdownAction(this);">▼</button>
                                <ul class="scroll" data-type="list">
                                  <apex:repeat value="{!QuantityUnitOptions}" var="option" >
                                    <li data-type="item" data-value="{!option.Value}" onclick="setInputField(this);">
                                      <a href="javascript:void(0);" onclick="return false;">
                                        <apex:outputText value="{!option.Label}" />
                                      </a>
                                    </li>
                                  </apex:repeat>
                                </ul>
                              </div>
                              <div class="field">
                                <apex:inputField rendered="{!!isReadOnly}" styleClass="field-value quotation-detail-UnitPrice number" value="{!item.rec.UnitPrice__c}" onchange="calcurate();" html-data-compare-value="{!item.rec.UnitPrice__c}" onblur="safetyLockCheck(this);" />
                                <apex:outputText rendered="{!isReadOnly}" styleClass="field-value quotation-detail-UnitPrice number" value="{!item.rec.UnitPrice__c}" />
                              </div>
                              <div class="field">
                                <apex:outputText styleClass="field-value quotation-detail-Amount number" value="{0,number, ###,###,###,###,###,###}" >
                                  <apex:param value="{!item.rec.Amount__c}" />
                                </apex:outputText>
                              </div> 
                              <div class="field">
                                <div class="panel-area clearfix" >
                                  <div class="option-view-panel tax" data-target-class="isTaxationTarget" onclick="{!IF(isReadOnly,'','optionSettingFromPanelClick(this);calcurate();lockSafety();')}">{!$Label.JEOL_QuotEdit_Label_TaxableShort}</div>
                                  <div class="option-view-panel overhead" data-target-class="isOverheadTarget" onclick="{!IF(isReadOnly,'','optionSettingFromPanelClick(this);calcurate();lockSafety();')}">{!$Label.JEOL_QuotEdit_Label_SundryRelatedShort}</div>
                                  <div class="option-view-panel showAmount" data-target-class="isShowDetailAmountTarget" onclick="optionSettingFromPanelClick(this);lockSafety();">{!$Label.JEOL_QuotEdit_Label_ShowDetailAmountShort}</div>
                                  <div class="option-view-panel accompanyingPaperOutput" data-target-class="isAccompanyingPaperOutput" onclick="optionSettingFromPanelClick(this);lockSafety();">{!$Label.JEOL_QuotEdit_Label_SeparateSheetShort}</div>
                                  <div class="option-view-panel commissionTarget" data-target-class="isCommissionTarget" onclick="{!IF(isReadOnly,'','optionSettingFromPanelClick(this);calcurate();lockSafety();')}">{!$Label.JEOL_QuotEdit_Label_CommissionRelatedShort}</div>
                                  <div class="option-view-panel pagebreakTarget" data-target-class="isPagebreakTarget" onclick="optionSettingFromPanelClick(this);calcurate();lockSafety();">{!$Label.JEOL_QuotEdit_Label_PagebreakRelatedShort}</div>
                                </div>
                              </div>
                              <div class="field" data-type="dropdown">
                                <button type="button" onclick="dorpdownAction(this);" data-type="button" class="optionalButton">▼</button>
                                <ul class="detail-options" data-type="list"  style="{!IF(language <> 'ja', 'width: 225px;', '')}">
                                  <li style="height: 30px;" class="{!IF(isReadOnly,'hidden','field detail-options-item')}" data-type="item">
                                    <apex:commandLink action="{!item.copyAction}" title="{!$Label.JEOL_QuotEdit_Label_CloneRow}" onclick="lockSafety();clearAction(this);" rerender="detailArea,modalListView,modalListViewDel,totalResult,apexMessage" styleClass="quotation-detail-action" status="ajaxStatus"  style="{!IF(language <> 'ja', 'width: 225px;', '')}" >{!$Label.JEOL_QuotEdit_Label_CloneRow}</apex:commandLink>
                                  </li>
                                  <li class="{!IF(isReadOnly,'hidden','')}"><hr/></li>
                                  <li style="height: 30px;{!IF(language <> 'ja', 'width: 225px;', '')}" class="field detail-options-item" data-type="item">
                                    <div class="tax"></div>
                                    <apex:outputLabel for="isTaxationTarget" value="{!$Label.JEOL_QuotEdit_Label_Taxable}" styleClass="field-label" style="{!IF(language <> 'ja', 'width: 175px;', '')}" />
                                    <apex:inputField rendered="{!!isReadOnly}" id="isTaxationTarget" value="{!item.rec.IsTaxationTarget__c}" html-data-target="data-tax-target" styleClass="isTaxationTarget"  onchange="optionSetting(this);calcurate();" html-data-compare-value="{!item.rec.IsTaxationTarget__c}" onblur="safetyLockCheck(this);" />
                                    <apex:inputcheckbox rendered="{!isReadOnly}" disabled="true" id="isTaxationTargetView" value="{!item.rec.IsTaxationTarget__c}" />
                                  </li>
                                  <li style="height: 30px;{!IF(language <> 'ja', 'width: 225px;', '')}" class="field detail-options-item" data-type="item" >
                                    <div class="overhead"></div>
                                    <apex:outputLabel for="isOverheadTarget" value="{!$Label.JEOL_QuotEdit_Label_SundryRelated}" styleClass="field-label" style="{!IF(language <> 'ja', 'width: 175px;', '')}" />
                                    <apex:inputField rendered="{!!isReadOnly}" id="isOverheadTarget" value="{!item.rec.IsOverheadTarget__c}" html-data-target="data-overhead-target" styleClass="isOverheadTarget" onchange="optionSetting(this);calcurate();" html-data-compare-value="{!item.rec.IsOverheadTarget__c}" onblur="safetyLockCheck(this);" />
                                    <apex:inputcheckbox rendered="{!isReadOnly}" disabled="true" id="isOverheadTargetView" value="{!item.rec.IsOverheadTarget__c}" />
                                  </li>
                                  <li style="height: 30px;{!IF(language <> 'ja', 'width: 225px;', '')}" class="field detail-options-item" data-type="item" >
                                    <div class="showAmount"></div>
                                    <apex:outputLabel for="isShowDetailAmountTarget" value="{!$Label.JEOL_QuotEdit_Label_ShowDetailAmount}" styleClass="field-label" style="{!IF(language <> 'ja', 'width: 175px;', '')}" />
                                    <apex:inputField id="isShowDetailAmountTarget" value="{!item.rec.IsShowDetailAmount__c}" html-data-target="data-show-target" styleClass="isShowDetailAmountTarget" onchange="optionSetting(this);" html-data-compare-value="{!item.rec.IsShowDetailAmount__c}" onblur="safetyLockCheck(this);" />
                                  </li>
                                  <li style="height: 30px;{!IF(language <> 'ja', 'width: 225px;', '')}" class="field detail-options-item" data-type="item" >
                                    <div class="accompanyingPaperOutput"></div>
                                    <apex:outputLabel for="isAccompanyingPaperOutput" value="{!$Label.JEOL_QuotEdit_Label_SeparateSheet}" styleClass="field-label" style="{!IF(language <> 'ja', 'width: 175px;', '')}" />
                                    <apex:inputField id="isAccompanyingPaperOutput" value="{!item.rec.AccompanyingPaperOutput__c}" html-data-target="data-accompanying-paper-output" styleClass="isAccompanyingPaperOutput" onchange="optionSetting(this);" html-data-compare-value="{!item.rec.AccompanyingPaperOutput__c}" onblur="safetyLockCheck(this);" />
                                  </li>
                                  <li style="height: 30px;{!IF(language <> 'ja', 'width: 225px;', '')}" class="field detail-options-item" data-type="item" >
                                    <div class="commissionTarget"></div>
                                    <apex:outputLabel for="isCommissionTarget" value="{!$Label.JEOL_QuotEdit_Label_CommissionRelated}" styleClass="field-label" style="{!IF(language <> 'ja', 'width: 175px;', '')}" />
                                    <apex:inputField rendered="{!!isReadOnly}" id="isCommissionTarget" value="{!item.rec.CommissionTarget__c}" html-data-target="data-commission-target" styleClass="isCommissionTarget" onchange="optionSetting(this);calcurate();" html-data-compare-value="{!item.rec.CommissionTarget__c}" onblur="safetyLockCheck(this);" />
                                    <apex:inputcheckbox rendered="{!isReadOnly}" disabled="true" id="isCommissionTargetView" value="{!item.rec.CommissionTarget__c}" />
                                  </li>

                                  <li style="height: 30px;{!IF(language <> 'ja', 'width: 225px;', '')}" class="field detail-options-item" data-type="item" >
                                    <div class="pagebreakTarget"></div>
                                    <apex:outputLabel for="isPagebreakTarget" value="{!$Label.JEOL_QuotEdit_Label_PagebreakRelated}" styleClass="field-label" style="{!IF(language <> 'ja', 'width: 175px;', '')}" />
                                    <apex:inputField id="isPagebreakTarget" value="{!item.rec.PagebreakTarget__c}" html-data-target="data-pagebreak-target" styleClass="isPagebreakTarget" onchange="optionSetting(this);calcurate();" html-data-compare-value="{!item.rec.PagebreakTarget__c}" onblur="safetyLockCheck(this);" />
                                  </li>

                                  <li class="{!IF(isReadOnly,'hidden','')}"><hr/></li>
                                  <li style="height: 30px;{!IF(language <> 'ja', 'width: 225px;', '')}" class="{!IF(isReadOnly,'hidden','field detail-options-item')}" data-type="item" >
                                    <div style="margin-left: 8px; width: 14px; display: inline-block; *display: inline; *zoom: 1; "></div>
                                    <apex:outputLabel for="isDiscountTarget" value="{!$Label.JEOL_QuotEdit_Label_DiscountRelated}" styleClass="field-label" style="{!IF(language <> 'ja', 'width: 175px;', '')}" />
                                    <apex:inputField id="isDiscountTarget" value="{!item.rec.IsDiscountTarget__c}" html-data-target="data-discount-target" onchange="optionSetting(this);calcurate();" html-data-compare-value="{!item.rec.IsDiscountTarget__c}" onblur="safetyLockCheck(this);" />
                                  </li>
                                  <li><hr/></li>
                                  <li style="height: 30px;{!IF(language <> 'ja', 'width: 225px;', '')}" class="field detail-options-item close-option" data-type="item" >
                                    <apex:outputLink value="javascript: void(0);" styleClass="closeButton" onclick="clearAction(this);$j(this).closest('[data-type=\'dropdown\']').find('[data-type=\'button\']').trigger('focus');return false;"  style="{!IF(language <> 'ja', 'width: 225px;', '')}" >{!$Label.JEOL_QuotEdit_Label_Close}</apex:outputLink>
                                  </li>
                                </ul>
                              </div>
                              <div class="{!IF(isReadOnly,'hidden','field')}">
                                <apex:commandLink action="{!item.deleteAction}" title="{!$Label.JEOL_QuotEdit_Label_RemoveRow}" onclick="lockSafety();" rerender="detailArea,modalListView,modalListViewDel,totalResult,apexMessage" styleClass="quotation-detail-action deleteAction" status="ajaxStatus" >×</apex:commandLink>
                              </div>
                              
                              <!-- ROW DISCOUNT -->
                              <div class="discount-row clearfix" >
                                <div class="field" style="{!IF(isReadOnly, 'width: 120px;','')}">
                                  <label for="discountRate" class="field-label" style="{!IF(language <> 'ja', 'width: 95px;', '')}" >{!$Label.JEOL_QuotEdit_Label_DiscountPercent}</label>
                                  <apex:inputField rendered="{!!isReadOnly}" value="{!item.rec.DiscountRate__c}" onchange="calcurate();" styleClass="field-value quotation-detail-discountRate number" html-data-compare-value="{!item.rec.DiscountRate__c}" onblur="safetyLockCheck(this);" />
                                  <apex:outputField rendered="{!isReadOnly}" value="{!item.rec.DiscountRate__c}"  />
                                </div>
                                <div class="field" style="{!IF(isReadOnly,'width: 185px;','')}">
                                  <label for="discountAmount" class="field-label" >{!$Label.JEOL_QuotEdit_Label_DiscountAmount}</label>
                                  <apex:inputField rendered="{!!isReadOnly}" value="{!item.rec.DiscountAmount__c}" onchange="calcurate();" styleClass="field-value quotation-detail-discountAmount number" html-data-compare-value="{!item.rec.DiscountAmount__c}" onblur="safetyLockCheck(this);" />
                                  <apex:outputField rendered="{!isReadOnly}" value="{!item.rec.DiscountAmount__c}" styleClass="field-value quotation-detail-discountAmount number" />
                                </div>
                                <div class="field">
                                  <apex:outputLabel value="{!$Label.JEOL_QuotEdit_Label_AmountAfterDiscount}" styleClass="field-label" style="{!IF(language <> 'ja', 'width: 109px;', '')}" />
                                  <apex:outputText styleClass="field-value quotation-detail-totalDiscountAmount number" value="{0,number, ###,###,###,###,###,###}" >
                                    <apex:param value="{!item.rec.TotalDiscountAmount__c}" />
                                  </apex:outputText>
                                </div>
                              </div>
                            </apex:outputPanel>
                            
                            
                            <!-- SUMMARY ROW -->
                            <apex:outputPanel id="detail_title" layout="block"
                                              html-data-depth="{!item.rec.Depth__c}"
                                              html-data-sortNo="{!item.rec.SortNo__c}"
                                              html-data-type="{!item.rec.Type__c}"
                                              html-data-accompanying-paper-output="{!item.rec.AccompanyingPaperOutput__c}"
                                              html-data-pagebreak-target="{!item.rec.PagebreakTarget__c}"
                                              styleClass="quotation-detail-item clearfix"
                                              rendered="{!item.rec.Type__c = '2'}">
                              <div class="{!IF(isReadOnly,'hidden','field')}">
                                <div class="quotation-detail-action sortableAction" onmousedown="dragAction(this);" >
                                  <div class="sortable-pointer"></div>
                                </div>
                              </div>
                              <div class="{!IF(isReadOnly,'hidden','field')}">
                                <div class="quotation-detail-action configAction">
                                  <apex:outputLink value="javascript: void(0);" onclick="removeDepth(this);lockSafety();return false;" styleClass="paragraph-option paragraph-up">&lsaquo;</apex:outputLink>
                                  <apex:outputLink value="javascript: void(0);" onclick="addDepth(this);lockSafety();return false;" styleClass="paragraph-option paragraph-down">&rsaquo;</apex:outputLink>
                                </div>
                              </div>
                              <div class="hidden">
                                <apex:inputHidden html-class="quotation-detail-sortNo" value="{!item.rec.SortNo__c}" />
                                <apex:inputHidden html-class="quotation-detail-depth" value="{!item.rec.Depth__c}" />
                              </div>
                              <div class="field" style="overflow-x: hidden;{!IF(isReadOnly,'margin-left: 63px;width: 790px;','')}">
                                <div class="indent-wrap">
                                  <apex:inputField rendered="{!!isReadOnly}" styleClass="field-value quotation-detail-headingBody" value="{!item.rec.Body__c}" onfocus="detailBodyFocus(this);" onblur="safetyLockCheck(this);detailBodyBlur(this);" html-data-compare-value="{!item.rec.Body__c}" />
                                  <apex:outputText rendered="{!isReadOnly}"  styleClass="field-value quotation-detail-headingBody" value="{!item.rec.Body__c}" />
                                </div>
                              </div>
                              <div class="field">
                                <div class="panel-area clearfix" >
                                  <div class="option-view-panel" ></div>
                                  <div class="option-view-panel" ></div>
                                  <div class="option-view-panel" ></div>
                                  <div class="option-view-panel accompanyingPaperOutput" data-target-class="isAccompanyingPaperOutput" onclick="optionSettingFromPanelClick(this);lockSafety();">{!$Label.JEOL_QuotEdit_Label_SeparateSheetShort}</div>
                                  <div class="option-view-panel" ></div>
                                  <div class="option-view-panel pagebreakTarget" data-target-class="isPagebreakTarget" onclick="optionSettingFromPanelClick(this);calcurate();lockSafety();">{!$Label.JEOL_QuotEdit_Label_PagebreakRelatedShort}</div>
                                </div>
                              </div>
                              <div class="field" data-type="dropdown">
                                <button type="button" onclick="dorpdownAction(this);" data-type="button" class="optionalButton">▼</button>
                                <ul class="detail-options" data-type="list" style="{!IF(language <> 'ja', 'width: 225px;', '')}">
                                  <li style="height: 30px;{!IF(language <> 'ja', 'width: 225px;', '')}" class="{!IF(isReadOnly,'hidden','field detail-options-item')}" data-type="item">
                                    <apex:commandLink action="{!item.copyAction}" title="{!$Label.JEOL_QuotEdit_Label_CloneRow}" onclick="lockSafety();clearAction(this);" rerender="detailArea,modalListView,modalListViewDel,totalResult,apexMessage" styleClass="quotation-detail-action" status="ajaxStatus" style="{!IF(language <> 'ja', 'width: 225px;', '')}">{!$Label.JEOL_QuotEdit_Label_CloneRow}</apex:commandLink>
                                  </li>
                                  <li class="{!IF(isReadOnly,'hidden','')}" ><hr/></li>
                                  <li style="height: 30px;{!IF(language <> 'ja', 'width: 225px;', '')}" class="field detail-options-item" data-type="item">
                                    <div class="accompanyingPaperOutput"></div>
                                    <apex:outputLabel for="isAccompanyingPaperOutput-breakdown" value="{!$Label.JEOL_QuotEdit_Label_SeparateSheet}" styleClass="field-label" style="{!IF(language <> 'ja', 'width: 175px;', '')}" />
                                    <apex:inputField id="isAccompanyingPaperOutput-breakdown" value="{!item.rec.AccompanyingPaperOutput__c}" html-data-target="data-accompanying-paper-output" styleClass="field-value isAccompanyingPaperOutput" onchange="optionSetting(this);" html-data-compare-value="{!item.rec.AccompanyingPaperOutput__c}" onblur="safetyLockCheck(this);" />
                                  </li>

                                  <li style="height: 30px;{!IF(language <> 'ja', 'width: 225px;', '')}" class="field detail-options-item" data-type="item" >
                                    <div class="pagebreakTarget"></div>
                                    <apex:outputLabel for="isPagebreakTarget-2" value="{!$Label.JEOL_QuotEdit_Label_PagebreakRelated}" styleClass="field-label" style="{!IF(language <> 'ja', 'width: 175px;', '')}" />
                                    <apex:inputField id="isPagebreakTarget-2" value="{!item.rec.PagebreakTarget__c}" html-data-target="data-pagebreak-target" styleClass="isPagebreakTarget" onchange="optionSetting(this);calcurate();" html-data-compare-value="{!item.rec.PagebreakTarget__c}" onblur="safetyLockCheck(this);" />
                                  </li>

                                  <li><hr/></li>
                                  <li style="height: 30px;{!IF(language <> 'ja', 'width: 225px;', '')}" class="field detail-options-item close-option" data-type="item">
                                    <apex:outputLink value="javascript: void(0);" styleClass="closeButton" onclick="clearAction(this);$j(this).closest('[data-type=\'dropdown\']').find('[data-type=\'button\']').trigger('focus');return false;" >{!$Label.JEOL_QuotEdit_Label_Close}</apex:outputLink>
                                  </li>
                                </ul>
                              </div>
                              <div class="{!IF(isReadOnly,'hidden','field')}" >
                                <apex:commandLink action="{!item.deleteAction}" title="{!$Label.JEOL_QuotEdit_Label_RemoveRow}" onclick="lockSafety();" rerender="detailArea,modalListView,modalListViewDel,totalResult,apexMessage" styleClass="quotation-detail-action deleteAction" status="ajaxStatus" >×</apex:commandLink>
                              </div>
                            </apex:outputPanel>
                            
                            <!-- ROW SUNDRY EXPENSE -->
                            <apex:outputPanel id="detail_overhead" 
                                              layout="block"
                                              html-data-depth="{!item.rec.Depth__c}"
                                              html-data-sortNo="{!item.rec.SortNo__c}"
                                              html-data-type="{!item.rec.Type__c}"
                                              html-data-tax-target="{!item.rec.IsTaxationTarget__c}"
                                              html-data-commission-target="{!item.rec.CommissionTarget__c}"
                                              html-data-pagebreak-target="{!item.rec.PagebreakTarget__c}"
                                              styleClass="quotation-detail-item clearfix"
                                              rendered="{!item.rec.Type__c = '3'}">
                              <div class="{!IF(isReadOnly,'hidden','field')}">
                                <div class="quotation-detail-action sortableAction" onmousedown="dragAction(this);" >
                                  <div class="sortable-pointer"></div>
                                </div>
                              </div>
                              <div class="{!IF(isReadOnly,'hidden','field')}">
                                <div class="quotation-detail-action configAction">
                                  <apex:outputLink value="javascript: void(0);" onclick="removeDepth(this);lockSafety();return false;" styleClass="paragraph-option paragraph-up">&lsaquo;</apex:outputLink>
                                  <apex:outputLink value="javascript: void(0);" onclick="addDepth(this);lockSafety();return false;" styleClass="paragraph-option paragraph-down">&rsaquo;</apex:outputLink>
                                </div>
                              </div>
                              <div class="hidden">
                                <apex:inputHidden html-class="quotation-detail-totalDiscountAmount-input" value="{!item.rec.TotalDiscountAmount__c}" />
                                <apex:inputHidden html-class="quotation-detail-Amount-input" value="{!item.rec.Amount__c}" />
                                <apex:inputHidden html-class="quotation-detail-sortNo" value="{!item.rec.SortNo__c}" />
                                <apex:inputHidden html-class="quotation-detail-depth" value="{!item.rec.Depth__c}" />
                              </div>
                              <div class="field" style="overflow-x: hidden;{!IF(isReadOnly,'margin-left: 63px;width: 438px;white-space: nowrap;','')}">
                                <div class="indent-wrap">
                                  <apex:inputField rendered="{!!isReadOnly}" styleClass="field-value quotation-detail-overheadBody" value="{!item.rec.Body__c}" onfocus="detailBodyFocus(this);" onblur="safetyLockCheck(this);detailBodyBlur(this);" html-data-compare-value="{!item.rec.Body__c}" />
                                  <apex:outputText rendered="{!isReadOnly}" styleClass="field-value quotation-detail-overheadBody" value="{!item.rec.Body__c}" />
                                </div>
                              </div>
                              <div class="field">
                                <apex:inputField rendered="{!!isReadOnly}" styleClass="field-value quotation-detail-overheadRate number" value="{!item.rec.Quantity__c}" onchange="calcurate();" />
                                <apex:outputText rendered="{!isReadOnly}" styleClass="field-value quotation-detail-overheadRate number" value="{!item.rec.Quantity__c}" />
                              </div>
                              <div class="field">
                                <div class="field-value quotation-detail-quantityUnit-rate ">
                                  <apex:outputField value="{!item.rec.QuantityUnit__c}"  />
                                </div>
                              </div>
                              <div class="field" style="{!IF(isReadOnly,'margin-left: 80px;width: 116px','margin-left: 94px;width: 116px;')}">
                                <apex:outputText styleClass="field-value quotation-detail-Amount number" value="{0,number, ###,###,###,###,###,###}" >
                                  <apex:param value="{!item.rec.Amount__c}" />
                                </apex:outputText>
                              </div>

                              <div class="field">
                                <div class="panel-area clearfix" >
                                  <div class="option-view-panel" ></div>
                                  <div class="option-view-panel" ></div>
                                  <div class="option-view-panel" ></div>
                                  <div class="option-view-panel" ></div>
                                  <div class="option-view-panel commissionTarget" data-target-class="isCommissionTarget" onclick="{!IF(isReadOnly,'','optionSettingFromPanelClick(this);calcurate();lockSafety();')}">{!$Label.JEOL_QuotEdit_Label_CommissionRelatedShort}</div>
                                  <div class="option-view-panel pagebreakTarget" data-target-class="isPagebreakTarget" onclick="optionSettingFromPanelClick(this);calcurate();lockSafety();">{!$Label.JEOL_QuotEdit_Label_PagebreakRelatedShort}</div>
                                </div>
                              </div>
                              <div class="field" data-type="dropdown" style="{!IF(isReadOnly,'margin-right: 75px;','')}">
                                <button type="button" onclick="dorpdownAction(this);" data-type="button" class="optionalButton">▼</button>
                                <ul class="detail-options" data-type="list" style="{!IF(language <> 'ja', 'width: 225px;', '')}">
                                  <li style="height: 30px;{!IF(language <> 'ja', 'width: 225px;', '')}" class="field detail-options-item" data-type="item">
                                    <div class="commissionTarget"></div>
                                    <apex:outputLabel for="isCommissionTarget-sundry" value="{!$Label.JEOL_QuotEdit_Label_CommissionRelated}" styleClass="field-label" style="{!IF(language <> 'ja', 'width: 175px;', '')}" />
                                    <apex:inputField rendered="{!!isReadOnly}" id="isCommissionTarget-sundry" value="{!item.rec.CommissionTarget__c}" html-data-target="data-commission-target" styleClass="isCommissionTarget" onchange="optionSetting(this);calcurate();" html-data-compare-value="{!item.rec.CommissionTarget__c}" onblur="safetyLockCheck(this);" />
                                    <apex:inputcheckbox rendered="{!isReadOnly}" disabled="true" id="isCommissionTarget-sundryView" value="{!item.rec.CommissionTarget__c}" />
                                  </li>

                                  <li style="height: 30px;{!IF(language <> 'ja', 'width: 225px;', '')}" class="field detail-options-item" data-type="item" >
                                    <div class="pagebreakTarget"></div>
                                    <apex:outputLabel for="isPagebreakTarget-3" value="{!$Label.JEOL_QuotEdit_Label_PagebreakRelated}" styleClass="field-label" style="{!IF(language <> 'ja', 'width: 175px;', '')}" />
                                    <apex:inputField id="isPagebreakTarget-3" value="{!item.rec.PagebreakTarget__c}" html-data-target="data-pagebreak-target" styleClass="isPagebreakTarget" onchange="optionSetting(this);calcurate();" html-data-compare-value="{!item.rec.PagebreakTarget__c}" onblur="safetyLockCheck(this);" />
                                  </li>

                                  <li><hr/></li>
                                  <li style="height: 30px;{!IF(language <> 'ja', 'width: 225px;', '')}" class="field detail-options-item close-option" data-type="item">
                                    <apex:outputLink value="javascript: void(0);" styleClass="closeButton" onclick="clearAction(this);$j(this).closest('[data-type=\'dropdown\']').find('[data-type=\'button\']').trigger('focus');return false;" >{!$Label.JEOL_QuotEdit_Label_Close}</apex:outputLink>
                                  </li>
                                </ul>
                              </div>
                              
                              <div class="{!IF(isReadOnly,'hidden','field')}" >
                                <apex:commandLink action="{!item.deleteAction}" title="{!$Label.JEOL_QuotEdit_Label_RemoveRow}" onclick="lockSafety();" rerender="detailArea,modalListView,modalListViewDel,totalResult,apexMessage" styleClass="quotation-detail-action deleteAction" status="ajaxStatus" >×</apex:commandLink>
                              </div>
                            </apex:outputPanel>
                            
                            <!-- ROW SUBTOTAL -->
                            <apex:outputPanel id="detail_subtotal"
                                              layout="block"
                                              html-data-depth="{!item.rec.Depth__c}"
                                              html-data-sortNo="{!item.rec.SortNo__c}"
                                              html-data-type="{!item.rec.Type__c}"
                                              html-data-pagebreak-target="{!item.rec.PagebreakTarget__c}"
                                              styleClass="quotation-detail-item clearfix"
                                              rendered="{!item.rec.Type__c = '4'}">
                              <div class="{!IF(isReadOnly,'hidden','field')}">
                                <div class="quotation-detail-action sortableAction" onmousedown="dragAction(this);" >
                                  <div class="sortable-pointer"></div>
                                </div>
                              </div>
                              <div class="{!IF(isReadOnly,'hidden','field')}">
                                <div class="quotation-detail-action configAction">
                                  <apex:outputLink value="javascript: void(0);" onclick="removeDepth(this);lockSafety();return false;" styleClass="paragraph-option paragraph-up">&lsaquo;</apex:outputLink>
                                  <apex:outputLink value="javascript: void(0);" onclick="addDepth(this);lockSafety();return false;" styleClass="paragraph-option paragraph-down">&rsaquo;</apex:outputLink>
                                </div>
                              </div>
                              <div class="hidden">
                                <apex:inputHidden html-class="quotation-detail-totalDiscountAmount-input" value="{!item.rec.TotalDiscountAmount__c}" />
                                <apex:inputHidden html-class="quotation-detail-Amount-input" value="{!item.rec.Amount__c}" />
                                <apex:inputHidden html-class="quotation-detail-sortNo" value="{!item.rec.SortNo__c}" />
                                <apex:inputHidden html-class="quotation-detail-depth" value="{!item.rec.Depth__c}" />
                              </div>
                              <div class="field" style="overflow-x: hidden;{!IF(isReadOnly,'margin-left: 63px;width: 666px;white-space: nowrap;','')}">
                                <div class="indent-wrap">
                                    <apex:inputField rendered="{!!isReadOnly}" styleClass="field-value quotation-detail-subtotalBody" value="{!item.rec.Body__c}" onfocus="detailBodyFocus(this);" onblur="safetyLockCheck(this);detailBodyBlur(this);" html-data-compare-value="{!item.rec.Body__c}" />
                                  <apex:outputText rendered="{!isReadOnly}" styleClass="field-value quotation-detail-subtotalBody" value="{!item.rec.Body__c}" />
                                </div>
                              </div>
                              <div class="field" >
                                <apex:outputText styleClass="field-value quotation-detail-Amount number" value="{0,number, ###,###,###,###,###,###}" >
                                  <apex:param value="{!item.rec.Amount__c}" />
                                </apex:outputText>
                              </div>

<!--
                              <div class="field">
                                <div style="{!IF(isReadOnly,'width: 157px;','width: 81px;')}"></div>
                              </div>
-->
                              <div class="field">
                                <div class="panel-area clearfix" >
                                  <div class="option-view-panel" ></div>
                                  <div class="option-view-panel" ></div>
                                  <div class="option-view-panel" ></div>
                                  <div class="option-view-panel" ></div>
                                  <div class="option-view-panel" ></div>
                                  <div class="option-view-panel pagebreakTarget" data-target-class="isPagebreakTarget" onclick="optionSettingFromPanelClick(this);calcurate();lockSafety();">{!$Label.JEOL_QuotEdit_Label_PagebreakRelatedShort}</div>
                                </div>
                              </div>
                              <div class="field" data-type="dropdown" style="{!IF(isReadOnly,'margin-right: 75px;','')}">
                                <button type="button" onclick="dorpdownAction(this);" data-type="button" class="optionalButton">▼</button>
                                <ul class="detail-options" data-type="list" style="{!IF(language <> 'ja', 'width: 225px;', '')}">

                                  <li style="height: 30px;{!IF(language <> 'ja', 'width: 225px;', '')}" class="field detail-options-item" data-type="item" >
                                    <div class="pagebreakTarget"></div>
                                    <apex:outputLabel for="isPagebreakTarget-4" value="{!$Label.JEOL_QuotEdit_Label_PagebreakRelated}" styleClass="field-label" style="{!IF(language <> 'ja', 'width: 175px;', '')}" />
                                    <apex:inputField id="isPagebreakTarget-4" value="{!item.rec.PagebreakTarget__c}" html-data-target="data-pagebreak-target" styleClass="isPagebreakTarget" onchange="optionSetting(this);calcurate();" html-data-compare-value="{!item.rec.PagebreakTarget__c}" onblur="safetyLockCheck(this);" />
                                  </li>

                                  <li><hr/></li>
                                  <li style="height: 30px;{!IF(language <> 'ja', 'width: 225px;', '')}" class="field detail-options-item close-option" data-type="item">
                                    <apex:outputLink value="javascript: void(0);" styleClass="closeButton" onclick="clearAction(this);$j(this).closest('[data-type=\'dropdown\']').find('[data-type=\'button\']').trigger('focus');return false;" >{!$Label.JEOL_QuotEdit_Label_Close}</apex:outputLink>
                                  </li>
                                </ul>
                              </div>

                              <div class="{!IF(isReadOnly,'hidden','field')}">
                                <apex:commandLink action="{!item.deleteAction}" title="{!$Label.JEOL_QuotEdit_Label_RemoveRow}" onclick="lockSafety();" rerender="detailArea,modalListView,modalListViewDel,totalResult,apexMessage" styleClass="quotation-detail-action deleteAction" status="ajaxStatus" >×</apex:commandLink>
                              </div>
                            </apex:outputPanel>

                            <!-- ROW COMMISSION -->
                            <apex:outputPanel id="detail_commission"
                                              layout="block"
                                              html-data-depth="{!item.rec.Depth__c}"
                                              html-data-sortNo="{!item.rec.SortNo__c}"
                                              html-data-type="{!item.rec.Type__c}"
                                              html-data-tax-target="{!item.rec.IsTaxationTarget__c}"
                                              html-data-pagebreak-target="{!item.rec.PagebreakTarget__c}"
                                              styleClass="quotation-detail-item clearfix"
                                              rendered="{!item.rec.Type__c = '5'}">
                              <div class="{!IF(isReadOnly,'hidden','field')}">
                                <div class="quotation-detail-action sortableAction" onmousedown="dragAction(this);" >
                                  <div class="sortable-pointer"></div>
                                </div>
                              </div>
                              <div class="{!IF(isReadOnly,'hidden','field')}">
                                <div class="quotation-detail-action configAction">
                                  <apex:outputLink value="javascript: void(0);" onclick="removeDepth(this);lockSafety();return false;" styleClass="paragraph-option paragraph-up">&lsaquo;</apex:outputLink>
                                  <apex:outputLink value="javascript: void(0);" onclick="addDepth(this);lockSafety();return false;" styleClass="paragraph-option paragraph-down">&rsaquo;</apex:outputLink>
                                </div>
                              </div>
                              <div class="hidden">
                                <apex:inputHidden html-class="quotation-detail-totalDiscountAmount-input" value="{!item.rec.TotalDiscountAmount__c}" />
                                <apex:inputHidden html-class="quotation-detail-Amount-input" value="{!item.rec.Amount__c}" />
                                <apex:inputHidden html-class="quotation-detail-sortNo" value="{!item.rec.SortNo__c}" />
                                <apex:inputHidden html-class="quotation-detail-depth" value="{!item.rec.Depth__c}" />
                              </div>
                              <div class="field" style="overflow-x: hidden;{!IF(isReadOnly,'margin-left: 63px;width: 438px;white-space: nowrap;','')}">
                                <div class="indent-wrap">
                                  <apex:inputField rendered="{!!isReadOnly}" styleClass="field-value quotation-detail-commissionBody" value="{!item.rec.Body__c}" onfocus="detailBodyFocus(this);" onblur="safetyLockCheck(this);detailBodyBlur(this);" html-data-compare-value="{!item.rec.Body__c}" />
                                  <apex:outputText rendered="{!isReadOnly}" styleClass="field-value quotation-detail-commissionBody" value="{!item.rec.Body__c}" />
                                </div>
                              </div>
                              <div class="field">
                                <apex:inputField rendered="{!!isReadOnly}" styleClass="field-value quotation-detail-commissionRate number" value="{!item.rec.Quantity__c}" onchange="calcurate();" />
                                <apex:outputText rendered="{!isReadOnly}" styleClass="field-value quotation-detail-commissionRate number" value="{!item.rec.Quantity__c}" />
                              </div>
                              <div class="field">
                                <div class="field-value quotation-detail-quantityUnit-rate ">
                                  <apex:outputField value="{!item.rec.QuantityUnit__c}"  />
                                </div>
                              </div>
                              <div class="field" style="{!IF(isReadOnly,'margin-left: 80px;/*margin-right: 165px;*/','margin-left: 94px;/*margin-right: 89px;*/')}">
                                <apex:outputText styleClass="field-value quotation-detail-Amount number" value="{0,number, ###,###,###,###,###,###}" >
                                  <apex:param value="{!item.rec.Amount__c}" />
                                </apex:outputText>
                              </div>

                              <div class="field">
                                <div class="panel-area clearfix" >
                                  <div class="option-view-panel" ></div>
                                  <div class="option-view-panel" ></div>
                                  <div class="option-view-panel" ></div>
                                  <div class="option-view-panel" ></div>
                                  <div class="option-view-panel" ></div>
                                  <div class="option-view-panel pagebreakTarget" data-target-class="isPagebreakTarget" onclick="optionSettingFromPanelClick(this);calcurate();lockSafety();">{!$Label.JEOL_QuotEdit_Label_PagebreakRelatedShort}</div>
                                </div>
                              </div>
                              <div class="field" data-type="dropdown" style="{!IF(isReadOnly,'margin-right: 75px;','')}">
                                <button type="button" onclick="dorpdownAction(this);" data-type="button" class="optionalButton">▼</button>
                                <ul class="detail-options" data-type="list" style="{!IF(language <> 'ja', 'width: 225px;', '')}">

                                  <li style="height: 30px;{!IF(language <> 'ja', 'width: 225px;', '')}" class="field detail-options-item" data-type="item" >
                                    <div class="pagebreakTarget"></div>
                                    <apex:outputLabel for="isPagebreakTarget-5" value="{!$Label.JEOL_QuotEdit_Label_PagebreakRelated}" styleClass="field-label" style="{!IF(language <> 'ja', 'width: 175px;', '')}" />
                                    <apex:inputField id="isPagebreakTarget-5" value="{!item.rec.PagebreakTarget__c}" html-data-target="data-pagebreak-target" styleClass="isPagebreakTarget" onchange="optionSetting(this);calcurate();" html-data-compare-value="{!item.rec.PagebreakTarget__c}" onblur="safetyLockCheck(this);" />
                                  </li>

                                  <li><hr/></li>
                                  <li style="height: 30px;{!IF(language <> 'ja', 'width: 225px;', '')}" class="field detail-options-item close-option" data-type="item">
                                    <apex:outputLink value="javascript: void(0);" styleClass="closeButton" onclick="clearAction(this);$j(this).closest('[data-type=\'dropdown\']').find('[data-type=\'button\']').trigger('focus');return false;" >{!$Label.JEOL_QuotEdit_Label_Close}</apex:outputLink>
                                  </li>
                                </ul>
                              </div>

                              <div class="{!IF(isReadOnly,'hidden','field')}" >
                                <apex:commandLink action="{!item.deleteAction}" title="{!$Label.JEOL_QuotEdit_Label_RemoveRow}" onclick="lockSafety();" rerender="detailArea,modalListView,modalListViewDel,totalResult,apexMessage" styleClass="quotation-detail-action deleteAction" status="ajaxStatus" >×</apex:commandLink>
                              </div>
                            </apex:outputPanel>
                            
                          </apex:repeat>
                        </apex:outputPanel>
                        <apex:outputPanel layout="none" rendered="{!!hasDetails}">
                          <div style="padding: 10px; margin: 2px 0px;">{!$Label.JEOL_QuotEdit_Message_DetailNotCreated}</div>
                        </apex:outputPanel>
                      </apex:outputPanel>
                      <apex:actionStatus layout="block" onstop="initWithCalcurate();focusOpenModalDetail();" id="ajaxStatus" startStyleClass="ajax-status-start">
                        <apex:facet name="start">
                          <div class="ajax-status-start-inner ajax-loading">
                            <span style="position:relative; z-index: 2;">{!$Label.JEOL_QuotEdit_Label_Searching}</span>
                          </div>
                        </apex:facet>
                      </apex:actionStatus>
                      <hr />
                      
                    <!-- SUMMARY SECTION -->
                    </apex:outputPanel>
                    <div class="quotation-item create-action-area" >
                      <div class="quotation-item-body clearfix" >
                        <div class="{!IF(isReadOnly,'hidden','field clearfix top')}" data-type="dropdown">
                          <apex:commandLink rerender="detailArea,modalListView,modalListViewDel,apexMessage" action="{!qdm.createQuotationDetail}" oncomplete="lockSafety();showResult('{!$Label.JEOL_QuotEdit_Message_ProcessingCompleted}');" styleClass="add-default-detail customButton" status="ajaxStatus" >{!$Label.JEOL_QuotEdit_Label_AddNewItem}</apex:commandLink>
                          <apex:outputLink value="javascript: void(0);" onclick="dorpdownAction(this);return false;" html-data-type="button" styleClass="add-optional-details customButton">▲</apex:outputLink>
                          <ul class="optional-list" data-type="list">
                            <li data-type="item">
                              <apex:commandLink styleClass="optional-item" oncomplete="lockSafety();showResult('{!$Label.JEOL_QuotEdit_Message_ProcessingCompleted}');" rerender="detailArea,modalListView,modalListViewDel,apexMessage" action="{!qdm.createQuotationDetail}" status="ajaxStatus" >{!$Label.JEOL_QuotEdit_Label_AddNewItem}</apex:commandLink>
                            </li>
                            <li data-type="item">
                              <apex:commandLink styleClass="optional-item" oncomplete="lockSafety();showResult('{!$Label.JEOL_QuotEdit_Message_ProcessingCompleted}');" rerender="detailArea,modalListView,modalListViewDel,apexMessage" action="{!qdm.createHeadingDetail}" status="ajaxStatus">{!$Label.JEOL_QuotEdit_Label_AddHeading}</apex:commandLink>
                            </li>
                            <li data-type="item">
                              <apex:commandLink styleClass="optional-item" oncomplete="lockSafety();showResult('{!$Label.JEOL_QuotEdit_Message_ProcessingCompleted}');" rerender="detailArea,modalListView,modalListViewDel,apexMessage" action="{!qdm.createOverheadDetail}" status="ajaxStatus">{!$Label.JEOL_QuotEdit_Label_AddSundry}</apex:commandLink>
                            </li>
                            <li data-type="item">
                              <apex:commandLink styleClass="optional-item" oncomplete="lockSafety();showResult('{!$Label.JEOL_QuotEdit_Message_ProcessingCompleted}');" rerender="detailArea,modalListView,modalListViewDel,apexMessage" action="{!qdm.createSubtotalDetail}" status="ajaxStatus">{!$Label.JEOL_QuotEdit_Label_AddSubtotal}</apex:commandLink>
                            </li>
                            <li data-type="item">
                              <apex:commandLink styleClass="optional-item" oncomplete="lockSafety();showResult('{!$Label.JEOL_QuotEdit_Message_ProcessingCompleted}');" rerender="detailArea,modalListView,modalListViewDel,apexMessage" action="{!qdm.createCommissionDetail}" status="ajaxStatus">{!$Label.JEOL_QuotEdit_Label_AddCommission}</apex:commandLink>
                            </li>
                            <li><hr/></li>
                            <li class="field close-option" data-type="item">
                              <apex:outputLink value="javascript: void(0);" styleClass="optional-item closeButton" onclick="clearAction(this);$j(this).closest('[data-type=\'dropdown\']').find('[data-type=\'button\']').trigger('focus');return false;" >{!$Label.JEOL_QuotEdit_Label_Close}</apex:outputLink>
                            </li>
                          </ul>
                        </div>
                      </div>
                    </div>
                    <div class="quotation-item total-amount-area" >
                      <apex:outputPanel layout="block" styleClass="quotation-item-body clearfix" id="totalResult">
                        <div class="hidden" >
                          <apex:inputHidden html-class="quotationCommissionAmount" value="{!qdm.parentRec.CommissionAmount__c}" />
                          <apex:inputHidden html-class="quotationSubtitle" value="{!qdm.parentRec.Subtitle__c}" />
                          <apex:inputHidden html-class="quotationSubtotalReductionAmount1" value="{!qdm.parentRec.SubtotalReductionAmount1__c}" />
                          <apex:inputHidden html-class="quotationSubtotalReductionAmount2" value="{!qdm.parentRec.SubtotalReductionAmount2__c}" />
                          <apex:inputHidden html-class="quotationTotalAmount" value="{!qdm.parentRec.TotalAmount__c}" />
                          <apex:inputHidden html-class="quotationConsumptionTaxAmount" value="{!qdm.parentRec.ConsumptionTaxAmount__c}" />
                          <apex:inputHidden html-class="quotationTotalTaxAmount" value="{!qdm.parentRec.TotalTaxAmount__c}" />
                        </div>
                        <div class="hidden"> <!-- class="field" -->
                          <div class="field-label">
                            <apex:outputLabel value="口銭 (" style="padding-right: 8px;"/>
                            <apex:inputField rendered="{!!isReadOnly}" styleClass="field-value commissionRate number" value="{!qdm.parentRec.CommissionRate__c}" html-tabIndex="-1" onchange="calcurate();" html-data-compare-value="{!qdm.baseParentRec.CommissionRate__c}" onblur="safetyLockCheck(this);" />
                            <apex:outputField rendered="{!isReadOnly}" styleClass="field-value commissionRate number" value="{!qdm.parentRec.CommissionRate__c}" />
                            <apex:outputLabel rendered="{!!isReadOnly}" value="%)" style="padding-left: 8px;"/>
                            <apex:outputLabel rendered="{!isReadOnly}" value=")" style="padding-left: 8px;"/>
                          </div>
                          <apex:outputText styleClass="field-value quotationCommissionAmountOutput number" value="{0,number, ###,###,###,###,###,###}" style="font-size: 13px;">
                            <apex:param value="{!qdm.parentRec.CommissionAmount__c}" />
                          </apex:outputText>
                        </div>
                        <div class="{!IF(isReadOnly && (qdm.parentRec.CustomReductionAmount1__c == null || qdm.parentRec.CustomReductionAmount1__c == 0 ) && (qdm.parentRec.CustomReductionAmount2__c == null || qdm.parentRec.CustomReductionAmount2__c == 0 ) && (qdm.parentRec.CustomReductionAmount3__c == null || qdm.parentRec.CustomReductionAmount3__c == 0 ),'hidden','field')}" >
                          <apex:inputField rendered="{!!isReadOnly}" value="{!qdm.parentRec.SubtitleLabel__c}" styleClass="field-value subtitleLabel" html-placeholder="{!$Label.JEOL_QuotEdit_Label_SubtotalName}" html-data-compare-value="{!qdm.baseParentRec.SubtitleLabel__c}" onblur="safetyLockCheck(this);" />
                          <apex:outputLabel rendered="{!isReadOnly}" value="{!qdm.parentRec.SubtitleLabel__c}" styleClass="field-value subtitleLabel" html-placeholder="{!$Label.JEOL_QuotEdit_Label_SubtotalName}" />
                          <apex:outputText styleClass="field-value quotationSubtitleOutput number" value="{0,number, ###,###,###,###,###,###}" style="font-size: 13px;">
                            <apex:param value="{!qdm.parentRec.Subtitle__c}" />
                          </apex:outputText>
                          <div class="field-value" style="width: auto;">
                            <apex:inputCheckbox value="{!qdm.parentRec.OutputSubtitle__c}" html-data-compare-value="{!qdm.baseParentRec.OutputSubtitle__c}" onblur="safetyLockCheck(this);"/>  <!--Modification-VAIB(2015/05/27 UAT_QA_List No.72) -->

                          </div>
                        </div>
                        <div class="{!IF(isReadOnly && (qdm.parentRec.CustomReductionAmount1__c == null || qdm.parentRec.CustomReductionAmount1__c == 0 ),'hidden','field')}" >
                          <apex:inputField rendered="{!!isReadOnly}" value="{!qdm.parentRec.CustomReductionName1__c}" styleClass="field-value customReductionTitle" html-placeholder="{!$Label.JEOL_QuotEdit_Label_DiscountName}" html-data-compare-value="{!qdm.baseParentRec.CustomReductionName1__c}" onblur="safetyLockCheck(this);" />
                          <apex:outputLabel rendered="{!isReadOnly}" value="{!qdm.parentRec.CustomReductionName1__c}" styleClass="field-value customReductionTitle" html-placeholder="{!$Label.JEOL_QuotEdit_Label_DiscountName}" />
                          <apex:inputField rendered="{!!isReadOnly}" id="customReductionAcmount1" styleClass="field-value customReductionAmount number" value="{!qdm.parentRec.CustomReductionAmount1__c}" onchange="setTotalAmount();" html-data-compare-value="{!qdm.baseParentRec.CustomReductionAmount1__c}" onblur="safetyLockCheck(this);" />
                          <apex:outputText rendered="{!isReadOnly}" id="customReductionAcmount1Value" styleClass="field-value customReductionAmount number" value="{!qdm.parentRec.CustomReductionAmount1__c}" />
                        </div>

                        <div class="{!IF(isReadOnly && ((qdm.parentRec.CustomReductionAmount1__c == null || qdm.parentRec.CustomReductionAmount1__c == 0) || ((qdm.parentRec.CustomReductionAmount2__c == null || qdm.parentRec.CustomReductionAmount2__c == 0) && (qdm.parentRec.CustomReductionAmount3__c == null || qdm.parentRec.CustomReductionAmount3__c == 0))),'hidden','field')}" >
                          <apex:inputField rendered="{!!isReadOnly}" value="{!qdm.parentRec.SubtotalReductionName1__c}" styleClass="field-value subtitleLabel" html-placeholder="{!$Label.JEOL_QuotEdit_Label_Subtotal}" html-data-compare-value="{!qdm.baseParentRec.SubtotalReductionName1__c}" onblur="safetyLockCheck(this);" />
                          <apex:outputLabel rendered="{!isReadOnly}" value="{!qdm.parentRec.SubtotalReductionName1__c}" styleClass="field-value subtitleLabel" html-placeholder="{!$Label.JEOL_QuotEdit_Label_Subtotal}" />
                          <apex:outputText styleClass="field-value quotationSubtotalReductionAmount1Output number" value="{0,number, ###,###,###,###,###,###}" style="font-size: 13px;">
                            <apex:param value="{!qdm.parentRec.SubtotalReductionAmount1__c}" />
                          </apex:outputText>
                          <div class="field-value" style="width: auto;">
                            <apex:inputCheckbox value="{!qdm.parentRec.OutputSubtotalReduction1__c}" html-data-compare-value="{!qdm.baseParentRec.OutputSubtotalReduction1__c}" onblur="safetyLockCheck(this);"/>
                          </div>
                        </div>

                        <div class="{!IF(isReadOnly && (qdm.parentRec.CustomReductionAmount2__c == null || qdm.parentRec.CustomReductionAmount2__c == 0 ),'hidden','field')}" >
                          <apex:inputField rendered="{!!isReadOnly}" value="{!qdm.parentRec.CustomReductionName2__c}" styleClass="field-value customReductionTitle" html-placeholder="{!$Label.JEOL_QuotEdit_Label_DiscountName}" html-data-compare-value="{!qdm.baseParentRec.CustomReductionName2__c}" onblur="safetyLockCheck(this);" />
                          <apex:outputLabel rendered="{!isReadOnly}" value="{!qdm.parentRec.CustomReductionName2__c}" styleClass="field-value customReductionTitle" html-placeholder="{!$Label.JEOL_QuotEdit_Label_DiscountName}" />
                          <apex:inputField rendered="{!!isReadOnly}" id="customReductionAcmount2" styleClass="field-value customReductionAmount number" value="{!qdm.parentRec.CustomReductionAmount2__c}" onchange="setTotalAmount()" html-data-compare-value="{!qdm.baseParentRec.CustomReductionAmount2__c}" onblur="safetyLockCheck(this);" />
                          <apex:outputText rendered="{!isReadOnly}" id="customReductionAcmount2Value" styleClass="field-value customReductionAmount number" value="{!qdm.parentRec.CustomReductionAmount2__c}" />
                        </div>

                        <div class="{!IF(isReadOnly && ((qdm.parentRec.CustomReductionAmount2__c == null || qdm.parentRec.CustomReductionAmount2__c == 0 ) || (qdm.parentRec.CustomReductionAmount3__c == null || qdm.parentRec.CustomReductionAmount3__c == 0 )),'hidden','field')}" >
                          <apex:inputField rendered="{!!isReadOnly}" value="{!qdm.parentRec.SubtotalReductionName2__c}" styleClass="field-value subtitleLabel" html-placeholder="{!$Label.JEOL_QuotEdit_Label_Subtotal}" html-data-compare-value="{!qdm.baseParentRec.SubtotalReductionName2__c}" onblur="safetyLockCheck(this);" />
                          <apex:outputLabel rendered="{!isReadOnly}" value="{!qdm.parentRec.SubtotalReductionName2__c}" styleClass="field-value subtitleLabel" html-placeholder="{!$Label.JEOL_QuotEdit_Label_Subtotal}" />
                          <apex:outputText styleClass="field-value quotationSubtotalReductionAmount2Output number" value="{0,number, ###,###,###,###,###,###}" style="font-size: 13px;">
                            <apex:param value="{!qdm.parentRec.SubtotalReductionAmount2__c}" />
                          </apex:outputText>
                          <div class="field-value" style="width: auto;">
                            <apex:inputCheckbox value="{!qdm.parentRec.OutputSubtotalReduction2__c}" html-data-compare-value="{!qdm.baseParentRec.OutputSubtotalReduction2__c}" onblur="safetyLockCheck(this);"/>
                          </div>
                        </div>

                        <div class="{!IF(isReadOnly && (qdm.parentRec.CustomReductionAmount3__c == null || qdm.parentRec.CustomReductionAmount3__c == 0 ),'hidden','field')}" >
                          <apex:inputField rendered="{!!isReadOnly}" value="{!qdm.parentRec.CustomReductionName3__c}" styleClass="field-value customReductionTitle" html-placeholder="{!$Label.JEOL_QuotEdit_Label_DiscountName}" html-data-compare-value="{!qdm.baseParentRec.CustomReductionName3__c}" onblur="safetyLockCheck(this);"/>
                          <apex:outputLabel rendered="{!isReadOnly}" value="{!qdm.parentRec.CustomReductionName3__c}" styleClass="field-value customReductionTitle" html-placeholder="{!$Label.JEOL_QuotEdit_Label_DiscountName}" />
                          <apex:inputField rendered="{!!isReadOnly}" id="customReductionAcmount3" styleClass="field-value customReductionAmount number" value="{!qdm.parentRec.CustomReductionAmount3__c}" onchange="setTotalAmount();" html-data-compare-value="{!qdm.baseParentRec.CustomReductionAmount3__c}" onblur="safetyLockCheck(this);" />
                          <apex:outputText rendered="{!isReadOnly}" id="customReductionAcmount3Value" styleClass="field-value customReductionAmount number" value="{!qdm.parentRec.CustomReductionAmount3__c}" />
                        </div>
                        <div class="field" >
                          <apex:inputField rendered="{!!isReadOnly}" value="{!qdm.parentRec.TotalAmountName__c}" styleClass="field-value subtitleLabel" html-placeholder="{!$Label.JEOL_QuotEdit_Label_Subtotal}" html-data-compare-value="{!qdm.baseParentRec.TotalAmountName__c}" onblur="safetyLockCheck(this);" />
                          <apex:outputLabel rendered="{!isReadOnly}" value="{!qdm.parentRec.TotalAmountName__c}" styleClass="field-value subtitleLabel" html-placeholder="{!$Label.JEOL_QuotEdit_Label_Subtotal}" />
                          <apex:outputText styleClass="field-value quotationTotalAmountOutput number" value="{0,number, ###,###,###,###,###,###}" style="font-size: 13px;" >
                            <apex:param value="{!qdm.parentRec.TotalAmount__c}" />
                          </apex:outputText>
                          <div class="field-value" style="width: auto;">
                            <apex:inputCheckbox value="{!qdm.parentRec.OutputTotalAmount__c}" html-data-compare-value="{!qdm.baseParentRec.OutputTotalAmount__c}" onblur="safetyLockCheck(this);" /> <!--Modification-VAIB(2015/05/27 UAT_QA_List No.72) -->
                          </div>
                        </div>
                        <div class="field" >
                          <div class="field-label">
                            <apex:outputLabel for="quotationConsumptionTaxAmountOutput" value="{!$Label.JEOL_QuotEdit_Label_Tax}(" style="padding-right: 8px;" />
                            <apex:inputField rendered="{!!isReadOnly}" styleClass="field-value taxRate number" value="{!qdm.parentRec.TaxRate__c}" html-tabIndex="-1" onchange="calcurate();" html-data-compare-value="{!qdm.baseParentRec.TaxRate__c}" onblur="safetyLockCheck(this);" />
                            <apex:outputField rendered="{!isReadOnly}" styleClass="field-value taxRate number" value="{!qdm.parentRec.TaxRate__c}" />
                            <apex:outputText rendered="{!!isReadOnly}" value=" %)" style="padding-left: 8px;" />
                            <apex:outputText rendered="{!isReadOnly}" value=" )" style="padding-left: 8px;" />
                          </div>
                          <apex:outputText id="quotationConsumptionTaxAmountOutput" styleClass="field-value quotationConsumptionTaxAmountOutput number" value="{0,number, ###,###,###,###,###,###}" style="font-size: 13px;" >
                            <apex:param value="{!qdm.parentRec.ConsumptionTaxAmount__c}" />
                          </apex:outputText>
                          <div class="field-value" style="width: auto;">
                            <apex:inputCheckbox value="{!qdm.parentRec.OutputConsumptionTaxAmount__c}" styleClass="includeTaxOutput" html-data-compare-value="{!qdm.baseParentRec.OutputConsumptionTaxAmount__c}" onblur="safetyLockCheck(this);" /> <!--Modification-VAIB(2015/05/27 UAT_QA_List No.72) -->
                          </div>
                        </div>
                        <div class="field" >
                          <apex:inputField rendered="{!!isReadOnly}" value="{!qdm.parentRec.TotalTaxAmountName__c}" styleClass="field-value subtitleLabel" html-placeholder="{!$Label.JEOL_QuotEdit_Label_Total}" html-data-compare-value="{!qdm.baseParentRec.TotalTaxAmountName__c}" onblur="safetyLockCheck(this);" />
                          <apex:outputLabel rendered="{!isReadOnly}" value="{!qdm.parentRec.TotalTaxAmountName__c}" styleClass="field-value subtitleLabel" html-placeholder="{!$Label.JEOL_QuotEdit_Label_Total}" />
                          <apex:outputText styleClass="field-value quotationTotalTaxAmountOutput number" value="{0,number, ###,###,###,###,###,###}" style="font-size: 13px;" >
                            <apex:param value="{!qdm.parentRec.TotalTaxAmount__c}" />
                          </apex:outputText>
                          <div class="field-value" style="width: auto;">
                            <apex:inputCheckbox value="{!qdm.parentRec.OutputTotalTaxAmount__c}" styleClass="includeTaxOutput" html-data-compare-value="{!qdm.baseParentRec.OutputTotalTaxAmount__c}" onblur="safetyLockCheck(this);" /> <!--Modification-VAIB(2015/05/27 UAT_QA_List No.72) -->
                          </div>
                        </div>
                      </apex:outputPanel>
                    </div>
                    <div class="quotation-item quotation-note-area" >
                      <hr />
                      <div>
                        <apex:inputField rendered="{!!isReadOnly}" value="{!qdm.parentRec.TaxExemptionTextOutput__c}" id="isExcludeTax" onchange="changeTaxAmountOutput(this);" html-data-compare-value="{!qdm.baseParentRec.TaxExemptionTextOutput__c}" onblur="safetyLockCheck(this);"/>
                        <apex:inputcheckbox rendered="{!isReadOnly}" disabled="true" value="{!qdm.parentRec.TaxExemptionTextOutput__c}" tabIndex="-1" />
                        <apex:outputLabel for="isExcludeTax" value="{!$Label.JEOL_QuotEdit_Message_ShowTax}" />
                      </div>
                      <div class="quotation-item-body clearfix">
                        <div class="field">
                          <apex:outputLabel value="{!$Label.JEOL_QuotEdit_Label_Remarks}" for="note" styleClass="field-label" />
                          <apex:outputLabel rendered="{!isReadOnly}" escape="false" value="<br/>" />
                          <apex:inputField rendered="{!!isReadOnly}" id="note" styleClass="field-value note" value="{!qdm.parentRec.Note__c}" html-data-compare-value="{!qdm.baseParentRec.Note__c}" onblur="safetyLockCheck(this);" />
                          <apex:outputField rendered="{!isReadOnly}" id="noteView" styleClass="field-value note" value="{!qdm.parentRec.Note__c}" />
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <div class="section memo-area base-width" >
                <div class="section-body clearfix">
                  <div class="field panel">
                    <div class="panel-header">
                      <apex:outputLabel for="memo" value="{!$Label.JEOL_QuotEdit_Label_InternalMemo}" />
                    </div>
                    <hr />
                    <div class="panel-body">
                      <apex:inputField rendered="{!!isReadOnly}" id="memo" styleClass="field-value memo" value="{!qdm.parentRec.Memo__c}" html-data-compare-value="{!qdm.baseParentRec.Memo__c}" onblur="safetyLockCheck(this);" />
                      <apex:outputField rendered="{!isReadOnly}" id="memoView" styleClass="field-value memo" value="{!qdm.parentRec.Memo__c}" />
                    </div>
                  </div>
                </div>
              </div>
            </apex:outputPanel>
            <div class="footer">
              <apex:include pageName="{!$Page.JEOL_VisualforceFooter}" />
            </div>
            <style>
              .modal-dialog .modal-content {
                border: 2px solid #5e82b2;
                //overflow: hidden;
              }
              .modal-dialog.modal-alert .modal-content {
                border: 2px solid #e34b4b; 
              }
              #OutputPrintView .modal-dialog {width: 600px;}
              #wordSettingView .modal-dialog {width: 631px;}
              #detailImportView .modal-dialog {width: 1180px;}
              #detailProductItemView .modal-dialog {width: 882px;}
              #destinationPrintView .modal-dialog {width: 822px;}
              #certificatePrintView .modal-dialog {width: 822px;}
              #multiDeleteView .modal-dialog {width: 822px;}
              .modal-dialog .modal-content .modal-header {
                background: #5e82b2;
                background: -moz-linear-gradient(top,  #5e82b2 0%, #5575a1 100%);
                background: -webkit-gradient(linear, left top, left bottom, color-stop(0%,#5e82b2), color-stop(100%,#5575a1));
                background: -webkit-linear-gradient(top,  #5e82b2 0%,#5575a1 100%);
                background: -o-linear-gradient(top,  #5e82b2 0%,#5575a1 100%);
                background: -ms-linear-gradient(top,  #5e82b2 0%,#5575a1 100%);
                background: linear-gradient(to bottom,  #5e82b2 0%,#5575a1 100%);
                filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#5e82b2', endColorstr='#5575a1',GradientType=0 );
                text-shadow: -1px -1px #415b7c, 1px 1px #415b7c;
                font-size: 16px;
                font-weight: bold;
                color: #fff;
                border-bottom: none;
              }
              .modal-dialog.modal-alert .modal-content .modal-header {
                background: #e34b4b; /* Old browsers */
                background: -moz-linear-gradient(top,  #e34b4b 0%, #993737 100%); /* FF3.6+ */
                background: -webkit-gradient(linear, left top, left bottom, color-stop(0%,#e34b4b), color-stop(100%,#993737)); /* Chrome,Safari4+ */
                background: -webkit-linear-gradient(top,  #e34b4b 0%,#993737 100%); /* Chrome10+,Safari5.1+ */
                background: -o-linear-gradient(top,  #e34b4b 0%,#993737 100%); /* Opera 11.10+ */
                background: -ms-linear-gradient(top,  #e34b4b 0%,#993737 100%); /* IE10+ */
                background: linear-gradient(to bottom,  #e34b4b 0%,#993737 100%); /* W3C */
                filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#e34b4b', endColorstr='#993737',GradientType=0 ); /* IE6-9 */
              }
              .modal-dialog .modal-body {
              }
              .modal-body .search-area {
                padding-top: 0px;
                background-color: #becde0;
                border: none;
                padding: 8px;
                margin-bottom: 16px;
                position: relative;
              }
              .modal-dialog .modal-content .modal-body .search-area .toggle-button {
                width: 80px;
                height: 20px;
                border-radius: 0 0 6px 6px;
                border: 1px solid #7e9bc1;
                background-color: #ffffff;
                text-align: center;
                cursor: pointer;
                line-height: 20px;
                position: absolute;
                top: 100%;
                padding: 0px;
              }
              .modal-body .search-area .toggle-button:before {
                content: '▼';
              }
              .modal-body .search-area .collapse.in + .toggle-button:before {
                content: '▲';
              }
              .modal-body .search-area .section-body .field,
              .modal-body .search-area .section-body .field .field-value[type="text"] {
                width: 100%;
              }
              .modal-body .search-area .section-body .search-field {
                display: table;
                float: left;
              }
              .modal-body .search-area .section-body .search-field .field {
                display: table-row;
                float: none;
              }
              .modal-body .search-area .section-body .search-field .field .field-label,
              .modal-body .search-area .section-body .search-field .field .field-value[type="text"] {
                display: table-cell;
              } 
              .modal-body .search-area .section-body .search-field .field .field-label {
                width: 1%;
                min-width: 80px;
                white-space: nowrap;
              }
              .modal-body .search-area .section-body .search-field .field .field-value[type="text"] {
                width: 100%;
              }
              .modal-body .search-area .section-body .field.field-fitness,
              .modal-body .search-area .section-body .field.field-fitness .field-value {
                width: auto;
              }
              .modal-dialog .modal-body .errors {
                display: none;
              }
              .modal-dialog .modal-body .select-area {
                width: 100%;
              }
              .modal-dialog .modal-body .select-area>* {
                float: left;
              }
              .modal-dialog .modal-body .select-area:after {
                content: ".";
                display: block;
                height: 0px;
                overflow: hidden;
                clear: both;
              }
              .modal-dialog .modal-content .modal-body .select-area .item-list {
                width: 100%;
                height: 342px;
                overflow: auto;
              }
              .setting-row {
                width: 100%;
              }
              fieldset.setting-row {
                margin-top: 20px;
              }
              fieldset.setting-row legend {
                color: inherit;
                font-weight: normal;
                padding: 4px 8px;
              }
              .contents .modal-body .options-area .output-controls fieldset.setting-row .field .field-label {
                line-height: 30px;
                padding: 0px 8px;
              }
              
              .contents .modal-body .options-area .output-controls fieldset.setting-row .field .field-label,
              .contents .modal-body .options-area .output-controls fieldset.setting-row .field .field-value {
                height: 30px;
                vertical-align: middle;
              }
              .setting-row .word-text .field-value,
              .setting-row .word-text .field-label {
                font-size: 13px;
                text-align: left;
                width: 452px;
                margin-left: 8px; 
              }
              .setting-row .word-select-list .field-value,
              .setting-row .word-select-list .field-label {
                font-size: 13px;
                width: 116px;
                text-align: left;
              }
              .modal-dialog .modal-content .modal-body .select-area .table {
                display: table;
                width: 100%;
              }
              .modal-dialog .modal-content .modal-body #productCatalogTabPanel .select-area .table {
                width: 396px;
              }
              .modal-dialog .modal-content .modal-body .select-area .table .item {
                display: table-row;
                padding: 4px;
                border-radius: 2px;
                border: 1px solid #cccccc;
                //height: 58px;
                margin-top: -1px;
                user-select: none;
                -moz-user-select: none;
                -webkit-user-select: none;
                -ms-user-select: none;  
                cursor: pointer;
                overflow: hidden;
                background-color: #fff;
              }
              
              .modal-dialog .modal-content .modal-body .select-area .table .item:first-child {
                margin-top: 0px;
              }
              .modal-dialog .modal-content .modal-body .select-area .table .item:hover .field {
                border-top: 1px solid #00ABFF;
                border-color: #00ABFF;
                box-shadow: 0 1px 5px rgba(0,171,255,0.25);
                background-color: #fff;
                position: relative;
              }
              .modal-dialog .modal-content .modal-body .select-area .table .item:first-child:hover .field:first-child {
                border-left-color: #666;
              }
              .modal-dialog .modal-content .modal-body .select-area .table .item:hover .field:first-child {
                border-left-color: #00ABFF;
              }
              .modal-dialog .modal-content .modal-body .select-area .table .item:hover .field:last-child {
                border-right-color: #00ABFF;
              }
              .modal-dialog .modal-content .modal-body .select-area .table .item:last-child:hover .field {
                border-bottom-color: #00ABFF;
              }
              .modal-dialog .modal-content .modal-body .select-area .table .item .field.head {
                border-color: #666;
                box-shadow: none;
                background-color: #becde0;
                position: static;
                cursor: default;
              }
              .modal-dialog .modal-content .modal-body .select-area .item-list .table .item.selected .field {
                background-color: #00ABFF;
                color: #fff;
              }
              .modal-dialog .modal-content .modal-body .select-area .item-list .table .item.selected .field:first-child {
                border-left-color: #00ABFF;
              }
              .modal-dialog .modal-content .modal-body .select-area .table .item.selected:hover .field {
                background-color: #00ABFF;
                color: #fff;
              }
              .modal-dialog .modal-content .modal-body .select-area .table .item .field {
                display: table-cell;
                margin: 0;
                float:none;
                border: 1px solid #eee;
                border-left: none;
                border-top: none;
              }
              .modal-dialog .modal-content .modal-body .select-area .table .item:first-child .field {border-top: 1px solid #666;}
              .modal-dialog .modal-content .modal-body .select-area .table .item:last-child .field {border-bottom: 1px solid #666;}
              .modal-dialog .modal-content .modal-body .select-area .table .item .field:first-child {border-left: 1px solid #666;}
              .modal-dialog .modal-content .modal-body .select-area .table .item .field:last-child {border-right-color: #666;}

              .modal-dialog .modal-content .modal-body .select-area .table .item .field .field-label {
                font-size: 12px;
                padding: 0 8px;
                width: 80px;
                margin: 3px 0px;
                color: #999999;
              }
              .modal-dialog .modal-content .modal-body .select-area .table .item .field .field-value {
                font-size: 12px;
                margin-left: 4px;
                overflow: hidden;
                padding: 2px 8px;
                vertical-align: middle;
                white-space: nowrap;
                text-overflow: ellipsis;
                height: auto;
                line-height: normal;
                width: 100%;
              }
              .modal-dialog .modal-content .modal-body .select-area .table .item .field .field-value.number {
                text-align: right;
              }
              .modal-dialog .modal-content .modal-body #productCatalogTabPanel .select-area .tree {
                padding: 8px;
              }
              .modal-dialog .modal-content .modal-body #productCatalogTabPanel .select-area .selected-area .tree>.item {
                border: 1px solid #999;
                margin-top: -1px;
              }
              .modal-dialog .modal-content .modal-body #productCatalogTabPanel .select-area .selected-area .tree>.item:first-child {
                margin-top: 0px;
              }
              .modal-dialog .modal-content .modal-body #productCatalogTabPanel .select-area .tree .item {
                display: block;
                border-radius: 2px;
                user-select: none;
                -moz-user-select: none;
                -webkit-user-select: none;
                -ms-user-select: none;  
                cursor: pointer;
                background-color: #fff;
                padding-bottom: 4px;
              }
              .modal-dialog .modal-content .modal-body #productCatalogTabPanel .select-area .tree .item:after {
                content: "";
                display:block;
                width: 100%;
                height: 0px;
                clear: both;
              }
              .modal-dialog .modal-content .modal-body #productCatalogTabPanel .select-area .tree .item .tree-view {
                //float: left;
                width: 100%;
              }
              .modal-dialog .modal-content .modal-body #productCatalogTabPanel .select-area .tree .item .tree-view:hover {
                background-color: #ddd;
              }
              .modal-dialog .modal-content .modal-body #productCatalogTabPanel .select-area .tree .item[data-target]>.tree-view:before {
                display: inline-block;
                margin-right: 8px;
                background-image: url("{!URLFOR($Resource.JEOL_CustomizedMaterials, 'JEOL_CustomizedMaterials/images/folder.png')}");
                background-position: center center;
                background-size: contain;
                background-repeat: no-repeat;
                vertical-align: text-bottom;
                width: 20px;
                height: 20px;
                content: "";
              }
              .modal-dialog .modal-content .modal-body #productCatalogTabPanel .select-area .tree .item.open[data-target]>.tree-view:before {
                background-image: url("{!URLFOR($Resource.JEOL_CustomizedMaterials, 'JEOL_CustomizedMaterials/images/folder_open.png')}");
              }
              .modal-dialog .modal-content .modal-body #productCatalogTabPanel .select-area .tree .item .tree-fieldset {
                width: 100%;
                float: left;
                display: none;
              }
              .modal-dialog .modal-content .modal-body #productCatalogTabPanel .select-area .tree .item>.children {
                display: none;
                width: 100%;
                float: left;
                padding-left: 8px;
              }
              .modal-dialog .modal-content .modal-body #productCatalogTabPanel .select-area .tree .item>.children>.tree>.item:before {
                display: block;
                float: left;
                content: "┗";
                height: 20px;
                line-height: 20px;
                margin-right: 8px;
              }
              .modal-dialog .modal-content .modal-body #productCatalogTabPanel .select-area .tree .item.open>.children {
                display: block;
              }
              .modal-dialog .modal-content .modal-body #productCatalogTabPanel .select-area .tree .item.item-drag>.children {
                display: none;
              }
              #detailProductItemView[data-tab-target] [data-tab-panel] {
                display: none;
              }
              #detailProductItemView[data-tab-target="productItemSearch"] [data-tab-panel="productItemSearch"],
              #detailProductItemView[data-tab-target="catalogItemSearch"] [data-tab-panel="catalogItemSearch"] {
                display: block;
              }
              [data-tab-target] .tab-buttons {
                margin-top: 8px;
              }
              [data-tab-target] .tab-buttons .tab {
                position: relative;
                bottom: -2px;
                padding: 2px 16px;
                border: 1px solid #7e9bc1;
                border-bottom: none;
                background: none;
                color: #999;
                margin: 0px 4px;
                font-weight: normal;
                border-radius: 4px 4px 0px 0px;
                transition: color 0.3s ease 0s;
              }
              [data-tab-target] .tab-buttons .tab:hover,
              [data-tab-target] .tab-buttons .tab.active {
                padding: 4px 16px;
                bottom: 0px;
                background-color: #fff;
                color: #333;
              }
              [data-tab-target] .tab-panel {
                border: 1px solid #7e9bc1;
              }
              #detailProductItemView .section .detail-product-action-area,
              #detailImportView .section .quotation-detail-action-area {
                padding: 4px;
                float: right;
              }
              #detailProductItemView .section .detail-product-action-area:first-child,
              #detailImportView .section .quotation-detail-action-area:first-child {
                float: left;
              }
              #detailProductItemView .section .detail-product-action-area .title,
              #detailImportView .section .quotation-detail-action-area .title {
                width: auto;
                line-height: 40px;
              }
              #detailProductItemView .section .detail-product-action-area hr,
              #detailImportView .section .quotation-detail-action-area hr {
                float: left
              }
              #detailProductItemView .select-area .item-list,
              #detailProductItemView .select-area .selected-list {
                height: 348px;
              }
              #detailProductItemView .select-area .selected-list {
                float: right;
              }
              #detailProductItemView .section .detail-product-action-area,
              #detailProductItemView .select-area .item-list,
              #detailProductItemView .select-area .selected-list {
                width: 406px;
                overflow: auto;
              }
              #detailImportView .select-area .item-list,
              #detailImportView .select-area .detail-list,
              #detailImportView .select-area .list-separator {
                height: 348px;
              }
              #detailImportView .section .quotation-detail-action-area,
              #detailImportView .select-area .item-list,
              #detailImportView .select-area .detail-list {
                width: 47%;
              }
              #detailImportView .select-area .detail-list {
                overflow: auto;
              }
              #detailImportView .select-area .list-separator {
                width: 6%;
                overflow: hidden;
                position: relative;
              }
              
              #detailImportView .select-area .list-separator:before,
              #detailImportView .select-area .list-separator:after {
                content: " ";
                display: block;
                width: 20px;
                height: 70px;
                background-color: #ccc;
                position: absolute;
                margin: auto;
                top: 0px;
                left: 0px;
                right: 0px;
                bottom: 0px;
              }
              #detailImportView .select-area .list-separator:before {
                transform: rotate(-30deg) translate(11px, -24px);
                -moz-transform: rotate(-30deg) translate(11px, -24px);
                -webkit-transform: rotate(-30deg) translate(11px, -24px);
                -ms-transform: rotate(-30deg) translate(11px, -24px);
                border-radius: 0px 100% 0px 0px;
                -moz-border-radius: 0px 100% 0px 0px;
                -webkit-border-radius: 0px 100% 0px 0px;
                -ms-border-radius: 0px 100% 0px 0px;
              }
              #detailImportView .select-area .list-separator:after {
                transform: rotate(30deg) translate(11px, 24px);
                -moz-transform: rotate(30deg) translate(11px, 24px);
                -webkit-transform: rotate(30deg) translate(11px, 24px);
                -ms-transform: rotate(30deg) translate(11px, 24px);
                border-radius: 0px 0px 100% 0px;
                -moz-border-radius: 0px 0px 100% 0px;
                -webkit-border-radius: 0px 0px 100% 0px;
                -ms-border-radius: 0px 0px 100% 0px;
              }
              #detailImportView .select-area .item-list {
                float: left;
                border: 3px solid transparent;
              }
              #detailProductItemView .select-area .selected-list {
                border: 3px dashed #eee;
                border-radius: 4px;
                margin-left: 0px;
                float: right;
                overflow-y: auto;
                overflow-x: overlay;
              }
              #detailProductItemView .select-area .selected-list .drop-target:empty {
                display: block;
                line-height: 326px;
                margin: 0px;
                width: 400px;
                text-align: center;
                color: #aaa;
                //background-color: #fff;
                font-size: 120%;
              }
              #detailProductItemView .select-area .selected-list.drop-hover .drop-target:empty {
                color: #fff;
              }
              #detailProductItemView .select-area .selected-list .drop-target:empty:after {
                content: "ドラッグ ＆ ドロップ で選択可能です。";
                display: inline-block;
                *display: inline;
                *zoom: 1;
                width: 100%;
              }
              #detailProductItemView .select-area .selected-list.drop-active {
                background-color: #eee;
                border-color: #fff;
              }
              #detailProductItemView .select-area .selected-list.drop-hover {
                background-color: #becde0;
                border-color: #fff;
              }
              #detailProductItemView #productItemTabPanel .select-area .selected-list .item {
                position: relative;
                top: 0px;
                box-shadow: 0px -1px 3px -1px rgba(0,0,0,0.4);
                transition: height 0.2s linear 0s;
              }
              #detailProductItemView .item-drag {
                width: 402px;
              }
              .modal-dialog .modal-content .modal-footer {
                overflow: hidden;
              }
              .modal-body .customButton {
                width: 100%;
              }
              .modal-dialog .modal-content .modal-footer .button-area {
                overflow: hidden;
                float: left;
              }
              .modal-dialog .modal-content .modal-footer .button-area.right {
                float: right;
              }
              .modal-dialog .modal-content .modal-footer .button-area .customButton {
                float: left;
                width: 120px;
                margin-left: 8px;
              }
              .modal-dialog .modal-content .modal-footer .button-area .customButton:first-child {
                margin-left: 0px;
              }
              .modal-dialog .modal-content .modal-body .section .title,
              .modal-dialog .modal-content .modal-body .section .header {
                width: 100%;
                float: left;
              }
              
              .modal-dialog .modal-content .modal-body .title {
                font-size: 15px;
                margin: 12px 0px;
              }
              #OutputPrintView .modal-dialog .modal-content .modal-body .options-area .output-controls .field{
                width: 154px;
              }
              .modal-dialog .modal-content .modal-body .options-area .output-settings .field .field-label,
              .modal-dialog .modal-content .modal-body .options-area .output-settings .field .field-value,
              .modal-dialog .modal-content .modal-body .options-area .output-controls .field .field-label,
              .modal-dialog .modal-content .modal-body .options-area .output-controls .field .field-value {
                font-size: 13px;
                padding: 4px 8px 4px 8px;
              }
              .modal-dialog .modal-content .modal-body .options-area .output-settings .field .field-value {
                width: 80px;
              }
              .modal-dialog .modal-content .modal-body .options-area .output-controls .field .field-label {
                width: 112px;
              }
              .modal-dialog .modal-content .item-loading {
                background-color: #ffffff;
                position: absolute;
                opacity: 0.7;
                filter: alpha(opacity=70);
                left: 0;
                top: 0;
                height: 100%;
                width: 100%;
                z-index: 100;
              }
              .customButton.doCancel {
                width: 100px;
                float: left;
              }
              .customButton.doDelete {
                float: left;
                width: 120px;
                color: #7F2D2D;
                border-color: #FF6B6B;
                margin-left: 12px;
                margin-right: 12px;
                text-shadow: none;
              }
              .customButton.doDelete:focus,
              .customButton.doDelete:hover {
                background-color: #E34B4B;
                color: #fff;
                border-color: #E21F1F;
              }
              .customButton.doDelete:active {
                box-shadow: 0px 1px 3px rgba(0,0,0,0.70) inset;
              }
              .customButton.doSave {
                width: 120px;
                float: right;
              }
              .customButton.doOutput {
                width: 120px;
                color: #3D6951;
                border-color: #16874A;
                text-shadow: none;
                margin-left: 8px;
                float: right;
              }
              .customButton.doOutput:hover {
                background-color: #4CB47C;
                color: #fff;
                border-color: #16874A;
              }
              .customButton.doOutput:active {
                background-color: #309F64;
              }
              .customButton.doPreview {
                float: right;
                width: 120px;
                margin-left: 8px;
              }
              .alert {
                top: 10px;
                display: none;
                position: fixed;
                text-align: center;
                width: 100%;
                opacity: 0;
                transition: top 0.4s ease-out 0s, opacity 0.4s ease-out 0s;
                z-index: 2000;
              }
              .alert p {
                display: inline-block;
                *display: inline;
                *zoom: 1;
                white-space: nowrap;
                border: 1px solid #FFF100;
                background-color: #FFFBC6;
                border-radius: 2px;
                box-shadow: 0px 2px 3px 1px rgba(0,0,0,0.4);
                padding: 2px 30px;
              }
              .field .radio-item {
                float: left;
              }
              .field-value.master-accountCode {
                width: 72px;
              }
              .field-value.master-contactName,
              .field-value.master-contactPhone,
              .field-value.master-contactBelong,
              .field-value.master-contactPost {
                width: 108px;
              }
              .field-value.master-accountName {
                width: 158px;
              }
              .field-value.master-accountAddress {
                width: 320px;
              }
              .field-value.master-quoteId {
                display: none;
              }
              #destinationPrintView .modal-dialog .modal-content .modal-body .section .output-controls .field {
                width: auto;
              }
              
              .guide-destinationNameTitle {
                width: 80px;
              }
              .guide-destinationAccountCode,
              .guide-destinationPostalCode {
                width: 126px;
              }
              .field .guide-destinationGuideDate {
                width: 100px;
              }
              
              .guide-destinationName,
              .guide-destinationBelong,
              .guide-destinationPersonInCharge {
                width: 180px;
              }
              .guide-destinationAccountName,
              .guide-destinationUndergraduate {
                width: 398px;
              }
              .guide-destinationGuideSubject,
              .guide-destinationAddress {
                width: 637px;
              }
              
              .modalDetailList col.checkbox {width: 46px;}
              .modalDetailList col.productCode {width: 122px;}
              .modalDetailList col.body {width: 400px;}
              .modalDetailList col.amount {width: 200px;}
              .modalDetailList {
                width: 100%;
                table-layout: fixed;
                border-collapse: collapse;
              }
              .modalDetailList tr th,
              .modalDetailList tr td {
                vertical-align: middle;
                border: 1px solid #ccc;
                overflow: hidden;
              }
              .modalDetailList tr th div.field,
              .modalDetailList tr td div.field {
                float: none;
                width: 100%;
              }
              .modalDetailList tr td div.field .field-value.center,
              .modalDetailList tr th div.field .field-label.center {
                text-align: center;
              }
              .modalDetailList tr td div.field .field-value.right,
              .modalDetailList tr th div.field .field-label.right {
                text-align: right;
              }
              .modalDetailList tr th div.field .field-label,
              .modalDetailList tr td div.field .field-value {
                text-align: left;
                padding: 2px 8px;
                white-space: nowrap;
                text-overflow: ellipsis;
                overflow: hidden;
                border: none;
                height: auto;
                width: 100%;
              }
              .modalDetailList tr[data-type="3"] {background-color:#d9edeb;}
              .modalDetailList tr[data-type="4"] {background-color:#F9E4EC;}
              .modalDetailList tr[data-type="5"] {background-color:#abcdef;}
              .modalDetailList tr[data-depth] td div.field .field-value.body:before {content:"&#9493;";padding-right: 4px;color:#ccc;}
              .modalDetailList tr[data-depth="0"] td div.field .field-value.body:before {content:""}
              
              .modalDetailList tr[data-depth="1"] td div.field .field-value {padding-left: 16px;}
              .modalDetailList tr[data-depth="2"] td div.field .field-value {padding-left: 24px;}
              .modalDetailList tr[data-depth="3"] td div.field .field-value {padding-left: 32px;}
              .modalDetailList tr[data-depth="4"] td div.field .field-value {padding-left: 40px;}
              .modalDetailList tr[data-depth="5"] td div.field .field-value {padding-left: 48px;}

              .search-field-quotation-createdDate {
                  margin-left: 4px;
              }

                table.delete_table td {
                  width:100px;
                  text-align:center;
                  vertical-align:middle;
                }
                table.delete_table tr {
                }
                table.delete_table tr.todelete {
                  background-color:#999;
                }
            </style>
            <script>
$j(function () {
 
  
  $j(document)
    .mouseup(function () {
      isMouseDown = false;
    });
});

            </script>            
            <div id="alert" class="alert">
              <p class="description" ></p>
            </div>
            <div class="modal fade" id="wordSettingView" data-backdrop="static" tabindex="-1" role="dialog" aria-labelledby="wordSetting" aria-hidden="true">
              <div class="modal-dialog">
                <div class="modal-content">
                  <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                      <span aria-hidden="true">&times;</span>
                    </button>
                    <div id="wordSetting" class="screen-name">個人設定</div>
                  </div>
                  <apex:outputPanel layout="block" id="wordSettingContent"  styleClass="modal-body">
                    <div class="section word-setting-area">
                      <div class="title" style="float: none;">
                        <span>見積書出力設定</span>
                      </div>
                      <div class="setting-row clearfix">
                        <div class="field word-select-list">
                          <div class="field-label ">デフォルト設定</div>
                        </div>
                        <div class="field word-text">
                          <div class="field-label ">文言</div>
                        </div>
                      </div>
                      <div class="setting-row clearfix">
                        <div class="field word-select-list">
                          <apex:inputField value="{!userSetting.WordSettingDefaultDisplay1__c}" styleClass="field-value " required="true"/>
                        </div>
                        <div class="field word-text">
                          <apex:inputField value="{!userSetting.Word1__c}" styleClass="field-value " />
                        </div>
                      </div>
                      <div class="setting-row clearfix">
                        <div class="field word-select-list">
                          <apex:inputField value="{!userSetting.WordSettingDefaultDisplay2__c}" styleClass="field-value" required="true" />
                        </div>
                        <div class="field word-text">
                          <apex:inputField value="{!userSetting.Word2__c}" styleClass="field-value " />
                        </div>
                      </div>
                      <div class="setting-row clearfix">
                        <div class="field word-select-list">
                          <apex:inputField value="{!userSetting.WordSettingDefaultDisplay3__c}" styleClass="field-value " required="true" />
                        </div>
                        <div class="field word-text">
                          <apex:inputField value="{!userSetting.Word3__c}" styleClass="field-value " />
                        </div>
                      </div>
                      <hr/>
                      <div class="title" style="float: none;">
                        <span>品目検索初期値</span>
                      </div>
                      <div class="setting-row clearfix">
                        <div class="field">
                          <apex:outputLabel styleClass="field-label" value="品目区分"/>
                          <apex:inputField value="{!userSetting.ProductDivision__c}" styleClass="field-value" required="true" />
                        </div>
                      </div>
                      <hr/>
                      <div class="title" style="float: none;">
                        <span>見積出力</span>
                      </div>
                      <div class="setting-row clearfix">
                        <div class="field">
                          <apex:outputLabel styleClass="field-label" value="明細数量の整数表示" style="width: auto;"/>
                          <apex:inputField value="{!userSetting.IsDisplayDecimal__c}" required="true" />
                        </div>
                      </div>







                      <div class="section options-area clearfix">
                        <div class="output-settings clearfix">
                          <div class="field header">
                            <span>・{!$Label.JEOL_QuotEdit_Label_ViewSettings}</span>
                          </div>

                          <!-- 西暦/和暦 -->
                          <div class="field">
                            <apex:OutputLabel value="{!$Label.JEOL_QuotEdit_Label_Calendar}" styleclass="field-label" style="width: 80px;" />

                            <apex:selectList value="{!userSetting.CalendarExpress__c}"
                                             size="1" 
                                             styleclass="field-value"
                                             style="{!IF(language <> 'ja', 'width: 100px;', 'width: 65px;')}">
                              <apex:selectOptions value="{!CalendarExpressOptions}" />
                            </apex:selectList>
                          </div>

                          <!-- 客先表示 -->
                          <div class="field" >
                            <apex:OutputLabel value="{!$Label.JEOL_QuotEdit_Label_Attention}" styleclass="field-label" style="width: 78px;" />
                            <apex:selectList value="{!userSetting.CustomerExpress__c}"
                                             size="1" 
                                             styleclass="field-value"
                                             style="width: 79px;" >
                              <apex:selectOptions value="{!CustomerExpressOptions}" />
                            </apex:selectList>
                          </div>

                          <div class="field" >
                            <apex:OutputLabel value="{!$Label.JEOL_QuotEdit_Label_Messrs}"
                                              styleclass="field-label"
                                              rendered="{!!(language <> 'ja')}"
                                              style="width: 50px;"/>
                            <apex:Inputfield value="{!userSetting.Addressee__c}"
                                             styleclass="field-value"
                                             rendered="{!!(language <> 'ja')}"
                                             style="width: 72px;"/>
                          </div>
                          <div class="field" >
                            <apex:OutputLabel value="{!$Label.JEOL_QuotEdit_Label_Messrs2}"
                                              styleclass="field-label"
                                              rendered="{!!(language <> 'ja')}"
                                              style="width: 52px;"/>
                            <apex:Inputfield value="{!userSetting.Addressee2__c}"
                                             styleclass="field-value"
                                             rendered="{!!(language <> 'ja')}"
                                             style="width: 72px;"/>
                          </div>
                        </div>
                        <hr />
                        <div class="output-controls clearfix">
                          <div  class="field header">
                            <span>・{!$Label.JEOL_QuotEdit_Label_ViewControls}</span>
                          </div>
                          <div class="field" style="width: 100%;float: left;">
                            

  <div style="width: 154px;max-width: 154px;height: 30px;float: left;vertical-align:top;margin-top: 4px;">
                            <apex:OutputLabel value="{!$Label.JEOL_QuotEdit_Label_HandlingDepartment}" styleclass="field-label" />
                            <apex:Inputfield value="{!userSetting.DepartmentOutput__c}">
                              <apex:actionsupport rerender="useroverdepartment,useroverdepartmentbtn,useroverrideDepartmentText,useroverrideDepartmentTextBtn,apexMessage" event="onchange" status="useroverrideDepartmentTextProcessing"/>
                            </apex:Inputfield>
  </div>


                              <div class="field" data-type="dropdown">
                                <apex:inputText id="useroverdepartment"
                                                html-data-type="input-field"
                                                styleClass="field-value department"
                                                value="{!userSetting.OverrideDepartmentCode__c}" disabled="{!!userSetting.DepartmentOutput__c}" onchange="this.value=transformInputText(this.value);"
                                                onfocus="openSearchToggleButton(this);"/>
                                <apex:commandLink action="{!useroverDepartmentInfoAttachment}"
                                                  title="コード検索"
                                                  styleClass="productSearchButton"
                                                  rerender="useroverDptName,apexMessage"
                                                  status="useroverrideDepartmentTextProcessing" >
                                  <span class="refresh-icon"></span>
                                </apex:commandLink>
                                <apex:outputPanel id="useroverdepartmentbtn">
                                <button type="button" data-type="button" onclick="{!IF(userSetting.DepartmentOutput__c,'dorpdownAction(this);','')}">▼</button>
                              </apex:outputPanel>
                                <ul class="scroll" data-type="list" style="top: 30px;" >
                                  <apex:repeat value="{!DepartmentOptions}" var="option">
                                    <li data-type="item" data-value="{!option.value}" >
                                      <apex:commandLink action="{!useroverDepartmentInfoAttachment}" onclick="setInputField(this);" rerender="useroverDptName,apexMessage" status="useroverrideDepartmentTextProcessing" >
                                        <apex:outputText value="{!option.label}" />
                                      </apex:commandLink>
                                    </li>
                                  </apex:repeat>
                                </ul>
                                
                              </div>
                              <apex:outputPanel layout="block" styleClass="field" style="margin-left: 8px;">
                                <apex:outputText id="useroverDptName" value="{!userSetting.OverrideDepartmentName__c}" styleClass="field-value" style="width: 225px; display: block;overflow: hidden;white-space: nowrap;text-overflow: ellipsis;"/>
                              </apex:outputPanel>


                          <div style="width: 154px;max-width: 154px;height: 30px;float: left;vertical-align:top;margin-top: 4px;">
                            <apex:OutputLabel value="{!$Label.JEOL_QuotEdit_Label_Area}" styleclass="field-label" />
                          </div>

                          <apex:outputPanel layout="block" styleClass="field" html-data-type="dropdown">
                            <apex:InputText id="useroverrideDepartmentText"
                                            html-data-type="input-field"
                                            styleClass="field-value salesAreaBis"
                                            value="{!userSetting.OverrideDepartmentOutputText__c}"
                                            disabled="{!!userSetting.DepartmentOutput__c}"
                                            onchange="this.value=transformInputText(this.value);"
                                            onfocus="openSearchToggleButton(this);" />
                            <apex:commandLink action="{!usersalesAreaAttachmentBis}"
                                              title="コード検索"
                                              styleClass="productSearchButton"
                                              rerender="useroverrideDepartmentText"
                                              status="useroverrideDepartmentTextProcessing" >
                              <span class="refresh-icon"></span>
                            </apex:commandLink>
                                <apex:outputPanel id="useroverrideDepartmentTextBtn">
                            <button type="button" data-type="button" onclick="{!IF(userSetting.DepartmentOutput__c,'dorpdownAction(this);','')}">▼</button>
                                </apex:outputPanel>
                            <ul class="scroll" data-type="list" style="top: 30px;">
                              <apex:repeat value="{!SalesAreaOptions}" var="option">
                                <li data-type="item" data-value="{!option.label}" >
                                  <apex:commandLink action="{!usersalesAreaAttachmentBis}"
                                                    onclick="setInputField(this);"
                                                    rerender="useroverrideDepartmentText"
                                                    status="useroverrideDepartmentTextProcessing" >
                                    <apex:outputText value="{!option.label}" />
                                  </apex:commandLink>
                                </li>
                              </apex:repeat>
                            </ul>
                          </apex:outputPanel>

                          </div>

                          <!-- 代表者名出力 -->
                          <div class="field" style="{!IF(language <> 'ja', 'width: 180px;', 'width: 154px;')}">
                            <apex:OutputLabel value="{!$Label.JEOL_QuotEdit_Label_PersonInChargeOutput}" styleclass="field-label" style="{!IF(language <> 'ja', 'width: 140px;', '')}" />
                            <apex:Inputfield value="{!userSetting.RepresentativeNameExpress__c}" />
                          </div>

                          <!-- 問合せ先出力 -->
                          <div class="field" style="{!IF(language <> 'ja', 'width: 180px;', 'width: 154px;')}">
                            <apex:OutputLabel value="{!$Label.JEOL_QuotEdit_Label_InquiriesContact}" styleclass="field-label" style="{!IF(language <> 'ja', 'width: 140px;', '')}"/>
                            <apex:Inputfield value="{!userSetting.ReferenceExpress__c}" />
                          </div>

                          <!-- 単価出力 -->
                          <div class="field" style="{!IF(language <> 'ja', 'width: 180px;', 'width: 154px;')}">
                            <apex:OutputLabel value="{!$Label.JEOL_QuotEdit_Label_UnitPriceOutput}" styleclass="field-label" style="{!IF(language <> 'ja', 'width: 140px;', '')}"/>
                            <apex:Inputfield value="{!userSetting.PriceExpress__c}" />
                          </div>

                          <!-- 品目No.出力 -->
                          <div class="field" style="{!IF(language <> 'ja', 'width: 180px;', 'width: 154px;')}">
                            <apex:OutputLabel value="{!$Label.JEOL_QuotEdit_Label_ItemListNo}" styleclass="field-label" style="{!IF(language <> 'ja', 'width: 140px;', '')}" />
                            <apex:Inputfield value="{!userSetting.ProductCodeExpress__c}" />
                          </div>

                          <!-- 本体号機出力 -->
                          <div class="field" style="{!IF(language <> 'ja', 'width: 180px;', 'width: 154px;')}">
                            <apex:OutputLabel value="{!$Label.JEOL_QuotEdit_Label_UnitBodyOutput}" styleclass="field-label" style="{!IF(language <> 'ja', 'width: 140px;', '')}"/>
                            <apex:Inputfield value="{!userSetting.UnitbodyExpress__c}" />
                          </div>

                          <!--見積名称出力 -->
                          <div class="field" style="{!IF(language <> 'ja', 'width: 180px;', 'width: 154px;')}">
                            <apex:OutputLabel value="{!$Label.JEOL_QuotEdit_Label_QuotationTitleOutput}" styleclass="field-label" style="{!IF(language <> 'ja', 'width: 140px;', '')}" />
                            <apex:Inputfield value="{!userSetting.QuotationNameExpress__c}" />
                          </div>

                          <!-- 支店連絡先出力 -->
                          <div class="field" style="{!IF(language <> 'ja', 'width: 180px;', 'width: 154px;')}">
                            <apex:OutputLabel value="{!$ObjectType.UserSetting__c.fields.BranchTelephoneFaxExpress__c.Label}" styleclass="field-label" style="{!IF(language <> 'ja', 'width: 140px;', '')}" />
                            <apex:Inputfield value="{!userSetting.BranchTelephoneFaxExpress__c}" />
                          </div>

                        </div>
                      </div>




                      <hr/>
                      <div class="title" style="float: none;">
                        <span>明細項目初期設定</span>
                      </div>
                      <div class="setting-row clearfix">
                        <div class="field">
                          <apex:outputLabel styleClass="field-label" value="{!$ObjectType.UserSetting__c.fields.DefaultRowsItems__c.label}" style="width: 80pt;"/>
                          <apex:input value="{!inputDefaultRowsItems}" styleClass="field-value" />
                        </div>
                      </div>
                      <div class="setting-row clearfix">
                        <div class="field">
                          <apex:outputLabel styleClass="field-label" value="{!$ObjectType.UserSetting__c.fields.DefaultRowsHeading__c.label}" style="width: 80pt;"/>
                          <apex:input value="{!inputDefaultRowsHeading}" styleClass="field-value" />
                        </div>
                      </div>
                      <div class="setting-row clearfix">
                        <div class="field">
                          <apex:outputLabel styleClass="field-label" value="{!$ObjectType.UserSetting__c.fields.DefaultRowsSubItems__c.label}" style="width: 80pt;"/>
                          <apex:input value="{!inputDefaultRowsSubItems}" styleClass="field-value" />
                        </div>
                      </div>
                      
                    </div>
                  </apex:outputPanel>
                  <div class="modal-footer">
                    <div class="button-area right">
                      <apex:commandLink onclick="$j('#wordSettingView .modal-content').addClass('ajax-loading');" action="{!userSettingSave}" styleclass="customButton" oncomplete="$j('#wordSettingView .modal-content').removeClass('ajax-loading');$j('#wordSettingView').modal('hide');showResult('個人設定の更新が完了しました。');" rerender="wordSettingContent" value="保存" />
                      <button type="button" class="customButton" onclick="$j('#wordSettingView').modal('hide');">キャンセル</button>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <div class="modal fade" id="OutputPrintView" data-backdrop="static" tabindex="-1" role="dialog" aria-labelledby="OutputPrint" aria-hidden="true">
              <div class="modal-dialog">
                <div class="modal-content">
                  <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                      <span aria-hidden="true">&times;</span>
                    </button>
                    <div id="OutputPrint" class="screen-name">{!$Label.JEOL_QuotEdit_Label_OutputQuotation}</div>
                  </div>
                  <apex:outputPanel layout="block" styleClass="modal-body" id="outputSetting">
                    <div class="section standard-info-area clearfix">
                      <div class="title">
                        <span>{!$Label.JEOL_QuotEdit_Label_OutputSettings}</span>
                      </div>
                      <div class="field">
                        <apex:OutputLabel value="{!$Label.JEOL_QuotEdit_Label_QuotationNo}" styleclass="field-label" style="{!IF(language <> 'ja', 'width: 120px;', '')}" />
                        <apex:Outputfield value="{!qdm.parentRec.QuoteNo__c}" styleclass="field-value"/>
                      </div>
                      <div class="field" >
                        <apex:OutputLabel value="{!$Label.JEOL_QuotEdit_Label_BranchNo}" styleclass="field-label" style="{!IF(language <> 'ja', 'width: 130px;', '')}" />
                        <apex:Outputfield value="{!qdm.parentRec.BranchNo__c}" styleclass="field-value"/>
                      </div>
                          <apex:actionStatus layout="inline"  id="overrideDepartmentTextProcessing" >
                            <apex:facet name="start">
                              <div style="display: inline-block; *display: inline; *zoom: 1; line-height: 30px; margin-left: 108px; color: #22816b;">{!$Label.JEOL_QuotEdit_Label_Searching}</div>
                            </apex:facet>
                          </apex:actionStatus>
                    </div>
                    <div class="section options-area clearfix">
                      <div class="title">
                        <apex:OutputLabel value="{!$Label.JEOL_QuotEdit_Label_OutputOptions}" styleclass="field-label" style="width:130px"/>
                      </div>
                      <div class="output-settings clearfix">
                        <div class="field header">
                          <span>・{!$Label.JEOL_QuotEdit_Label_ViewSettings}</span>
                        </div>

                        <!-- 西暦/和暦 -->
                        <div class="field">
                          <apex:OutputLabel value="{!$Label.JEOL_QuotEdit_Label_Calendar}" styleclass="field-label" style="width: 80px;" />

                          <apex:selectList id="CalendarExpress1"
                                           value="{!CalendarExpress1}"
                                           html-data-compare-value="{!qdm.baseParentRec.CalendarExpress__c}" 
                                           size="1" 
                                           styleclass="field-value"
                                           style="{!IF(language <> 'ja', 'width: 100px;', 'width: 65px;')}"
                                           onblur="safetyLockCheck(this);">
                            <apex:selectOptions value="{!CalendarExpressOptions}" />
                            <apex:actionSupport event="onchange" action="{!setCalendarExpress1}" reRender="CalendarExpress1,CalendarExpress2" status="overrideDepartmentTextProcessing"/>
                          </apex:selectList>
                        </div>


                        <!-- 客先表示 -->
                        <div class="field" >
                          <apex:OutputLabel value="{!$Label.JEOL_QuotEdit_Label_Attention}" styleclass="field-label" style="width: 78px;" />
                          <apex:selectList id="CustomerExpress1"
                                           value="{!CustomerExpress1}"
                                           html-data-compare-value="{!qdm.baseParentRec.CustomerExpress__c}" 
                                           size="1" 
                                           styleclass="field-value"
                                           style="width: 79px;" 
                                           onblur="safetyLockCheck(this);">
                            <apex:selectOptions value="{!CustomerExpressOptions}" />
                            <apex:actionSupport event="onchange" action="{!setCustomerExpress1}" reRender="CustomerExpress1,CustomerExpress2" status="overrideDepartmentTextProcessing"/>
                          </apex:selectList>
                        </div>

                        <div class="field" >
                          <apex:OutputLabel value="{!$Label.JEOL_QuotEdit_Label_Messrs}" styleclass="field-label" rendered="{!!(language <> 'ja')}" style="width: 50px;"/>
                          <apex:Inputfield value="{!qdm.parentRec.Addressee__c}" styleclass="field-value" html-data-compare-value="{!qdm.baseParentRec.Addressee__c}" onblur="safetyLockCheck(this);" rendered="{!!(language <> 'ja')}" style="width: 72px;"/>
                        </div>
                        <div class="field" >
                          <apex:OutputLabel value="{!$Label.JEOL_QuotEdit_Label_Messrs2}" styleclass="field-label" rendered="{!!(language <> 'ja')}" style="width: 52px;"/>
                          <apex:Inputfield value="{!qdm.parentRec.Addressee2__c}" styleclass="field-value" html-data-compare-value="{!qdm.baseParentRec.Addressee2__c}" onblur="safetyLockCheck(this);" rendered="{!!(language <> 'ja')}" style="width: 72px;"/>
                        </div>
                      </div>
                      <hr />
                      <div class="output-controls clearfix">
                        <div  class="field header">
                          <span>・{!$Label.JEOL_QuotEdit_Label_ViewControls}</span>
                        </div>
                        <div class="field" style="width: 100%;float: left;">
                          
<!--                          <apex:inputText id="DestsalesAreaCode" html-data-type="input-field"  styleClass="field-value salesAreaCode" value="{!qdm.parentRec.SalesAreaCode__c}" html-data-compare-value="{!qdm.baseParentRec.SalesAreaCode__c}" onchange="this.value=transformInputText(this.value);" onfocus="openSearchToggleButton(this);" onblur="safetyLockCheck(this);" /> -->

<div style="width: 154px;max-width: 154px;height: 30px;float: left;vertical-align:top;margin-top: 4px;">
                          <apex:OutputLabel value="{!$Label.JEOL_QuotEdit_Label_HandlingDepartment}" styleclass="field-label" />
                          <apex:Inputfield value="{!qdm.parentRec.DepartmentOutput__c}" html-data-compare-value="{!qdm.baseParentRec.DepartmentOutput__c}" onblur="safetyLockCheck(this);" >
                            <apex:actionsupport rerender="overdepartment,overdepartmentbtn,overrideDepartmentText,overrideDepartmentTextBtn,apexMessage" event="onchange" status="overrideDepartmentTextProcessing"/>
                          </apex:Inputfield>
</div>


                            <div class="field" data-type="dropdown">
                              <apex:inputText id="overdepartment" html-data-type="input-field" styleClass="field-value department" value="{!qdm.parentRec.OverrideDepartmentCode__c}" disabled="{!!qdm.parentRec.DepartmentOutput__c}" html-data-compare-value="{!qdm.baseParentRec.OverrideDepartmentCode__c}" onchange="this.value=transformInputText(this.value);" onfocus="openSearchToggleButton(this);" onblur="safetyLockCheck(this);" />
                              <apex:commandLink action="{!overDepartmentInfoAttachment}" title="コード検索" styleClass="productSearchButton" rerender="overDptName,apexMessage" status="overrideDepartmentTextProcessing" >
                                <span class="refresh-icon"></span>
                              </apex:commandLink>
                              <apex:outputPanel id="overdepartmentbtn">
                              <button type="button" data-type="button" onclick="{!IF(qdm.parentRec.DepartmentOutput__c,'dorpdownAction(this);','')}">▼</button>
                            </apex:outputPanel>
                              <ul class="scroll" data-type="list" style="right: 27px;top: 30px;" >
                                <apex:repeat value="{!DepartmentOptions}" var="option">
                                  <li data-type="item" data-value="{!option.value}" >
                                    <apex:commandLink action="{!overDepartmentInfoAttachment}" onclick="setInputField(this);" rerender="overDptName,apexMessage" status="overrideDepartmentTextProcessing" >
                                      <apex:outputText value="{!option.label}" />
                                    </apex:commandLink>
                                  </li>
                                </apex:repeat>
                              </ul>
                              
                            </div>
                            <apex:outputPanel layout="block" styleClass="field" style="margin-left: 8px;">
                              <apex:outputText id="overDptName" value="{!qdm.parentRec.OverrideDepartmentName__c}" styleClass="field-value" style="width: 225px; display: block;overflow: hidden;white-space: nowrap;text-overflow: ellipsis;"/>
                            </apex:outputPanel>


                        <!--
                        <apex:outputPanel id="DestSalesAreaCodeField" layout="block" styleClass="field" style="margin-left: 154px;width: 300px;" html-data-type="dropdown">
                        -->

                        <!-- Added "地域" label and changed the style by mkubomura 20150821 -->                       
                        <div style="width: 154px;max-width: 154px;height: 30px;float: left;vertical-align:top;margin-top: 4px;">
                          <apex:OutputLabel value="{!$Label.JEOL_QuotEdit_Label_Area}" styleclass="field-label" />
                        </div>

                        <apex:outputPanel id="DestSalesAreaCodeField" layout="block" styleClass="field" html-data-type="dropdown">
                          <apex:InputText id="overrideDepartmentText" html-data-type="input-field"  styleClass="field-value salesAreaBis" value="{!qdm.parentRec.OverrideDepartmentOutputText__c}" disabled="{!!qdm.parentRec.DepartmentOutput__c}" html-data-compare-value="{!qdm.baseParentRec.OverrideDepartmentOutputText__c}" onchange="this.value=transformInputText(this.value);" onfocus="openSearchToggleButton(this);" onblur="safetyLockCheck(this);" />
                          <apex:commandLink action="{!salesAreaAttachmentBis}" title="コード検索" styleClass="productSearchButton" rerender="overrideDepartmentText" status="overrideDepartmentTextProcessing" >
                            <span class="refresh-icon"></span>
                          </apex:commandLink>
                              <apex:outputPanel id="overrideDepartmentTextBtn">
                          <button type="button" data-type="button" onclick="{!IF(qdm.parentRec.DepartmentOutput__c,'dorpdownAction(this);','')}">▼</button>
                              </apex:outputPanel>
                          <ul class="scroll" data-type="list" style="right: 27px;top: 30px;">
                            <apex:repeat value="{!SalesAreaOptions}" var="option">
                              <li data-type="item" data-value="{!option.label}" >
                                <apex:commandLink action="{!salesAreaAttachmentBis}" onclick="setInputField(this);" rerender="overrideDepartmentText" status="overrideDepartmentTextProcessing" >
                                  <apex:outputText value="{!option.label}" />
                                </apex:commandLink>
                              </li>
                            </apex:repeat>
                          </ul>
                        </apex:outputPanel>


                        </div>

                        <!-- 代表者名出力 -->
                        <div class="field" style="{!IF(language <> 'ja', 'width: 180px;', '')}">
                          <apex:OutputLabel value="{!$Label.JEOL_QuotEdit_Label_PersonInChargeOutput}" styleclass="field-label" style="{!IF(language <> 'ja', 'width: 140px;', '')}" />
                          <apex:InputCheckbox id="ReprNameExpress1" value="{!ReprNameExpress1}" html-data-compare-value="{!qdm.baseParentRec.RepresentativeNameExpress__c}" onblur="safetyLockCheck(this);" >
                            <apex:actionSupport event="onchange" action="{!setReprNameExpress1}" reRender="ReprNameExpress1,ReprNameExpress2,ReprNameExpress3" status="overrideDepartmentTextProcessing"/>
                          </apex:InputCheckbox>
                        </div>

                        <!-- 問合せ先出力 -->
                        <div class="field" style="{!IF(language <> 'ja', 'width: 180px;', '')}">
                          <apex:OutputLabel value="{!$Label.JEOL_QuotEdit_Label_InquiriesContact}" styleclass="field-label" style="{!IF(language <> 'ja', 'width: 140px;', '')}"/>
                          <apex:Inputfield value="{!qdm.parentRec.ReferenceExpress__c}" html-data-compare-value="{!qdm.baseParentRec.ReferenceExpress__c}" onblur="safetyLockCheck(this);" />
                        </div>

                        <!-- 単価出力 -->
                        <div class="field" style="{!IF(language <> 'ja', 'width: 180px;', '')}">
                          <apex:OutputLabel value="{!$Label.JEOL_QuotEdit_Label_UnitPriceOutput}" styleclass="field-label" style="{!IF(language <> 'ja', 'width: 140px;', '')}"/>
                          <apex:Inputfield value="{!qdm.parentRec.PriceExpress__c}" html-data-compare-value="{!qdm.baseParentRec.PriceExpress__c}" onblur="safetyLockCheck(this);" />
                        </div>

                        <!-- 品目No.出力 -->
                        <div class="field" style="{!IF(language <> 'ja', 'width: 180px;', '')}">
                          <apex:OutputLabel value="{!$Label.JEOL_QuotEdit_Label_ItemListNo}" styleclass="field-label" style="{!IF(language <> 'ja', 'width: 140px;', '')}" />
                          <apex:InputCheckbox id="ProdCodeExpress1" value="{!ProdCodeExpress1}" html-data-compare-value="{!qdm.baseParentRec.ProductCodeExpress__c}" onblur="safetyLockCheck(this);" >
                            <apex:actionSupport event="onchange" action="{!setProdCodeExpress1}" reRender="ProdCodeExpress1,ProdCodeExpress2" status="overrideDepartmentTextProcessing"/>
                          </apex:InputCheckbox>
                        </div>

                        <!-- 本体号機出力 -->
                        <div class="field" style="{!IF(language <> 'ja', 'width: 180px;', '')}">
                          <apex:OutputLabel value="{!$Label.JEOL_QuotEdit_Label_UnitBodyOutput}" styleclass="field-label" style="{!IF(language <> 'ja', 'width: 140px;', '')}"/>
                          <apex:Inputfield value="{!qdm.parentRec.UnitbodyExpress__c}" html-data-compare-value="{!qdm.baseParentRec.UnitbodyExpress__c}" onblur="safetyLockCheck(this);" />
                        </div>

                        <!--見積名称出力 -->
                        <div class="field" style="{!IF(language <> 'ja', 'width: 180px;', '')}">
                          <apex:OutputLabel value="{!$Label.JEOL_QuotEdit_Label_QuotationTitleOutput}" styleclass="field-label" style="{!IF(language <> 'ja', 'width: 140px;', '')}" />
                          <apex:Inputfield value="{!qdm.parentRec.QuotationNameExpress__c}" html-data-compare-value="{!qdm.baseParentRec.QuotationNameExpress__c}" onblur="safetyLockCheck(this);"/>
                        </div>

                        <!-- 支店連絡先出力 -->
                        <div class="field" style="{!IF(language <> 'ja', 'width: 180px;', '')}">
                          <apex:OutputLabel value="{!$ObjectType.QuotationInformation__c.fields.BranchTelephoneFaxExpress__c.Label}" styleclass="field-label" style="{!IF(language <> 'ja', 'width: 140px;', '')}" />
                          <apex:InputCheckbox id="BranchTelFaxExpress1" value="{!BranchTelFaxExpress1}" html-data-compare-value="{!qdm.baseParentRec.BranchTelephoneFaxExpress__c}" onblur="safetyLockCheck(this);" >
                            <apex:actionSupport event="onchange" action="{!setBranchTelFaxExpress1}" reRender="BranchTelFaxExpress1,BranchTelFaxExpress2" status="overrideDepartmentTextProcessing"/>
                          </apex:InputCheckbox>
                        </div>

                      </div>
                    </div>
                  </apex:outputPanel>
                  <div class="modal-footer">
                    <div class="button-area">
                      <button type="button" class="customButton" onclick="$j('#OutputPrintView').modal('hide');" >{!$Label.JEOL_QuotEdit_Label_Cancel}</button>
                    </div>
                    <div class="button-area right">
                      <apex:commandLink value="{!$Label.JEOL_QuotEdit_Label_Save}" onclick="$j('#OutputPrintView .modal-content').addClass('ajax-loading');" styleclass="customButton doSave" action="{!ajaxSaveAction}" oncomplete="$j('#OutputPrintView .modal-content').removeClass('ajax-loading');showResult('{!$Label.JEOL_QuotEdit_Message_SettingsSaved}');unlockSafery();" rerender="listview, modalListView, modalListViewDel, outputSetting" status="ajaxStatus"/>
                      <apex:commandLink value="{!$Label.JEOL_QuotEdit_Label_Preview}" onclick="$j('#OutputPrintView .modal-content').addClass('ajax-loading');" styleClass="customButton doPreview" action="{!ajaxSaveAction}" oncomplete="$j('#OutputPrintView .modal-content').removeClass('ajax-loading');openPreview();unlockSafery();" rerender="listview, modalListView, modalListViewDel, outputSetting" status="ajaxStatus" />
                      <apex:commandLink value="{!$Label.JEOL_QuotEdit_Label_Output}" onclick="$j('#OutputPrintView .modal-content').addClass('ajax-loading');" styleClass="customButton doOutput" action="{!doSaveWithPrintDatePart1}" oncomplete="doSaveWithPrintDatePart2_JS();" rerender="listview, modalListView, modalListViewDel, outputSetting, attachmentList" status="ajaxStatus" />
                      <apex:actionFunction action="{!doSaveWithPrintDatePart2}" name="doSaveWithPrintDatePart2_JS" oncomplete="$j('#OutputPrintView .modal-content').removeClass('ajax-loading');$j('#OutputPrintView').modal('hide');showResult('{!$Label.JEOL_QuotEdit_Message_PdfPrinted}');openPrintWindow();unlockSafery();" rerender="listview, modalListView, modalListViewDel, outputSetting, attachmentList" status="ajaxStatus" />
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <div class="modal fade" id="deleteConfirm" tabindex="-1" role="dialog" aria-labelledby="QuotationDelete" aria-hidden="true">
              <div class="modal-dialog modal-alert">
                <div class="modal-content">
                  <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                      <span aria-hidden="true">&times;</span>
                    </button>
                    <div id="QuotationDelete" class="screen-name">見積書の削除</div>
                  </div>
                  <div class="modal-body">
                    <div class="confirm-area">
                      <p>見積書を削除します。</p>
                      <p>よろしいですか？</p>
                    </div>
                  </div>
                  <div class="modal-footer">
                    <div class="button-area right">
                      <button type="button" class="customButton doDelete" onclick="deleteConfirm();" >削除する</button>
                      <button type="button" class="customButton doCancel" onclick="$j('#deleteConfirm').modal('hide');" >キャンセル</button>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <div class="modal fade" id="detailImportView" data-backdrop="static" tabindex="-1" role="dialog" aria-labelledby="detailImport" aria-hidden="true">
              <div class="modal-dialog">
                <div class="modal-content">
                  <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                      <span aria-hidden="true">&times;</span>
                    </button>
                    <div id="detailImport" class="screen-name">明細のインポート</div>
                  </div>
                  <div class="modal-body">
                    <div class="section search-area">
                      <div class="section-header">
                        <span>検索条件：</span>
                      </div>
                      <div id="detailImportSearchArea" class="collapse in section-body clearfix">
                        <div class="field" style="width: 100%;">
                          <input type="checkbox" class="field-value auto-close-check" style="width: auto;" checked="checked"/>
                          <label class="field-label" style="width: auto;" >検索完了時に自動的に閉じる</label>
                        </div>
                        <div class="field field-fitness">
                          <label class="field-label">見積名称</label>
                          <input type="text" data-field="Name" class="field-value search-field-quotation-name" />
                        </div>
                        <div class="field field-fitness">
                          <label class="field-label">見積No</label>
                          <input type="text" data-field="QuoteNo__c" class="field-value search-field-quotation-no" />
                        </div>
                        <div class="field field-fitness">
                          <label class="field-label">枝番</label>
                          <input type="text" data-field="BranchNo__c" class="field-value search-field-quotation-branchNo" />
                        </div>
                        <div class="field field-fitness">
                          <label class="field-label">登録日</label>
                          <apex:inputField html-data-field="CreatedDateFormula__c" value="{!proxyObject.RegisterDate__c}" styleClass="field-value search-field-quotation-createdDate" onclick="$j('#datePicker').css({'z-index': '2000'});"  />
                        </div>
                        <hr />
                        <div class="field">
                          <button type="button" onclick="detailImportItemSearch();" class="customButton">検索</button>
                        </div>
                      </div>
                      <button type="button" class="toggle-button customButton" data-toggle="collapse" data-target="#detailImportSearchArea" aria-expanded="false" aria-controls="detailImportSearchArea" ></button>
                    </div>
                    <div class="section">
                      <div class="select-header clearfix">
                        <div class="quotation-detail-action-area clearfix">
                          <div class="title">
                            <span>見積一覧：</span>
                          </div>
                          <div class="pager-area clearfix">
                            <a href="javascript: void(0);" class="prev customButton" onclick="prevQuotationRecords();return false;" style="display: none;">&laquo;</a>
                            <div class="prev disabled-button" >&laquo;</div>
                            <div class="current-page-number"></div>
                            <div class="separator">/</div>
                            <div class="max-page-number"></div>
                            <a href="javascript: void(0);" class="next customButton" onclick="nextQuotationRecords();return false;" style="display: none;">&raquo;</a>
                            <div class="next disabled-button" >&raquo;</div>
                          </div>
                          <hr />
                        </div>
                        <div class="quotation-detail-action-area clearfix">
                          <div class="title">
                            <span>対象見積明細一覧：</span>
                          </div>
                          <hr />
                        </div>
                      </div>
                      <div class="select-area clearfix">
                        <div class="item-list"></div>
                        <div class="list-separator">&rsaquo;</div>
                        <div class="detail-list" ></div>
                      </div>
                    </div>
                  </div>
                  <div class="modal-footer">
                    <button type="button" class="customButton" onclick="importDetailFromSelectedQuotation();" >選択中の見積から明細をインポート</button>
                  </div>
                </div>
              </div>
            </div>
            <div class="modal fade" id="detailProductItemView" data-tab-target="catalogItemSearch" data-backdrop="static" tabindex="-1" role="dialog" aria-labelledby="detailProductItem" aria-hidden="true">
              <div class="modal-dialog">
                <div class="modal-content">
                  <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                      <span aria-hidden="true">&times;</span>
                    </button>
                    <div id="detailProductItem" class="screen-name">品目の選択</div>
                  </div>
                  <div class="modal-body section">
                    <div class="tab-buttons">
                      <button type="button" class="tab" onclick="tabSelection(this);" data-target="productItemSearch" >品目検索</button>
                      <button type="button" class="tab active" onclick="tabSelection(this);" data-target="catalogItemSearch" >カタログ検索</button>
                    </div>
                    <div id="productItemTabPanel" class="tab-panel" data-tab-panel="productItemSearch">
                      <div class="section search-area">
                        <div class="section-header" >
                          <span>検索条件：</span>
                        </div>
                        <div id="detailProductItemSearchArea" class="section-body collapse in clearfix">
                          <div class="field" style="width: 100%;">
                            <input type="checkbox" class="field-value auto-close-check" style="width: auto;" checked="checked" />
                            <label class="field-label" style="width: auto;" >検索完了時に自動的に閉じる</label>
                          </div>
                          <div class="field clearfix" style="border-bottom: 1px solid #ABB8C9; box-shadow: 0px 1px 0px #eee">
                            <div class="radio-item">
                              <apex:outputLabel value="品目区分: " styleClass="field-label" />
                              <input id="productItemType" type="text" class="field-value productDivision radio-product-type" style="display: none;" data-field="Division__c"/>
                            </div>
                            <div class="radio-item">
                              <input id="radio-product-type-product2" type="radio" name="productType2" onchange="$j('#productItemType').val(this.value);" class="field-value" value="製品" />
                              <label for="radio-product-type-product2" class="field-label">製品</label>
                            </div>
                            <div class="radio-item">
                              <input id="radio-product-type-parts2" type="radio" name="productType2" onchange="$j('#productItemType').val(this.value);" class="field-value" value="パーツ" />
                              <label for="radio-product-type-parts2" class="field-label">パーツ</label>
                            </div>
                          </div>
                          <div class="search-field">
                            <div class="field ">
                              <label class="field-label" >品目名</label>
                              <input type="text" class="field-value search-field-product-name" data-field="JapaneseName__c" placeholder="品目名" />
                            </div>
                            <div class="field">
                              <label class="field-label" >{!$Label.JEOL_QuotEdit_Label_ItemNo}</label>
                              <input type="text" class="field-value search-field-product-code" data-field="Name" placeholder="{!$Label.JEOL_QuotEdit_Label_ItemNo}" />
                            </div>
                            <div class="field">
                              <label class="field-label" >形式</label>
                              <input type="text" class="field-value search-field-model-type" data-field="ModelType__c" placeholder="形式" />
                            </div>
                          </div>
                          <div class="field">
                            <button type="button" onclick="productItemSearch();" class="customButton">検索</button>
                          </div>
                        </div>
                        <button type="button" class="toggle-button customButton" data-toggle="collapse" data-target="#detailProductItemSearchArea" aria-expanded="false" aria-controls="detailProductItemSearchArea" ></button>
                      </div>
                      <div class="section">
                        <div class="select-header clearfix">
                          <div class="detail-product-action-area clearfix">
                            <div class="title">
                              <span>品目一覧：</span>
                            </div>
                            <div class="pager-area clearfix">
                              <a href="javascript: void(0);" class="prev customButton" onclick="prevRecordsAddDraggable();return false;" style="display: none;">&laquo;</a>
                              <div class="prev disabled-button" >&laquo;</div>
                              <div class="current-page-number"></div>
                              <div class="separator">/</div>
                              <div class="max-page-number"></div>
                              <a href="javascript: void(0);" class="next customButton" onclick="nextRecordsAddDraggable();return false;" style="display: none;">&raquo;</a>
                              <div class="next disabled-button">&raquo;</div>
                            </div>
                            <hr />
                          </div>
                          <div class="detail-product-action-area clearfix">
                            <div class="title">
                              <span>選択済み品目一覧：</span>
                            </div>
                            <hr />
                          </div>
                        </div>
                        <div class="select-area clearfix">
                          <div class="item-list"></div>
                          <div  id="selected-list" class="selected-list" >
                            <div class="drop-target table" ></div>
                          </div>
                        </div>
                      </div>
                    </div>
                    <div id="productCatalogTabPanel" class="tab-panel" data-tab-panel="catalogItemSearch">
                      <div class="section search-area">
                        <div class="section-header" >
                          <span>検索条件：</span>
                        </div>
                        <div id="detailProductCatalogSearchArea" class="section-body collapse in clearfix">
                          <div class="field" style="width: 100%;">
                            <input type="checkbox" class="field-value auto-close-check" style="width: auto;" checked="checked" />
                            <label class="field-label" style="width: auto;" >検索完了時に自動的に閉じる</label>
                          </div>
                          <div class="search-field">
                            <div class="field">
                              <label class="field-label" >製品カタログNo</label>
                              <input type="text" class="field-value search-field-product-name" data-field="ProductCatalog__c" placeholder="製品カタログNo" />
                            </div>
                            <div class="field">
                              <label class="field-label" >検索キー</label>
                              <input type="text" class="field-value search-field-product-code" data-field="SearchKeyWord__c" placeholder="検索キー" />
                            </div>
                          </div>
                          <div class="field">
                            <button type="button" onclick="productCatalogSearch();" class="customButton">検索</button>
                          </div>
                        </div>
                        <button type="button" class="toggle-button customButton" data-toggle="collapse" data-target="#detailProductCatalogSearchArea" aria-expanded="false" aria-controls="detailProductCatalogSearchArea" ></button>
                      </div>
                      <div class="section">
                        <div class="select-header clearfix">
                          <div class="detail-product-action-area clearfix">
                            <div class="title">
                              <span>品目一覧：</span>
                            </div>
                            <hr />
                          </div>
                          <div class="detail-product-action-area clearfix">
                            <div class="title">
                              <span>選択済み品目一覧：</span>
                            </div>
                            <hr />
                          </div>
                        </div>
                        <div class="select-area catalog clearfix">
                          <div class="item-list"></div>
                          <div  id="selected-list-catalog" class="selected-list" >
                            <div class="drop-target tree" ></div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                  <div class="modal-footer">
                    <div data-tab-panel="productItemSearch">
                      <button type="button" class="customButton" onclick="lockSafety();chooseItemDetailProduct();">選択</button>
                    </div>
                    <div data-tab-panel="catalogItemSearch">
                      <button type="button" class="customButton" onclick="lockSafety();chooseCatalogDetailProduct();" >選択</button>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <div class="modal fade" id="mainProductItemView" data-backdrop="static" tabindex="-1" role="dialog" aria-labelledby="mainProductItem" aria-hidden="true">
              <div class="modal-dialog">
                <div class="modal-content">
                  <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                      <span aria-hidden="true">&times;</span>
                    </button>
                    <div id="mainProductItem" class="screen-name">品目の選択</div>
                  </div>
                  <div class="modal-body">
                    <div class="section search-area">
                      <div class="section-header">
                        <span>検索条件：</span>
                      </div>
                      <div id="mainProductItemSearchArea" class="section-body collapse in clearfix">
                        <div class="field" style="width: 100%;">
                          <input type="checkbox" class="field-value auto-close-check" style="width: auto;" checked="checked" />
                          <label class="field-label" style="width: auto;">検索完了時に自動的に閉じる</label>
                        </div>
                        <div class="field clearfix" style="border-bottom: 1px solid #ABB8C9; box-shadow: 0px 1px 0px #eee">
                          <div class="radio-item">
                            <apex:outputLabel value="品目区分: " styleClass="field-label" />
                            <input id="mainProductItemType" type="text" class="field-value productDivision radio-product-type" style="display: none;" data-field="Division__c" />
                          </div>
                          <div class="radio-item">
                            <input id="radio-product-type-product1" type="radio" name="productType1" onchange="$j('#mainProductItemType').val(this.value);" class="field-value search-field-product-name" value="製品" />
                            <label for="radio-product-type-product1" class="field-label">製品</label>
                          </div>
                          <div class="radio-item">
                            <input id="radio-product-type-parts1" type="radio" name="productType1" onchange="$j('#mainProductItemType').val(this.value);" class="field-value search-field-product-name" value="パーツ" />
                            <label for="radio-product-type-parts1" class="field-label">パーツ</label>
                          </div>
                        </div>
                        <div class="search-field">
                          <div class="field">
                            <label class="field-label" >品目名</label>
                            <input type="text" class="field-value search-field-product-name" data-field="JapaneseName__c" placeholder="品目名" />
                          </div>
                          <div class="field">
                            <label class="field-label" >{!$Label.JEOL_QuotEdit_Label_ItemNo}</label>
                            <input type="text" class="field-value search-field-product-code" data-field="Name" placeholder="{!$Label.JEOL_QuotEdit_Label_ItemNo}" />
                          </div>
                          <div class="field">
                            <label class="field-label" >形式</label>
                            <input type="text" class="field-value search-field-model-type" data-field="ModelType__c" placeholder="形式" />
                          </div>
                        </div>
                        <div class="field">
                          <a href="javascript: void(0);" onclick="mainProductItemSearch();return false;" class="customButton">検索</a>
                        </div>
                      </div>
                      <button type="button" class="toggle-button customButton" data-toggle="collapse" data-target="#mainProductItemSearchArea" aria-expanded="false" aria-controls="mainProductItemSearchArea" ></button>
                    </div>
                    <div class="section errors"></div>
                    <div class="section ">
                      <div class="select-header clearfix" >
                        <div class="title">
                          <span>品目一覧：</span>
                        </div>
                        <div class="pager-area clearfix">
                          <a href="javascript: void(0);" class="prev customButton" onclick="prevRecords();return false;" style="display: none;" >&laquo;</a>
                          <div class="prev disabled-button" >&laquo;</div>
                          <div class="current-page-number"></div>
                          <div class="separator">/</div>
                          <div class="max-page-number"></div>
                          <a href="javascript: void(0);" class="next customButton" onclick="nextRecords();return false;" style="display: none;" >&raquo;</a>
                          <div class="next disabled-button" >&raquo;</div>
                        </div>
                      </div>
                      <hr />
                      <div class="select-area">
                        <div class="item-list"></div>
                      </div>
                    </div>
                  </div>
                  <div class="modal-footer">
                    <button type="button" class="customButton" onclick="lockSafety();chooseMainProductItem();" >選択</button>
                  </div>
                </div>
              </div>
            </div>
            <div class="modal fade" id="destinationPrintView" data-backdrop="static" tabindex="-1" role="dialog" aria-labelledby="destinationPrint" aria-hidden="true">
              <div class="modal-dialog">
                <div class="modal-content">
                  <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                      <span aria-hidden="true">&times;</span>
                    </button>
                    <div id="destinationPrint" class="screen-name">送付案内出力</div>
                  </div>
                  <apex:outputPanel layout="block" styleClass="modal-body" id="destinationOutputSettigs">
                    <div class="section options-area ">
                      <div class="select-header clearfix" >
                        <div class="title clearfix" >
                          <div style="float: left;">送付案内出力設定</div>
                          <apex:commandLink action="{!includeDestinationData}" rerender="destinationOutputSettigs" onclick="lockSafety();" styleClass="customButton"  status="destinationAjaxStatus" style="float: right; width: auto; font-size: 13px;">
                            <span class="refresh-icon" style="vertical-align: middle;"></span>
                            <span>見積書から情報をコピー</span>
                          </apex:commandLink>
                        </div>
                      </div>
                      <div class="section-body output-controls clearfix">
                        <div class="setting-row clearfix">
                          <div class="field">
                            <apex:outputLabel value="見積No." styleClass="field-label" />
                            <apex:outputField value="{!qdm.parentRec.QuoteNo__c}" styleClass="field-value" />
                          </div>
                          <div class="field">
                            <apex:outputLabel value="枝番" styleClass="field-label" />
                            <apex:outputField value="{!qdm.parentRec.BranchNo__c}" styleClass="field-value" />
                          </div>
                        </div>
                        <div class="setting-row clearfix">
                          <apex:actionStatus layout="inline"  id="destinationAjaxStatus" >
                            <apex:facet name="start">
                              <div style="display: inline-block; *display: inline; *zoom: 1; line-height: 30px; margin-left: 8px; color: #22816b;">{!$Label.JEOL_QuotEdit_Label_Searching}</div>
                            </apex:facet>
                          </apex:actionStatus>
                        </div>
                        <div class="setting-row clearfix">
                          <div class="field">

                            <apex:outputLabel value="指定宛先コード" styleClass="field-label" />

                            <apex:inputField id="DestinationAccountCode"
                                             value="{!qdm.parentRec.DestinationAccountCode__c}" 
                                             styleClass="field-value guide-destinationAccountCode"
                                             html-data-compare-value="{!qdm.baseParentRec.DestinationAccountCode__c}"
                                             onfocus="openSearchToggleButton(this);" 
                                             onblur="safetyLockCheck(this);" />

                            <!-- contractCode -->

                            <apex:commandLink action="{!DestinationAttachmentFromCode}"
                                              title="コード検索"
                                              rerender="DestinationAccountCode, DestinationAccountName, DestinationAccountPostalCode, DestinationAccountUndergraduate, DestinationAccountAddress"
                                              styleClass="productSearchButton"
                                              status="ReprNameProcessing3">
                              <span class="refresh-icon"></span>
                            </apex:commandLink>



                          </div>
                          <div class="field">
                            <apex:outputLabel value="指定宛先名" styleClass="field-label" />
                            <apex:inputField id="DestinationAccountName"
                                             value="{!qdm.parentRec.DestinationAccountName__c}"
                                             styleClass="field-value guide-destinationAccountName"
                                             html-data-compare-value="{!qdm.baseParentRec.DestinationAccountName__c}"
                                             onblur="safetyLockCheck(this);" />
                          </div>
                        </div>
                        <div class="setting-row clearfix">
                          <div class="field">
                            <apex:outputLabel value="郵便番号" styleClass="field-label" />
                            <apex:inputField id="DestinationAccountPostalCode"
                                             value="{!qdm.parentRec.DestinationPostalCode__c}"
                                             styleClass="field-value guide-destinationPostalCode"
                                             html-data-compare-value="{!qdm.baseParentRec.DestinationPostalCode__c}"
                                             onblur="safetyLockCheck(this);" />
                          </div>
                          <div class="field" >
                            <apex:outputLabel value="学部事業所" styleClass="field-label" />
                            <apex:inputField id="DestinationAccountUndergraduate"
                                             value="{!qdm.parentRec.DestinationUndergraduate__c}"
                                             styleClass="field-value guide-destinationUndergraduate"
                                             html-data-compare-value="{!qdm.baseParentRec.DestinationUndergraduate__c}"
                                             onblur="safetyLockCheck(this);" />
                          </div>
                        </div>
                        <div class="setting-row clearfix">
                          <div class="field" >
                            <apex:outputLabel value="{!$Label.JEOL_QuotEdit_Label_Address}" styleClass="field-label" />
                            <apex:inputField id="DestinationAccountAddress"
                                             value="{!qdm.parentRec.DestinationAddress__c}"
                                             styleClass="field-value guide-destinationAddress"
                                             html-data-compare-value="{!qdm.baseParentRec.DestinationAddress__c}"
                                             onblur="safetyLockCheck(this);" />
                          </div>
                        </div>
                        <div class="setting-row clearfix">
                          <div class="field">
                            <apex:outputLabel value="氏名" styleClass="field-label" />
                            <apex:inputField value="{!qdm.parentRec.DestinationName__c}" styleClass="field-value guide-destinationName" html-data-compare-value="{!qdm.baseParentRec.DestinationName__c}" onblur="safetyLockCheck(this);" />
                            <apex:inputField value="{!qdm.parentRec.DestinationNameTitle__c}" styleClass="field-value guide-destinationNameTitle" style="margin-left: 8px;" html-data-compare-value="{!qdm.baseParentRec.DestinationNameTitle__c}" onblur="safetyLockCheck(this);" />
                          </div>
                          <div class="field">
                            <apex:outputLabel value="所属" styleClass="field-label" />
                            <apex:inputField value="{!qdm.parentRec.DestinationBelong__c}" styleClass="field-value guide-destinationBelong" html-data-compare-value="{!qdm.baseParentRec.DestinationBelong__c}" onblur="safetyLockCheck(this);" />
                          </div>
                        </div>
                        <div class="setting-row clearfix">
                          <div class="field">
                            <apex:outputLabel value="担当" styleClass="field-label" />
                            <apex:inputField value="{!qdm.parentRec.DestinationPersonInCharge__c}" styleClass="field-value guide-destinationPersonInCharge" html-data-compare-value="{!qdm.baseParentRec.DestinationPersonInCharge__c}" onblur="safetyLockCheck(this);" />
                          </div>


                          <!-- 送付案内日 -->
                          <div class="field">
                            <apex:outputLabel value="送付案内日" styleClass="field-label" style="{!IF(language <> 'ja', 'width: 83px;', 'width: 101px;')}"/>
                            <apex:inputField value="{!qdm.parentRec.DestinationGuideDate__c}" styleClass="field-value guide-destinationGuideDate" onclick="$j('#datePicker').css({'z-index': '2000'});" html-data-compare-value="{!qdm.baseParentRec.DestinationGuideDate__c}" onblur="safetyLockCheck(this);" />
                          </div>

                          <!-- 西暦/和暦 -->
                          <div class="field">
                            <apex:OutputLabel value="{!$Label.JEOL_QuotEdit_Label_Calendar}" styleclass="field-label" style="{!IF(language <> 'ja', 'width: 74px;', 'width: 90px;')}" />

                            <apex:selectList id="CalendarExpress2"
                                             value="{!CalendarExpress2}"
                                             html-data-compare-value="{!qdm.baseParentRec.CalendarExpress__c}" 
                                             size="1" 
                                             styleclass="field-value"
                                             style="{!IF(language <> 'ja', 'width: 100px;', 'width: 66px;')}"
                                             onblur="safetyLockCheck(this);">
                              <apex:selectOptions value="{!CalendarExpressOptions}" />
                              <apex:actionSupport event="onchange" action="{!setCalendarExpress2}" reRender="CalendarExpress1,CalendarExpress2" status="ReprNameProcessing3"/>
                            </apex:selectList>
                          </div>




                        </div>
                        <div class="setting-row clearfix">
                          <div class="field">
                            <apex:outputLabel value="件名" styleClass="field-label" style="vertical-align: top;"/>
                            <apex:inputField value="{!qdm.parentRec.DestinationGuideSubject__c}" styleClass="field-value guide-destinationGuideSubject" html-data-compare-value="{!qdm.baseParentRec.DestinationGuideSubject__c}" onblur="safetyLockCheck(this);" />
                          </div>
                        </div>

                        <div class="setting-row clearfix">
                          <div class="field"  style="width: 100%;">
                            <apex:OutputLabel value="{!$Label.JEOL_QuotEdit_Label_PersonInChargeOutput}" styleclass="field-label" style="{!IF(language <> 'ja', 'width: 140px;', '')}" />
                            <apex:InputCheckbox id="ReprNameExpress3" value="{!ReprNameExpress3}" html-data-compare-value="{!qdm.baseParentRec.RepresentativeNameExpress__c}" onblur="safetyLockCheck(this);">
                              <apex:actionSupport event="onchange" action="{!setReprNameExpress3}" reRender="ReprNameExpress1,ReprNameExpress2,ReprNameExpress3" status="ReprNameProcessing3"/>
                            </apex:InputCheckbox>
                              <apex:actionStatus layout="inline"  id="ReprNameProcessing3" >
                                <apex:facet name="start">
                                  <div style="display: inline-block; *display: inline; *zoom: 1; line-height: 30px; margin-left: 108px; color: #22816b;">{!$Label.JEOL_QuotEdit_Label_Searching}</div>
                                </apex:facet>
                              </apex:actionStatus>                            
                          </div>
                        </div>

                        <div class="setting-row clearfix">
                          <div class="field"  style="width: 100%;">
                            <apex:OutputLabel value="{!$ObjectType.QuotationInformation__c.fields.BranchTelephoneFaxExpress__c.Label}" styleclass="field-label" style="{!IF(language <> 'ja', 'width: 140px;', '')}" />
                            <apex:InputCheckbox id="BranchTelFaxExpress2" value="{!BranchTelFaxExpress2}" html-data-compare-value="{!qdm.baseParentRec.BranchTelephoneFaxExpress__c}" onblur="safetyLockCheck(this);">
                              <apex:actionSupport event="onchange" action="{!setBranchTelFaxExpress2}" reRender="BranchTelFaxExpress1,BranchTelFaxExpress2" status="ReprNameProcessing3"/>
                            </apex:InputCheckbox>
                          </div>
                        </div>

                      </div>
                    </div>
                  </apex:outputPanel>
                  <div class="modal-footer">
                    <div class="button-area">
                      <button type="button" class="customButton" onclick="$j('#destinationPrintView').modal('hide');" >キャンセル</button>
                    </div>
                    <div class="button-area right">
                      <apex:commandLink value="保存" action="{!ajaxSaveAction}" onclick="$j('#destinationPrintView .modal-content').addClass('ajax-loading');" styleclass="customButton doSave" oncomplete="$j('#destinationPrintView .modal-content').removeClass('ajax-loading');showResult('設定を保存しました。');unlockSafety();" rerender="listview, modalListView, modalListViewDel, destinationOutputSettigs" status="ajaxStatus"/>
<!--                  <apex:commandLink value="プレビュー" action="{!ajaxSaveAction}" onclick="$j('#destinationPrintView .modal-content').addClass('ajax-loading');" styleClass="customButton doPreview" oncomplete="$j('#destinationPrintView .modal-content').removeClass('ajax-loading');openDestinationPrintPreview();unlockSafety();" rerender="listview, modalListView, modalListViewDel, destinationOutputSettigs" status="ajaxStatus" /> -->
                      <apex:commandLink value="出力" onclick="$j('#destinationPrintView .modal-content').addClass('ajax-loading');" styleClass="customButton doOutput" action="{!doSaveWithDestinationPrintDatePart1}" oncomplete="doSaveWithDestinationPrintDatePart2_JS();" rerender="listview, modalListView, modalListViewDel, destinationOutputSettigs, attachmentList" status="ajaxStatus" />
                      <apex:actionFunction action="{!doSaveWithDestinationPrintDatePart2}" name="doSaveWithDestinationPrintDatePart2_JS" oncomplete="$j('#destinationPrintView .modal-content').removeClass('ajax-loading');$j('#OutputPrintView').modal('hide');showResult('pdfへ出力が完了しました。');openDestinationPrintWindow();unlockSafety();" rerender="listview, modalListView, modalListViewDel, destinationOutputSettigs, attachmentList" status="ajaxStatus" />
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <div class="modal fade" id="certificatePrintView" data-backdrop="static" tabindex="-1" role="dialog" aria-labelledby="certificatePrint" aria-hidden="true">
              <div class="modal-dialog">
                <div class="modal-content">
                  <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                      <span aria-hidden="true">&times;</span>
                    </button>
                    <div id="certificatePrint" class="screen-name">直販/定価証出力</div>
                  </div>
                  <apex:outputPanel layout="block" styleClass="modal-body" id="certificateOutputSettings">
                    <div class="section options-area">
                      <div class="select-header clearfix" >
                        <div class="title clearfix" >
                          <div >直販/定価証明書出力</div>
                        </div>
                      </div>
                      <div class="section-body output-controls clearfix">
                        <div class="setting-row clearfix">
                          <div class="field">
                            <apex:outputLabel value="見積No." styleClass="field-label" />
                            <apex:outputField value="{!qdm.parentRec.QuoteNo__c}" styleClass="field-value" />
                          </div>
                          <div class="field">
                            <apex:outputLabel value="枝番" styleClass="field-label" />
                            <apex:outputField value="{!qdm.parentRec.BranchNo__c}" styleClass="field-value" />
                          </div>
                        </div>
                        <fieldset class="setting-row clearfix">
                          <legend>出力設定</legend>
                          <div class="field"  style="width: 100%;">

                            <!-- 代表者名出力 -->
                            <div class="field" style="width: 200px;">
                              <apex:OutputLabel value="{!$Label.JEOL_QuotEdit_Label_PersonInChargeOutput}" styleclass="field-label" style="{!IF(language <> 'ja', 'width: 140px;', '')}" />
                              <apex:InputCheckbox id="ReprNameExpress2" value="{!ReprNameExpress2}" html-data-compare-value="{!qdm.baseParentRec.RepresentativeNameExpress__c}" onblur="safetyLockCheck(this);">
                                <apex:actionSupport event="onchange" action="{!setReprNameExpress2}" reRender="ReprNameExpress1,ReprNameExpress2,ReprNameExpress3" status="ReprNameProcessing"/>
                              </apex:InputCheckbox>
                            </div>

                            <div class="field" style="width: 200px;">
                              <!-- 品目No.出力 -->
                              <apex:OutputLabel value="{!$Label.JEOL_QuotEdit_Label_ItemListNo}" styleclass="field-label" style="{!IF(language <> 'ja', 'width: 140px;', '')}" />
                              <apex:InputCheckbox id="ProdCodeExpress2" value="{!ProdCodeExpress2}" html-data-compare-value="{!qdm.baseParentRec.ProductCodeExpress__c}" onblur="safetyLockCheck(this);">
                                <apex:actionSupport event="onchange" action="{!setProdCodeExpress2}" reRender="ProdCodeExpress1,ProdCodeExpress2" status="ReprNameProcessing"/>
                              </apex:InputCheckbox>
                            </div>

                            <apex:actionStatus layout="inline"  id="ReprNameProcessing" >
                              <apex:facet name="start">
                                <div style="display: inline-block; *display: inline; *zoom: 1; line-height: 30px; margin-left: 108px; color: #22816b;">{!$Label.JEOL_QuotEdit_Label_Searching}</div>
                              </apex:facet>
                            </apex:actionStatus>                            

                          </div>

                          <div class="field"  style="width: 100%;">

                            <apex:OutputLabel value="{!$Label.JEOL_QuotEdit_Label_Attention}" styleclass="field-label" />

                            <apex:selectList id="CustomerExpress2"
                                             value="{!CustomerExpress2}"
                                             html-data-compare-value="{!qdm.baseParentRec.CustomerExpress__c}" 
                                             size="1" 
                                             styleclass="field-value"
                                             onblur="safetyLockCheck(this);">
                              <apex:selectOptions value="{!CustomerExpressOptions}" />
                              <apex:actionSupport event="onchange" action="{!setCustomerExpress2}" reRender="CustomerExpress1,CustomerExpress2" status="CustomerExpressProcessing"/>
                            </apex:selectList>

                            <apex:actionStatus layout="inline"  id="CustomerExpressProcessing" >
                              <apex:facet name="start">
                                <div style="display: inline-block; *display: inline; *zoom: 1; line-height: 30px; margin-left: 108px; color: #22816b;">{!$Label.JEOL_QuotEdit_Label_Searching}</div>
                              </apex:facet>
                            </apex:actionStatus>                            

                          </div>

                        </fieldset>
                        <fieldset class="setting-row clearfix">
                          <legend>直販証明書</legend>
                          <div class="field"  style="width: 100%;">
                            <apex:outputLabel value="出力" styleClass="field-label"/>
                            <apex:inputField value="{!qdm.parentRec.DirectSalesExpress__c}" html-data-compare-value="{!qdm.baseParentRec.DirectSalesExpress__c}" onblur="safetyLockCheck(this);" />
                          </div>
                          <div class="field" style="width: 100%;">
                            <apex:outputLabel value="発行日" styleClass="field-label" />
                            <!--Modification-VAIB-Begin(2015/05/21 UAT_QA_List No.44)-->
                            <apex:inputField type="date" showDatePicker="false" styleClass="field-value" value="{!qdm.parentRec.DirectSalesSheetIssueDate__c}" style="width: 200px;"/>
                            <!-- <apex:outputField value="{!qdm.parentRec.DirectSalesSheetIssueDate__c}" styleClass="field-value" /> -->
                            <!--Modification-VAIB-End(2015/05/21 UAT_QA_List No.44)-->
                          </div>
                        </fieldset>
                        <fieldset class="setting-row clearfix">
                          <legend>定価証明書</legend>
                          <div class="field" style="width: 100%;">
                            <apex:outputLabel value="出力" styleClass="field-label" />
                            <apex:inputField value="{!qdm.parentRec.RegulerPriceExpress__c}" html-data-compare-value="{!qdm.baseParentRec.RegulerPriceExpress__c}" onblur="safetyLockCheck(this);" />
                          </div>
                          <div class="field" style="width: 100%;">
                            <apex:outputLabel value="発行日" styleClass="field-label" />
                            <!--Modification-VAIB-Begin(2015/05/21 UAT_QA_List No.44)-->
                            <apex:inputField type="date" showDatePicker="false" styleClass="field-value" value="{!qdm.parentRec.RegulerPriceSheetIssueDate__c}" style="width: 200px"/>
                            <!-- <apex:outputField value="{!qdm.parentRec.RegulerPriceSheetIssueDate__c}" styleClass="field-value" /> -->
                            <!--Modification-VAIB-End(2015/05/21 UAT_QA_List No.44)-->
                          </div>
                          <div class="field" style="width: 100%;">
                            <apex:outputLabel value="コメント" styleClass="field-label" />
                            <apex:inputField value="{!qdm.parentRec.RegulerPriceCommentExpress__c}" html-data-compare-value="{!qdm.baseParentRec.RegulerPriceCommentExpress__c}" onblur="safetyLockCheck(this);"/>
                            <apex:outputText value="(*本価格は税抜きです)" style="padding-left: 8px;"/>
                          </div>
                        </fieldset>
                      </div>
                    </div>
                    <div class="section options-area" >
                      <div class="select-header clearfix" >
                        <div class="title clearfix" >
                          <div style="float: left;">出力明細の選択</div>
                          <apex:commandLink styleClass="customButton" rerender="detailArea,modalListView,modalListViewDel,apexMessage" onclick="$j('#certificatePrintView .modal-content').addClass('ajax-loading');lockSafety();" oncomplete="$j('#certificatePrintView .modal-content').removeClass('ajax-loading');showResult('明細情報を更新しました。');" status="ajaxStatus" style="float: right; width: auto; font-size: 13px;">
                            <span class="refresh-icon" style="vertical-align: middle;"></span>
                            <span>最新の状態に更新</span>
                          </apex:commandLink>
                        </div>
                      </div>
                      <apex:outputPanel layout="block" id="modalListView">
                        <table class="modalDetailList" >
                          <col class="checkbox" />
                          <col class="body" />
                          <col class="productCode" />
                          <col class="amount" />
                          <tr >
                            <th >
                              <div class="field">
                                <apex:outputText value="出力" styleClass="field-label center" />
                              </div>
                            </th>
                            <th >
                              <div class="field">
                                <apex:outputText value="{!$Label.JEOL_QuotEdit_Label_ProductName}" styleClass="field-label  body" />
                              </div>
                            </th>
                            <th >
                              <div class="field">
                                <apex:outputText value="品目No." styleClass="field-label" />
                              </div>
                            </th>
                            <th >
                              <div class="field">
                                <apex:outputText value="金額" styleClass="field-label" />
                              </div>
                            </th>
                          </tr>
                          <apex:repeat value="{!qdm.items}" var="item" >
                            <tr data-depth="{!item.rec.Depth__c}" data-type="{!item.rec.Type__c}">
                              <td >
                                <div class="field">
                                  <apex:inputField value="{!item.rec.CertificationExpress__c}" styleClass="field-value center" html-data-compare-value="{!item.rec.CertificationExpress__c}" onblur="safetyLockCheck(this);"/>
                                </div>
                              </td>
                              <td >
                                <div class="field">
                                  <apex:outputText value="{!item.rec.Body__c}" styleClass="field-value body" />
                                </div>
                              </td>
                              <td >
                                <div class="field">
                                  <apex:outputText value="{!item.rec.ProductCode__c}" styleClass="field-value" />
                                </div>
                              </td>
                              <td >
                                <div class="field">
                                  <apex:outputText value="{0, number, ###,###,###,###,###,##0}" styleClass="field-value  right" >
                                    <apex:param value="{!item.rec.TotalDiscountAmount__c}" />
                                  </apex:outputText>
                                </div>
                              </td>
                            </tr>
                          </apex:repeat>
                        </table>
                      </apex:outputPanel>
                    </div>
                  </apex:outputPanel>
                  <div class="modal-footer">
                    <div class="button-area">
                      <button type="button" class="customButton" onclick="$j('#certificatePrintView').modal('hide');" >キャンセル</button>
                    </div>
                    <div class="button-area right">
                      <apex:commandLink value="保存" action="{!ajaxSaveAction}" onclick="$j('#certificatePrintView .modal-content').addClass('ajax-loading');" styleclass="customButton doSave" oncomplete="$j('#certificatePrintView .modal-content').removeClass('ajax-loading');showResult('設定を保存しました。');unlockSafety();" rerender="listview, modalListView, modalListViewDel" status="ajaxStatus"/>
                      <apex:commandLink value="プレビュー" action="{!ajaxSaveAction}" onclick="$j('#certificatePrintView .modal-content').addClass('ajax-loading');" styleClass="customButton doPreview" oncomplete="$j('#certificatePrintView .modal-content').removeClass('ajax-loading');openCertificationPrintPreview();unlockSafety();" rerender="listview, modalListView, modalListViewDel" status="ajaxStatus" />
                      <apex:commandLink value="出力" onclick="$j('#certificatePrintView .modal-content').addClass('ajax-loading');" styleClass="customButton doOutput" action="{!doSaveWithCertificationPrintDatePart1}" oncomplete="doSaveWithCertificationPrintDatePart2_JS();" rerender="listview, modalListView, modalListViewDel, attachmentList" status="ajaxStatus" />
                      <apex:actionFunction action="{!doSaveWithCertificationPrintDatePart2}" name="doSaveWithCertificationPrintDatePart2_JS" oncomplete="$j('#certificatePrintView .modal-content').removeClass('ajax-loading');$j('#certificatePrintView').modal('hide');showResult('pdfへ出力が完了しました。');openCertificationPrintWindow();unlockSafety();" rerender="listview, modalListView, modalListViewDel, attachmentList" status="ajaxStatus" />
                
                    </div>
                  </div>
                </div>
              </div>
            </div>
            
            <!-- MULTI DELETE MODAL FORM -->
            <div class="modal fade" id="multiDeleteView" data-backdrop="static" tabindex="-1" role="dialog" aria-labelledby="multiDelete" aria-hidden="true">
              <div class="modal-dialog">
                <div class="modal-content">
                  <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                      <span aria-hidden="true">&times;</span>
                    </button>
                    <div id="multiDelete" class="screen-name">複数行の削除</div>

                  </div>
                  <apex:outputPanel layout="block" styleClass="modal-body" id="multiDeleteViewPanel">
                    <div class="section options-area" >
                      <div class="select-header clearfix" >
                        <div class="title clearfix" >
                          <div style="float: left;">削除行の選択</div>
                        </div>
                      </div>
                      <apex:outputPanel layout="block" id="modalListViewDel">
                        <table class="modalDetailList delete_table" id="delete_table" >
                          <col class="body" />
                          <col class="productCode" />
                          <col class="amount" />
                          <tr >
                            <th >
                              <div class="field">
                                <apex:outputText value="{!$Label.JEOL_QuotEdit_Label_ProductName}" styleClass="field-label  body" />
                              </div>
                            </th>
                            <th >
                              <div class="field">
                                <apex:outputText value="品目No." styleClass="field-label" />
                              </div>
                            </th>
                            <th >
                              <div class="field">
                                <apex:outputText value="金額" styleClass="field-label" />
                              </div>
                            </th>
                          </tr>
                          <apex:repeat value="{!qdm.items}" var="item" >
                            <tr data-depth="{!item.rec.Depth__c}" data-type="{!item.rec.Type__c}" data-rowguid="{!item.IdxRow}"
                                onmousedown="isMouseDown = true; window.getSelection().removeAllRanges(); if ($j(this).hasClass('todelete')) {isRemoveMode = true; $j(this).removeClass('todelete');} else {isRemoveMode = false; $j(this).addClass('todelete');} return false;"
                                onmouseover="if (isMouseDown) {if (isRemoveMode) {$j(this).removeClass('todelete');} else {$j(this).addClass('todelete');}}" >
                              <td >
                                <div class="field">
                                  <apex:outputText value="{!item.rec.Body__c}" styleClass="field-value body" />
                                </div>
                              </td>
                              <td >
                                <div class="field">
                                  <apex:outputText value="{!item.rec.ProductCode__c}" styleClass="field-value" />
                                </div>
                              </td>
                              <td >
                                <div class="field">
                                  <apex:outputText value="{0, number, ###,###,###,###,###,##0}" styleClass="field-value  right" >
                                    <apex:param value="{!item.rec.TotalDiscountAmount__c}" />
                                  </apex:outputText>
                                </div>
                              </td>
                            </tr>
                          </apex:repeat>
                        </table>
                      </apex:outputPanel>
                    </div>
                  </apex:outputPanel>
                  <div class="modal-footer">
                    <div class="button-area">
                      <button type="button" class="customButton" onclick="$j('#multiDeleteView').modal('hide');" >キャンセル</button>
                    </div>
                    <div class="button-area right">
                      <apex:commandLink value="削除" onclick="$j('#multiDeleteView .modal-content').addClass('ajax-loading');deleteMultipleRows();" action="{!deleteMultiRows}" styleclass="customButton doSave" oncomplete="$j('#multiDeleteView .modal-content').removeClass('ajax-loading');$j('#multiDeleteView').modal('hide');showResult('複数行を削除しました。');unlockSafety();" rerender="listview, modalListView, modalListViewDel" status="ajaxStatus"/>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            
          </apex:form>
          <hr style="margin-bottom: 40px; width: 96%; border-color: #ddd;"/>
          <apex:outputPanel id="attachmentList" layout="block" styleClass="section base-width" rendered="{!(qdm.parentRec.id != null)}">
            <apex:relatedList list="CombinedAttachments" subject="{!qdm.parentRec.id}" />
          </apex:outputPanel>
        </div>
      </apex:outputPanel>
    </body>
  </html>
</apex:outputPanel>

    <script>
        showDependantFields();
        $j('html').scrollTop({!scrollTopValue});
        $j('body').scrollTop({!scrollTopValue});
        if ({!scrollTopValue > 48}) {
            $j('.navi-area').addClass('fixed-top');
        }
    </script>
    <script type="text/javascript">
      window.onscroll = function() {
          var iTop1 = $j('html').scrollTop();
          var iTop2 = $j('body').scrollTop();
          
          $j('input[id$=fieldScrollValue]').val((iTop1 > iTop2) ? iTop1 : iTop2);     
      };
    </script>
    
</apex:page>