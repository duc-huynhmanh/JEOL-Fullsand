<apex:page renderAs="{!renderTarget}" showHeader="false" standardStylesheets="false" applyHtmlTag="false" applyBodyTag="false" doctype="html-5.0" controller="JEOLAsia_QuotationPrintPageCtrl" rendered="{!outputType == 'preview' || outputType == 'print'}">
    <html>
        <head>
            <meta charset="utf-8" />
            <title>Salesforce - {!$ObjectType.AsiaProfitCalculation__c.Label}</title>
            <apex:includeScript value="{!URLFOR($Resource.JQuery)}" />
            <style>
                @page {
                    /*size: A4;*/
                    /*margin: 39pt;*/
                    size:210mm 297mm;
                    margin: 13mm;
                    @top-center {
                        content: element(header);
                        width: 100%;
                    }
                    @bottom-center {
                        content: element(footer);
                    }
                }
                @media print,screen {
                    html, body {
                        margin: 0pt;
                        padding: 0pt;
                        font-size: 10pt;
                        /*line-height: 15px;*/
                        line-height: 4mm;
                        /*font-family: 'Arial Unicode MS';*/
                        height: 100%;
                        /*counter-reset: page;*/
                    }
                    .discountFont {
                        font-family: 'Arial Unicode MS';
                    }
                    .coverPage {
                        page-break-after:always;
                        padding: 1pt;
                    }
                    .pageBreak{
                        page-break-after:always;
                    }
                    .lastPage {
                        page-break-before:always;
                        page-break-after:avoid;
                    }
                    .marginSpace {
                        margin: 2mm auto;
                    }
                    .userSignUnderLine {
                        border-bottom: 1px solid black;
                        /*background-image: {!quotation.Approver__r.UserSign__c};*/
                    }
                    .lineH {
                        /*line-height: 15px;*/
                        line-height: 4mm;
                    }
                    .footerlineH {
                        /*line-height: 10px;*/
                        line-height: 2.5mm;
                    }
                    .firstPage {
                        min-height: 100%;
                        height: auto !important;/*IE6対応===min-height*/
                        height: 100%;
                    }
                    .textFontFamily {
                        font-family: 'Arial Unicode MS';
                    }
                    .contents {
                        display: none;
                        width: 100%;
                        margin: 0 auto;
                    }
                    .boldStr{
                        font-size: 12pt;
                        font-weight: bold;
                    }
                    .boldStr1{
                        font-weight: bold;
                    }
                    .largeFont {
                        font-weight: bold;
                        font-size: 20pt;
                    }
                    .strFont{
                        font-size: 12pt;
                    }
                    .strFont1{
                        font-size: 22pt;
                        font-weight: 900;  
                    }
                    td.textL {
                        text-align: left !important;
                    }
                    .disLeft {
                        text-align: left !important;
                    }
                    .disRight {
                        text-align: right !important;
                    }
                    td.textR {
                        text-align: right !important;
                    }
                    td.textT {
                        vertical-align: text-top !important;
                    }
                    .modelTypeFont {
                        font-size: 16pt;
                        font-weight: 900!important;
                        color: #0B0B61;
                    }
                    .sections3L {
                        width: 60%;
                        height: 5mm;
                        text-align: left;
                        font-size: 12pt;
                        padding-bottom: 6px;
                        font-weight: bold;
                        vertical-align: middle;
                    }
                    .sections3R {
                        width: 40%;
                        height: 5mm;
                        text-align: right;
                        font-size: 12pt;
                        padding-bottom: 6px;
                        font-weight: bold;
                        vertical-align: middle;
                    }
                    .subtotal {
                        height: 8mm;
                        width: 100%;
                        border-collapse: collapse;
                    }
                    .quotation-img {
                        position: absolute;
                        top: 50px;
                        left: 65%;
                    }
                    .quotation-img1 {
                        position: absolute;
                        top: 115px;
                        left: 65%;
                    }
                    .quotation-img2 {
                        position: absolute;
                        top: 55px;
                        left: 50%;
                    }
                    .image-info {
                        position: absolute;
                        top:30%;
                        text-align: left;
                        width: 100%;
                        margin: 0 0 0 0;
                    }
                    .quotation-info {
                        position: absolute;
                        top:40%;
                        text-align: left;
                        width: 100%;
                        margin: 50px 0 0 0;
                    }
                    .quotation-info td {
                        width: 50%;
                        padding-right: 20px;
                    }
                    .coverpage-bottom {
                        position:absolute;
                        bottom:0;   
                    }
                    .coverpage-bottom td{
                        width: 50%;
                    }
                    .greCor {
                        color: #808080;
                        font-size: 12pt;
                    }
                    .lightGreCor {
                        color: #AAAAAA;
                        font-size: 9pt;
                    }
                    .imgLogo {
                        background-position: center center;
                        width: 300px;
                        height: 120px;
                    }
                    .imgLogo1 {
                        background-position: left center;
                        width: 140px;
                        height: 60px;
                    }
                    .headerTable {
                        width: 100%;
                    }
                    .customInfo {
                        width: 100%;
                        margin: -5px auto 5px;
                        padding-top:0;
                    }
                    .customInfo td{
                        width: 50% !important;
                    }
                    .quotationDescription-header {
                        width: 100%;
                        border-radius: 2px;
                        background-color: #becde0;
                        margin: 0;
                    }
                    .quotationDescription-headerBreak {
                        width: 100%;
                        border-radius: 2px;
                        background-color: #becde0;
                        margin: 0;
                        page-break-before:always;
                    }
                    .quotationDescription-headerNotBreak {
                        width: 100%;
                        border-radius: 2px;
                        background-color: #becde0;
                        margin: 0;
                        page-break-after:avoid;
                        page-break-before:avoid;
                    }
                    .quotationDescription-header-title {
                        display: block;
                        padding: 0;
                        page-break-inside:auto
                    }
                    .quotationDescription-header-title0 {
                        padding: 0;
                    }
                    .quotationDescription-detail {
                        width: 100%;
                        background-color: #ffffff;
                        page-break-inside:auto;
                    }
                    .quotationDescription-detail td, th {
                        page-break-inside:auto;
                        text-align: center;
                    }
                    .quotationDescription-detail td{
                        padding: 0;
                    }
                    .tableHeight {
                        height: 10mm;
                    }
                    .tableHeight2 {
                        height: 20mm;
                    }
                    .section5W {
                        width: 100%;
                    }
                    .section5W_td1 {
                        width: 18%;
                    }
                    .right_justified{
                        text-align: right !important;
                    }
                    .headerTdCenter{
                        text-align: center;
                        height: 13mm;
                    }
                    .Hid{
                        display: none;   
                    }
                    div.header {
                        width: 100%;
                    }
                    div.footer {
                        /*display: block;*/
                        padding: 5px;
                        width: 100%;
                        bottom: 0;
                        position: absolute;
                        position: running(footer);
                    }
                    .pageNumberInit
                    {
                        /* ページ開始番号のズレ対応として-1を初期値とする */
                        counter-reset: pageCounter -1;
                    }
                    .pageNumber:before
                    {
                        counter-increment: pageCounter;
                        content: counter(pageCounter);
                    }
                }
            </style>

            <apex:outputPanel layout="none" rendered="{!outputType == 'print'}">
                <style>
                  @media print {
                    .contents {
                      display: block;
                    }
                  }
                </style>
            </apex:outputPanel>
        </head>

        <apex:outputPanel rendered="{!isError}">
            <apex:outputtext value="{!errorMsg}" style="color:red;size: x-large;"/>
        </apex:outputPanel>
        <body>
        <apex:form id="formId1">
            <div class="contents">
                
                <!-- ==================================================================================================== -->
                <!-- Cover Page -->
                <!-- ==================================================================================================== -->
                <apex:outputPanel layout="none" rendered="{!quotation.PrintQuotationFirstPage__c}" >

                    <apex:outputPanel layout="none" rendered="{!quotation.Status__c != '3'}">
                      <img src="{!URLFOR($Resource.WatermarkAsia)}" width="100%" height="100%" style="position: fixed;background-repeat:repeat;left: 0.5cm; top:0cm; z-index:0"/>
                    </apex:outputPanel>

                    <div class="coverPage">
                        <!-- Product Image -->
                        <apex:outputPanel layout="none" rendered="{!IF(imgURL == null, true, false)}">
                            <img src="{!URLFOR($Resource.JEOL_AsiaImg, 'image/productImg.JPG')}" width="100%" height="33.55%" style="position: fixed; z-index:-1;"/>
                        </apex:outputPanel>
                        <apex:outputPanel layout="none" rendered="{!IF(imgURL != null, true, false)}">
                            <apex:image url="{!imgURL}" width="100%" height="33.55%" style="position: fixed; z-index:-1;"/>
                        </apex:outputPanel>
                        <!-- Information on Product Image -->
                        <table class="{!IF(NOT(quotation.PrintProformaInvoice__c), 'quotation-img', 'quotation-img2')}" cellspacing="5">
                            <tr>
                                <td class="boldStr">
                                    <apex:outputText value="{!IF(NOT(quotation.PrintProformaInvoice__c), $Label.JEOLAsia_Quotation_Label_QuotationNo & ' : ', $Label.JEOLAsia_Quotation_Label_OrderAcknowledgeNumber & ' : ')}"/>
                                    <apex:outputText value="{!quotationNoFirstPage}" />
                                </td>
                            </tr>
                            <tr>
                                <td class="boldStr">
                                    <span>
                                        <apex:outputLabel value="Date: "/>
                                        <apex:outputtext value="{0, date, dd/MMM/yyyy}">
                                            <apex:param value="{!quotation.IssueDate__c}"></apex:param>
                                        </apex:outputtext>
                                    </span>
                                </td>
                            </tr>                            
                            <tr>
                                <td>
                                    <apex:outputtext value="{!IF(Not(quotation.PrintProformaInvoice__c), 'Quotation is valid ' & QuotationValidityLabel, '')}"/>
                                </td>
                            </tr>


                        </table>
                        <table class="quotation-img1" cellspacing="5">
                            <tr><td>&nbsp;</td></tr>
                            <tr>
                                <td>
                                    <div style="margin-left: {!IF(quotation.PrintProformaInvoice__c, '0', '0')}px;">
                                        <apex:outputText value="{!productName}" escape="false" />
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td class="modelTypeFont">
                                    <div style="margin-left: {!IF(quotation.PrintProformaInvoice__c, '0', '0')}px;">
                                        <apex:repeat value="{!modelTypeDisplay1List}" var="modelTypeDisplay">
                                            <apex:outputText value="{!modelTypeDisplay}"/><br/>
                                        </apex:repeat>
                                    </div>
                                </td>
                            </tr>
                        </table>
                        
                        <table class="image-info">
                            <tr class="lightGreCor">
                                <td>
                                    <apex:outputtext value="*The product images shown are for illustration purposes only."/>
                                </td>
                            </tr>
                        </table>

                        <!-- Blank Table when sales people mobile is none output it -->
                        <table class="quotation-info">
                            <apex:outputPanel layout="none" rendered="{!IF(quotation.PrintNotPhoneSalespeople__c, true, false)}">
                            <tr>
                                <td colspan="2">&nbsp;</td>
                            </tr>
                            </apex:outputPanel>
                        </table>
                        <!-- Information on product image below -->
                        <table class="quotation-info">
                            <tr class="greCor">
                                <td>
                                    <apex:outputtext value="Instrument:"/>
                                </td>
                                <td>
                                    <apex:outputtext value="Prepared for:"/>
                                </td>
                            </tr>
                            <tr class="boldStr">
                                <td>
                                    <apex:outputText value="{!modelTypeDisplay2}"/>
                                </td>
                                <td>
                                    <apex:outputLabel value="{!quotation.ContractPersonInCharge__c}"/>
                                </td>
                            </tr>
                            <tr class="boldStr">
                                <td rowspan="2" valign="top">
                                    <apex:outputText value="{!productName}" styleClass="boldStr" escape="false"/>
                                </td>
                                <td>
                                    <apex:outputText value="{!ContractName}" escape="false" />
                                </td>
                            </tr>
                            <tr class="strFont">
                                <td colspan="2">
                                    <apex:outputText value="{!IF(quotation.ContractAddress__c != null, quotation.ContractAddress__c, '')}" escape="false"/>
                                </td>
                            </tr>
                            <tr><td colspan="2">&nbsp;</td></tr>
                            <tr>
                                <td align="right" valign="top"></td>
                                <td class="boldStr">
                                    <apex:outputPanel layout="none" rendered="{!ShipmentNameDispFlg}">
                                    END USER&nbsp;:
                                    </apex:outputPanel>
                                </td>
                            </tr>
                            <tr>
                                <td align="right" valign="top"></td>
                                <td class="boldStr">
                                    <apex:outputPanel layout="none" rendered="{!ShipmentNameDispFlg}">
                                    <apex:outputText value="{!ShipmentName}" escape="false" />
                                    </apex:outputPanel>
                                </td>
                            </tr>
                            <tr><td colspan="2">&nbsp;</td></tr>
                            
                            <tr>
                                <td rowspan="8"></td>
                                <td>
                                    <font class="greCor"><apex:outputtext value="JEOL Contact:" rendered="{!quotation.SalesPerson__c != NULL}"/></font>
                                </td>
                            </tr>
                            <tr>
                                <td colspan="2" class="boldStr">
                                    <apex:outputLabel value="{!quotation.SalesPerson__r.Name}"/>
                                </td>
                            </tr>
                            <tr><td colspan="2">&nbsp;</td></tr>
                            <tr>
                                <td colspan="2" class="greCor">
                                    <!-- <apex:outputText value="{!quotation.ContractEmail__c}"/> -->
                                    <apex:outputText value="{!quotation.SalesPerson__r.Email}"/>
                                </td>
                            </tr>
                            <tr>
                                <td colspan="2" class="greCor">
                                    <apex:outputPanel layout="none" rendered="{!IF(quotation.PrintNotPhoneSalespeople__c, false, true)}">
                                        <apex:outputLabel value="{!quotation.SalesPerson__r.Phone}"/>
                                    </apex:outputPanel>
                                </td>
                            </tr>
                            <tr>
                                <td colspan="2" class="strFont">
                                    <apex:outputText value="{!IF((quotation.SalesAssistant__r.Email == null ||
                                                                    quotation.SalesAssistant__r.Email == '' ),'', 'Sales Administration Support:')}"/>
                                </td>
                            </tr>
                            <tr>
                                <td colspan="2" class="greCor">
                                    <apex:outputLabel value="{!quotation.SalesAssistant__r.Email}"/>
                                </td>
                            </tr>
                            
                            <tr class="strFont"><td colspan="2">&nbsp;</td></tr>
                            <tr class="strFont">
                                <td colspan="2">
                                    <apex:outputLabel value="Dear," rendered="{!quotation.PrintProformaInvoice__c}"/>
                                </td>
                            </tr>
                            <tr class="strFont">
                                <td colspan="2">
                                    <apex:outputText value="&nbsp;&nbsp;We are glad to acknowledge your Purchase Order {0}." rendered="{!quotation.PrintProformaInvoice__c && quotation.CustomerPurchaseOrder__c != NULL}" escape="false">
                                        <apex:param value="{!quotation.CustomerPurchaseOrder__c}" />
                                    </apex:outputText>
                                    <apex:outputText value="&nbsp;&nbsp;We are glad to acknowledge your Purchase Order." rendered="{!quotation.PrintProformaInvoice__c && quotation.CustomerPurchaseOrder__c == NULL}" escape="false" />
                                </td>
                            </tr>
                            <tr class="strFont">
                                <td colspan="2">
                                    <apex:outputText rendered="{!quotation.PrintProformaInvoice__c}" escape="false" value="&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- Date:&nbsp;"/>
                                    <apex:outputtext rendered="{!quotation.PrintProformaInvoice__c}" value="{0, date, dd/MMM/yyyy}">
                                        <apex:param value="{!quotation.IssueDate__c}"></apex:param>
                                    </apex:outputtext>
                                </td>
                            </tr>
                            <tr class="strFont">
                                <td colspan="2">
                                    <apex:variable var="decimalDispFlg" value="{!IF(quotation.TotalTaxAmount__c == FLOOR(quotation.TotalTaxAmount__c),false,true)}"/>
                                    <apex:outputText value="&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- Amount: {0} {1,number,###,###,##0.00}" rendered="{!quotation.PrintProformaInvoice__c && decimalDispFlg}" escape="false">
                                        <apex:param value="{!quotation.SalesCurrency__c}" />
                                        <apex:param value="{! quotation.TotalTaxAmount__c }" />
                                    </apex:outputText>
                                    <apex:outputText value="&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- Amount: {0} {1,number,###,###,###}" rendered="{!quotation.PrintProformaInvoice__c && NOT(decimalDispFlg)}" escape="false">
                                        <apex:param value="{!quotation.SalesCurrency__c}" />
                                        <apex:param value="{! quotation.TotalTaxAmount__c }" />
                                    </apex:outputText>
                                </td>
                            </tr>
                        </table>
                        
                        <table class="coverpage-bottom">
                            <tr>
                                <td rowspan="3">
                                    <div align="left">
                                        <img class="imgLogo" src="{!URLFOR($Resource.JEOL_AsiaImg, 'image/jeol-logo1.jpg')}"/>
                                    </div>
                                </td>
                                <td>
                                    <font style="color: #a9a9a9;">
                                        <apex:outputLabel value="{!IF(quotation.OrgName__c != null, quotation.OrgName__c, '')}"/>
                                    </font>
                                </td>
                            </tr>
                            <tr>
                                <td colspan="2" class="greCor">
                                    <apex:outputText value="{!IF(quotation.OrgAddress__c != null, quotation.OrgAddress__c, '')}" escape="false"/>
                                </td>
                            </tr>
                            <tr>
                                <td colspan="2" class="greCor">
                                    <apex:outputText value="Phone: {!quotation.OrgPhone__c}"
                                                     rendered="{!quotation.OrgPhone__c != null}"/>
                                    <apex:outputText value="&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"
                                                     rendered="{!quotation.OrgPhone__c != null}"
                                                     escape="false"/>
                                    <apex:outputText value="Fax: {!quotation.OrgFax__c}"
                                                     rendered="{!quotation.OrgFax__c != null}"/>
                                </td>
                            </tr>
                        </table>
                    </div>
                </apex:outputPanel>
                
                <!-- ==================================================================================================== -->
                <!-- first page info -->
                <!-- ==================================================================================================== -->
                <div class="firstPage">
                    
                    <!-- ---------------------------------------------------------------------------------------------------- -->
                    <!-- ページ番号 初期化                                                                                    -->
                    <!-- - ページ番号表示はCSSを利用し、ここから順次採番してページ番号を表示                                  -->
                    <!-- ---------------------------------------------------------------------------------------------------- -->
                    <span class="pageNumberInit" />
                    
                    <!-- ---------------------------------------------------------------------------------------------------- -->
                    <!-- フッター セクション（全ページ共通）                                                                  -->
                    <!-- - フッターはこのfooterクラスのdivを、全ページ共通して利用する                                        -->
                    <!-- - ここより以前のページは該当のdiv宣言がされていないのでフッターは表示されない                        -->
                    <!-- ---------------------------------------------------------------------------------------------------- -->
                    <div class="footer">
                        <table align="center" width="100%" class="footerlineH">
                            <tr>
                                <td>
                                    <apex:outputLabel value="{!IF(quotation.PrintProformaInvoice__c, 'Proforma Invoice' & ' : ',$Label.JEOLAsia_Quotation_Label_QuotationNo & ' : ')}"/>
                                    <apex:outputText value="{!quotationNoOtherPage}" />
                                </td>
                                <td align="right">
                                    <span>
                                        Page&nbsp;<span class="pageNumber" />&nbsp;of&nbsp;{! totalPageNumber }
                                    </span>
                                </td>
                            </tr>
                            <tr>
                                <td colspan="2">
                                    <apex:outputLabel value="{!IF(quotation.PrintProformaInvoice__c, 'Proforma Invoice Date : ','Quotation Date : ')}"/>
                                    <apex:outputtext value="{0, date, dd/MMM/yyyy}">
                                        <apex:param value="{!quotation.IssueDate__c}"></apex:param>
                                    </apex:outputtext>
                                </td>
                            </tr>
                        </table>
                    </div>
                    
                    <!-- ---------------------------------------------------------------------------------------------------- -->
                    <!-- 以降から見積データ関連出力処理 -->
                    <!-- ---------------------------------------------------------------------------------------------------- -->
                    <apex:variable value="{!0}" var="LineNo"/>
                    <apex:variable value="{!0}" var="reLineNo"/>
                    <apex:variable value="{!0}" var="othersNo"/>
                    
                    <apex:repeat value="{!pageBlockList}" var="pageDetail">
                        
                        <div class="{!IF(pageDetail.pageBreak && pageDetail.pageNo != 1, 'pageBreak', '')}" />

                        <!-- page break section1 -->
                        <table class="header {!IF(pageDetail.section1AppearTime == 1, '', 'Hid')}"
                               align="center"
                               width="100%">
                            <tr class="tableHeight">
                                <td rowspan="2" width="30%">
                                    <div align="left">
                                        <img class="imgLogo1" src="{!URLFOR($Resource.JEOL_AsiaImg, 'image/jeol-logo3.jpg')}"/>
                                    </div>
                                </td>
                                <td align="left" class="strFont1">
                                    <apex:outputText value="{!modelTypeDisplay3}" rendered="{!quotation.RecordType.DeveloperName != 'SVC'}"/>
                                </td>
                            </tr>
                            <tr class="tableHeight">
                                <td colspan="2" align="right" class="strFont1">
                                    <apex:outputText value="{!IF(quotation.PrintProformaInvoice__c,'Proforma Invoice','Quotation')}"/>
                                </td>
                            </tr>
                            <tr class="tableHeight">
                                <td>
                                    <apex:outputText value="{!IF(pageDetail.pageQuotation.OrgAddress__c != null, pageDetail.pageQuotation.OrgAddress__c, '')}" escape="false"/>
                                </td>
                                <td align="right">
                                    <span>
                                        <apex:outputLabel value="{!IF(quotation.PrintProformaInvoice__c,'Proforma Invoice',$Label.JEOLAsia_Quotation_Label_QuotationNo)}"/>
                                        <apex:outputText value=": " />
                                        <apex:outputLabel value="{!quotationNoOtherPage}" />
                                    </span>
                                </td>
                            </tr>
                            <tr class="tableHeight">
                                <td align="left">
                                    <apex:outputField value="{!pageDetail.pageQuotation.ContractPersonInCharge__c}"/>
                                </td>
                                <td align="right">
                                    <span>
                                        <apex:outputLabel value="Quotation Date: " rendered="{!NOT(quotation.PrintProformaInvoice__c)}"/>
                                        <apex:outputtext value="{0, date, dd/MMM/yyyy}" rendered="{!NOT(quotation.PrintProformaInvoice__c)}">
                                            <apex:param value="{!pageDetail.pageQuotation.IssueDate__c}"></apex:param>
                                        </apex:outputtext>
                                    </span>
                                </td>
                            </tr>
                            <tr class="{!IF(pageDetail.pageQuotation.ContractContact_dummyField__r.Email == null ||
                                            pageDetail.pageQuotation.ContractContact_dummyField__r.Email == '', 'Hid', 'tableHeight')}">
                                <td colspan="2">
                                    <apex:outputLabel value="{!pageDetail.pageQuotation.ContractContact_dummyField__r.Email}"/>
                                </td>
                            </tr>
                            <tr class="tableHeight">
                                <td align="left">
                                    <apex:outputField value="{!pageDetail.pageQuotation.ContractName__c}"/>
                                </td>
                                <td colspan="2" align="right">
                                    <span>
                                        <apex:outputtext value="Quotation is valid {!QuotationValidityLabel}" rendered="{!NOT(quotation.PrintProformaInvoice__c)}"/>
                                    </span>
                                </td>
                            </tr>
                            <tr class="{!IF(pageDetail.pageQuotation.PrintQuotationFirstPage__c ||
                                                (!pageDetail.pageQuotation.PrintQuotationFirstPage__c &&
                                                 ((pageDetail.pageQuotation.ContractAddress__c != null && pageDetail.pageQuotation.ContractAddress__c != '') ||
                                                  (pageDetail.pageQuotation.SalesPerson__r.Name != null && pageDetail.pageQuotation.SalesPerson__r.Name != '') ||
                                                  (pageDetail.pageQuotation.ContractEmail__c != null && pageDetail.pageQuotation.ContractEmail__c != '') ||
                                                  (pageDetail.pageQuotation.SalesPerson__r.Phone != null && pageDetail.pageQuotation.SalesPerson__r.Phone != '') ||
                                                  (pageDetail.pageQuotation.SalesAssistant__r.Email != null && pageDetail.pageQuotation.SalesAssistant__r.Email != ''))), 'Hid', 'tableHeight')}">
                                <td valign="top">
                                    <apex:outputText value="{!IF(pageDetail.pageQuotation.ContractAddress__c != null, pageDetail.pageQuotation.ContractAddress__c, '')}" escape="false"/>
                                </td>
                                <td>
                                    <table class="{!IF(!pageDetail.pageQuotation.PrintQuotationFirstPage__c &&
                                                        (pageDetail.pageQuotation.SalesPerson__r.Name == null ||
                                                        pageDetail.pageQuotation.SalesPerson__r.Name == '') &&
                                                        (pageDetail.pageQuotation.ContractEmail__c == null ||
                                                        pageDetail.pageQuotation.ContractEmail__c == '') &&
                                                        (pageDetail.pageQuotation.SalesPerson__r.Phone == null ||
                                                        pageDetail.pageQuotation.SalesPerson__r.Phone == '') &&
                                                        (pageDetail.pageQuotation.SalesAssistant__r.Email == null ||
                                                        pageDetail.pageQuotation.SalesAssistant__r.Email == ''), 'Hid', '')}">
                                        <tr>
                                            <td align="left" style="width: 40% !important;"></td>
                                            <td align="right" valign="top" style="font-weight: bold;width: 20% !important;">
                                                <div class="{!IF(pageDetail.pageQuotation.PrintQuotationFirstPage__c, 'Hid', '')}">
                                                    <apex:outputLabel value="JEOL Contact:"/>
                                                </div>
                                            </td>
                                            <td align="left" style="width: 40% !important;">
                                                <div class="{!IF(pageDetail.pageQuotation.PrintQuotationFirstPage__c, 'Hid', '')}">
                                                    <div><apex:outputField value="{!pageDetail.pageQuotation.SalesPerson__r.Name}"/></div>
                                                    <div><apex:outputText value="{!pageDetail.pageQuotation.ContractEmail__c}"/></div>
                                                    <div>
                                                        <apex:outputLabel value="{!IF(pageDetail.pageQuotation.PrintNotPhoneSalespeople__c, '', pageDetail.pageQuotation.SalesPerson__r.Phone)}"/>
                                                    </div>
                                                    <div style="font-weight: bold;">
                                                        <apex:outputtext value="{!IF((pageDetail.pageQuotation.SalesAssistant__r.Email != null &&
                                                                                    pageDetail.pageQuotation.SalesAssistant__r.Email != ''),'Sales Administration Support:', '')}"/>
                                                    </div>
                                                    <div class="{!IF(pageDetail.pageQuotation.SalesAssistant__r.Email != null &&
                                                                    pageDetail.pageQuotation.SalesAssistant__r.Email != '', '', 'Hid')}">
                                                        <apex:outputText value="{!pageDetail.pageQuotation.SalesAssistant__r.Email}"/>
                                                    </div>
                                                </div>
                                            </td>
                                        </tr>
                                    </table>
                                </td>
                            </tr>
                        </table>
                        <!-- page break section2 -->
                        <table class="quotationDescription-detail {!IF(pageDetail.noRecommendList.size > 0 , '', 'Hid')}"
                               align="center" 
                               cellspacing="0" 
                               cellpadding="0"
                               style="margin-bottom: {!section2Margin}mm;margin-top:{!section2Margin}mm;">
                            <tr class="quotationDescription-header boldStr">
                                <td width="5%" class="headerTdCenter">
                                    <div class="quotationDescription-header-title">Line</div>
                                </td>
                                <td width="22%" class="headerTdCenter">
                                    <div class="quotationDescription-header-title">Model Type</div>
                                </td>
                                <td width="33%" class="headerTdCenter">
                                    <div class="quotationDescription-header-title">Description</div>
                                </td>
                                <td width="5%" class="headerTdCenter {!IF(!pageDetail.pageQuotation.PrintQuantityUnit__c &&
                                                                          !pageDetail.pageQuotation.PrintUnitPrice__c , 'right_justified', '')}">
                                    <div class="quotationDescription-header-title">Qty</div>
                                </td>
                                <td width="5%" class="{!IF(pageDetail.pageQuotation.PrintQuantityUnit__c,'headerTdCenter', 'Hid')}">
                                    <div class="quotationDescription-header-title"></div>
                                </td>
                                <td width="15%" class="{!IF(pageDetail.pageQuotation.PrintUnitPrice__c,'headerTdCenter', 'Hid')}">
                                    <div class="quotationDescription-header-title">Unit Price</div>
                                </td>
                                <td width="15%" align="center" class="headerTdCenter">
                                    <apex:outputPanel rendered="{!IF(pageDetail.pageQuotation.PrintNotDetailAmounts__c, false, true)}">
                                        <div class="quotationDescription-header-title">Ext. Price</div>
                                        <div class="quotationDescription-header-title">( {!pageDetail.pageQuotation.SalesCurrency__c} )</div>
                                    </apex:outputPanel>
                                </td>
                            </tr>
                            <!-- Type A -->
                            <apex:repeat value="{!pageDetail.noRecommendList}" var="qd">
                                <apex:variable value="{!if(qd.Depth__c == 0 && qd.Type__c == '1', LineNo + 1, LineNo)}" var="LineNo"/>
                                <tr style="height: 4mm;" class="{!IF(qd.Type__c == '1', '', 'Hid')}">
                                    <td width="5%" class="textT">
                                        <div class="quotationDescription-header-title">
                                            <apex:outputText value="{!if(qd.Depth__c == 0 && qd.Type__c == '1', LineNo, '')}"/>
                                        </div>
                                    </td>
                                    <td width="22%" class="textT textL">
                                        <div class="quotationDescription-header-title">
                                            <apex:repeat value="{!noRecommendModelTypeMap[qd.id]}" var="modelTypeRow">
                                                <apex:outputText value="{!modelTypeRow}"/><br/>
                                            </apex:repeat>
                                        </div>
                                    </td>
                                    <td width="33%" class="textT textL">
                                        <div class="quotationDescription-header-title">
                                            <apex:repeat value="{!noRecommendBodyMap[qd.id]}" var="bodyRow">
                                                &nbsp;&nbsp;<apex:outputText value="{!bodyRow}"/><br/>
                                            </apex:repeat>
                                        </div>
                                    </td>
                                    <td width="5%" class="textT right_justified">
                                        <div class="{!IF(qd.Quantity__c != null && qd.Quantity__c != 0, '', 'Hid')}">
                                        <span class="quotationDescription-header-title">
                                            <apex:outputText value="{0, number, #.#}">
                                                <apex:param value="{!qd.Quantity__c}"></apex:param>
                                            </apex:outputText>
                                        </span>
                                        </div>
                                    </td>
                                    <td width="5%" class="textT {!IF(pageDetail.pageQuotation.PrintQuantityUnit__c,'textL', 'Hid')}">
                                        <span class="quotationDescription-header-title">
                                            <apex:outputText value="{!IF(qd.Quantity__c != 0 &&
                                                                         qd.Quantity__c != null, qd.QuantityUnit__c, '')}"/>
                                        </span>
                                    </td>
                                    <td width="15%" class="textT {!IF(pageDetail.pageQuotation.PrintUnitPrice__c, 'textR', 'Hid')}">
                                        <div class="{!IF(qd.SalesUnitPrice__c != 0 && qd.SalesUnitPrice__c != null, '', 'Hid')}">
                                            <apex:outputField value="{!qd.SalesUnitPrice__c}"/>
                                        </div>
                                    </td>
                                    <td width="15%" class="textT textR" >
                                        <apex:outputPanel rendered="{!IF(pageDetail.pageQuotation.PrintNotDetailAmounts__c, false, true)}">
                                            <div class="quotationDescription-header-title" style="display: inline-block;">
                                                <div class="{!IF(qd.IsShowDetailAmount__c &&
                                                                qd.SalesPriceFormula__c != 0 &&
                                                                qd.SalesPriceFormula__c != null, '','Hid')}">
                                                    <apex:outputField value="{!qd.SalesPriceFormula__c}" />
                                                </div>
                                            </div>
                                        </apex:outputPanel>
                                    </td>
                                </tr>
                                <!-- child sum detail &&pageDetail.pageQuotation.Print2SPDetail__c-->
                                <!-- <tr style="height: 4mm;" class="{!IF(qd.Type__c == '1' &&
                                                                    LineNo == (pageDetail.noRecommendList.size - countBtype) &&
                                                                    !pageDetail.pageQuotation.PrintNotDetailAmounts__c , '', 'Hid')}">
                                    <apex:variable value="{!IF(LineNo == (pageDetail.noRecommendList.size - countBtype) &&
                                                            !pageDetail.pageQuotation.PrintNotDetailAmounts__c, (LineNo + 1), LineNo)}" var="LineNo"/>
                                    <td width="5%">
                                        <div class="quotationDescription-header-title">
                                            <apex:outputText value="{!LineNo}"/>
                                        </div>
                                    </td>
                                    <td width="15%" ></td>
                                    <td style="text-align: left;">
                                        <div class="quotationDescription-header-title">
                                            <apex:outputText value="Spare Parts for {!qd.ModelType__c}"/>
                                        </div>
                                    </td>
                                    <td colspan="{!CospanCol4}" class="textR">
                                        <div class="quotationDescription-header-title">
                                            <apex:outputText value="{!qd.SalesPriceSalesCur2SP__c}"/>
                                        </div>
                                    </td>
                                </tr> -->
                                <!-- Type B -->
                                <tr style="height: 4mm;" class="{!IF(qd.Type__c == '2', '', 'Hid')}">
                                    <td width="5%" class="textT">
                                        <div class="quotationDescription-header-title">
                                            <apex:outputText value="{!if(qd.Depth__c == 0 && qd.Type__c == '1',LineNo, '')}"/>
                                        </div>
                                    </td>
                                    <td width="95%" colspan="{!CospanCol1}" class="textT textL">
                                        <apex:repeat value="{!noRecommendBodyMap[qd.id]}" var="bodyRow">
                                            <apex:outputText value="{!bodyRow}"/><br/>
                                        </apex:repeat>
                                    </td>
                                </tr>
                            </apex:repeat>
                                <tr class="subtotal {!IF(pageDetail.pageQuotation.OutputSubtitle__c = true, 
                                                          IF(( pageDetail.pageQuotation.SubtitleLabel__c != null &&
                                                                pageDetail.pageQuotation.SubtitleLabel__c != '') ||
                                                                ( pageDetail.pageQuotation.Subtitle__c != null && 
                                                                pageDetail.pageQuotation.Subtitle__c != 0 ), '', 'Hid'), 'Hid')} {!IF(section2row == LineNo && section2LastPageNo == pageDetail.pageNo, '', 'Hid')}">
                                    <td class="sections3L textL" colspan="3">
                                        <apex:outputLabel value="{!pageDetail.pageQuotation.SubtitleLabel__c}" />
                                    </td>
                                    <td class="sections3R textR {!IF(pageDetail.pageQuotation.Subtitle__c != 0 &&
                                                                         pageDetail.pageQuotation.Subtitle__c != null, '', 'Hid')}" colspan="{!CospanCol3}">
                                        <apex:outputText value="{0, number, ###,###.00}">
                                            <apex:param value="{!pageDetail.pageQuotation.Subtitle__c}"></apex:param>
                                        </apex:outputText>
                                    </td>
                                </tr>
                        </table>
                        <!-- section3 -->
                        <table border="1"
                               cellspacing="0"
                               bordercolor="#000000"
                               width="100%"
                               class="{!IF(section2row == LineNo && pageDetail.section3AppearTime == 1, '', 'Hid')}">
                            <tr class="{!IF(pageDetail.pageQuotation.CustomReductionAmount1__c != null &&
                                            pageDetail.pageQuotation.CustomReductionAmount1__c != 0, '', 'Hid')}">
                                <td class="sections3L">
                                    <apex:outputLabel value="{!pageDetail.pageQuotation.CustomReductionName1__c}"/>
                                </td>
                                <td class="sections3R">
                                    <div class="{!IF(pageDetail.pageQuotation.CustomReductionAmount1__c != null &&
                                            pageDetail.pageQuotation.CustomReductionAmount1__c != 0, '', 'Hid')}">
                                    <apex:outputText value="{!IF(pageDetail.pageQuotation.SubtotalReduction1PlusMinus__c = '-', '( ', '')}"/>
                                    <apex:outputText value="{0, number, ###,###.00}">
                                        <apex:param value="{!pageDetail.pageQuotation.CustomReductionAmount1__c}"></apex:param>
                                    </apex:outputText>
                                    <apex:outputText value="{!IF(pageDetail.pageQuotation.SubtotalReduction1PlusMinus__c = '-', ' )', '')}"/>
                                    </div>
                                </td>
                            </tr>
                            <tr class="{!IF(pageDetail.pageQuotation.OutputSubtotalReduction1__c = true,
                                            IF((pageDetail.pageQuotation.SubtotalReductionName1__c != null && 
                                                pageDetail.pageQuotation.SubtotalReductionName1__c != '') ||
                                                (pageDetail.pageQuotation.SubtotalReductionAmount1__c != null && 
                                                pageDetail.pageQuotation.SubtotalReductionAmount1__c != 0), '', 'Hid'),'Hid')}">
                                <td class="sections3L"><apex:outputLabel value="{!pageDetail.pageQuotation.SubtotalReductionName1__c}" /></td>
                                <td class="sections3R">
                                    <div class="{!IF(pageDetail.pageQuotation.SubtotalReductionAmount1__c != null &&
                                            pageDetail.pageQuotation.SubtotalReductionAmount1__c != 0, '', 'Hid')}">
                                    <apex:outputText value="{0, number, ###,###.00}">
                                        <apex:param value="{!pageDetail.pageQuotation.SubtotalReductionAmount1__c}"></apex:param>
                                    </apex:outputText>
                                    </div>
                                </td>
                            </tr>
                            <tr class="{!IF(pageDetail.pageQuotation.CustomReductionAmount2__c != null && 
                                            pageDetail.pageQuotation.CustomReductionAmount2__c != 0, '', 'Hid')}">
                                <td class="sections3L"><apex:outputLabel value="{!pageDetail.pageQuotation.CustomReductionName2__c}" /></td>
                                <td class="sections3R">
                                    <div class="{!IF(pageDetail.pageQuotation.CustomReductionAmount2__c != null &&
                                            pageDetail.pageQuotation.CustomReductionAmount2__c != 0, '', 'Hid')}">
                                    <apex:outputText value="{!IF(pageDetail.pageQuotation.SubtotalReduction2PlusMinus__c = '-', '( ', '')}"/>
                                    <apex:outputText value="{0, number, ###,###.00}">
                                        <apex:param value="{!pageDetail.pageQuotation.CustomReductionAmount2__c}"></apex:param>
                                    </apex:outputText>
                                    <apex:outputText value="{!IF(pageDetail.pageQuotation.SubtotalReduction2PlusMinus__c = '-', ' )', '')}"/>
                                    </div>
                                </td>
                            </tr>
                            <tr class="{!IF(pageDetail.pageQuotation.OutputSubtotalReduction2__c, 
                                            IF((pageDetail.pageQuotation.SubtotalReductionName2__c != null && 
                                                pageDetail.pageQuotation.SubtotalReductionName2__c != '') || 
                                                (pageDetail.pageQuotation.SubtotalReductionAmount2__c != null && 
                                                pageDetail.pageQuotation.SubtotalReductionAmount2__c != 0), '', 'Hid'), 'Hid')}">
                                <td class="sections3L"><apex:outputLabel value="{!pageDetail.pageQuotation.SubtotalReductionName2__c}" /></td>
                                <td class="sections3R">
                                    <div class="{!IF(pageDetail.pageQuotation.SubtotalReductionAmount2__c != 0 &&
                                                                     pageDetail.pageQuotation.SubtotalReductionAmount2__c != null, '', 'Hid')}">
                                        <apex:outputText value="{0, number, ###,###.00}">
                                            <apex:param value="{!pageDetail.pageQuotation.SubtotalReductionAmount2__c}"></apex:param>
                                        </apex:outputText>
                                    </div>
                                </td>
                            </tr>
                            <tr class="{!IF(pageDetail.pageQuotation.CustomReductionAmount3__c != null && 
                                            pageDetail.pageQuotation.CustomReductionAmount3__c != 0, '', 'Hid')}">
                                <td class="sections3L"><apex:outputLabel value="{!pageDetail.pageQuotation.CustomReductionName3__c}" /></td>
                                <td class="sections3R">
                                    <div class="{!IF(pageDetail.pageQuotation.CustomReductionAmount3__c != 0 &&
                                                                     pageDetail.pageQuotation.CustomReductionAmount3__c != null, '', 'Hid')}">
                                    <apex:outputText value="{!IF(pageDetail.pageQuotation.SubtotalReduction3PlusMinus__c = '-', '( ', '')}"/>
                                    <apex:outputText value="{0, number, ###,###.00}">
                                        <apex:param value="{!pageDetail.pageQuotation.CustomReductionAmount3__c}"></apex:param>
                                    </apex:outputText>
                                    <apex:outputText value="{!IF(pageDetail.pageQuotation.SubtotalReduction3PlusMinus__c = '-', ' )', '')}"/>
                                    </div>
                                </td>
                            </tr>
                            <tr class="{!IF(pageDetail.pageQuotation.OutputTotalAmount__c = true && 
                                            pageDetail.pageQuotation.TotalAmount__c != null && 
                                            pageDetail.pageQuotation.TotalAmount__c != 0, '', 'Hid')}">
                                <td class="sections3L"><apex:outputLabel value="{!pageDetail.pageQuotation.TotalAmountName__c}" /></td>
                                <td class="sections3R">
                                    <div class="{!IF(pageDetail.pageQuotation.TotalAmount__c != 0 &&
                                                                     pageDetail.pageQuotation.TotalAmount__c != null, '', 'Hid')}">
                                        <apex:outputText value="{0, number, ###,###.00}">
                                            <apex:param value="{!pageDetail.pageQuotation.TotalAmount__c}"></apex:param>
                                        </apex:outputText>
                                    </div>
                                </td>
                            </tr>
                            <tr class="{!IF(pageDetail.pageQuotation.OutputConsumptionTaxAmount__c = true && 
                                            pageDetail.pageQuotation.ConsumptionTaxAmount__c != null &&
                                            pageDetail.pageQuotation.ConsumptionTaxAmount__c != 0, '', 'Hid')}">
                                <td class="sections3L"><apex:outputText value="Tax( {!pageDetail.pageQuotation.TaxRate__c} %)" /></td>
                                <td class="sections3R">
                                    <div class="{!IF(pageDetail.pageQuotation.ConsumptionTaxAmount__c != 0 &&
                                                                     pageDetail.pageQuotation.ConsumptionTaxAmount__c != null, '', 'Hid')}">
                                        <apex:outputText value="{0, number, ###,###.00}">
                                            <apex:param value="{!pageDetail.pageQuotation.ConsumptionTaxAmount__c}"></apex:param>
                                        </apex:outputText>
                                    </div>
                                </td>
                            </tr>
                            <tr class="{!IF(pageDetail.pageQuotation.OutputTotalTaxAmount__c = true && 
                                            pageDetail.pageQuotation.TotalTaxAmount__c != null && 
                                            pageDetail.pageQuotation.TotalTaxAmount__c != 0, '', 'Hid')}">
                                <td class="sections3L" style="font-size: 22pt !important;height: 10mm !important;">
                                    <apex:outputText value="{!pageDetail.pageQuotation.TotalTaxAmountName__c}"/></td>
                                <td class="sections3R" style="font-size: 22pt !important;height: 10mm !important;">
                                    <div class="{!IF(pageDetail.pageQuotation.TotalTaxAmount__c != 0 &&
                                                                     pageDetail.pageQuotation.TotalTaxAmount__c != null, '', 'Hid')}">
                                        <apex:outputText value="{0, number, ###,###.00}">
                                            <apex:param value="{!pageDetail.pageQuotation.TotalTaxAmount__c}"></apex:param>
                                        </apex:outputText>
                                    </div>
                                </td>
                            </tr>
                            <div class="marginSpace {!IF(section2row == LineNo && pageDetail.section3AppearTime == 1, '', 'Hid')}" align="right">
                                All Prices are in {!pageDetail.pageQuotation.SalesCurrencyLabel__c}
                            </div>
                        </table>
                        <!-- section4 -->
                        <!-- Start -->
                        <apex:outputPanel layout="none" rendered="{!NOT(quotation.PrintProformaInvoice__c)}">
                        <div class="textL boldStr marginSpace {!IF(section2row == LineNo &&
                                                               pageDetail.section4TitleAppearTime == 1, 
                                                                    IF(pageDetail.recommendList.size > 0, '', 'Hid'), 'Hid')}" style="height: 5mm;">
                            Optionally Available (May replace above item(s) or be added to system):
                        </div>
                        <table class="quotationDescription-detail {!IF(section2row == LineNo, IF(pageDetail.recommendList.size > 0, '', 'Hid'), 'Hid')}"
                                align="center"
                                cellspacing="0"
                                cellpadding="0"
                                style="margin-bottom: 2mm;">
                            <tr class="quotationDescription-header boldStr">
                                <td width="5%" class="headerTdCenter">
                                    <div class="quotationDescription-header-title">Line</div>
                                </td>
                                <td width="22%" class="headerTdCenter">
                                    <div class="quotationDescription-header-title">Model Type</div>
                                </td>
                                <td width="33%" class="headerTdCenter">
                                    <div class="quotationDescription-header-title">Description</div>
                                </td>
                                <td width="5%" class="headerTdCenter {!IF(!pageDetail.pageQuotation.PrintQuantityUnit__c &&
                                                                           !pageDetail.pageQuotation.PrintUnitPrice__c, 'right_justified', '')}">
                                    <div class="quotationDescription-header-title">Qty</div>
                                </td>
                                <td width="5%" class="{!IF(pageDetail.pageQuotation.PrintQuantityUnit__c,'headerTdCenter', 'Hid')}">
                                    <div class="quotationDescription-header-title"></div>
                                </td>
                                <td width="15%" class="{!IF(pageDetail.pageQuotation.PrintUnitPrice__c,'headerTdCenter', 'Hid')}">
                                    <div class="quotationDescription-header-title">Unit Price</div>
                                </td>
                                <td width="15%" align="center" class="headerTdCenter">
                                    <apex:outputPanel rendered="{!IF(pageDetail.pageQuotation.PrintNotDetailAmounts__c, false, true)}">
                                        <div class="quotationDescription-header-title">Ext. Price</div>
                                        <div class="quotationDescription-header-title">( {!pageDetail.pageQuotation.SalesCurrency__c} )</div>
                                    </apex:outputPanel>
                                </td>
                            </tr>
                            <!-- Type A -->
                            <apex:repeat value="{!pageDetail.recommendList}" var="reco">
                                <apex:variable value="{!if(reco.Depth__c == 0 && reco.Type__c == '1',reLineNo + 1, reLineNo)}" var="reLineNo"/>
                                <tr style="height: 4mm;" class="{!IF(reco.Type__c == '2', '', 'Hid')}">
                                    <td width="5%" class="textT">
                                        <div class="quotationDescription-header-title">
                                            <apex:outputText value="{!if(reco.Depth__c == 0 && reco.Type__c == '1', reLineNo, '')}"/>
                                        </div>
                                    </td>
                                    <td width="95%" colspan="{!CospanCol2}" class="textT textL">
                                        <apex:repeat value="{!recommendBodyMap[reco.id]}" var="bodyRow">
                                            <apex:outputText value="{!bodyRow}"/><br/>
                                        </apex:repeat>
                                    </td>
                                </tr>
                                <!-- Type B -->
                                <tr style="height: 4mm;" class="{!IF(reco.Type__c == '1', '', 'Hid')}">
                                    <td width="5%" class="textT">
                                        <div class="quotationDescription-header-title">
                                            <apex:outputText value="{!if(reco.Depth__c == 0 && reco.Type__c == '1', reLineNo, '')}"/>
                                        </div>
                                    </td>

                                    <td width="22%" class="textT textL">
                                        <div class="quotationDescription-header-title">
                                            <apex:repeat value="{!recommendModelTypeMap[reco.id]}" var="modelType">
                                                <apex:outputText value="{!modelType}"/><br/>
                                            </apex:repeat>
                                        </div>
                                    </td>
                                    <td width="33%" class="textT textL">
                                        <div class="quotationDescription-header-title">
                                            <apex:repeat value="{!recommendBodyMap[reco.id]}" var="bodyRow">
                                                &nbsp;&nbsp;<apex:outputText value="{!bodyRow}"/><br/>
                                            </apex:repeat>
                                        </div>
                                    </td>
                                    
                                    <td width="5%" class="textT right_justified">
                                        <div class="{!IF(reco.Quantity__c != null && reco.Quantity__c!= 0, '', 'Hid')}">
                                        <div class="quotationDescription-header-title">
                                            <apex:outputText value="{0, number, #}">
                                                <apex:param value="{!reco.Quantity__c}"></apex:param>
                                            </apex:outputText>
                                        </div>
                                        </div>
                                    </td>
                                    <td width="5%" class="textT {!IF(pageDetail.pageQuotation.PrintQuantityUnit__c,'textL', 'Hid')}">
                                        <span class="quotationDescription-header-title">
                                            <apex:outputText value="{!IF(reco.Quantity__c != 0 &&
                                                                         reco.Quantity__c != null, reco.QuantityUnit__c, '')}"/>
                                        </span>
                                    </td>
                                    <td width="15%" class="textT {!IF(pageDetail.pageQuotation.PrintUnitPrice__c, 'textR', 'Hid')}">
                                        <div class="{!IF(reco.SalesUnitPrice__c != 0 && reco.SalesUnitPrice__c != null, '', 'Hid')}">
                                            <apex:outputField value="{!reco.SalesUnitPrice__c}"/>
                                        </div>
                                    </td>
                                    <td width="15%" class="textT extR" >
                                        <apex:outputPanel rendered="{!IF(pageDetail.pageQuotation.PrintNotDetailAmounts__c, false, true)}">
                                            <div class="quotationDescription-header-title" style="display: inline-block;" >
                                                <div class="{!IF(reco.IsShowDetailAmount__c, '', 'Hid')}">
                                                    <div class="{!IF(reco.SalesPriceFormula__c != 0 && reco.SalesPriceFormula__c != null, '', 'Hid')}">
                                                        <apex:outputField value="{!reco.SalesPriceFormula__c}" />
                                                    </div>
                                                </div>
                                            </div>
                                        </apex:outputPanel>
                                    </td>
                                </tr>
                            </apex:repeat>
                        </table>
                        </apex:outputPanel>
                        <!-- END -->
                        <!-- section5 -->
                        <table class="{!IF(pageDetail.section5_Freight_AppearTime != 0 ||
                                            pageDetail.section5_Estimated_AppearTime != 0 ||
                                            pageDetail.section5_Payment_AppearTime != 0 ||
                                            pageDetail.section5_Others_AppearTime != 0, 'section5W', 'Hid')}">
                            <tr style="height: 4mm;" class="{!IF(pageDetail.section5_Freight_AppearTime != 0, '', 'Hid')}" border="1">
                                <td class="textL boldStr1 section5W_td1">
                                    <apex:outputText value="Freight Terms:"/>
                                </td>
                                <td>
                                    <span>
                                        <apex:outputText value="{!pageDetail.pageQuotation.DeliveryCondition3__c}"/>
                                    </span>
                                </td>
                            </tr>
                            <tr style="height: 4mm;" class="{!IF(pageDetail.section5_Estimated_AppearTime != 0 && NOT(quotation.PrintProformaInvoice__c), '', 'Hid')}">
                                <td class="textL boldStr1 section5W_td1">
                                    <apex:outputText value="Estimated Shipment:" rendered="{!pageDetail.pageQuotation.DeliveryDeadline__c != NULL}"/>
                                    <apex:outputText value="{!pageDetail.pageQuotation.DeliveryDate_ArbitrarilyTitle__c}" rendered="{!pageDetail.pageQuotation.DeliveryDeadline__c == NULL}"/>
                                </td>
                                <td>

                                    <apex:outputtext value="{0, date, dd/MMM/yyyy}" rendered="{!pageDetail.pageQuotation.DeliveryDeadline__c != NULL}">
                                        <apex:param value="{!pageDetail.pageQuotation.DeliveryDeadline__c}"></apex:param>
                                    </apex:outputtext>

                                    <apex:outputtext value="{!pageDetail.pageQuotation.DeliveryDate_Arbitrarily__c}" rendered="{!pageDetail.pageQuotation.DeliveryDeadline__c == NULL}" />

                                </td>
                            </tr>
                            <tr class="{!IF(pageDetail.section5_Payment_AppearTime != 0, '', 'Hid')}">
                                <td class="textL textT boldStr1 section5W_td1">
                                    <apex:outputText value="Payment Terms:"/>
                                </td>
                                <td>
                                    <apex:outputText value="{!PaymentTermsLabel}" escape="false"/>
                                </td>
                            </tr>
                            <tr class="{!IF(pageDetail.section5_Others_AppearTime != 0, '', 'Hid')}">
                                <td class="textL textT boldStr1 section5W_td1">
                                    <apex:outputText value="Others:"
                                                     styleClass="{!IF(pageDetail.section5_Others_Title_AppearTime != 0, '', 'Hid')}"/>
                                </td>
                                <td>
                                    <table>
                                        <apex:repeat value="{!pageDetail.otherList}" var="other">
                                        <tr>
                                            <td style="padding:0;height: 4mm;">
                                                <apex:outputText value="{!other}" escape="false"/>
                                            </td>
                                        </tr>
                                        </apex:repeat>
                                    </table>
                                </td>
                            </tr>
                        </table>
                        <!-- section6 -->
                        <apex:outputPanel rendered="{!quotation.RecordType.DeveloperName != 'SVC'}">
                        <table style="margin-top: 10mm;" class="{!IF(pageDetail.section6_Title_AppearTime != 0 || 
                                                                    pageDetail.section6_Warranty_AppearTime != 0 ||
                                                                    pageDetail.section6_Installation_AppearTime != 0 ||
                                                                    pageDetail.section6_Packing_AppearTime != 0 ||
                                                                    pageDetail.section6_Training_AppearTime != 0 ||
                                                                    pageDetail.section6_Export_AppearTime != 0 ||
                                                                    pageDetail.section6_Validity_AppearTime != 0 || 
                                                                    (pageDetail.section6_Manufacturer_AppearTime != 0 && quotation.PrintProformaInvoice__c) || 
                                                                    (pageDetail.section6_BankDetail_AppearTime != 0 && quotation.PrintProformaInvoice__c), '', 'Hid')}" width="100%">
                            <!-- Title -->
                            <tr class="{!IF(pageDetail.section6_Title_AppearTime != 0, '', 'Hid')}">
                                <td colspan="2" class="textL boldStr1" >
                                    <apex:outputText value="Basic Terms & Conditions:" />
                                </td>
                            </tr>
                            <!-- Warranty -->
                            <tr class="{!IF(pageDetail.section6_Warranty_AppearTime != 0, '', 'Hid')}">
                                <td valign="top" class="section5W_td1" align="right">
                                    <apex:outputLabel value="{!$ObjectType.AsiaQuotationTermsConditions__c.Fields.Warranty__c.Label & ' : '}"
                                                      styleClass="{!IF(pageDetail.section6_Warranty_Title_AppearTime != 0, '', 'Hid')}"/>
                                </td>
                                <td>
                                    <table>
                                        <apex:repeat value="{!pageDetail.warrantyList}" var="war">
                                        <tr>
                                            <td style="padding:0;height: 4mm;">
                                                <apex:outputtext value="{!war}" escape="false"/>
                                            </td>
                                        </tr>
                                        </apex:repeat>
                                    </table>
                                </td>
                            </tr>
                            <!-- Installation -->
                            <tr class="{!IF(pageDetail.section6_Installation_AppearTime != 0, '', 'Hid')}">
                                <td valign="top" class="section5W_td1" align="right">
                                    <apex:outputLabel value="{!$ObjectType.AsiaQuotationTermsConditions__c.Fields.Installation__c.Label & ' : '}"
                                                      styleClass="{!IF(pageDetail.section6_Installation_Title_AppearTime != 0, '', 'Hid')}"/>
                                </td>
                                <td>
                                    <table>
                                        <apex:repeat value="{!pageDetail.installationList}" var="ins">
                                        <tr>
                                            <td style="padding:0;height: 4mm;">
                                                <apex:outputtext value="{!ins}" escape="false"/>
                                            </td>
                                        </tr>
                                        </apex:repeat>
                                    </table>
                                </td>
                            </tr>
                            <!-- Packing -->
                            <tr class="{!IF(pageDetail.section6_Packing_AppearTime != 0, '', 'Hid')}">
                                <td valign="top" class="section5W_td1" align="right">
                                    <apex:outputLabel value="{!$ObjectType.AsiaQuotationTermsConditions__c.Fields.Packing__c.Label & ' : '}"
                                                      styleClass="{!IF(pageDetail.section6_Packing_Title_AppearTime != 0, '', 'Hid')}"/>
                                </td>
                                <td>
                                    <table>
                                        <apex:repeat value="{!pageDetail.packingList}" var="pack">
                                        <tr>
                                            <td style="padding:0;height: 4mm;">
                                                <apex:outputtext value="{!pack}" escape="false"/>
                                            </td>
                                        </tr>
                                        </apex:repeat>
                                    </table>
                                </td>
                            </tr>
                            <!-- Training -->
                            <tr class="{!IF(pageDetail.section6_Training_AppearTime != 0, '', 'Hid')}">
                                <td valign="top" class="section5W_td1" align="right">
                                    <apex:outputLabel value="{!$ObjectType.AsiaQuotationTermsConditions__c.Fields.Training__c.Label & ' : '}"
                                                      styleClass="{!IF(pageDetail.section6_Training_Title_AppearTime != 0, '', 'Hid')}"/>
                                </td>
                                <td>
                                    <table>
                                        <apex:repeat value="{!pageDetail.trainingList}" var="train">
                                        <tr>
                                            <td style="padding:0;height: 4mm;">
                                                <apex:outputtext value="{!train}" escape="false"/>
                                            </td>
                                        </tr>
                                        </apex:repeat>
                                    </table>
                                </td>
                            </tr>
                            <!-- Export -->
                            <tr class="{!IF(pageDetail.section6_Export_AppearTime != 0, '', 'Hid')}">
                                <td valign="top" class="section5W_td1" align="right">
                                    <apex:outputLabel value="{!$ObjectType.AsiaQuotationTermsConditions__c.Fields.Export__c.Label & ' : '}"
                                                      styleClass="{!IF(pageDetail.section6_Export_Title_AppearTime != 0, '', 'Hid')}"/>
                                </td>
                                <td>
                                    <table width="100%">
                                        <apex:repeat value="{!pageDetail.exportList}" var="exp">
                                        <tr>
                                            <td style="padding:0;height: 4mm;">
                                                <apex:outputtext value="{!exp}" escape="false"/>
                                            </td>
                                        </tr>
                                        </apex:repeat>
                                    </table>
                                </td>
                            </tr>
                            <!-- Validity -->
                            <tr class="{!IF(pageDetail.section6_Validity_AppearTime != 0 &&
                                            QuotationValidityLabel != null && NOT(quotation.PrintProformaInvoice__c), '', 'Hid')}">
                                <td valign="top" class="section5W_td1" align="right">
                                    <apex:outputLabel value="{!$ObjectType.AsiaQuotationTermsConditions__c.Fields.Validity__c.Label & ' : '}"
                                                      styleClass="{!IF(pageDetail.section6_Validity_Title_AppearTime != 0, '', 'Hid')}"/>
                                </td>
                                <td>
                                    <apex:outputText value="This quotation stands valid {!QuotationValidityLabel}."
                                                     styleClass="{!IF(pageDetail.section6_Validity_Title_AppearTime != 0, '', 'Hid')}"/>
                                </td>
                            </tr>
                            <!-- Manufacturer -->
                            <tr class="{!IF(pageDetail.section6_Manufacturer_AppearTime != 0 && quotation.PrintProformaInvoice__c, '', 'Hid')}">
                                <td valign="top" class="section5W_td1" align="right">
                                    <apex:outputLabel value="Manufacturer : "/>
                                </td>
                                <td>
                                    <table>
                                        <apex:repeat value="{!pageDetail.manufacturerList}" var="manufacturer">
                                        <tr>
                                            <td style="padding:0;height: 4mm;">
                                                <apex:outputtext value="{!manufacturer}" escape="false"/>
                                            </td>
                                        </tr>
                                        </apex:repeat>
                                    </table>
                                </td>
                            </tr>
                            <!-- BankDetail -->
                            <tr class="{!IF(pageDetail.section6_BankDetail_AppearTime != 0 && quotation.PrintProformaInvoice__c, '', 'Hid')}">
                                <td valign="top" class="section5W_td1" align="right">
                                    <apex:outputLabel value="Bank Detail : "/>
                                </td>
                                <td>
                                    <table width="100%">
                                        <apex:repeat value="{!pageDetail.bankDetailList}" var="bankDetail">
                                        <tr>
                                            <td style="padding:0;height: 4mm;">
                                                <apex:outputtext value="{!bankDetail}" escape="false"/>
                                            </td>
                                        </tr>
                                        </apex:repeat>
                                    </table>
                                </td>
                            </tr>
                        </table>
                        </apex:outputPanel>
                        
                        <apex:outputPanel rendered="{!quotation.RecordType.DeveloperName == 'SVC'}">
                            <table style="margin-top: 10mm;" class="{!IF(pageDetail.section6_Title_AppearTime != 0 || 
                                                                        pageDetail.section6_Price_AppearTime != 0 ||
                                                                        pageDetail.section6_Remarks_AppearTime != 0 ||
                                                                        pageDetail.section6_Validity_AppearTime != 0 || 
                                                                        (pageDetail.section6_Manufacturer_AppearTime != 0 && quotation.PrintProformaInvoice__c) || 
                                                                        (pageDetail.section6_BankDetail_AppearTime != 0 && quotation.PrintProformaInvoice__c), '', 'Hid')}" width="100%">
                                <!-- Title -->
                                <tr class="{!IF(pageDetail.section6_Title_AppearTime != 0, '', 'Hid')}">
                                    <td colspan="2" class="textL boldStr1" >
                                        <apex:outputText value="Basic Terms & Conditions:" />
                                    </td>
                                </tr>
                                <!-- Price -->
                                <tr class="{!IF(pageDetail.section6_Price_Title_AppearTime != 0, '', 'Hid')}">
                                    <td valign="top" class="section5W_td1" align="right">
                                        <apex:outputLabel value="{!$ObjectType.AsiaQuotationTermsConditions__c.Fields.Price__c.Label & ' : '}"
                                                          styleClass="{!IF(pageDetail.section6_Price_Title_AppearTime != 0, '', 'Hid')}"/>
                                    </td>
                                    <td>
                                        <table>
                                            <apex:repeat value="{!pageDetail.priceList}" var="price">
                                            <tr>
                                                <td style="padding:0;height: 4mm;">
                                                    <apex:outputtext value="{!price}" escape="false"/>
                                                </td>
                                            </tr>
                                            </apex:repeat>
                                        </table>
                                    </td>
                                </tr>
                                <!-- Remarks -->
                                <tr class="{!IF(pageDetail.section6_Remarks_AppearTime != 0, '', 'Hid')}">
                                    <td valign="top" class="section5W_td1" align="right">
                                        <apex:outputLabel value="{!$ObjectType.AsiaQuotationTermsConditions__c.Fields.Remarks__c.Label & ' : '}"
                                                          styleClass="{!IF(pageDetail.section6_Remarks_Title_AppearTime != 0, '', 'Hid')}"/>
                                    </td>
                                    <td>
                                        <table width="100%">
                                            <apex:repeat value="{!pageDetail.remarksList}" var="remarks">
                                            <tr>
                                                <td style="padding:0;height: 4mm;">
                                                    <apex:outputtext value="{!remarks}" escape="false"/>
                                                </td>
                                            </tr>
                                            </apex:repeat>
                                        </table>
                                    </td>
                                </tr>
                                <!-- Validity -->
                                <tr class="{!IF(pageDetail.section6_Validity_AppearTime != 0 &&
                                                QuotationValidityLabel != null && NOT(quotation.PrintProformaInvoice__c), '', 'Hid')}">
                                    <td valign="top" class="section5W_td1" align="right">
                                        <apex:outputLabel value="{!$ObjectType.AsiaQuotationTermsConditions__c.Fields.Validity__c.Label & ' : '}"
                                                          styleClass="{!IF(pageDetail.section6_Validity_Title_AppearTime != 0, '', 'Hid')}"/>
                                    </td>
                                    <td>
                                        <apex:outputText value="This quotation stands valid {!QuotationValidityLabel}."
                                                         styleClass="{!IF(pageDetail.section6_Validity_Title_AppearTime != 0, '', 'Hid')}"/>
                                    </td>
                                </tr>
                                <!-- Manufacturer -->
                                <tr class="{!IF(pageDetail.section6_Manufacturer_AppearTime != 0 && quotation.PrintProformaInvoice__c, '', 'Hid')}">
                                    <td valign="top" class="section5W_td1" align="right">
                                        <apex:outputLabel value="Manufacturer : "/>
                                    </td>
                                    <td>
                                        <table>
                                            <apex:repeat value="{!pageDetail.manufacturerList}" var="manufacturer">
                                            <tr>
                                                <td style="padding:0;height: 4mm;">
                                                    <apex:outputtext value="{!manufacturer}" escape="false"/>
                                                </td>
                                            </tr>
                                            </apex:repeat>
                                        </table>
                                    </td>
                                </tr>
                                <!-- Bank Detail -->
                                <tr class="{!IF(pageDetail.section6_BankDetail_AppearTime != 0 && quotation.PrintProformaInvoice__c, '', 'Hid')}">
                                    <td valign="top" class="section5W_td1" align="right">
                                        <apex:outputLabel value="Bank Detail : "/>
                                    </td>
                                    <td>
                                        <table width="100%">
                                            <apex:repeat value="{!pageDetail.bankDetailList}" var="bankDetail">
                                            <tr>
                                                <td style="padding:0;height: 4mm;">
                                                    <apex:outputtext value="{!bankDetail}" escape="false"/>
                                                </td>
                                            </tr>
                                            </apex:repeat>
                                        </table>
                                    </td>
                                </tr>
                            </table>
                        </apex:outputPanel>
                        <!-- section7 -->
                        <table align="center" width="100%" style="margin-top: 4mm;" class="{!IF(pageDetail.pageNo == pageBlockList.size, '', 'Hid')}">
                            <tr class="{!IF(quotation.PrintQuotationBudgetPurpose__c, '', 'Hid')}">
                                <td class="boldStr" colspan="2" align="right" valign="center">
                                    <apex:outputText value="This quotation is for budgetary purposes only."/>
                                </td>
                            </tr>
                            <tr class="{!IF(userSignURL != null && userSignURL != '', '', 'Hid')}">
                                <td width="60%"></td>
                                <td align="center" width="40%">
                                    <apex:image url="{!userSignURL}"/>
                                </td>
                            </tr>
                            <tr class="{!IF(userSignURL != null && userSignURL != '', 'Hid', '')}" style="height: {!userSignHeight}mm;">
                                <td width="60%"></td>
                                <td align="center" width="40%"></td>
                            </tr>
                            <tr>
                                <td width="60%"></td>
                                <td align="center" class="userSignUnderLine"></td>
                            </tr>
                            <tr>
                                <td width="60%"></td>
                                <td align="center">
                                    <apex:outputText value="{!userName}"/>
                                </td>
                            </tr>
                            <tr>
                                <td width="60%"></td>
                                <td align="center">
                                    <apex:outputText value="{!userTitle}"/>
                                </td>
                            </tr>
                        </table>
                    </apex:repeat>
                </div>
                
                <!-- ==================================================================================================== -->
                <!-- Specification Section                                                                                -->
                <!-- ==================================================================================================== -->
                <apex:outputPanel layout="none" rendered="{! quotation.PrintQuotationSpecificationsPage__c }" >
                    
                    <!-- ---------------------------------------------------------------------------------------------------- -->
                    <!-- Specification Section:  noRecommendedPageBlock                                                       -->
                    <!-- ---------------------------------------------------------------------------------------------------- -->
                    <!-- noRecommended LineNo init -->
                    <apex:variable value="{! 0 }" var="LineNo"/>
                    <apex:repeat value="{! noRecommendedSpecPageBlockList }" var="pageBlock">
                        
                        <apex:variable value="{! 0 }" var="LineCount"/>
                        
                        <div>
                            <!-- Header -->
                            <apex:outputPanel rendered="{! pageBlock.isBreak }">
                                <table id="noRecommendedHeaderId" class="{! IF(pageBlock.isBreak, 'quotationDescription-headerBreak', 'quotationDescription-headerNotBreak') }" align="center">
                                    <tr class="boldStr">
                                        <td width="5%" class="headerTdCenter">
                                            <div class="quotationDescription-header-title">Line</div>
                                        </td>
                                        <td width="22%" class="headerTdCenter">
                                            <div class="quotationDescription-header-title">Model Type</div>
                                        </td>
                                        <td width="33%" class="headerTdCenter">
                                            <div class="quotationDescription-header-title">Detailed Description</div>
                                        </td>
                                        <td width="5%" class="headerTdCenter">
                                            <div class="quotationDescription-header-title">Qty</div>
                                        </td>
                                        <td width="5%" class="headerTdCenter">
                                            <apex:outputPanel rendered="{! IF(quotation.PrintQuantityUnit__c, true, false) }">
                                                <div class="quotationDescription-header-title"></div>
                                            </apex:outputPanel>
                                        </td>
                                        <td width="15%" class="headerTdCenter">
                                            <apex:outputPanel rendered="{! IF(quotation.PrintUnitPrice__c, true, false) }">
                                                <div class="quotationDescription-header-title">Unit Price</div>
                                            </apex:outputPanel>
                                        </td>
                                        <td width="15%" align="center" class="headerTdCenter">
                                            <apex:outputPanel rendered="{! IF(quotation.PrintNotDetailAmounts__c, false, true) }">
                                                <div class="quotationDescription-header-title">Ext. Price</div>
                                                <div class="quotationDescription-header-title">( {! quotation.SalesCurrency__c } )</div>
                                            </apex:outputPanel>
                                        </td>
                                    </tr>
                                </table>
                            </apex:outputPanel>
                            
                            <!-- Detail -->
                            <apex:repeat value="{! pageBlock.splitResultList }" var="recordKey">
                                
                                <!-- 明細カウント -->
                                <apex:variable value="{! (LineCount + 1) }" var="LineCount"/>
                                <apex:variable value="{! if(pageBlock.recordRowMapPCD[recordKey].Depth__c == 0 && pageBlock.recordRowMapPCD[recordKey].Type__c == '1', (LineNo + 1), LineNo) }" var="LineNo"/>
                                
                                <table id="noRecommendedDetailId" class="quotationDescription-detail lineH" align="center" cellspacing="0" cellpadding="0" >
                                    
                                    <!-- 明細間の空白行 -->
                                    <apex:outputPanel rendered="{! IF(LineCount > 1, true, false) }" layout="none">
                                        <tr style="height:2mm;">
                                            <td width="5%"/>
                                            <td width="22%"/>
                                            <td width="33%"/>
                                            <td width="5%"/>
                                            <td width="5%"/>
                                            <td width="15%"/>
                                            <td width="15%"/>
                                        </tr>
                                    </apex:outputPanel>
                                    
                                    <!-- 明細行 -->
                                    <apex:outputPanel rendered="true" layout="none">
                                    <tr class="boldStr1">
                                        <td width="5%">
                                            <div class="quotationDescription-header-title">
                                                <apex:outputText value="{! if(pageBlock.recordRowMapPCD[recordKey].Depth__c == 0 && pageBlock.recordRowMapPCD[recordKey].Type__c == '1', LineNo, '') }"/>
                                            </div>
                                        </td>
                                        <td width="22%" class="textL">
                                            <div class="quotationDescription-header-title">
                                                <apex:outputField value="{! pageBlock.recordRowMapPCD[recordKey].ModelType__c }"/>
                                            </div>
                                        </td>
                                        <td width="33%" class="textL">
                                            <div class="quotationDescription-header-title">
                                                <apex:outputField value="{! pageBlock.recordRowMapPCD[recordKey].Body__c }"/>
                                            </div>
                                        </td>
                                        <td width="5%" class="right_justified">
                                            <div class="quotationDescription-header-title">
                                                <apex:outputText value="{0, number, #}">
                                                    <apex:param value="{! pageBlock.recordRowMapPCD[recordKey].Quantity__c }" />
                                                </apex:outputText>
                                            </div>
                                        </td>
                                        <td width="5%" class="textL">
                                            <apex:outputPanel rendered="{!IF(quotation.PrintQuantityUnit__c, true, false)}">
                                                <div class="quotationDescription-header-title">
                                                    <apex:outputText value="{! pageBlock.recordRowMapPCD[recordKey].QuantityUnit__c }"/>
                                                </div>
                                            </apex:outputPanel>
                                        </td>
                                        <td width="15%" class="textR">
                                            <apex:outputPanel rendered="{!IF(quotation.PrintUnitPrice__c, true, false)}">
                                            <apex:outputPanel rendered="{!IF(pageBlock.recordRowMapPCD[recordKey].SalesUnitPrice__c != 0, true, false)}">
                                            <div class="quotationDescription-header-title" >
                                                <apex:outputText value="{0, number, ###,###.00}">
                                                    <apex:param value="{! pageBlock.recordRowMapPCD[recordKey].SalesUnitPrice__c }" />
                                                </apex:outputText>
                                            </div>
                                            </apex:outputPanel>
                                            </apex:outputPanel>
                                        </td>
                                        <td width="15%" class="textR" >
                                            <apex:outputPanel rendered="{!IF(quotation.PrintNotDetailAmounts__c, false, true)}">
                                            <apex:outputPanel rendered="{!IF(pageBlock.recordRowMapPCD[recordKey].SalesPriceFormula__c != 0, true, false)}">
                                                <div class="quotationDescription-header-title" >
                                                    <apex:outputText value="{0, number, ###,###.00}">
                                                        <apex:param value="{! pageBlock.recordRowMapPCD[recordKey].SalesPriceFormula__c }" />
                                                    </apex:outputText>
                                                </div>
                                            </apex:outputPanel>
                                            </apex:outputPanel>
                                        </td>
                                    </tr>
                                        <tr style="height:2mm;">
                                            <td width="5%"/>
                                            <td width="22%"/>
                                            <td width="33%"/>
                                            <td width="5%"/>
                                            <td width="5%"/>
                                            <td width="15%"/>
                                            <td width="15%"/>
                                        </tr>
                                    </apex:outputPanel>
                                    
                                    <apex:outputPanel rendered="true" layout="none">
                                    <tr>
                                        <td width="5%"/>
                                        <td colspan="6" width="95%" style="padding:0;height: 4mm" class="textL">
                                            <apex:repeat value="{! pageBlock.recordRowMapSpec[recordKey] }" var="spec">
                                                
                                                <!-- 1行出力する毎に強制改ページが必要か否かを判断して出力する -->
                                                
                                                <!-- 強制改ページ -->
                                                <div class="{!IF(spec == pageBreakTag, 'pageBreak', '')}"></div>
                                                
                                                <!-- スペック情報 -->
                                                <apex:outputPanel rendered="{!IF(spec == pageBreakTag, false, true)}" layout="none">
                                                    <apex:outputText escape="false" value="{! spec }" /><br/>
                                                </apex:outputPanel>
                                                
                                            </apex:repeat>
                                        </td>
                                    </tr>
                                    </apex:outputPanel>
                                </table>
                            </apex:repeat>
                        </div>
                    </apex:repeat>
                    
                    <!-- ---------------------------------------------------------------------------------------------------- -->
                    <!-- Specification Section:  recommendedPageBlock                                                       -->
                    <!-- ---------------------------------------------------------------------------------------------------- -->
                    <!-- recommended LineNo init -->
                    <apex:variable value="{! 0 }" var="LineNo"/>
                    <apex:repeat value="{! recommendedSpecPageBlockList }" var="pageBlock">
                        
                        <apex:variable value="{! 0 }" var="LineCount"/>
                        
                        <div>
                            <!-- Header -->
                            <apex:outputPanel rendered="{! pageBlock.isBreak }">
                                <table class="{!IF(pageBlock.isBreak, 'quotationDescription-headerBreak', 'quotationDescription-headerNotBreak')}" align="center">
                                    <tr class="boldStr">
                                        <td width="5%" class="headerTdCenter">
                                            <div class="quotationDescription-header-title">Line</div>
                                        </td>
                                        <td width="15%" class="headerTdCenter">
                                            <div class="quotationDescription-header-title">Model Type</div>
                                        </td>
                                        <td width="40%" class="headerTdCenter">
                                            <div class="quotationDescription-header-title">
                                                Optionally Available Detailed Description<br/>
                                                (May replace above item(s) or be added to system)
                                            </div>
                                        </td>
                                        <td width="5%" class="headerTdCenter">
                                            <div class="quotationDescription-header-title">Qty</div>
                                        </td>
                                        <td width="5%" class="{!IF(quotation.PrintQuantityUnit__c,'headerTdCenter', 'Hid')}">
                                            <div class="quotationDescription-header-title"></div>
                                        </td>
                                        <td width="15%" class="{!IF(quotation.PrintUnitPrice__c,'headerTdCenter', 'Hid')}">
                                            <div class="quotationDescription-header-title">Unit Price</div>
                                        </td>
                                        <td width="15%" align="center" class="headerTdCenter">
                                            <apex:outputPanel rendered="{!IF(quotation.PrintNotDetailAmounts__c, false, true)}">
                                                <div class="quotationDescription-header-title">Ext. Price</div>
                                                <div class="quotationDescription-header-title">( {!quotation.SalesCurrency__c} )</div>
                                            </apex:outputPanel>
                                        </td>
                                    </tr>
                                </table>
                            </apex:outputPanel>
                            
                            <!-- Detail -->
                            <apex:repeat value="{! pageBlock.splitResultList }" var="recordKey">
                                
                                <!-- 明細カウント -->
                                <apex:variable value="{! (LineCount + 1) }" var="LineCount"/>
                                <apex:variable value="{! if(pageBlock.recordRowMapPCD[recordKey].Depth__c == 0 && pageBlock.recordRowMapPCD[recordKey].Type__c == '1', (LineNo + 1), LineNo) }" var="LineNo"/>
                                
                                <table id="recommendedDetailId" class="quotationDescription-detail lineH" align="center" cellspacing="0" cellpadding="0" >
                                    
                                    <!-- 明細間の空白行 -->
                                    <apex:outputPanel rendered="{! IF(LineCount > 1, true, false) }" layout="none">
                                        <tr style="height:2mm;">
                                            <td width="5%"/>
                                            <td width="22%"/>
                                            <td width="33%"/>
                                            <td width="5%"/>
                                            <td width="5%"/>
                                            <td width="15%"/>
                                            <td width="15%"/>
                                        </tr>
                                    </apex:outputPanel>
                                    
                                    <!-- 明細行 -->
                                    <apex:outputPanel rendered="true" layout="none">
                                    <tr class="boldStr1">
                                        <td width="5%">
                                            <div class="quotationDescription-header-title">
                                                <apex:outputText value="{! if(pageBlock.recordRowMapPCD[recordKey].Depth__c == 0 && pageBlock.recordRowMapPCD[recordKey].Type__c == '1', LineNo, '') }"/>
                                            </div>
                                        </td>
                                        <td width="15%" class="textL">
                                            <div class="quotationDescription-header-title">
                                                <apex:outputField value="{! pageBlock.recordRowMapPCD[recordKey].ModelType__c }"/>
                                            </div>
                                        </td>
                                        <td width="40%" class="textL">
                                            <div class="quotationDescription-header-title">
                                                <apex:outputField value="{! pageBlock.recordRowMapPCD[recordKey].Body__c }"/>
                                            </div>
                                        </td>
                                        <td width="5%" class="right_justified">
                                            <div class="quotationDescription-header-title">
                                                <apex:outputText value="{0, number, #}">
                                                    <apex:param value="{! pageBlock.recordRowMapPCD[recordKey].Quantity__c }" />
                                                </apex:outputText>
                                            </div>
                                        </td>
                                        <td width="5%" class="{!IF(quotation.PrintQuantityUnit__c,'textL', 'Hid')}">
                                            <apex:outputPanel rendered="{!IF(quotation.PrintQuantityUnit__c, true, false)}">
                                                <div class="quotationDescription-header-title">
                                                    <apex:outputText value="{! pageBlock.recordRowMapPCD[recordKey].QuantityUnit__c }"/>
                                                </div>
                                            </apex:outputPanel>
                                        </td>
                                        <td width="15%" class="{!IF(quotation.PrintUnitPrice__c, 'textR', 'Hid')}">
                                            <apex:outputPanel rendered="{!IF(quotation.PrintUnitPrice__c, true, false)}">
                                            <apex:outputPanel rendered="{!IF(pageBlock.recordRowMapPCD[recordKey].SalesUnitPrice__c != 0, true, false)}">
                                            <div class="quotationDescription-header-title" >
                                                <apex:outputText value="{0, number, ###,###.00}">
                                                    <apex:param value="{! pageBlock.recordRowMapPCD[recordKey].SalesUnitPrice__c }" />
                                                </apex:outputText>
                                            </div>
                                            </apex:outputPanel>
                                            </apex:outputPanel>
                                        </td>
                                        <td width="15%" class="textR" >
                                            <apex:outputPanel rendered="{!IF(quotation.PrintNotDetailAmounts__c, false, true)}">
                                            <apex:outputPanel rendered="{!IF(pageBlock.recordRowMapPCD[recordKey].SalesPriceFormula__c != 0, true, false)}">
                                                <div class="quotationDescription-header-title" >
                                                    <apex:outputText value="{0, number, ###,###.00}">
                                                        <apex:param value="{! pageBlock.recordRowMapPCD[recordKey].SalesPriceFormula__c }" />
                                                    </apex:outputText>
                                                </div>
                                            </apex:outputPanel>
                                            </apex:outputPanel>
                                        </td>
                                    </tr>
                                    </apex:outputPanel>
                                    
                                    <apex:outputPanel rendered="true" layout="none">
                                    <tr>
                                        <td width="5%"/>
                                        <td colspan="6" width="95%" style="padding:0;height: 4mm" class="textL">
                                            <apex:repeat value="{! pageBlock.recordRowMapSpec[recordKey] }" var="spec">
                                                
                                                <!-- 1行出力する毎に強制改ページが必要か否かを判断して出力する -->
                                                
                                                <!-- 強制改ページ -->
                                                <div class="{!IF(spec == pageBreakTag, 'pageBreak', '')}"></div>
                                                
                                                <!-- スペック情報 -->
                                                <apex:outputPanel rendered="{!IF(spec == pageBreakTag, false, true)}" layout="none">
                                                    <apex:outputText escape="false" value="{! spec }" /><br/>
                                                </apex:outputPanel>
                                                
                                            </apex:repeat>
                                        </td>
                                    </tr>
                                    </apex:outputPanel>
                                </table>
                            </apex:repeat>
                        </div>
                    </apex:repeat>
                </apex:outputPanel>
                
                <!-- ==================================================================================================== -->
                <!-- Spare Parts detail -->
                <!-- ==================================================================================================== -->
                <apex:variable value="{!0}" var="LineNo"/>
                <apex:variable value=" " var="modelName"/>
                <apex:outputPanel layout="block" id="spParts" rendered="{!quotation.Print2SPDetail__c && spPageBlockList.size > 0}">
                    <apex:repeat value="{!spPageBlockList}" var="spPage" >

                        <div class="{!IF(spPage.pageBreak, 'pageBreak', '')}"></div>

                        <apex:variable value="{!IF(modelName == spPage.parent.ModelType__c, LineNo, 0)}" var="LineNo"/>
                        <apex:variable value="{!spPage.parent.ModelType__c}" var="modelName"/>
                        <table class="headerTable marginSpace">
                            <tr>
                                <th colspan="6" class="disLeft boldStr">
                                    <apex:outputText value="Spare Parts for {!spPage.parent.ModelType__c}" />
                                </th>
                            </tr>
                        </table>
                        <table class="headerTable" cellspacing="0">
                            <tr class="headerTdCenter boldStr quotationDescription-header">
                                <th width="5%">
                                    <apex:outputText value="Line" />
                                </th>
                                <th width="2%">
                                    <apex:outputText value="" />
                                </th>
                                <th width="5%">
                                    <apex:outputText value="Qty" />
                                </th>
                                <th width="2%">
                                    <apex:outputText value="" />
                                </th>
                                <th class="disLeft" width="43%">
                                    <apex:outputText value="Part Number" />
                                </th>
                                <th class="disLeft" width="43%">
                                    <apex:outputText value="Description" />
                                </th>
                            </tr>
                        </table>
                    
                        <apex:repeat value="{!spPage.spMap[spPage.parent.Id]}" var="sp" >
                            <table class="headerTable" cellspacing="0">
                                <apex:variable value="{!if(spPage.parent.Depth__c == 0 && spPage.parent.Type__c == '1', LineNo + 1, LineNo)}" var="LineNo"/>
                                    <tr>
                                        <th width="5%">
                                            <apex:outputText value="{!if(spPage.parent.Depth__c == 0 && spPage.parent.Type__c == '1', LineNo, '')}" />
                                        </th>
                                        <th width="2%">
                                            <apex:outputText value="" />
                                        </th>
                                        <th class="disRight" width="5%">
                                            <apex:outputText value="{0, number, #.#}">
                                                <apex:param value="{!sp.Quantity__c}" />
                                            </apex:outputText>
                                        </th>
                                        <th width="2%">
                                            <apex:outputText value="" />
                                        </th>
                                        <th class="disLeft" width="43%">
                                            <apex:outputText value="{!sp.PartNumber__c}" />
                                        </th>
                                        <th class="disLeft" width="43%">
                                            <apex:outputText value="{!sp.Description__c}" />
                                        </th>
                                    </tr>
                            </table>
                        </apex:repeat>
                    </apex:repeat>
                </apex:outputPanel>

                <!-- ==================================================================================================== -->
                <!-- Terms And Conditions -->
                <!-- ==================================================================================================== -->
                <apex:outputPanel layout="none" rendered="{! quotation.PrintJeolTerms__c }">
                    
                    <!-- 事前 強制改ページ (改ページしてからフッターを空上書きする必要がある) -->
                    <div class="pageBreak"></div>
                    
                    <!-- from here, the footer is overwrite with blank data -->
                    <apex:outputPanel layout="none" rendered="true">
                        <div class="footer">
                            <table align="center" width="100%" class="footerlineH" >
                                <tr>
                                    <td></td>
                                    <td align="right">
                                        <span>
                                            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                                        </span>
                                    </td>
                                </tr>
                                <tr>
                                    <td colspan="2">
                                    </td>
                                </tr>
                            </table>
                        </div>
                    </apex:outputPanel>
                    
                    <apex:repeat value="{!lsTermsAndConditions}" var="varTerms" >
                        <apex:outputPanel layout="none" rendered="true" >
                            <div class="lastPage" >
                                <apex:outputLabel value="{!varTerms.TermsAndConditions__c}" escape="false" />
                            </div>
                        </apex:outputPanel>
                    </apex:repeat>
                    
                </apex:outputPanel>

            </div>
        </apex:form>
        </body>
    </html>
</apex:page>